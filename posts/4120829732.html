<!-- build time:Sat Sep 20 2025 23:13:34 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon.ico"><link rel="alternate" href="/rss.xml" title="LinuxSre云原生" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="LinuxSre云原生" type="application/atom+xml"><link rel="alternate" type="application/json" title="LinuxSre云原生" href="http://ixuyong.cn/feed.json"><link rel="preconnect" href="https://s4.zstatic.net"><link rel="preconnect" href="https://at.alicdn.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.17"><link rel="modulepreload" href="/js/chunk-GV364XSK.js"><link rel="modulepreload" href="/js/chunk-NYSE5UKM.js"><link rel="modulepreload" href="/js/chunk-RONCYO2S.js"><link rel="modulepreload" href="/js/chunk-THHXCRSX.js"><link rel="modulepreload" href="/js/chunk-WIQECBEN.js"><link rel="modulepreload" href="/js/comments-DL2IYMPZ.js"><link rel="modulepreload" href="/js/copy-tex-NADCTXPG.js"><link rel="modulepreload" href="/js/post-DA635IH6.js"><link rel="modulepreload" href="/js/quicklink-WEDHL4BA.js"><link rel="modulepreload" href="/js/search-VCZRKTM5.js"><link rel="modulepreload" href="/js/siteInit.js"><link rel="modulepreload" href="/js/waline-NNBYRQEE.js"><link rel="stylesheet" href="/css/comments-F4ZGS7LD.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/siteInit.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/waline-IDNZKML2.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="preload" href="https://s21.ax1x.com/2025/03/29/pEsS0hD.png" as="image" fetchpriority="high"><meta name="keywords" content="Linux"><meta name="description" content="专注于 Linux 运维、云计算、云原⽣等技术"><link rel="canonical" href="http://ixuyong.cn/posts/4120829732.html"><title>DNS域名解析服务</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">DNS域名解析服务</h1><div class="meta"><span class="item" title="创建时间：2025-09-19 22:12:25"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2025-09-19T22:12:25+08:00">2025-09-19</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>25k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>23 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">LinuxSre云原生</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><img src="https://s21.ax1x.com/2025/03/29/pEsS0hD.png" loading="eager" decoding="async" fetchpriority="high" alt="LinuxSre云原生"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Linux/" itemprop="item" rel="index" title="分类于Linux"><span itemprop="name">Linux<meta itemprop="position" content="0"></span></a></span></div><article class="post block" itemscope itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://ixuyong.cn/posts/4120829732.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.png"><meta itemprop="name" content="Xu Yong"><meta itemprop="description" content="致力于技术布道、普及前沿技术、打造云原生系列标杆博客, 专注于 Linux 运维、云计算、云原⽣等技术"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="LinuxSre云原生"></span><div class="body md" itemprop="articleBody"><h3 id="dns域名解析服务"><a class="anchor" href="#dns域名解析服务">#</a> DNS 域名解析服务</h3><h4 id="1-dns基本概述"><a class="anchor" href="#1-dns基本概述">#</a> 1. DNS 基本概述</h4><h5 id="11-为什么需要域名"><a class="anchor" href="#11-为什么需要域名">#</a> 1.1 为什么需要域名</h5><p>在互联网中，使用 IP 地址与服务器进行通信根本行不通，原因如下：</p><ul><li>1、不好记忆，例如：学校官网的 IP 地址是 &quot;39.104.16.126&quot; ，难以记忆；</li><li>2、IP 地址会经常变更，所以通过 IP 地址去访问某台机器就会发生访不到的问题；</li></ul><p>此时 DNS 协议就应运而生了，那 DNS 解决了什么问题？DNS 主要用来管理域名（比较好记忆的字符）与 IP 地址（比较难记忆）的对应关系表。</p><h5 id="12-什么是dns"><a class="anchor" href="#12-什么是dns">#</a> 1.2 什么是 DNS</h5><p>DNS（Domain Name System） 是 ” 域名系统 “英文缩写，它所提供的服务是用来将域名转换为 IP 地址的工作。 DNS 就是一位” 翻译官 “，它的基本工作原理可以用下图来表示；</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/S1Ee9BX.jpeg" alt="1.jpg"></p><h5 id="13-dns域名结构"><a class="anchor" href="#13-dns域名结构">#</a> 1.3 DNS 域名结构</h5><p>由于因特网的用户数量较多，所以因特网在命名时采用的是层次树状结构的命名方法。</p><ul><li>1. 互联网中的域名是有结构有规划的；</li><li>2. 由于域名进行了分级，在进行域名和 IP 地址解析时能更容易找到；</li><li>3. 其次域名具备全球唯一性；</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/ec0zOe9.png" alt="918540-20230506205656234-525954592.png"></p><h5 id="14-域名分类"><a class="anchor" href="#14-域名分类">#</a> 1.4 域名分类</h5><ul><li><p>根域：知道所有顶级域名服务器的域名和地址全世界只有 13 组根服务器，其中 10 台设置在美国，另外的三台设置与英国，瑞典，日本；</p></li><li><p>顶级域：知道所有顶级域名服务器下注册的所有二级域名的 IP 地址。</p><ul><li><p>顶级域有两种：通用域 （com） 域和国家域 （cn【包括 hk/tw】、jp）。</p></li><li><p>顶级域名由 ICANN （互联网名称与数字地址分配机构）委任的注册机构负责运行。</p></li></ul></li><li><p>二级域：负责一个区的域名服务器 （<a target="_blank" rel="noopener" href="http://hmallleasing.com">hmallleasing.com</a>）</p><ul><li>无需到 ICANN 进行申请，只需要到运行顶级域的注册机构（阿里、腾讯）去申请即可。</li><li>如果申请的域名没有被注册，也没有被注册为商标，仅需要缴纳一笔年费即可得到心仪的域名。</li></ul></li><li><p>三级域或主机名：根据服务器所提供的业务功能，选择配置对应的主机名称解析记录，比如（www、ops）</p></li></ul><h5 id="15-dns查询原理"><a class="anchor" href="#15-dns查询原理">#</a> 1.5 DNS 查询原理</h5><p>DNS 查询的结果通常会在本地域名服务器中进行缓存，如果本地域名服务器中有缓存的情况下，则会跳过如下 DNS 查询步骤，很快返回解析结果。<br>下面的示例则概述了本地域名服务器没有缓存的情况下， DNS 查询所需的步骤：</p><ul><li>1、用户在浏览器中输入 <a target="_blank" rel="noopener" href="http://example.com">example.com</a> ， 则由本地域名服务器开始进行递归查询。</li><li>2、本地域名服务器采用迭代查询的方法，向根域名服务器进行查询。</li><li>3、根域名服务器告诉本地域名服务器，下一步应该查询的顶级域名服务器 .TLD 的 IP 地址。</li><li>4、本地域名服务器向顶级域名服务器 .com TLD 进行查询。</li><li>5、.com TLD 服务器告诉本地域名服务器，下一步查询 <a target="_blank" rel="noopener" href="http://example.com">example.com</a> 权威域名服务器的 IP 地址。</li><li>6、本地域名服务器向 <a target="_blank" rel="noopener" href="http://example.com">example.com</a> 权威域名服务器发送查询。</li><li>7、<a target="_blank" rel="noopener" href="http://example.com">example.com</a> 权威域名服务器告诉本地域名服务器所查询的主机 IP 地址。</li><li>8、本地域名服务器最后把查询的 IP 地址响应给浏览器。</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/tskD255.jpeg" alt="Snipaste_2025-09-19_22-27-08.jpg"></p><h6 id="151-递归查询"><a class="anchor" href="#151-递归查询">#</a> 1.5.1 递归查询</h6><p>递归查询是指 DNS 服务器在收到用户发起的请求时，必须向用户返回一个准确的查询结果。<br>如果 DNS 服务器本地没有存储与之对应的信息，则该服务器需要询问其他服务器，并将返回的查询结构提交给用户。</p><h6 id="152-迭代查询"><a class="anchor" href="#152-迭代查询">#</a> 1.5.2 迭代查询</h6><p>迭代查询是指 DNS 服务器在收到用户发起的请求时，并不直接回复查询结果，而是告诉另一台 DNS 服务器的地址，用户再向这台 DNS 服务器提交请求，这样依次反复，直到返回查询结果。</p><h5 id="16-dns解析类型"><a class="anchor" href="#16-dns解析类型">#</a> 1.6 DNS 解析类型</h5><h6 id="161-a"><a class="anchor" href="#161-a">#</a> 1.6.1 A</h6><ul><li>A 记录可实现将域名指向 IP 地址，也称为正向解析；</li><li>正向解析：域名 --&gt; DNS 服务返回 IP；</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/3WCbtLs.jpeg" alt="1.jpg"></p><h6 id="162-ptr"><a class="anchor" href="#162-ptr">#</a> 1.6.2 PTR</h6><ul><li>PTR 记录可以实现 IP 查找域名，也称为反向解析；</li><li>反向解析： IP--&gt;DNS 服务返回域名；</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/BWcFQtl.jpeg" alt="2.jpg"></p><h6 id="163-cname"><a class="anchor" href="#163-cname">#</a> 1.6.3 CNAME</h6><ul><li>当需要将域名指向另一个域名，再由另一个域名提供 IP 地址，就需要添加 CNAME 记录；</li><li>最常用 CNAME 的场景有 WAF (Web Application Firewall)、CDN；</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/icO0aXj.jpeg" alt="3.jpg"></p><h6 id="164-ns"><a class="anchor" href="#164-ns">#</a> 1.6.4 NS</h6><ul><li>1、客户端查询 DNS 服务，如当前 DNS 无法提供权威解析，则返回一条 NS 记录；</li><li>2、客户端在通过 NS 记录中提供的 DNS 权威服务器进行解析；</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/e8xVQa8.jpeg" alt="4.jpg"></p><h6 id="165-mx"><a class="anchor" href="#165-mx">#</a> 1.6.5 MX</h6><p>MX 记录用于说明哪台服务器是当前区域的邮件服务器，包含内容：</p><ul><li>name：域名</li><li>IN MX：表示是邮件服务器的记录</li><li>数字：代表优先级</li><li>邮件服务器的完整域名：FQDN</li></ul><h5 id="17-企业自建dns方式"><a class="anchor" href="#17-企业自建dns方式">#</a> 1.7 企业自建 DNS 方式</h5><p>企业常规做法：购买域名、完成 ICP 备案，并使用公网 DNS 服务（万网..）进行免费（付费）解析。</p><p>为什么需要自建 DNS？</p><ul><li>1、内网 web 服务，例如： jenkins、jumpserver、wiki 等，不适合解析至公网；</li><li>2、内网中间件服务 db、mq 等，由于会经常迁移或扩缩容，应该使用域名对外提供，便于维护；</li><li>3、服务器都有 hostname ， hostname 应该设置为 FQDN ，如何维护主机名和主机的内网 IP 的关系；</li></ul><p>综上：我们需要构建至少一套企业内部的 DNS 服务；</p><h4 id="2-bind基础应用"><a class="anchor" href="#2-bind基础应用">#</a> 2. BIND 基础应用</h4><h5 id="21-什么是bind"><a class="anchor" href="#21-什么是bind">#</a> 2.1 什么是 BIND</h5><p>BIND （由美国加州大学开发并且维护的）、BIND 是一个开源、稳定、且应用广泛的 DNS 服务。</p><ul><li>开源：指 BIND 服务源代码是开放的；</li><li>稳定：指 BIND 服务运行非常稳定；</li><li>广泛：政府企业、单位机构、学校、等；</li></ul><h5 id="22-bind的组成"><a class="anchor" href="#22-bind的组成">#</a> 2.2 BIND 的组成</h5><p>BIND 提供（域名解析服务、权威域名服务、DNS 调试工具）</p><ul><li>域名解析服务：将域名解析为 IP 地址；</li><li>权威域名服务：能从该服务器查询到完整域名对应的 IP 地址，则这台服务器就算权威解析；</li><li>DNS 调试工具：主要提供 DNS 客户端调试工具，供客户端使用；</li></ul><h5 id="23-bind服务实战"><a class="anchor" href="#23-bind服务实战">#</a> 2.3 BIND 服务实战</h5><h6 id="231-bind环境准备"><a class="anchor" href="#231-bind环境准备">#</a> 2.3.1 BIND 环境准备</h6><table><thead><tr><th>系统版本</th><th>外网地址</th><th>内网地址</th><th>功能及作用</th></tr></thead><tbody><tr><td>Centos7</td><td>eth0：192.168.40.91</td><td>eth1：172.16.1.91</td><td>DNS-Master</td></tr><tr><td>Centos7</td><td>eth0：192.168.40.92</td><td>eth1：172.16.1.92</td><td>DNS-Slave</td></tr><tr><td>Centos7</td><td>eth0：192.168.40.93</td><td>eth1：172.16.1.93</td><td>DNS-Son【子域】</td></tr></tbody></table><h6 id="232-bind服务安装"><a class="anchor" href="#232-bind服务安装">#</a> 2.3.2 BIND 服务安装</h6><p>Bind 的安装非常简单，只需要通过 yum 即可完成安装；</p><ul><li>1、bind 提供主程序包；</li><li>2、bind-utils 提供工具包；</li></ul><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># yum install bind bind-utils -y</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># systemctl start named &amp;&amp; systemctl enable named</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc-confgen -r /dev/urandom -a</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># chown root:named /etc/rndc.key</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># chmod 640 /etc/rndc.key </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart named</span></pre></td></tr></table></figure><h6 id="233-bind配置文件"><a class="anchor" href="#233-bind配置文件">#</a> 2.3.3 BIND 配置文件</h6><ol><li>主配置文件格式</li></ol><ul><li>options {} ：全局选项（监听端口、数据文件存储位置、缓存位置、权限等）</li><li>logging {} ：服务日志选项</li><li>zone . {}：自定义区域配置</li><li>include：包含别的文件</li></ul><ol start="2"><li>主配置文件注意事项</li></ol><ul><li>语法非常严格；</li><li>文件权限属主 root ，属组 named ，文件权限 640</li></ul><ol start="3"><li>配置文件解析</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf </span></pre></td></tr><tr><td data-num="2"></td><td><pre>options <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	// ipv4监听地址及端口</pre></td></tr><tr><td data-num="4"></td><td><pre>	listen-on port <span class="token number">53</span> <span class="token punctuation">&#123;</span> <span class="token number">127.0</span>.0.1<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 	// ipv6监听地址及端口</pre></td></tr><tr><td data-num="6"></td><td><pre>	listen-on-v6 port <span class="token number">53</span> <span class="token punctuation">&#123;</span> ::1<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	// 区域配置存储目录</pre></td></tr><tr><td data-num="8"></td><td><pre>	directory 	<span class="token string">"/var/named"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	// DNS解析过内容的缓存文件</pre></td></tr><tr><td data-num="10"></td><td><pre>	dump-file 	<span class="token string">"/var/named/data/cache_dump.db"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	// 静态解析文件（几乎不用）</pre></td></tr><tr><td data-num="12"></td><td><pre>	statistics-file <span class="token string">"/var/named/data/named_stats.txt"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	// 内存的统计信息</pre></td></tr><tr><td data-num="14"></td><td><pre>	memstatistics-file <span class="token string">"/var/named/data/named_mem_stats.txt"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	recursing-file  <span class="token string">"/var/named/data/named.recursing"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	secroots-file   <span class="token string">"/var/named/data/named.secroots"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	// 允许谁本台DNS发起查询请求（localhost<span class="token operator">|</span><span class="token function">ip</span><span class="token operator">|</span>any）</pre></td></tr><tr><td data-num="18"></td><td><pre>	allow-query     <span class="token punctuation">&#123;</span> localhost<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>	/* </pre></td></tr><tr><td data-num="21"></td><td><pre>	 - If you are building an AUTHORITATIVE DNS server, <span class="token keyword">do</span> NOT <span class="token builtin class-name">enable</span> recursion.</pre></td></tr><tr><td data-num="22"></td><td><pre>	 - If you are building a RECURSIVE <span class="token punctuation">(</span>caching<span class="token punctuation">)</span> DNS server, you need to <span class="token builtin class-name">enable</span> </pre></td></tr><tr><td data-num="23"></td><td><pre>	   recursion. </pre></td></tr><tr><td data-num="24"></td><td><pre>	 - If your recursive DNS server has a public IP address, you MUST <span class="token builtin class-name">enable</span> access </pre></td></tr><tr><td data-num="25"></td><td><pre>	   control to limit queries to your legitimate users. Failing to <span class="token keyword">do</span> so will</pre></td></tr><tr><td data-num="26"></td><td><pre>	   cause your server to become part of large scale DNS amplification </pre></td></tr><tr><td data-num="27"></td><td><pre>	   attacks. Implementing BCP38 within your network would greatly</pre></td></tr><tr><td data-num="28"></td><td><pre>	   reduce such attack surface </pre></td></tr><tr><td data-num="29"></td><td><pre>	*/</pre></td></tr><tr><td data-num="30"></td><td><pre>	//递归查询</pre></td></tr><tr><td data-num="31"></td><td><pre>	recursion <span class="token function">yes</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	//安全校验相关的</pre></td></tr><tr><td data-num="33"></td><td><pre>	dnssec-enable <span class="token function">yes</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>	//安全校验相关的</pre></td></tr><tr><td data-num="35"></td><td><pre>	dnssec-validation <span class="token function">yes</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre>	/* Path to ISC DLV key */</pre></td></tr><tr><td data-num="38"></td><td><pre>	bindkeys-file <span class="token string">"/etc/named.root.key"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>	managed-keys-directory <span class="token string">"/var/named/dynamic"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>	pid-file <span class="token string">"/run/named/named.pid"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	session-keyfile <span class="token string">"/run/named/session.key"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>// 控制日志输出的级别以及输出的位置</pre></td></tr><tr><td data-num="47"></td><td><pre>logging <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        channel default_debug <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>                <span class="token function">file</span> <span class="token string">"data/named.run"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>                severity dynamic<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>//默认可以对任何域名提供解析服务，因为named.ca中存储的是全球根域服务器<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>zone <span class="token string">"."</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>	<span class="token builtin class-name">type</span> hint<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>	<span class="token function">file</span> <span class="token string">"named.ca"</span><span class="token punctuation">;</span>  //区域配置文件名称</pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>//包含其他文件</pre></td></tr><tr><td data-num="61"></td><td><pre>include <span class="token string">"/etc/named.rfc1912.zones"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>include <span class="token string">"/etc/named.root.key"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h6 id="234-客户端验证dns解析的配置"><a class="anchor" href="#234-客户端验证dns解析的配置">#</a> 2.3.4 客户端验证 DNS 解析的配置</h6><p>1. 配置 DNS 服务器指向，在 /etc/resolv.conf 里配置 dns 的 IP 地址</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-son ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/resolv.conf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># Generated by NetworkManager</span></pre></td></tr><tr><td data-num="3"></td><td><pre>nameserver <span class="token number">223.5</span>.5.5</pre></td></tr><tr><td data-num="4"></td><td><pre>nameserver <span class="token number">192.168</span>.40.91</pre></td></tr></table></figure><ol start="2"><li>使用 ping 命令验证解析</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-son ~<span class="token punctuation">]</span><span class="token comment"># ping www.baidu.com</span></pre></td></tr><tr><td data-num="2"></td><td><pre>PING www.a.shifen.com <span class="token punctuation">(</span><span class="token number">183.2</span>.172.17<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">64</span> bytes from <span class="token number">183.2</span>.172.17 <span class="token punctuation">(</span><span class="token number">183.2</span>.172.17<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">128</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">12.4</span> ms</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">64</span> bytes from <span class="token number">183.2</span>.172.17 <span class="token punctuation">(</span><span class="token number">183.2</span>.172.17<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">128</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">14.8</span> ms</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">64</span> bytes from <span class="token number">183.2</span>.172.17 <span class="token punctuation">(</span><span class="token number">183.2</span>.172.17<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">128</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">16.7</span> ms</pre></td></tr></table></figure><h5 id="24-自定义区域"><a class="anchor" href="#24-自定义区域">#</a> 2.4 自定义区域</h5><p>自定义域分为如下两类：</p><p>主机域（内网）</p><ul><li>1、主机域其实是一个假域；</li><li>2、主机域其实是不能解析到互联网上；</li><li>3、主机域它只对局域网（内网）提供服务；</li></ul><p>业务域（外网）</p><ul><li>1、业务域一般都是真实可用的；</li><li>2、业务域则为一个真正需要对外提供服务的域名；</li></ul><h6 id="241-自定义区域配置文件解析"><a class="anchor" href="#241-自定义区域配置文件解析">#</a> 2.4.1 自定义区域配置文件解析</h6><ul><li>区域 zone 文件定义在 /etc/named.conf 配置；</li><li>也可以配置在自定义的其他文件里，并在 named.conf 里 include</li><li>注意文件的权限，属主 root 属组 named 文件权限 640</li></ul><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>zone <span class="token string">"hmallleasing.com"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	<span class="token builtin class-name">type</span> master<span class="token operator">|</span>slave<span class="token punctuation">;</span>      // 自定义区域类型</pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token function">file</span> /path/to/zonefile<span class="token punctuation">;</span> // 绝对路径和相对路径</pre></td></tr><tr><td data-num="4"></td><td><pre>	allow-update <span class="token punctuation">&#123;</span>ip<span class="token operator">|</span>none<span class="token punctuation">&#125;</span><span class="token punctuation">;</span> // 允许哪个ip可以使用nsupdate动态更新区域文件</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h6 id="242-自定义区域数据库文件"><a class="anchor" href="#242-自定义区域数据库文件">#</a> 2.4.2 自定义区域数据库文件</h6><p>范例以及编写注意事项：</p><ul><li>1、严格注意语法书写，其格式非常严格；</li><li>2、记录不准许折行书写；</li><li>3、单行记录开头不准许空格或 tab 开头；</li></ul><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /var/named/example.com.zone</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>hmallleasing.com. IN SOA ns.hmallleasinge.com. xuyong.hmallleasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">;</span> 区域名称 IN SOA dns.hmallleasing.com. 管理员邮箱</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span> 区域名称可以使用过@表示，@表示当前域</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token number">2021041514</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">;</span> 给客户端返回NS记录，hmallleasing.com. 域名由哪几台权威服务器提供解析</pre></td></tr><tr><td data-num="15"></td><td><pre>hmallleasing.com. IN NS ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="16"></td><td><pre>hmallleasing.com. IN NS ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">;</span> A记录，配置权威域名的真实IP地址；</pre></td></tr><tr><td data-num="19"></td><td><pre>ns1.hmallleasing.com. IN A <span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="20"></td><td><pre>ns2.hmallleasing.com. IN A <span class="token number">172.16</span>.1.92</pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">;</span> 真正的域名解析</pre></td></tr><tr><td data-num="23"></td><td><pre>www.hmallleasing.com. IN A <span class="token number">1.1</span>.1.1</pre></td></tr><tr><td data-num="24"></td><td><pre>web.hmallleasing.com. IN A <span class="token number">2.2</span>.2.2</pre></td></tr></table></figure><h5 id="25-bind增加a记录正向解析实战"><a class="anchor" href="#25-bind增加a记录正向解析实战">#</a> 2.5 BIND 增加 A 记录正向解析实战</h5><p>用户通过 DNS 服务器 172.16.1.91 解析 <a target="_blank" rel="noopener" href="http://www.hmalleasing.com">www.hmalleasing.com</a></p><ul><li>1、添加 <a target="_blank" rel="noopener" href="http://hmallleasing.com">hmallleasing.com</a> 区域配置文件</li><li>2、添加区域数据库文件，配置 NS 记录，返回 DNS 权威服务器地址</li><li>3、该域的 DNS 权威服务器为 172.16.1.91</li><li>4、添加该域的 A 记录解析</li></ul><h6 id="251-新增区域配置文件"><a class="anchor" href="#251-新增区域配置文件">#</a> 2.5.1 新增区域配置文件</h6><p>1. 在主配置文件 /etc/named.conf，新增一个 hmallleasing.com 区域配置</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>options <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	// ipv4监听地址及端口</pre></td></tr><tr><td data-num="5"></td><td><pre>	listen-on port <span class="token number">53</span> <span class="token punctuation">&#123;</span> <span class="token number">127.0</span>.0.1<span class="token punctuation">;</span><span class="token number">172.16</span>.1.91<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="7"></td><td><pre>	// 允许谁本台DNS发起查询请求（localhost<span class="token operator">|</span><span class="token function">ip</span><span class="token operator">|</span>any）</pre></td></tr><tr><td data-num="8"></td><td><pre>	allow-query     <span class="token punctuation">&#123;</span> localhost<span class="token punctuation">;</span> <span class="token number">172.16</span>.1.0/24<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="10"></td><td><pre>//自行配置权威域名解析hmallleaing.com</pre></td></tr><tr><td data-num="11"></td><td><pre>zone <span class="token string">"hmallleasing.com"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 	 <span class="token builtin class-name">type</span> master<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 	 <span class="token function">file</span> <span class="token string">"hmallleasing.com.zone"</span><span class="token punctuation">;</span>    //具体解析记录配置存储至哪个文件</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>2. 检查配置文件语法是否正常</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkconf</span></pre></td></tr></table></figure><h6 id="252-新增区域数据库文件"><a class="anchor" href="#252-新增区域数据库文件">#</a> 2.5.2 新增区域数据库文件</h6><p>1. 添加区域数据库文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /var/named/hmallleasing.com.zone</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>hmallleasing.com. IN SOA ns.hmallleasing.com. xuy.nf-leasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">;</span> 区域名称 IN SOA dns.hmallleasing.com. 管理员邮箱</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span> 区域名称可以使用过@表示，@表示当前域</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token number">2025092018</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">;</span> 给客户端返回NS记录，hmallleasing.com. 域名由哪几台权威服务器提供解析</pre></td></tr><tr><td data-num="15"></td><td><pre>hmallleasing.com. IN NS ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">;</span> A记录，配置权威域名的真实IP地址；</pre></td></tr><tr><td data-num="18"></td><td><pre>ns1.hmallleasing.com. IN A <span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">;</span> 真正的域名解析</pre></td></tr><tr><td data-num="21"></td><td><pre>www.hmallleasing.com. IN A <span class="token number">1.1</span>.1.1</pre></td></tr><tr><td data-num="22"></td><td><pre>web.hmallleasing.com. IN A <span class="token number">2.2</span>.2.2</pre></td></tr></table></figure><p>2. 检查区域数据库文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkzone hmallleasing.com  /var/named/hmallleasing.com.zone</span></pre></td></tr><tr><td data-num="2"></td><td><pre>zone hmallleasing.com/IN: loaded serial <span class="token number">2025092018</span></pre></td></tr><tr><td data-num="3"></td><td><pre>OK</pre></td></tr></table></figure><p>3. 重载 DNS 服务器</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr></table></figure><h6 id="253-客户端测试域名解析"><a class="anchor" href="#253-客户端测试域名解析">#</a> 2.5.3 客户端测试域名解析</h6><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># yum install bind-utils -y</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig web.hmallleasing.com @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">2.2</span>.2.2</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig www.hmallleasing.com @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">1.1</span>.1.1</pre></td></tr></table></figure><h5 id="26-bind增加cname记录实战"><a class="anchor" href="#26-bind增加cname记录实战">#</a> 2.6 BIND 增加 CNAME 记录实战</h5><p>用户通过 DNS 服务器 172.16.1.91 解析 <a target="_blank" rel="noopener" href="http://www.job.com">www.job.com</a></p><p>1、添加 <a target="_blank" rel="noopener" href="http://job.com">job.com</a> 区域配置文件</p><p>2、添加区域数据库文件，配置 NS 记录，返回 DNS 权威服务器地址</p><p>3、该域的 DNS 权威服务器为 172.16.1.91</p><p>4、添加该域的 CNAME 解析记录，解析至 <a target="_blank" rel="noopener" href="http://www.hmallleasing.com">www.hmallleasing.com</a> 域名上</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/RBrxONj.jpeg" alt="1.jpg"></p><h6 id="261-新增区域配置文件"><a class="anchor" href="#261-新增区域配置文件">#</a> 2.6.1 新增区域配置文件</h6><p>1. 在主配置文件 /etc/named.conf，新增一个 hmallleasing.com 区域配置</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>options <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	// ipv4监听地址及端口</pre></td></tr><tr><td data-num="5"></td><td><pre>	listen-on port <span class="token number">53</span> <span class="token punctuation">&#123;</span> <span class="token number">127.0</span>.0.1<span class="token punctuation">;</span><span class="token number">172.16</span>.1.91<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="7"></td><td><pre>	// 允许谁本台DNS发起查询请求（localhost<span class="token operator">|</span><span class="token function">ip</span><span class="token operator">|</span>any）</pre></td></tr><tr><td data-num="8"></td><td><pre>	allow-query     <span class="token punctuation">&#123;</span> localhost<span class="token punctuation">;</span> <span class="token number">172.16</span>.1.0/24<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="10"></td><td><pre>//自行配置权威域名解析job.com</pre></td></tr><tr><td data-num="11"></td><td><pre>zone <span class="token string">"job.com"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 	 <span class="token builtin class-name">type</span> master<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 	 <span class="token function">file</span> <span class="token string">"job.com.zone"</span><span class="token punctuation">;</span>    //具体解析记录配置存储至哪个文件</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>2. 检查配置文件语法是否正常</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkconf</span></pre></td></tr></table></figure><h6 id="262-新增区域数据库文件"><a class="anchor" href="#262-新增区域数据库文件">#</a> 2.6.2 新增区域数据库文件</h6><p>1. 添加区域数据库文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /var/named/job.com.zone</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>job.com. IN SOA ns.job.com. xuy.nf-leasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">;</span> 区域名称 IN SOA dns.hmallleasing.com. 管理员邮箱</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span> 区域名称可以使用过@表示，@表示当前域</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token number">2025092018</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">;</span> 给客户端返回NS记录，hmallleasing.com. 域名由哪几台权威服务器提供解析</pre></td></tr><tr><td data-num="15"></td><td><pre>job.com. IN NS ns1.job.com.</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">;</span> A记录，配置权威域名的真实IP地址；</pre></td></tr><tr><td data-num="18"></td><td><pre>ns1.job.com. IN A <span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">;</span> 真正的域名解析</pre></td></tr><tr><td data-num="21"></td><td><pre>www.job.com. IN CNAME www.hmallleasing.com.</pre></td></tr><tr><td data-num="22"></td><td><pre>dev.job.com. IN A <span class="token number">2.2</span>.2.3</pre></td></tr></table></figure><p>2. 检查区域数据库文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkzone job.com  /var/named/job.com.zone</span></pre></td></tr><tr><td data-num="2"></td><td><pre>zone job.com/IN: loaded serial <span class="token number">2025092018</span></pre></td></tr><tr><td data-num="3"></td><td><pre>OK</pre></td></tr></table></figure><p>3. 重载 DNS 服务器</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr></table></figure><h6 id="263-客户端测试域名解析"><a class="anchor" href="#263-客户端测试域名解析">#</a> 2.6.3 客户端测试域名解析</h6><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig www.job.com @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="2"></td><td><pre>www.hmallleasing.com.</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">1.1</span>.1.1</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig dev.job.com @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">2.2</span>.2.3</pre></td></tr></table></figure><h5 id="27-bind增加ptr记录反向解析实战"><a class="anchor" href="#27-bind增加ptr记录反向解析实战">#</a> 2.7 BIND 增加 PTR 记录反向解析实战</h5><p>配置反向解析 PTR：IP--&gt;FQDN</p><ul><li>1、反向区域文件名称为逆向网络地址 加 .in-addr.arpa. 后缀组成</li><li>2、反向区域数据库文件，例如 172.16.1.200 的 name 为 200 ，完全格式为：1.16.172.in-addr.arpa.</li></ul><h6 id="271-新增区域配置文件"><a class="anchor" href="#271-新增区域配置文件">#</a> 2.7.1 新增区域配置文件</h6><p>1. 在主配置文件 /etc/named.conf，新增一个反向区域配置</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>options <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	// ipv4监听地址及端口</pre></td></tr><tr><td data-num="5"></td><td><pre>	listen-on port <span class="token number">53</span> <span class="token punctuation">&#123;</span> <span class="token number">127.0</span>.0.1<span class="token punctuation">;</span><span class="token number">172.16</span>.1.91<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="7"></td><td><pre>	// 允许谁本台DNS发起查询请求（localhost<span class="token operator">|</span><span class="token function">ip</span><span class="token operator">|</span>any）</pre></td></tr><tr><td data-num="8"></td><td><pre>	allow-query     <span class="token punctuation">&#123;</span> localhost<span class="token punctuation">;</span> <span class="token number">172.16</span>.1.0/24<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="10"></td><td><pre>//配置反向解析</pre></td></tr><tr><td data-num="11"></td><td><pre>zone <span class="token string">"1.16.172.in-addr.arpa"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token builtin class-name">type</span> master<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token function">file</span> <span class="token string">"1.16.172.zone"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>2. 检查配置文件语法是否正常</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkconf</span></pre></td></tr></table></figure><h6 id="272-新增区域数据库文件"><a class="anchor" href="#272-新增区域数据库文件">#</a> 2.7.2 新增区域数据库文件</h6><p>1. 添加反向解析区域数据库文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /var/named/1.16.172.zone</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>@ IN SOA <span class="token number">1.16</span>.172.in-addr.arpa. xuy.nf-leasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token number">2025092018</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">;</span>ns反向解析</pre></td></tr><tr><td data-num="12"></td><td><pre>@ IN NS ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">;</span>权威DNS反向解析</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token number">91</span> IN PTR ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">;</span>www反向解析</pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token number">200</span> IN PTR route.hmallleasing.com.</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token number">5</span> IN PTR lb.hmallleasing.com.</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token number">7</span> IN PTR web01.hmallleasing.com.</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token number">8</span> IN PTR web02.hmallleasing.com.</pre></td></tr></table></figure><p>2. 检查区域数据库文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkzone job.com /var/named/1.16.172.zone</span></pre></td></tr><tr><td data-num="2"></td><td><pre>zone job.com/IN: loaded serial <span class="token number">2025092018</span></pre></td></tr><tr><td data-num="3"></td><td><pre>OK</pre></td></tr></table></figure><p>3. 重载 DNS 服务器</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr></table></figure><h6 id="273-客户端测试域名解析"><a class="anchor" href="#273-客户端测试域名解析">#</a> 2.7.3 客户端测试域名解析</h6><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig -x 172.16.1.200 @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="2"></td><td><pre>route.hmallleasing.com.</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig -x 172.16.1.7 @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="4"></td><td><pre>web01.hmallleasing.com.</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig -x 172.16.1.8 @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="6"></td><td><pre>web02.hmallleasing.com.</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig -x 172.16.1.5 @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="8"></td><td><pre>lb.hmallleasing.com.</pre></td></tr></table></figure><h4 id="3-递归查询"><a class="anchor" href="#3-递归查询">#</a> 3. 递归查询</h4><h5 id="31-什么是递归查询"><a class="anchor" href="#31-什么是递归查询">#</a> 3.1 什么是递归查询</h5><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/zLPqMP3.jpeg" alt="3.jpg"></p><ul><li>如果你要建立一个【授权域名】服务器，仅提供本地已存在域名解析即可；那么不要开启 recursion 功能。</li><li>如果你要建立一个递归 DNS 服务器，那么需要开启 recursion 功能。</li><li>如果你的递归 DNS 服务器有公网 IP 地址，你必须开启访问控制功能，只有合法用户才可以发询问。</li></ul><h5 id="32-递归查询配置参数"><a class="anchor" href="#32-递归查询配置参数">#</a> 3.2 递归查询配置参数</h5><table><thead><tr><th>参数</th><th>选项</th><th>作用</th></tr></thead><tbody><tr><td>recurison</td><td>yes/no</td><td>是否开启递归查询请求</td></tr><tr><td>allow-recursion</td><td>{address_match_list | any | none };</td><td>限制客户端递归请求的范围</td></tr></tbody></table><h5 id="33-递归查询配置场景"><a class="anchor" href="#33-递归查询配置场景">#</a> 3.3 递归查询配置场景</h5><h6 id="331-开启递归查询"><a class="anchor" href="#331-开启递归查询">#</a> 3.3.1 开启递归查询</h6><p>BIND 默认配置中的 recurison 参数是启用的；</p><ul><li>1、配置仅允许 172.16.1.0 网段用户可以查询（可选）；</li><li>2、使用客户端查询系统中存在的域名；</li><li>3、使用客户端查询系统中不存在的域名（让 BIND 进行递归查询）；</li></ul><p>1. 修改 /etc/named.conf 配置文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>	//递归查询</pre></td></tr><tr><td data-num="4"></td><td><pre>	recursion <span class="token function">yes</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	allow-recursion <span class="token punctuation">&#123;</span> <span class="token number">192.168</span>.40.0/24<span class="token punctuation">;</span><span class="token number">172.16</span>.1.0/24<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>2. 语法检查且重新加载 named</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkconf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr><tr><td data-num="3"></td><td><pre>server reload successful</pre></td></tr></table></figure><p>3. 查询存在 BIND 服务中的域名</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig web.hmallleasing.com @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">2.2</span>.2.2</pre></td></tr></table></figure><p>4. 查询不在 BIND 服务中的域名，可以获取正确返回，原因是 BIND 进行了递归查询</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig www.qq.com @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="2"></td><td><pre>ins-r23tsuuf.ias.tencent-cloud.net.</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">121.14</span>.77.221</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">121.14</span>.77.201</pre></td></tr></table></figure><h6 id="332-关闭递归查询"><a class="anchor" href="#332-关闭递归查询">#</a> 3.3.2 关闭递归查询</h6><p>1. 修改 /etc/named.conf 配置文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>	//递归查询</pre></td></tr><tr><td data-num="4"></td><td><pre>	recursion no<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token comment">#allow-recursion &#123; 192.168.40.0/24;172.16.1.0/24; &#125;;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>2. 语法检查且重新加载 named</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkconf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr><tr><td data-num="3"></td><td><pre>server reload successful</pre></td></tr></table></figure><p>3. 查询存在 BIND 服务中的域名会返回权威结果，因为本地无需进行递归查询，即可返回权威解析</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig web.hmallleasing.com @172.16.1.91 +short</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">2.2</span>.2.2</pre></td></tr></table></figure><p>4. 由于本地无法返回权威结果，同时也禁用了递归查询，所以查询本地不存在域名会有 WARNING 提示</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig www.qq.com @172.16.1.91</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">;</span> <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> DiG <span class="token number">9.11</span>.4-P2-RedHat-9.11.4-26.P2.el7_9.16 <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> www.qq.com @172.16.1.91</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> global options: +cmd</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Got answer:</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> -<span class="token operator">>></span>HEADER<span class="token operator">&lt;&lt;-</span> opcode: QUERY, status: REFUSED, id: <span class="token number">30635</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> flags: qr rd<span class="token punctuation">;</span> QUERY: <span class="token number">1</span>, ANSWER: <span class="token number">0</span>, AUTHORITY: <span class="token number">0</span>, ADDITIONAL: <span class="token number">1</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> WARNING: recursion requested but not available   <span class="token comment">#递归查询不可用</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> OPT PSEUDOSECTION:</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">;</span> EDNS: version: <span class="token number">0</span>, flags:<span class="token punctuation">;</span> udp: <span class="token number">4096</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> QUESTION SECTION:</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">;</span>www.qq.com.			IN	A</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Query time: <span class="token number">0</span> msec</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> SERVER: <span class="token number">172.16</span>.1.91<span class="token comment">#53(172.16.1.91)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> WHEN: Sat Sep <span class="token number">20</span> <span class="token number">21</span>:33:54 CST <span class="token number">2025</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> MSG SIZE  rcvd: <span class="token number">39</span></pre></td></tr></table></figure><h4 id="4-dns主辅同步"><a class="anchor" href="#4-dns主辅同步">#</a> 4. DNS 主辅同步</h4><h5 id="41-dns主辅同步概念"><a class="anchor" href="#41-dns主辅同步概念">#</a> 4.1 DNS 主辅同步概念</h5><p>辅助 DNS 是 DNS 容灾备份服务：在主 DNS 和辅 DNS 之间建立区域数据传输机制，当主 DNS 遇到故障或者服务中断时，辅 DNS 仍可以继续提供解析服务，因此保障业务稳定运行。</p><p>辅助 DNS 的优势：</p><ul><li>容灾备份，降低业务中断风险：主 DNS 系统故障，辅助 DNS 可继续提供域名解析服务，保障业务可用性。</li><li>负责均衡，流量均摊降低负载：当辅助 DNS 与主 DNS 同时对外提供解析服务时，可以达到流量负载均衡的效果。</li></ul><h5 id="42-dns主从同步原理"><a class="anchor" href="#42-dns主从同步原理">#</a> 4.2 DNS 主从同步原理</h5><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/4XJrCeP.jpeg" alt="918540-20230508112130365-444561605.jpg"></p><h5 id="43-dns主从同步场景"><a class="anchor" href="#43-dns主从同步场景">#</a> 4.3 DNS 主从同步场景</h5><h6 id="431-主从环境准备"><a class="anchor" href="#431-主从环境准备">#</a> 4.3.1 主从环境准备</h6><ul><li>1、确保防火墙规则开放（建议关闭）</li><li>2、保持主从服务器时钟一致；</li><li>3、搭建完主从后，若修改主服务器域配置， Serail Number 必须递增，否则不同步；</li></ul><h6 id="432-主辅同步配置要点"><a class="anchor" href="#432-主辅同步配置要点">#</a> 4.3.2 主辅同步配置要点</h6><ul><li>1、主 DNS 的 named.conf 里配置 allow-transfer 和 also-notify 选项；</li><li>2、辅助 DNS 主配置文件 option 段添加 masterfile-format text ，否则同步的文件为 data 类型；</li><li>3、辅助 DNS 添加区域配置文件，类型为 slave ，同时指向 masters 参数指向 master 地址；</li><li>4、辅助 DNS 不可主动修改 DNS 数据库文件；</li></ul><h6 id="433-master服务器的配置"><a class="anchor" href="#433-master服务器的配置">#</a> 4.3.3 Master 服务器的配置</h6><p>1. 在主配置文件 /etc/named.conf，新增一个反向区域配置</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>options <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	//允许哪个地址同步master配置信息</pre></td></tr><tr><td data-num="5"></td><td><pre>    allow-transfer <span class="token punctuation">&#123;</span> <span class="token number">172.16</span>.1.92<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>	//主动通知辅助DNS域名变更	</pre></td></tr><tr><td data-num="7"></td><td><pre>    also-notify <span class="token punctuation">&#123;</span> <span class="token number">172.16</span>.1.92<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="10"></td><td><pre>//自行配置权威域名解析hmallleaing.com</pre></td></tr><tr><td data-num="11"></td><td><pre>zone <span class="token string">"hmallleasing.com"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 	 <span class="token builtin class-name">type</span> master<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 	 <span class="token function">file</span> <span class="token string">"hmallleasing.com.zone"</span><span class="token punctuation">;</span>    //具体解析记录配置存储至哪个文件</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>zone <span class="token string">"job.com"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre> 	 <span class="token builtin class-name">type</span> master<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre> 	 <span class="token function">file</span> <span class="token string">"job.com.zone"</span><span class="token punctuation">;</span>    //具体解析记录配置存储至哪个文件</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>//配置反向解析</pre></td></tr><tr><td data-num="22"></td><td><pre>zone <span class="token string">"1.16.172.in-addr.arpa"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token builtin class-name">type</span> master<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token function">file</span> <span class="token string">"1.16.172.zone"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>2. 添加区域数据库文件 (需要多添加一条 ns 记录)</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#1.hmallleasing.com.zone 需要多添加一条 ns 记录</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /var/named/hmallleasing.com.zone </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>hmallleasing.com. IN SOA ns.hmallleasing.com. xuy.nf-leasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span> 区域名称 IN SOA dns.hmallleasing.com. 管理员邮箱</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">;</span> 区域名称可以使用过@表示，@表示当前域</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token number">2025092018</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">;</span> 给客户端返回NS记录，hmallleasing.com. 域名由哪几台权威服务器提供解析</pre></td></tr><tr><td data-num="16"></td><td><pre>hmallleasing.com. IN NS ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="17"></td><td><pre>hmallleasing.com. IN NS ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">;</span> A记录，配置权威域名的真实IP地址；</pre></td></tr><tr><td data-num="20"></td><td><pre>ns1.hmallleasing.com. IN A <span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="21"></td><td><pre>ns2.hmallleasing.com. IN A <span class="token number">172.16</span>.1.92</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">;</span> 真正的域名解析</pre></td></tr><tr><td data-num="24"></td><td><pre>www.hmallleasing.com. IN A <span class="token number">1.1</span>.1.1</pre></td></tr><tr><td data-num="25"></td><td><pre>web.hmallleasing.com. IN A <span class="token number">2.2</span>.2.2</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">#2./1.16.172.zone 需要多添加一条 ns 记录</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># cat /var/named/1.16.172.zone </span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>@ IN SOA <span class="token number">1.16</span>.172.in-addr.arpa. xuy.nf-leasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	<span class="token number">2025092018</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="33"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="34"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="35"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">;</span>ns反向解析</pre></td></tr><tr><td data-num="39"></td><td><pre>@ IN NS ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="40"></td><td><pre>@ IN NS ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">;</span>权威DNS反向解析</pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token number">91</span> IN PTR ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token number">92</span> IN PTR ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">;</span>www反向解析</pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token number">200</span> IN PTR route.hmallleasing.com.</pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token number">5</span> IN PTR lb.hmallleasing.com.</pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token number">7</span> IN PTR web01.hmallleasing.com.</pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token number">8</span> IN PTR web02.hmallleasing.com.</pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token comment">#2.job.com.zone 需要多添加一条 ns 记录</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">[</span>root@dns-master named<span class="token punctuation">]</span><span class="token comment"># cat job.com.zone </span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>job.com. IN SOA ns.job.com. xuy.nf-leasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token punctuation">;</span> 区域名称 IN SOA dns.hmallleasing.com. 管理员邮箱</pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">;</span> 区域名称可以使用过@表示，@表示当前域</pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre>	<span class="token number">2025092019</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="60"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="61"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="62"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="63"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token punctuation">;</span> 给客户端返回NS记录，hmallleasing.com. 域名由哪几台权威服务器提供解析</pre></td></tr><tr><td data-num="67"></td><td><pre>job.com. IN NS ns1.job.com.</pre></td></tr><tr><td data-num="68"></td><td><pre>job.com. IN NS ns2.job.com.</pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token punctuation">;</span> A记录，配置权威域名的真实IP地址；</pre></td></tr><tr><td data-num="71"></td><td><pre>ns1.job.com. IN A <span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="72"></td><td><pre>ns2.job.com. IN A <span class="token number">172.16</span>.1.92</pre></td></tr><tr><td data-num="73"></td><td><pre></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token punctuation">;</span> 真正的域名解析</pre></td></tr><tr><td data-num="75"></td><td><pre>www.job.com. IN CNAME www.hmallleasing.com.</pre></td></tr><tr><td data-num="76"></td><td><pre>dev.job.com. IN A <span class="token number">2.2</span>.2.3</pre></td></tr></table></figure><p>3. 检查语法并重载 DNS 服务器</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkconf</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkzone hmallleasing.com /var/named/hmallleasing.com.zone </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr></table></figure><h6 id="434-slave服务器的配置"><a class="anchor" href="#434-slave服务器的配置">#</a> 4.3.4 Slave 服务器的配置</h6><p>1. 安装 bind 服务</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># yum install bind bind-utils -y</span></pre></td></tr></table></figure><p>2. 配置 rndc【首次需要配置】</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># rndc-confgen -r /dev/urandom -a</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># chown root:named /etc/rndc.key</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># chmod 640 /etc/rndc.key </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart named</span></pre></td></tr></table></figure><p>3. 修改主配置文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>options <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	listen-on port <span class="token number">53</span> <span class="token punctuation">&#123;</span> any<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	allow-query     <span class="token punctuation">&#123;</span> any<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    masterfile-format text<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>4. 添加区域配置文件，类型为 slave，然后指向 master 地址</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/named.conf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre>//自行配置权威域名解析hmallleaing.com</pre></td></tr><tr><td data-num="4"></td><td><pre>zone <span class="token string">"hmallleasing.com"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>         <span class="token builtin class-name">type</span> slave<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>         <span class="token function">file</span> <span class="token string">"slaves/hmallleasing.com.zone"</span><span class="token punctuation">;</span>    //具体解析记录配置存储至哪个文件</pre></td></tr><tr><td data-num="7"></td><td><pre>         masters <span class="token punctuation">&#123;</span> <span class="token number">172.16</span>.1.91<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>zone <span class="token string">"job.com"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>         <span class="token builtin class-name">type</span> slave<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>         <span class="token function">file</span> <span class="token string">"slaves/job.com.zone"</span><span class="token punctuation">;</span>    //具体解析记录配置存储至哪个文件</pre></td></tr><tr><td data-num="13"></td><td><pre>         masters <span class="token punctuation">&#123;</span> <span class="token number">172.16</span>.1.91<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>//配置反向解析</pre></td></tr><tr><td data-num="17"></td><td><pre>zone <span class="token string">"1.16.172.in-addr.arpa"</span> IN <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre> 	<span class="token builtin class-name">type</span> slave<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre> 	<span class="token function">file</span> <span class="token string">"slaves/1.16.172.zone"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  	masters <span class="token punctuation">&#123;</span> <span class="token number">172.16</span>.1.91<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>include <span class="token string">"/etc/named.rfc1912.zones"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>include <span class="token string">"/etc/named.root.key"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure><p>4. 检查语法并重载 DNS 服务器</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># named-checkconf</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-master ~<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@dns-slave ~<span class="token punctuation">]</span><span class="token comment"># ll /var/named/slaves/</span></pre></td></tr><tr><td data-num="4"></td><td><pre>-rw-r--r-- <span class="token number">1</span> named named <span class="token number">549</span> Sep <span class="token number">20</span> <span class="token number">22</span>:30 <span class="token number">1.16</span>.172.zone</pre></td></tr><tr><td data-num="5"></td><td><pre>-rw-r--r-- <span class="token number">1</span> named named <span class="token number">420</span> Sep <span class="token number">20</span> <span class="token number">22</span>:30 hmallleasing.com.zone</pre></td></tr><tr><td data-num="6"></td><td><pre>-rw-r--r-- <span class="token number">1</span> named named <span class="token number">356</span> Sep <span class="token number">20</span> <span class="token number">22</span>:30 job.com.zone</pre></td></tr></table></figure><h6 id="435-测试主辅解析"><a class="anchor" href="#435-测试主辅解析">#</a> 4.3.5 测试主辅解析</h6><p>使用 dig 进行域名解析，先通过 master 解析，然后在使用 slave 测试解析</p><p>1. 通过 master 解析</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig www.hmallleasing.com @172.16.1.91 </span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">;</span> <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> DiG <span class="token number">9.11</span>.4-P2-RedHat-9.11.4-26.P2.el7_9.16 <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> www.hmallleasing.com @172.16.1.91</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> global options: +cmd</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Got answer:</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> -<span class="token operator">>></span>HEADER<span class="token operator">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class="token number">34451</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> flags: qr aa rd ra<span class="token punctuation">;</span> QUERY: <span class="token number">1</span>, ANSWER: <span class="token number">1</span>, AUTHORITY: <span class="token number">2</span>, ADDITIONAL: <span class="token number">3</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> OPT PSEUDOSECTION:</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">;</span> EDNS: version: <span class="token number">0</span>, flags:<span class="token punctuation">;</span> udp: <span class="token number">4096</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> QUESTION SECTION:</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">;</span>www.hmallleasing.com.		IN	A</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> ANSWER SECTION:</pre></td></tr><tr><td data-num="15"></td><td><pre>www.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">1.1</span>.1.1</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> AUTHORITY SECTION:</pre></td></tr><tr><td data-num="18"></td><td><pre>hmallleasing.com.	<span class="token number">600</span>	IN	NS	ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="19"></td><td><pre>hmallleasing.com.	<span class="token number">600</span>	IN	NS	ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> ADDITIONAL SECTION:</pre></td></tr><tr><td data-num="22"></td><td><pre>ns1.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="23"></td><td><pre>ns2.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">172.16</span>.1.92</pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Query time: <span class="token number">0</span> msec</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> SERVER: <span class="token number">172.16</span>.1.91<span class="token comment">#53(172.16.1.91)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> WHEN: Sat Sep <span class="token number">20</span> <span class="token number">23</span>:03:40 CST <span class="token number">2025</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> MSG SIZE  rcvd: <span class="token number">133</span></pre></td></tr></table></figure><p>2. 通过 slave 解析</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig www.hmallleasing.com @172.16.1.92 </span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">;</span> <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> DiG <span class="token number">9.11</span>.4-P2-RedHat-9.11.4-26.P2.el7_9.16 <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> www.hmallleasing.com @172.16.1.92</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> global options: +cmd</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Got answer:</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> -<span class="token operator">>></span>HEADER<span class="token operator">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class="token number">4506</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> flags: qr aa rd ra<span class="token punctuation">;</span> QUERY: <span class="token number">1</span>, ANSWER: <span class="token number">1</span>, AUTHORITY: <span class="token number">2</span>, ADDITIONAL: <span class="token number">3</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> OPT PSEUDOSECTION:</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">;</span> EDNS: version: <span class="token number">0</span>, flags:<span class="token punctuation">;</span> udp: <span class="token number">4096</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> QUESTION SECTION:</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">;</span>www.hmallleasing.com.		IN	A</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> ANSWER SECTION:</pre></td></tr><tr><td data-num="15"></td><td><pre>www.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">1.1</span>.1.1</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> AUTHORITY SECTION:</pre></td></tr><tr><td data-num="18"></td><td><pre>hmallleasing.com.	<span class="token number">600</span>	IN	NS	ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="19"></td><td><pre>hmallleasing.com.	<span class="token number">600</span>	IN	NS	ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> ADDITIONAL SECTION:</pre></td></tr><tr><td data-num="22"></td><td><pre>ns1.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="23"></td><td><pre>ns2.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">172.16</span>.1.92</pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Query time: <span class="token number">0</span> msec</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> SERVER: <span class="token number">172.16</span>.1.92<span class="token comment">#53(172.16.1.92)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> WHEN: Sat Sep <span class="token number">20</span> <span class="token number">23</span>:03:23 CST <span class="token number">2025</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> MSG SIZE  rcvd: <span class="token number">133</span></pre></td></tr></table></figure><p>3. 测试主辅同步</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#1.dns master 新增一条记录，然后滚动 seria2025092019 自增 1</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@dns-master named<span class="token punctuation">]</span><span class="token comment"># cat hmallleasing.com.zone </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$TTL</span> <span class="token number">600</span> <span class="token punctuation">;</span> DNS失效时间，单位秒<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>hmallleasing.com. IN SOA ns.hmallleasing.com. xuy.nf-leasing.com. <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">;</span> 区域名称 IN SOA dns.hmallleasing.com. 管理员邮箱</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">;</span> 区域名称可以使用过@表示，@表示当前域</pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token number">2025092019</span> <span class="token punctuation">;</span> 序列号<span class="token punctuation">(</span>serial number<span class="token punctuation">)</span> 十进制，不能超过10位，通常使用日期时间戳，例如2018121601</pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token number">10800</span>      <span class="token punctuation">;</span> 刷新时间<span class="token punctuation">(</span>refresh <span class="token function">time</span><span class="token punctuation">)</span> 即每隔多久到主服务器检查一次</pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token number">900</span>        <span class="token punctuation">;</span> 重试时间<span class="token punctuation">(</span>retry <span class="token function">time</span><span class="token punctuation">)</span> 即刷新不成功多久后重试，应该小于refresh <span class="token function">time</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token number">604800</span>     <span class="token punctuation">;</span> 过期时间<span class="token punctuation">(</span>expire <span class="token function">time</span><span class="token punctuation">)</span> 当辅助DNS无法联系主DNS时，辅助DNS在多长时间内认为其缓存是有效的。</pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token number">86400</span>      <span class="token punctuation">;</span> 权威应答的ttl<span class="token punctuation">(</span>netgative answer ttl<span class="token punctuation">)</span> <span class="token punctuation">;</span>缓存DNS服务器可以缓存记录多长时间</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">;</span> 给客户端返回NS记录，hmallleasing.com. 域名由哪几台权威服务器提供解析</pre></td></tr><tr><td data-num="15"></td><td><pre>hmallleasing.com. IN NS ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="16"></td><td><pre>hmallleasing.com. IN NS ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">;</span> A记录，配置权威域名的真实IP地址；</pre></td></tr><tr><td data-num="19"></td><td><pre>ns1.hmallleasing.com. IN A <span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="20"></td><td><pre>ns2.hmallleasing.com. IN A <span class="token number">172.16</span>.1.92</pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">;</span> 真正的域名解析</pre></td></tr><tr><td data-num="23"></td><td><pre>www.hmallleasing.com. IN A <span class="token number">1.1</span>.1.1</pre></td></tr><tr><td data-num="24"></td><td><pre>web.hmallleasing.com. IN A <span class="token number">2.2</span>.2.2</pre></td></tr><tr><td data-num="25"></td><td><pre>blog.hmallleasing.com. IN A <span class="token number">3.3</span>.3.3</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">#2. 重载 DNS 服务器</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">[</span>root@dns-master named<span class="token punctuation">]</span><span class="token comment"># rndc reload</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">#3. 使用 master 以及 slave 地址测试新添加的记录是否能解析</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig blog.hmallleasing.com @172.16.1.91 </span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">[</span>root@client ~<span class="token punctuation">]</span><span class="token comment"># dig blog.hmallleasing.com @172.16.1.92 </span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">;</span> <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> DiG <span class="token number">9.11</span>.4-P2-RedHat-9.11.4-26.P2.el7_9.16 <span class="token operator">&lt;&lt;</span><span class="token operator">>></span> blog.hmallleasing.com @172.16.1.91</pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> global options: +cmd</pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Got answer:</pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> -<span class="token operator">>></span>HEADER<span class="token operator">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class="token number">60136</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> flags: qr aa rd ra<span class="token punctuation">;</span> QUERY: <span class="token number">1</span>, ANSWER: <span class="token number">1</span>, AUTHORITY: <span class="token number">2</span>, ADDITIONAL: <span class="token number">3</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> OPT PSEUDOSECTION:</pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">;</span> EDNS: version: <span class="token number">0</span>, flags:<span class="token punctuation">;</span> udp: <span class="token number">4096</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> QUESTION SECTION:</pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token punctuation">;</span>blog.hmallleasing.com.		IN	A</pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> ANSWER SECTION:</pre></td></tr><tr><td data-num="46"></td><td><pre>blog.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">3.3</span>.3.3</pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> AUTHORITY SECTION:</pre></td></tr><tr><td data-num="49"></td><td><pre>hmallleasing.com.	<span class="token number">600</span>	IN	NS	ns1.hmallleasing.com.</pre></td></tr><tr><td data-num="50"></td><td><pre>hmallleasing.com.	<span class="token number">600</span>	IN	NS	ns2.hmallleasing.com.</pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> ADDITIONAL SECTION:</pre></td></tr><tr><td data-num="53"></td><td><pre>ns1.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">172.16</span>.1.91</pre></td></tr><tr><td data-num="54"></td><td><pre>ns2.hmallleasing.com.	<span class="token number">600</span>	IN	A	<span class="token number">172.16</span>.1.92</pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> Query time: <span class="token number">0</span> msec</pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> SERVER: <span class="token number">172.16</span>.1.91<span class="token comment">#53(172.16.1.91)</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> WHEN: Sat Sep <span class="token number">20</span> <span class="token number">23</span>:10:17 CST <span class="token number">2025</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">;</span><span class="token punctuation">;</span> MSG SIZE  rcvd: <span class="token number">134</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/Linux/" rel="tag"><i class="ic i-tag"></i>Linux</a></div></div><footer><div class="meta"><span class="icon"><i class="ic i-eye"></i></span><span>此文章已被阅读次数:</span><span class="waline-pageview-count" id="twikoo_visitors" data-path="/posts/4120829732.html">正在加载...</span><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2025-09-20 23:12:09" itemprop="dateModified" datetime="2025-09-20T23:12:09+08:00">2025-09-20</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/wechatpay.png" alt="Xu Yong 微信支付"><p>微信支付</p></div><div><img loading="lazy" data-src="/assets/alipay.png" alt="Xu Yong 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>Xu Yong<i class="ic i-at"><em>@</em></i>LinuxSre云原生</li><li class="link"><strong>本文链接：</strong><a href="http://ixuyong.cn/posts/4120829732.html" title="DNS域名解析服务">http://ixuyong.cn/posts/4120829732.html</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/posts/3327248306.html" rel="prev" itemprop="url" data-background-image="https:&#x2F;&#x2F;wp-cdn.4ce.cn&#x2F;v2&#x2F;SDKfGrH.jpeg" title="Firewalld防火墙实战"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>Iptables</span><h3>Firewalld防火墙实战</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#dns%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.</span> <span class="toc-text">DNS 域名解析服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-dns%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">1. DNS 基本概述</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#11-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%9F%9F%E5%90%8D"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 为什么需要域名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-%E4%BB%80%E4%B9%88%E6%98%AFdns"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 什么是 DNS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#13-dns%E5%9F%9F%E5%90%8D%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 DNS 域名结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#14-%E5%9F%9F%E5%90%8D%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 域名分类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#15-dns%E6%9F%A5%E8%AF%A2%E5%8E%9F%E7%90%86"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.5 DNS 查询原理</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#151-%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">1.5.1 递归查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#152-%E8%BF%AD%E4%BB%A3%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">1.5.2 迭代查询</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#16-dns%E8%A7%A3%E6%9E%90%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.6.</span> <span class="toc-text">1.6 DNS 解析类型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#161-a"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">1.6.1 A</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#162-ptr"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">1.6.2 PTR</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#163-cname"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">1.6.3 CNAME</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#164-ns"><span class="toc-number">1.1.6.4.</span> <span class="toc-text">1.6.4 NS</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#165-mx"><span class="toc-number">1.1.6.5.</span> <span class="toc-text">1.6.5 MX</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#17-%E4%BC%81%E4%B8%9A%E8%87%AA%E5%BB%BAdns%E6%96%B9%E5%BC%8F"><span class="toc-number">1.1.7.</span> <span class="toc-text">1.7 企业自建 DNS 方式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-bind%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">2. BIND 基础应用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#21-%E4%BB%80%E4%B9%88%E6%98%AFbind"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 什么是 BIND</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#22-bind%E7%9A%84%E7%BB%84%E6%88%90"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 BIND 的组成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#23-bind%E6%9C%8D%E5%8A%A1%E5%AE%9E%E6%88%98"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 BIND 服务实战</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#231-bind%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">2.3.1 BIND 环境准备</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#232-bind%E6%9C%8D%E5%8A%A1%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2.3.2 BIND 服务安装</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#233-bind%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">2.3.3 BIND 配置文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#234-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%AA%8C%E8%AF%81dns%E8%A7%A3%E6%9E%90%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">2.3.4 客户端验证 DNS 解析的配置</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#24-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%BA%E5%9F%9F"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 自定义区域</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#241-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%BA%E5%9F%9F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">2.4.1 自定义区域配置文件解析</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#242-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8C%BA%E5%9F%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">2.4.2 自定义区域数据库文件</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#25-bind%E5%A2%9E%E5%8A%A0a%E8%AE%B0%E5%BD%95%E6%AD%A3%E5%90%91%E8%A7%A3%E6%9E%90%E5%AE%9E%E6%88%98"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5 BIND 增加 A 记录正向解析实战</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#251-%E6%96%B0%E5%A2%9E%E5%8C%BA%E5%9F%9F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">2.5.1 新增区域配置文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#252-%E6%96%B0%E5%A2%9E%E5%8C%BA%E5%9F%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">2.5.2 新增区域数据库文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#253-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%8B%E8%AF%95%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">2.5.3 客户端测试域名解析</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#26-bind%E5%A2%9E%E5%8A%A0cname%E8%AE%B0%E5%BD%95%E5%AE%9E%E6%88%98"><span class="toc-number">1.2.6.</span> <span class="toc-text">2.6 BIND 增加 CNAME 记录实战</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#261-%E6%96%B0%E5%A2%9E%E5%8C%BA%E5%9F%9F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">2.6.1 新增区域配置文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#262-%E6%96%B0%E5%A2%9E%E5%8C%BA%E5%9F%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">2.6.2 新增区域数据库文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#263-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%8B%E8%AF%95%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.6.3.</span> <span class="toc-text">2.6.3 客户端测试域名解析</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#27-bind%E5%A2%9E%E5%8A%A0ptr%E8%AE%B0%E5%BD%95%E5%8F%8D%E5%90%91%E8%A7%A3%E6%9E%90%E5%AE%9E%E6%88%98"><span class="toc-number">1.2.7.</span> <span class="toc-text">2.7 BIND 增加 PTR 记录反向解析实战</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#271-%E6%96%B0%E5%A2%9E%E5%8C%BA%E5%9F%9F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">2.7.1 新增区域配置文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#272-%E6%96%B0%E5%A2%9E%E5%8C%BA%E5%9F%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">2.7.2 新增区域数据库文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#273-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%8B%E8%AF%95%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.7.3.</span> <span class="toc-text">2.7.3 客户端测试域名解析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.</span> <span class="toc-text">3. 递归查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#31-%E4%BB%80%E4%B9%88%E6%98%AF%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 什么是递归查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#32-%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 递归查询配置参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#33-%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2%E9%85%8D%E7%BD%AE%E5%9C%BA%E6%99%AF"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 递归查询配置场景</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#331-%E5%BC%80%E5%90%AF%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">3.3.1 开启递归查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#332-%E5%85%B3%E9%97%AD%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">3.3.2 关闭递归查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-dns%E4%B8%BB%E8%BE%85%E5%90%8C%E6%AD%A5"><span class="toc-number">1.4.</span> <span class="toc-text">4. DNS 主辅同步</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#41-dns%E4%B8%BB%E8%BE%85%E5%90%8C%E6%AD%A5%E6%A6%82%E5%BF%B5"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 DNS 主辅同步概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#42-dns%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 DNS 主从同步原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#43-dns%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%9C%BA%E6%99%AF"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 DNS 主从同步场景</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#431-%E4%B8%BB%E4%BB%8E%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">4.3.1 主从环境准备</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#432-%E4%B8%BB%E8%BE%85%E5%90%8C%E6%AD%A5%E9%85%8D%E7%BD%AE%E8%A6%81%E7%82%B9"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">4.3.2 主辅同步配置要点</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#433-master%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">4.3.3 Master 服务器的配置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#434-slave%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">4.3.4 Slave 服务器的配置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#435-%E6%B5%8B%E8%AF%95%E4%B8%BB%E8%BE%85%E8%A7%A3%E6%9E%90"><span class="toc-number">1.4.3.5.</span> <span class="toc-text">4.3.5 测试主辅解析</span></a></li></ol></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/posts/581151773.html" rel="bookmark" title="100个运维相关技术官网汇总">100个运维相关技术官网汇总</a></li><li><a href="/posts/2260957686.html" rel="bookmark" title="Linux—Centos7修改网卡名称">Linux—Centos7修改网卡名称</a></li><li><a href="/posts/2508697220.html" rel="bookmark" title="Chrony时间同步服务">Chrony时间同步服务</a></li><li><a href="/posts/430579059.html" rel="bookmark" title="NFS网络文件系统">NFS网络文件系统</a></li><li><a href="/posts/1922841233.html" rel="bookmark" title="Rsync服务实践">Rsync服务实践</a></li><li><a href="/posts/269104229.html" rel="bookmark" title="Samba服务实践">Samba服务实践</a></li><li><a href="/posts/2889248111.html" rel="bookmark" title="Vsftp服务实践">Vsftp服务实践</a></li><li class="active"><a href="/posts/4120829732.html" rel="bookmark" title="DNS域名解析服务">DNS域名解析服务</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="Xu Yong" src="/assets/avatar.png"><p class="name" itemprop="name">Xu Yong</p><div class="description" itemprop="description">专注于 Linux 运维、云计算、云原⽣等技术</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">69</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">17</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">20</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/xyapples" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;xyapples"><i class="ic i-github"></i></a><a target="_blank" rel="noopener" href="https://gitee.com/chinagei" class="item gitee" title="https:&#x2F;&#x2F;gitee.com&#x2F;chinagei"><i class="ic i-gitee"></i></a><a href="mailto:373370405@qq.com" class="item email" title="mailto:373370405@qq.com"><i class="ic i-envelope"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-about"></i>关于</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/posts/3327248306.html" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/ELKStack/" title="分类于ELKStack">ELKStack</a></div><span><a href="/posts/570469260.html">ELK收集Kubernetes组件日志分析与实践</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Nginx/" title="分类于Nginx">Nginx</a></div><span><a href="/posts/3682494305.html">Nginx常用模块（二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DevOps/" title="分类于DevOps">DevOps</a></div><span><a href="/posts/1366748664.html">K8S基于Jenkins实现Java项目CI与CD实践（二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/LVS/" title="分类于LVS">LVS</a></div><span><a href="/posts/1598774589.html">企业级负载均衡LVS场景实战（二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Nginx/" title="分类于Nginx">Nginx</a></div><span><a href="/posts/1601152722.html">Nginx反向代理服务（四）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Kubernetes/" title="分类于Kubernetes">Kubernetes</a></div><span><a href="/posts/108692210.html">K8s资源调度deployment、statefulset、daemonset</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Docker/" title="分类于Docker">Docker</a></div><span><a href="/posts/3364424907.html">阿里云+Github构建镜像仓库</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Tomcat/" title="分类于Tomcat">Tomcat</a></div><span><a href="/posts/754945111.html">Tomcat JVM调优实践</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Docker/" title="分类于Docker">Docker</a></div><span><a href="/posts/1888662579.html">Containerd常用命令</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Kubernetes/" title="分类于Kubernetes">Kubernetes</a></div><span><a href="/posts/3030097036.html">K8S云原生存储Rook-Ceph</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 -<span itemprop="copyrightYear">2025</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">Xu Yong @ LinuxSre云原生</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">1.8m 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">26:54</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `posts/4120829732.html`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="/js/siteInit.js?v=0.4.17" type="module" fetchpriority="high" defer></script></body></html><!-- rebuild by hrmmi -->