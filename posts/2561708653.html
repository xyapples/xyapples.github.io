<!-- build time:Wed Nov 26 2025 22:02:36 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon.ico"><link rel="alternate" href="/rss.xml" title="LinuxSre云原生" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="LinuxSre云原生" type="application/atom+xml"><link rel="alternate" type="application/json" title="LinuxSre云原生" href="http://ixuyong.cn/feed.json"><link rel="preconnect" href="https://s4.zstatic.net"><link rel="preconnect" href="https://at.alicdn.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.17"><link rel="modulepreload" href="/js/chunk-GV364XSK.js"><link rel="modulepreload" href="/js/chunk-NYSE5UKM.js"><link rel="modulepreload" href="/js/chunk-RONCYO2S.js"><link rel="modulepreload" href="/js/chunk-THHXCRSX.js"><link rel="modulepreload" href="/js/chunk-WIQECBEN.js"><link rel="modulepreload" href="/js/comments-DL2IYMPZ.js"><link rel="modulepreload" href="/js/copy-tex-NADCTXPG.js"><link rel="modulepreload" href="/js/post-DA635IH6.js"><link rel="modulepreload" href="/js/quicklink-WEDHL4BA.js"><link rel="modulepreload" href="/js/search-VCZRKTM5.js"><link rel="modulepreload" href="/js/siteInit.js"><link rel="modulepreload" href="/js/waline-NNBYRQEE.js"><link rel="stylesheet" href="/css/comments-F4ZGS7LD.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/siteInit.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/waline-IDNZKML2.css" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="preload" href="https://s21.ax1x.com/2025/03/29/pEsS0hD.png" as="image" fetchpriority="high"><meta name="keywords" content="DevOps"><meta name="description" content="专注于 Linux 运维、云计算、云原⽣等技术"><link rel="canonical" href="http://ixuyong.cn/posts/2561708653.html"><title>Jenkins SonarQube实践（六）</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Jenkins SonarQube实践（六）</h1><div class="meta"><span class="item" title="创建时间：2025-11-26 20:50:18"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2025-11-26T20:50:18+08:00">2025-11-26</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>16k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>15 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">LinuxSre云原生</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><img src="https://s21.ax1x.com/2025/03/29/pEsS0hD.png" loading="eager" decoding="async" fetchpriority="high" alt="LinuxSre云原生"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/DevOps/" itemprop="item" rel="index" title="分类于DevOps"><span itemprop="name">DevOps<meta itemprop="position" content="0"></span></a></span></div><article class="post block" itemscope itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://ixuyong.cn/posts/2561708653.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.png"><meta itemprop="name" content="Xu Yong"><meta itemprop="description" content="致力于技术布道、普及前沿技术、打造云原生系列标杆博客, 专注于 Linux 运维、云计算、云原⽣等技术"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="LinuxSre云原生"></span><div class="body md" itemprop="articleBody"><h3 id="jenkins-sonarqube实践"><a class="anchor" href="#jenkins-sonarqube实践">#</a> Jenkins SonarQube 实践</h3><h4 id="1-sonarqube基本概述"><a class="anchor" href="#1-sonarqube基本概述">#</a> 1. SonarQube 基本概述</h4><h5 id="11-什么是sonarqube"><a class="anchor" href="#11-什么是sonarqube">#</a> 1.1 什么是 SonarQube</h5><p>SonarQube 是⼀个开源的代码质量管理系统，⽤于检测代码中的错误、漏洞。它可以与 Jenkins 集成，让我们进⾏⾃动化代码质量扫描。</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/GNTYprF.png" alt="1.png"></p><h5 id="12-sonarqube服务架构"><a class="anchor" href="#12-sonarqube服务架构">#</a> 1.2 Sonarqube 服务架构</h5><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/HfouPKV.png" alt="2.png"></p><h5 id="13-使用sonarqube前提"><a class="anchor" href="#13-使用sonarqube前提">#</a> 1.3 使⽤ Sonarqube 前提</h5><ul><li>SonarQube 基于 Java 开发，版本⾄少需要安装 Open JDK17 版本。</li><li>SonarQube 依赖数据库，不在是 MySQL ，⽽是 PostgreSQL（11-15 版本）、Oracle、SQLServer 等。</li><li>SonarQube 的⼩型实例⾄少需要 4GB 内存，如果是⼤型实例需要 16GB 依赖的硬件版本、java 版本、数据库版本等参考地址</li></ul><h4 id="2-sonarqube服务安装"><a class="anchor" href="#2-sonarqube服务安装">#</a> 2. SonarQube 服务安装</h4><h5 id="21-环境准备"><a class="anchor" href="#21-环境准备">#</a> 2.1 环境准备</h5><p>1、关闭防⽕墙</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># systemctl stop firewalld</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># systemctl disable firewalld</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># setenforce 0</span></pre></td></tr></table></figure><p>2、修改内核参数（必选）</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># cat >>/etc/sysctl.conf&lt;&lt;-EOF</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">vm.max_map_count</span><span class="token operator">=</span><span class="token number">524288</span></pre></td></tr><tr><td data-num="3"></td><td><pre>fs.file-max<span class="token operator">=</span><span class="token number">131072</span></pre></td></tr><tr><td data-num="4"></td><td><pre>EOF</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># sysctl -p</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 操作系统级别对每个⽤户创建的进程数的限制</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># cat >> /etc/security/limits.conf &lt;&lt;-EOF</span></pre></td></tr><tr><td data-num="10"></td><td><pre>* soft nproc <span class="token number">8192</span></pre></td></tr><tr><td data-num="11"></td><td><pre>* hard nproc <span class="token number">8192</span></pre></td></tr><tr><td data-num="12"></td><td><pre>EOF</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># 重新打开⼀个新的窗⼝⽣效</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># ulimit -a</span></pre></td></tr><tr><td data-num="16"></td><td><pre>max user processes <span class="token punctuation">(</span>-u<span class="token punctuation">)</span> <span class="token number">8192</span></pre></td></tr></table></figure><p>3、安装 java 环境</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># wget https://download.oracle.com/java/17/archive/jdk-17.0.12_linux-x64_bin.tar.gz</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># tar xf jdk-17.0.12_linux-x64_bin.tar.gz  -C /usr/local/</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># ln -s /usr/local/jdk-17.0.12/ /usr/local/jdk</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#添加环境变量</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/profile.d/jdk.sh</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/jdk</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token builtin class-name">export</span> <span class="token assign-left variable">JRE_HOME</span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token builtin class-name">export</span> <span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/lib/:<span class="token variable">$JRE_HOME</span>/lib/</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># source /etc/profile</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># java -version</span></pre></td></tr></table></figure><h5 id="22-部署postgresql-数据库"><a class="anchor" href="#22-部署postgresql-数据库">#</a> 2.2 部署 postgresql 数据库</h5><p>1、安装 postgresql ，默认 RockyLinux 提供的版本为 13，如果需要其他版本可以参考 postgresql 官⽹下载</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># yum install postgresql15 postgresql15-server</span></pre></td></tr></table></figure><p>2、初始化 postgresql</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># /usr/pgsql-15/bin/postgresql-15-setup initdb</span></pre></td></tr></table></figure><p>3、编辑 postgresql 的配置⽂件。默认 pgsql 的认证是基于操作系统⽤户认证机制，不需要使⽤数据库密码，因此需要修改为⽀持⽤户名密码的认证⽅式。 将 peer 改为 scram-sha-256（推荐的加密方式），或者 md5（如果需要兼容旧客户端）</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment">#cat /var/lib/pgsql/15/data/pg_hba.conf </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># "local" is for Unix domain socket connections only</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token builtin class-name">local</span>   all             all                                     peer</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># IPv4 local connections:</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">host</span>    all             all             <span class="token number">127.0</span>.0.1/32            scram-sha-256</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># IPv6 local connections:</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token function">host</span>    all             all             ::1/128                 scram-sha-25</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 将 peer 改为 scram-sha-256（推荐的加密方式），或者 md5（如果需要兼容旧客户端）</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># "local" is for Unix domain socket connections only</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token builtin class-name">local</span>   all             all                                     scram-sha-256</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># IPv4 local connections:</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token function">host</span>    all             all             <span class="token number">127.0</span>.0.1/32            scram-sha-256</pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment"># IPv6 local connections:</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token function">host</span>    all             all             ::1/128                 scram-sha-256</pre></td></tr></table></figure><p>4、启动 postgresql 数据库</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># systemctl enable postgresql-15 --now</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 检查端⼝</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># netstat -lntp|grep postmaster</span></pre></td></tr><tr><td data-num="5"></td><td><pre>tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:5432          <span class="token number">0.0</span>.0.0:*               LISTEN      <span class="token number">31973</span>/postmaster    </pre></td></tr><tr><td data-num="6"></td><td><pre>tcp6       <span class="token number">0</span>      <span class="token number">0</span> ::1:5432                :::*                    LISTEN      <span class="token number">31973</span>/postmaster</pre></td></tr></table></figure><p>5、在 PostgreSQL 中，初始管理员⽤户名为 postgres 的⽤户</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># su - postgres -c "psql"</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment">#</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># ALTER USER postgres WITH PASSWORD '123456'; # 设定 postgres 账户</span></pre></td></tr><tr><td data-num="4"></td><td><pre>密码为123456</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 使⽤⽤户名密码登录测试</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># su - postgres -c "psql -h localhost -U postgres -W"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>Password:</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment">#</span></pre></td></tr></table></figure><p>6、创建 sonarqube 库，设定字符集为 utf8</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># create database sonarqube ENCODING utf8;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># \l      # 查询数据库</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                                                 List of databases</pre></td></tr><tr><td data-num="4"></td><td><pre>   Name    <span class="token operator">|</span>  Owner   <span class="token operator">|</span> Encoding <span class="token operator">|</span>   Collate   <span class="token operator">|</span>    Ctype    <span class="token operator">|</span> ICU Locale <span class="token operator">|</span> Locale Provider <span class="token operator">|</span>   Access privileges  </pre></td></tr><tr><td data-num="5"></td><td><pre> </pre></td></tr><tr><td data-num="6"></td><td><pre>-----------+----------+----------+-------------+-------------+------------+-----------------+----------------------</pre></td></tr><tr><td data-num="7"></td><td><pre>-</pre></td></tr><tr><td data-num="8"></td><td><pre> postgres  <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span>            <span class="token operator">|</span> libc            <span class="token operator">|</span> </pre></td></tr><tr><td data-num="9"></td><td><pre> sonarqube <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span>            <span class="token operator">|</span> libc            <span class="token operator">|</span> </pre></td></tr><tr><td data-num="10"></td><td><pre> template0 <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span>            <span class="token operator">|</span> libc            <span class="token operator">|</span> <span class="token operator">=</span>c/postgres          </pre></td></tr><tr><td data-num="11"></td><td><pre>+</pre></td></tr><tr><td data-num="12"></td><td><pre>           <span class="token operator">|</span>          <span class="token operator">|</span>          <span class="token operator">|</span>             <span class="token operator">|</span>             <span class="token operator">|</span>            <span class="token operator">|</span>                 <span class="token operator">|</span> <span class="token assign-left variable">postgres</span><span class="token operator">=</span>CTc/postgres</pre></td></tr><tr><td data-num="13"></td><td><pre> template1 <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span> en_US.UTF-8 <span class="token operator">|</span>            <span class="token operator">|</span> libc            <span class="token operator">|</span> <span class="token operator">=</span>c/postgres          </pre></td></tr><tr><td data-num="14"></td><td><pre>+</pre></td></tr><tr><td data-num="15"></td><td><pre>           <span class="token operator">|</span>          <span class="token operator">|</span>          <span class="token operator">|</span>             <span class="token operator">|</span>             <span class="token operator">|</span>            <span class="token operator">|</span>                 <span class="token operator">|</span> <span class="token assign-left variable">postgres</span><span class="token operator">=</span>CTc/postgre</pre></td></tr></table></figure><h5 id="23-安装sonarqube"><a class="anchor" href="#23-安装sonarqube">#</a> 2.3 安装 Sonarqube</h5><p>1、下载 sonarqube 的⼆进制包，然后解压⾄ /usr/local</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#sonarqube 10.5</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-10.5.0.89998.zip</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#sonarqube 11.0</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-25.11.0.114957.zip</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># unzip sonarqube-25.11.0.114957.zip -d /usr/local/</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># ln -s /usr/local/sonarqube-25.11.0.114957/ /usr/local/sonarqube</span></pre></td></tr></table></figure><p>2、修改 sonarqube 连接 postgresql 数据库配置⽂件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/sonarqube/conf/sonar.properties</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#----- PostgreSQL</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">sonar.jdbc.username</span><span class="token operator">=</span>postgres</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">sonar.jdbc.password</span><span class="token operator">=</span><span class="token number">123456</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">sonar.jdbc.url</span><span class="token operator">=</span>jdbc:postgresql://localhost/sonarqube</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># JVM options of Elasticsearch process</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token assign-left variable">sonar.search.javaOpts</span><span class="token operator">=</span>-Xmx2028m <span class="token parameter variable">-Xms2048m</span> <span class="token parameter variable">-XX:MaxDirectMemorySize</span><span class="token operator">=</span>256m <span class="token parameter variable">-XX:+HeapDumpOnOutOfMemoryError</span></pre></td></tr></table></figure><h5 id="24-启动sonarqube"><a class="anchor" href="#24-启动sonarqube">#</a> 2.4 启动 Sonarqube</h5><p>1、设定 sonarqube 中的 ElasticSearch 使⽤的内存⼤⼩</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/sonarqube/elasticsearch/config/jvm.options</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token parameter variable">-Xms1g</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token parameter variable">-Xmx1g</span></pre></td></tr></table></figure><p>2、启动 sonarqube 服务必须使⽤普通⽤户运⾏；如果使⽤ root 则会启动失败</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># useradd sonar</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># chown -R sonar:sonar /usr/local/sonarqube       </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># su - sonar -c "/usr/local/sonarqube/bin/linux-x86-64/sonar.sh start"</span></pre></td></tr></table></figure><h5 id="25-访问sonarqube"><a class="anchor" href="#25-访问sonarqube">#</a> 2.5 访问 Sonarqube</h5><p>1、通过浏览器输⼊ <a target="_blank" rel="noopener" href="http://hostname:9000">http://hostname:9000</a> 地址来访问 sonarqube ，输⼊⽤户名： admin ⽤户密码： admin</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/d9G2MI7.png" alt="3.png"></p><p>2、点击 Create a local project ，创建⼀个项⽬，然后分析的⽅式 Analysis Method 为⼿动</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/gl6aDT7.png" alt="1.png"></p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/MDoQ1Ne.png" alt="2.png"></p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/6k7HMNA.png" alt="3.png"></p><p>3、选择对应需要分析的项⽬语⾔，sonarqube 会给出对应的分析命令</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/PHypEpV.png" alt="4.png"></p><p>4、因此使⽤ SonarQube 分析 java 项⽬，可以直接使⽤ mvn 命令进⾏分析；</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>mvn clean verify sonar:sonar <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token parameter variable">-Dsonar.projectKey</span><span class="token operator">=</span>springboot <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token parameter variable">-Dsonar.projectName</span><span class="token operator">=</span><span class="token string">'springboot'</span> <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token parameter variable">-Dsonar.host.url</span><span class="token operator">=</span>http://sonar.hmallleasing.com:9000 <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token parameter variable">-Dsonar.token</span><span class="token operator">=</span>sqp_3a6fe642ad50ff06f2672cabe037fa692d3e722c</pre></td></tr></table></figure><p>5、但对于⾮ java 的项⽬，则需要借助 sonar-scanner 功能来完成对应的分析</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>sonar-scanner <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token parameter variable">-Dsonar.projectKey</span><span class="token operator">=</span>springboot <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token parameter variable">-Dsonar.sources</span><span class="token operator">=</span>. <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token parameter variable">-Dsonar.host.url</span><span class="token operator">=</span>http://sonar.hmallleasing.com:9000 <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token parameter variable">-Dsonar.token</span><span class="token operator">=</span>sqp_3a6fe642ad50ff06f2672cabe037fa692d3e722c</pre></td></tr></table></figure><h5 id="26-sonarqube插件管理"><a class="anchor" href="#26-sonarqube插件管理">#</a> 2.6 Sonarqube 插件管理</h5><p>Sonarqube 默认已经安装了 C Java Python Php 等代码的质量分析⼯具，那我们为什么还需要安装插件，因为我们还需要检测 html 等类型代码，⽽默认插件没有，所以需要安装；以便将代码检测的更加完善；</p><h6 id="261-联网安装插件"><a class="anchor" href="#261-联网安装插件">#</a> 2.6.1 联⽹安装插件</h6><p>联⽹安装插件⽐较简单，仅需要上应⽤市场搜索插件名称即可，如下以安装中⽂语⾔包插件为例；点击 Administration-&gt; Marketplace-&gt; 搜索框 chinese ，出现⼀个 Chinese Pack ，然后点击 install ，安装完毕后需要重启 sonarqube 服务</p><p>安装好的插件会存储在 /usr/local/sonarqube/extensions/plugins/ ⽬录下</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/7b0AF4G.png" alt="5.png"></p><h6 id="262-离线安装插件"><a class="anchor" href="#262-离线安装插件">#</a> 2.6.2 离线安装插件</h6><p>通过导⼊的⽅式来完成插件的安装。前提是该压缩包⾥⾯有⾜够多的插件，且版本要与当前的 sonarqube 保持⼀致。</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># rm -rf /usr/local/sonarqube/extensions/plugins</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># tar xf sonar_plugins.tar.gz -C /usr/local/sonarqube/extensions/</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># chown -R sonar.sonar /usr/local/sonarqube/extensions/plugins/</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>root@sonarqube ~<span class="token punctuation">]</span><span class="token comment"># su - sonar -c "/usr/local/sonarqube/bin/linux-x86-64/sonar.sh restart"</span></pre></td></tr></table></figure><h4 id="3-sonarqube检测代码"><a class="anchor" href="#3-sonarqube检测代码">#</a> 3. SonarQube 检测代码</h4><p>前⾯已经将 SonarQube 服务以及插件安装完成，那么接下来只需要将代码推送⾄ Sonarqube 进⾏分析即可</p><p><em><strong>Sonarqube 分析报错： NoClassDefFoundError: ch/qos/logback/classic/spi/ThrowableProxy</strong></em></p><h5 id="31-java项目分析"><a class="anchor" href="#31-java项目分析">#</a> 3.1 JAVA 项⽬分析</h5><p>1、生成 sonar 全局令牌</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/jJU4exf.png" alt="5.png"></p><p>2、进⼊项⽬⽬录，使⽤ mvn 命令将代码直接推送⾄ Sonarqube 分析，【注意：sonarqube 版本过多，他要求客户端也得⽀持 java17，项⽬也得⽀持 java17】；</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># mvn package</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># mvn clean verify sonar:sonar \</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token parameter variable">-Dsonar.projectKey</span><span class="token operator">=</span>springboot-devops-oldxu-jar <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token parameter variable">-Dsonar.projectName</span><span class="token operator">=</span><span class="token string">'springboot-devops-oldxu-jar'</span> <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token parameter variable">-Dsonar.host.url</span><span class="token operator">=</span>http://sonar.hmallleasing.com:9000 <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token parameter variable">-Dsonar.token</span><span class="token operator">=</span>sqa_b14c221e164b33d4733049072739739d51fbed04</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># -Dsonar.java.binaries=target/classes</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># -Dsonar.java.enablePreview=true   # 启⽤ java17 的新特性</span></pre></td></tr></table></figure><p>3、配置 hosts 解析</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@jenkins springboot-devops-demo-jar-java17<span class="token punctuation">]</span><span class="token comment"># cat /etc/hosts</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">127.0</span>.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</pre></td></tr><tr><td data-num="3"></td><td><pre>::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">192.168</span>.1.50 gitlab.hmallleasing.com</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">192.168</span>.1.32 nexus.hmallleasing.com</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">192.168</span>.1.8 sonar.hmallleasing.com</pre></td></tr></table></figure><p>4、登陆 Sonarqube 查看项⽬分析结果；</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/bNU272v.png" alt="6.png"></p><h5 id="32-非java项目分析"><a class="anchor" href="#32-非java项目分析">#</a> 3.2 ⾮ JAVA 项⽬分析</h5><p>Sonarqube 分析 Html、php、go 项⽬；需要借助 sonar-scanner 客户端⼯具来完成代码的分析；</p><p>1、安装 sonar-scanner 命令；sonar-scanner 下载地址</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># wget https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-5.0.1.3006-linux.zip</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># unzip sonar-scanner-cli-5.0.1.3006-linux.zip -d /usr/local/</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># ln -s /usr/local/sonar-scanner-5.0.1.3006-linux/ /usr/local/sonar-scanner</span></pre></td></tr></table></figure><p>2. 进⼊项⽬⽬录，使⽤ sonar-scanner ⼯具将代码推送 Sonarqube 服务端进⾏分析</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># html</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># /usr/local/sonar-scanner/bin/sonar-scanner \</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token parameter variable">-Dsonar.projectKey</span><span class="token operator">=</span>web_mointor <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token parameter variable">-Dsonar.sources</span><span class="token operator">=</span>. <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token parameter variable">-Dsonar.host.url</span><span class="token operator">=</span>http://sonar.hmallleasing.com:9000 <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token parameter variable">-Dsonar.token</span><span class="token operator">=</span>sqa_b14c221e164b33d4733049072739739d51fbed04</pre></td></tr><tr><td data-num="7"></td><td><pre> </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># java (需要先编译后检测，否则会报错)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># /usr/local/sonar-scanner/bin/sonar-scanner \</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token parameter variable">-Dsonar.projectKey</span><span class="token operator">=</span>springboot-devops-demo-war <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token parameter variable">-Dsonar.sources</span><span class="token operator">=</span>. <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token parameter variable">-Dsonar.java.binaries</span><span class="token operator">=</span>target/classes <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token parameter variable">-Dsonar.host.url</span><span class="token operator">=</span>http://sonar.hmallleasing.com:9000 <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token parameter variable">-Dsonar.token</span><span class="token operator">=</span>sqa_b14c221e164b33d4733049072739739d51fbed04</pre></td></tr></table></figure><p>3、登陆 Sonarqube 查看项⽬分析结果</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/IsGo36E.png" alt="7.png"></p><h4 id="4-jenkins集成sonarqube"><a class="anchor" href="#4-jenkins集成sonarqube">#</a> 4. Jenkins 集成 SonarQube</h4><p>Jenkins 需要知道 Sonarqube 服务的地址；以便能将代码推送指定服务节点；</p><p>Jenkins 需要知道 Sonar-Scanner 客户端⼯具，以便能正常调⽤ scanner 进⾏代码扫描；</p><h5 id="41-jenkins集成sonarqube"><a class="anchor" href="#41-jenkins集成sonarqube">#</a> 4.1 Jenkins 集成 Sonarqube</h5><p>1、插件安装； 系统管理 --&gt; 插件管理 --&gt;SonarQube Scanner for Jenkins</p><p>2、在 Jenkins 上配置 SonarQube 服务端地址； 系统管理 --&gt; 系统配置 --&gt;sonarQube (告诉 jenkins SonarQubeServers 服务端地址)</p><ul><li>Name 可以随意填写；</li><li>URL 添加 SonarQube 服务端地址（地址尾部不要添加斜杠，否则后期调⽤ Sonar 时，会出现⽆效的 JSON 字符串）；</li><li>token 添加⼀个 Secret text ；内容填写此前 SonarQube ⽣成的 Token（3.1 生成 sonar 全局令牌）</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/a5WCGzE.png" alt="1.png"></p><h5 id="42-jenkins集成sonar-scanner"><a class="anchor" href="#42-jenkins集成sonar-scanner">#</a> 4.2 Jenkins 集成 Sonar-Scanner</h5><p>在 Jenkins 上配置 Sonar-Scanner 客户端⼯具路径； 系统管理 --&gt; 全局⼯具配置 --&gt;sonar-scanner（告诉 jenkins SonarScanner 在本地哪个路径）</p><ul><li>Name 可以随意填写，但最好有规范<strong> SonarQube Scanner</strong></li><li>SONAR_RUNNER_HOME 填写 sonar-scanner 在 Jenkins 本地路径</li></ul><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/qBwBM1G.png" alt="2.png"></p><h4 id="5-jenkins为项目添加测试阶段"><a class="anchor" href="#5-jenkins为项目添加测试阶段">#</a> 5. Jenkins 为项⽬添加测试阶段</h4><h5 id="51-maven质检方式"><a class="anchor" href="#51-maven质检方式">#</a> 5.1 maven 质检⽅式</h5><p>在项⽬编译后执⾏扫描动作，也就是 Post Steps 阶段</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/mm2yx8L.png" alt="4.png"></p><p><em>注意：如下内容不要添加 \ 换⾏符，直接回⻋即可。</em></p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>clean</pre></td></tr><tr><td data-num="2"></td><td><pre>verify</pre></td></tr><tr><td data-num="3"></td><td><pre>sonar:sonar</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token parameter variable">-Dsonar.projectKey</span><span class="token operator">=</span><span class="token variable">$&#123;JOB_NAME&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token parameter variable">-Dsonar.projectName</span><span class="token operator">=</span><span class="token variable">$&#123;JOB_NAME&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token parameter variable">-Dsonar.host.url</span><span class="token operator">=</span>http://sonar.hmallleasing.com:9000</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token parameter variable">-Dsonar.token</span><span class="token operator">=</span>sqa_b14c221e164b33d4733049072739739d51fbed04</pre></td></tr></table></figure><h5 id="52-scanner质检方式"><a class="anchor" href="#52-scanner质检方式">#</a> 5.2 Scanner 质检⽅式</h5><p>在项⽬编译后执⾏扫描动作，也就是 Post Steps 阶段</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/hY509vW.png" alt="5.png"></p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 针对静态站点使⽤ sonar-canner（不要粘贴注释在⾥⾯）</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">sonar.projectName</span><span class="token operator">=</span><span class="token variable">$&#123;JOB_NAME&#125;</span> <span class="token comment">#项⽬在 sonarqube 上的显示名称</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">sonar.projectKey</span><span class="token operator">=</span><span class="token variable">$&#123;JOB_NAME&#125;</span>  <span class="token comment">#项⽬的唯⼀标识，不能重复</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">sonar.sources</span><span class="token operator">=</span>.               <span class="token comment">#扫描哪个项⽬的源码</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 针对 java 使⽤ sonar-canner ⾃动扫描</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token assign-left variable">sonar.projectName</span><span class="token operator">=</span><span class="token variable">$&#123;JOB_NAME&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token assign-left variable">sonar.projectKey</span><span class="token operator">=</span><span class="token variable">$&#123;JOB_NAME&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token assign-left variable">sonar.sources</span><span class="token operator">=</span>.</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token assign-left variable">sonar.java.binaries</span><span class="token operator">=</span>target/classes</pre></td></tr></table></figure><h5 id="53-质量检测结果查看"><a class="anchor" href="#53-质量检测结果查看">#</a> 5.3 质量检测结果查看</h5><p>1、检查 Jenkins 构建结果</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/vdCSA2P.png" alt="6.png"></p><p>2、检查 Sonarqube 质量检测结果</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/8u3dfgH.png" alt="7.png"></p><h4 id="6-jenkins为项目添加通知阶段"><a class="anchor" href="#6-jenkins为项目添加通知阶段">#</a> 6. Jenkins 为项⽬添加通知阶段</h4><p>CI 阶段： 通知 sonarqube 的质量结果；</p><p>CD 阶段：通知任务构建是否成功；</p><h5 id="61-配置钉钉"><a class="anchor" href="#61-配置钉钉">#</a> 6.1 配置钉钉</h5><p>1、点击钉钉右上角 +--&gt; 发起群聊 --&gt; 群名称：Jenkins-Notify--&gt; 群归属：普通群</p><p>2、设置 --&gt; 群类型 --&gt; 内部群</p><p>3、打开钉钉群组，点击群机器⼈。(如果你不是群主，且群主开启了仅群主可管理，那么将⽆法创建机器⼈。)</p><p>4、添加⼀个⾃定义机器⼈</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/BVznsqx.png" alt="3.png"></p><p>5、可以修改机器⼈名称，以及机器⼈的名字，自定义关键字（任务、BUG、漏洞、部署、代码、构建）</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/Xvo9mzQ.png" alt="1.png"></p><p>6、机器⼈修改成功后，会给出⼀个 webhook 地址。(此处的 webhook 后续 jenkins 需要使⽤)</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>https://oapi.dingtalk.com/robot/send?access_token<span class="token operator">=</span>53b3de985e09e3d7bc6ef1fa84f2c2820a9d5d1a52f43aaa2e6fa3c548997250</pre></td></tr></table></figure><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/ETGIQ1W.png" alt="2.png"></p><h5 id="62-jenkins集成钉钉"><a class="anchor" href="#62-jenkins集成钉钉">#</a> 6.2 Jenkins 集成钉钉</h5><p>1、Jenkins 安装 dingding 插件， DingTalk 。</p><p>2、配置钉钉机器⼈，系统管理 --&gt; 钉钉 --&gt; 配置通知机制</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/W2Oqi8A.png" alt="4.png"></p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/ZYgiBP3.png" alt="5.png"></p><p>3、添加机器⼈</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/wYgXD80.png" alt="7.png"></p><p>4、点击测试，验证是否能将消息发送⾄钉钉</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/NaA09HC.png" alt="8.png"></p><h5 id="63-为项目添加通知"><a class="anchor" href="#63-为项目添加通知">#</a> 6.3 为项⽬添加通知</h5><p>1、找到对应的 CD 阶段项⽬，然后选择此前添加的机器⼈，然后配置⾼级，选择通知谁，通知的消息是什么；</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/8lyUvEE.png" alt="1.png"></p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>- 部署的项⽬: <span class="token variable">$&#123;PROJECT_NAME&#125;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>- 部署的环境：<span class="token variable">$&#123;host_inventory&#125;</span>    <span class="token comment">#确实项目中是否存在该变量</span></pre></td></tr><tr><td data-num="3"></td><td><pre>- 部署的版本: <span class="token variable">$&#123;jar_deploy_url&#125;</span>    <span class="token comment">#确实项目中是否存在该变量</span></pre></td></tr></table></figure><p>2、检查钉钉的执⾏结果；</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/My2ekBX.png" alt="2.png"></p><h4 id="7-jenkins为项目通知质检结果"><a class="anchor" href="#7-jenkins为项目通知质检结果">#</a> 7. Jenkins 为项⽬通知质检结果</h4><h5 id="71-sonarqube结果通知方案"><a class="anchor" href="#71-sonarqube结果通知方案">#</a> 7.1 Sonarqube 结果通知⽅案</h5><p>Jenkins--&gt; 扫描项⽬ ---&gt; 推送 --&gt;Sonarqube--&gt;Webhook--&gt; 开源程序 --&gt; 发送 --&gt; 钉钉机器⼈</p><p>使⽤开源程序： sonarqube-ding-robot ，项⽬地址： <a target="_blank" rel="noopener" href="https://github.com/akkuman/sonarqube-ding-robot/tree/master">https://github.com/akkuman/sonarqube-ding-robot/tree/master</a></p><ul><li>1、设定钉钉机器⼈，然后获取对应机器⼈的 token。</li><li>2、运⾏ sonarqube_dingding 程序，但是需要指定 Sonarqube 的 Token ；</li><li>3、配置 Sonarqube 的 Webhook，指定 sonarqube-dingding 程序运⾏的地址以及端⼝，但需要传递钉钉的 Token 。</li></ul><h5 id="72-配置钉钉机器人"><a class="anchor" href="#72-配置钉钉机器人">#</a> 7.2 配置钉钉机器⼈</h5><p>1、点击钉钉右上角 +--&gt; 发起群聊 --&gt; 群名称：Jenkins-Notify--&gt; 群归属：普通群</p><p>2、设置 --&gt; 群类型 --&gt; 内部群</p><p>3、打开钉钉群组，点击群机器⼈。(如果你不是群主，且群主开启了仅群主可管理，那么将⽆法创建机器⼈。)</p><p>4、添加⼀个⾃定义机器⼈</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/BVznsqx.png" alt="3.png"></p><p>5、可以修改机器⼈名称，以及机器⼈的名字，自定义关键字（任务、BUG、漏洞、部署、代码、构建）</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/zouQ4i4.png" alt="3.png"></p><p>6、机器⼈修改成功后，会给出⼀个 webhook 地址。(此处的 webhook 后续 jenkins 需要使⽤)</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>https://oapi.dingtalk.com/robot/send?access_token<span class="token operator">=</span>55af9255dd264a6b4c51a4fcc6a0a4553488a7db87f1c2942702039248536c0c</pre></td></tr></table></figure><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/qGXQXw2.png" alt="5.png"></p><h5 id="73-启动sonarqube-ding程序"><a class="anchor" href="#73-启动sonarqube-ding程序">#</a> 7.3 启动 sonarqube-ding 程序</h5><p>如果在 Sonarqube 服务端上运⾏这个程序，则需要进⾏如下设定。</p><p>通⽤设置 --&gt; 权限 --&gt;Enable local webhooks validation (关闭) ，否则没办法通过 webhook 通知结果到本地的 localhost 程序上</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/vsT3r8M.png" alt="6.png"></p><p>1、下载 sonarqube-ding-robot</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># wget https://mirror.ghproxy.com/ https://github.com/akkuman/sonarqube-ding-robot/releases/download/v1.0.0/sonarqube-ding-robot</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># mv sonarqube-ding-robot /usr/local/bin/sonarqube_dingding</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># chmod +x /usr/local/bin/sonarqube_dingding</span></pre></td></tr></table></figure><p>2、启动 sonarqube-dingdingding ，然后传递对应 Sonarqube 的 Token</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/lib/systemd/system/sonarqube_dingding.service</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">Description</span><span class="token operator">=</span>sonarqube_dingding</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">Documentation</span><span class="token operator">=</span>https://sonarqube-webhook/</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">After</span><span class="token operator">=</span>network.target</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span>Service<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/bin/sonarqube_dingding <span class="token parameter variable">-addr</span> <span class="token number">0.0</span>.0.0:9002 <span class="token parameter variable">-token</span> sqa_0dd30b2ad16260b797d99b17f2f648ef6ee22570</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-HUP</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token assign-left variable">TimeoutStopSec</span><span class="token operator">=</span>20s</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token assign-left variable">Restart</span><span class="token operator">=</span>always</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">[</span>Install<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 启动</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># systemctl daemon-reload</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># systemctl start sonarqube_dingding</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># systemctl enable sonarqube_dingding</span></pre></td></tr></table></figure><p>3、检查程序是否启动成功</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@jenkins ~<span class="token punctuation">]</span><span class="token comment"># netstat -lntp|grep 9002</span></pre></td></tr><tr><td data-num="2"></td><td><pre>tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::9002                 :::*                    LISTEN      <span class="token number">23206</span>/sonarqube_din</pre></td></tr></table></figure><h5 id="74-配置sonarqube-webhook"><a class="anchor" href="#74-配置sonarqube-webhook">#</a> 7.4 配置 SOnarqube-webhook</h5><p>1、点击配置 --&gt;Webhook--&gt; 创建</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/u0Ik0ZG.png" alt="7.png"></p><p>2、填写名称和程序 URL（需要填写钉钉的 Token）</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>http://localhost:9002/dingtalk?access_token<span class="token operator">=</span>55af9255dd264a6b4c51a4fcc6a0a4553488a7db87f1c2942702039248536c0c</pre></td></tr></table></figure><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/B7n6THB.png" alt="8.png"></p><p>3、配置 Server base URL，通知中点击分析结果可以链接至 SOnarqube 页面</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/NhMNiS6.png" alt="12.png"></p><p>4、执⾏ Sonarqube 的质量扫描，然后检查最终钉钉的通知结果 **（章节 5.2 Scanner 质检⽅式）**。</p><p><img loading="lazy" data-src="https://wp-cdn.4ce.cn/v2/nKPHYIk.png" alt="11.png"></p><div class="tags"><a href="/tags/DevOps/" rel="tag"><i class="ic i-tag"></i>DevOps</a></div></div><footer><div class="meta"><span class="icon"><i class="ic i-eye"></i></span><span>此文章已被阅读次数:</span><span class="waline-pageview-count" id="twikoo_visitors" data-path="/posts/2561708653.html">正在加载...</span><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2025-11-26 20:57:28" itemprop="dateModified" datetime="2025-11-26T20:57:28+08:00">2025-11-26</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/wechatpay.png" alt="Xu Yong 微信支付"><p>微信支付</p></div><div><img loading="lazy" data-src="/assets/alipay.png" alt="Xu Yong 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>Xu Yong<i class="ic i-at"><em>@</em></i>LinuxSre云原生</li><li class="link"><strong>本文链接：</strong><a href="http://ixuyong.cn/posts/2561708653.html" title="Jenkins SonarQube实践（六）">http://ixuyong.cn/posts/2561708653.html</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/posts/1694028289.html" rel="prev" itemprop="url" data-background-image="https:&#x2F;&#x2F;wp-cdn.4ce.cn&#x2F;v2&#x2F;ofw8rP7.jpeg" title="Jenkins Nexus实践（五）"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>DevOps</span><h3>Jenkins Nexus实践（五）</h3></a></div><div class="item right"><a href="/posts/3198692923.html" rel="next" itemprop="url" data-background-image="https:&#x2F;&#x2F;wp-cdn.4ce.cn&#x2F;v2&#x2F;8mPCEuw.jpeg" title="Jenkins Pipeine实践（七）"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>DevOps</span><h3>Jenkins Pipeine实践（七）</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#jenkins-sonarqube%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.</span> <span class="toc-text">Jenkins SonarQube 实践</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-sonarqube%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">1. SonarQube 基本概述</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#11-%E4%BB%80%E4%B9%88%E6%98%AFsonarqube"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 什么是 SonarQube</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-sonarqube%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 Sonarqube 服务架构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#13-%E4%BD%BF%E7%94%A8sonarqube%E5%89%8D%E6%8F%90"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 使⽤ Sonarqube 前提</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-sonarqube%E6%9C%8D%E5%8A%A1%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.</span> <span class="toc-text">2. SonarQube 服务安装</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#21-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 环境准备</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#22-%E9%83%A8%E7%BD%B2postgresql-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 部署 postgresql 数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#23-%E5%AE%89%E8%A3%85sonarqube"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 安装 Sonarqube</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#24-%E5%90%AF%E5%8A%A8sonarqube"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 启动 Sonarqube</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#25-%E8%AE%BF%E9%97%AEsonarqube"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5 访问 Sonarqube</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#26-sonarqube%E6%8F%92%E4%BB%B6%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.6.</span> <span class="toc-text">2.6 Sonarqube 插件管理</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#261-%E8%81%94%E7%BD%91%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">2.6.1 联⽹安装插件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#262-%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">2.6.2 离线安装插件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-sonarqube%E6%A3%80%E6%B5%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">1.3.</span> <span class="toc-text">3. SonarQube 检测代码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#31-java%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 JAVA 项⽬分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#32-%E9%9D%9Ejava%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 ⾮ JAVA 项⽬分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-jenkins%E9%9B%86%E6%88%90sonarqube"><span class="toc-number">1.4.</span> <span class="toc-text">4. Jenkins 集成 SonarQube</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#41-jenkins%E9%9B%86%E6%88%90sonarqube"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 Jenkins 集成 Sonarqube</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#42-jenkins%E9%9B%86%E6%88%90sonar-scanner"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 Jenkins 集成 Sonar-Scanner</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-jenkins%E4%B8%BA%E9%A1%B9%E7%9B%AE%E6%B7%BB%E5%8A%A0%E6%B5%8B%E8%AF%95%E9%98%B6%E6%AE%B5"><span class="toc-number">1.5.</span> <span class="toc-text">5. Jenkins 为项⽬添加测试阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#51-maven%E8%B4%A8%E6%A3%80%E6%96%B9%E5%BC%8F"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 maven 质检⽅式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#52-scanner%E8%B4%A8%E6%A3%80%E6%96%B9%E5%BC%8F"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 Scanner 质检⽅式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#53-%E8%B4%A8%E9%87%8F%E6%A3%80%E6%B5%8B%E7%BB%93%E6%9E%9C%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 质量检测结果查看</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-jenkins%E4%B8%BA%E9%A1%B9%E7%9B%AE%E6%B7%BB%E5%8A%A0%E9%80%9A%E7%9F%A5%E9%98%B6%E6%AE%B5"><span class="toc-number">1.6.</span> <span class="toc-text">6. Jenkins 为项⽬添加通知阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#61-%E9%85%8D%E7%BD%AE%E9%92%89%E9%92%89"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 配置钉钉</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#62-jenkins%E9%9B%86%E6%88%90%E9%92%89%E9%92%89"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 Jenkins 集成钉钉</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#63-%E4%B8%BA%E9%A1%B9%E7%9B%AE%E6%B7%BB%E5%8A%A0%E9%80%9A%E7%9F%A5"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 为项⽬添加通知</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-jenkins%E4%B8%BA%E9%A1%B9%E7%9B%AE%E9%80%9A%E7%9F%A5%E8%B4%A8%E6%A3%80%E7%BB%93%E6%9E%9C"><span class="toc-number">1.7.</span> <span class="toc-text">7. Jenkins 为项⽬通知质检结果</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#71-sonarqube%E7%BB%93%E6%9E%9C%E9%80%9A%E7%9F%A5%E6%96%B9%E6%A1%88"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 Sonarqube 结果通知⽅案</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#72-%E9%85%8D%E7%BD%AE%E9%92%89%E9%92%89%E6%9C%BA%E5%99%A8%E4%BA%BA"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 配置钉钉机器⼈</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#73-%E5%90%AF%E5%8A%A8sonarqube-ding%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 启动 sonarqube-ding 程序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#74-%E9%85%8D%E7%BD%AEsonarqube-webhook"><span class="toc-number">1.7.4.</span> <span class="toc-text">7.4 配置 SOnarqube-webhook</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/posts/1208493697.html" rel="bookmark" title="K8S基于Jenkins实现SpringCloud微服务CI与CD实践（一）">K8S基于Jenkins实现SpringCloud微服务CI与CD实践（一）</a></li><li><a href="/posts/1366748664.html" rel="bookmark" title="K8S基于Jenkins实现Java项目CI与CD实践（二）">K8S基于Jenkins实现Java项目CI与CD实践（二）</a></li><li><a href="/posts/889219339.html" rel="bookmark" title="K8S基于Jenkins实现SpringCloud微服务CI与CD实践（三）">K8S基于Jenkins实现SpringCloud微服务CI与CD实践（三）</a></li><li><a href="/posts/2330853882.html" rel="bookmark" title="K8S基于Jenkins实现微服务应用CICD实践（四）">K8S基于Jenkins实现微服务应用CICD实践（四）</a></li><li><a href="/posts/1283421134.html" rel="bookmark" title="分布式版本控制系统Git（一）">分布式版本控制系统Git（一）</a></li><li><a href="/posts/3430284798.html" rel="bookmark" title="Jenkins快速入门实践（二））">Jenkins快速入门实践（二））</a></li><li><a href="/posts/2150338938.html" rel="bookmark" title="Jenkins FreeStyle实践（三）">Jenkins FreeStyle实践（三）</a></li><li><a href="/posts/2897649757.html" rel="bookmark" title="Jenkins Maven实践（四）">Jenkins Maven实践（四）</a></li><li><a href="/posts/1694028289.html" rel="bookmark" title="Jenkins Nexus实践（五）">Jenkins Nexus实践（五）</a></li><li class="active"><a href="/posts/2561708653.html" rel="bookmark" title="Jenkins SonarQube实践（六）">Jenkins SonarQube实践（六）</a></li><li><a href="/posts/3198692923.html" rel="bookmark" title="Jenkins Pipeine实践（七）">Jenkins Pipeine实践（七）</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="Xu Yong" src="/assets/avatar.png"><p class="name" itemprop="name">Xu Yong</p><div class="description" itemprop="description">专注于 Linux 运维、云计算、云原⽣等技术</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">87</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">19</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">22</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/xyapples" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;xyapples"><i class="ic i-github"></i></a><a target="_blank" rel="noopener" href="https://gitee.com/chinagei" class="item gitee" title="https:&#x2F;&#x2F;gitee.com&#x2F;chinagei"><i class="ic i-gitee"></i></a><a href="mailto:373370405@qq.com" class="item email" title="mailto:373370405@qq.com"><i class="ic i-envelope"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-about"></i>关于</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/posts/3198692923.html" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/posts/1694028289.html" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/DevOps/" title="分类于DevOps">DevOps</a></div><span><a href="/posts/2150338938.html">Jenkins FreeStyle实践（三）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Ansible/" title="分类于Ansible">Ansible</a></div><span><a href="/posts/4269570224.html">Ansible Variables（三）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/MySQL/" title="分类于MySQL">MySQL</a></div><span><a href="/posts/2628187572.html">MySQL运维DBA应用与实践</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DevOps/" title="分类于DevOps">DevOps</a></div><span><a href="/posts/2330853882.html">K8S基于Jenkins实现微服务应用CICD实践（四）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DevOps/" title="分类于DevOps">DevOps</a></div><span><a href="/posts/1366748664.html">K8S基于Jenkins实现Java项目CI与CD实践（二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Kubernetes/" title="分类于Kubernetes">Kubernetes</a></div><span><a href="/posts/3030097036.html">K8S云原生存储Rook-Ceph</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Nginx/" title="分类于Nginx">Nginx</a></div><span><a href="/posts/865547436.html">Nginx基础架构LNMP（三）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/LVS/" title="分类于LVS">LVS</a></div><span><a href="/posts/1598774589.html">企业级负载均衡LVS场景实战（二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Iptables/" title="分类于Iptables">Iptables</a></div><span><a href="/posts/3328453550.html">Iptables防火墙实战</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Windows/" title="分类于Windows">Windows</a></div><span><a href="/posts/3071070979.html">一键永久激活Window、office教程</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 -<span itemprop="copyrightYear">2025</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">Xu Yong @ LinuxSre云原生</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">2.2m 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">33:20</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `posts/2561708653.html`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="/js/siteInit.js?v=0.4.17" type="module" fetchpriority="high" defer></script></body></html><!-- rebuild by hrmmi -->