{
    "version": "https://jsonfeed.org/version/1",
    "title": "LinuxSre云原生",
    "description": "专注于 Linux 运维、云计算、云原⽣等技术",
    "home_page_url": "http://ixuyong.cn",
    "items": [
        {
            "id": "http://ixuyong.cn/posts/170066797.html",
            "url": "http://ixuyong.cn/posts/170066797.html",
            "title": "消费租赁项目Kubernetes基于ELK日志分析与实践",
            "date_published": "2025-05-25T06:35:21.000Z",
            "content_html": "<h3 id=\"消费租赁项目kubernetes基于elk日志分析与实践\"><a class=\"anchor\" href=\"#消费租赁项目kubernetes基于elk日志分析与实践\">#</a> 消费租赁项目 Kubernetes 基于 ELK 日志分析与实践</h3>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/Og7liF6.jpeg\" alt=\"Snipaste_2025-05-25_13-43-46.jpg\" /></p>\n<h4 id=\"1-elk创建namespace和secrets\"><a class=\"anchor\" href=\"#1-elk创建namespace和secrets\">#</a> 1. ELK 创建 Namespace 和 Secrets</h4>\n<pre><code># kubectl create ns logging\n# kubectl create secret docker-registry harbor-admin -n logging --docker-server=registry.cn-hangzhou.aliyuncs.com --docker-username=xyapples@163.com --docker-password=Talent*19871988\n</code></pre>\n<h4 id=\"2-交付zookeeper集群至k8s\"><a class=\"anchor\" href=\"#2-交付zookeeper集群至k8s\">#</a> 2. 交付 Zookeeper 集群至 K8S</h4>\n<h5 id=\"21-制作zk集群镜像\"><a class=\"anchor\" href=\"#21-制作zk集群镜像\">#</a> 2.1 制作 ZK 集群镜像</h5>\n<h6 id=\"211-dockerfile\"><a class=\"anchor\" href=\"#211-dockerfile\">#</a> 2.1.1 Dockerfile</h6>\n<pre><code># cat Dockerfile \nFROM openjdk:8-jre\n\n# 1、拷贝Zookeeper压缩包和配置文件\nENV VERSION=3.8.4\nADD ./apache-zookeeper-$&#123;VERSION&#125;-bin.tar.gz /\nADD ./zoo.cfg /apache-zookeeper-$&#123;VERSION&#125;-bin/conf\n\n# 2、对Zookeeper文件夹名称重新命名\nRUN mv /apache-zookeeper-$&#123;VERSION&#125;-bin /zookeeper\n\n# 3、拷贝eentrpoint的启动脚本文件\nADD ./entrypoint.sh /entrypoint.sh\n\n# 4、暴露Zookeeper端口\nEXPOSE 2181 2888 3888\n\n# 5、执行启动脚本\nCMD [&quot;/bin/bash&quot;,&quot;/entrypoint.sh&quot;]\n</code></pre>\n<h6 id=\"212-zoocfg\"><a class=\"anchor\" href=\"#212-zoocfg\">#</a> 2.1.2 zoo.cfg</h6>\n<pre><code># cat zoo.cfg \n# 服务器之间或客户端与服务器之间维持心跳的时间间隔 tickTime以毫秒为单位。\ntickTime=&#123;ZOOK_TICKTIME&#125;\n\n# 集群中的follower服务器(F)与leader服务器(L)之间的初始连接心跳数 10* tickTime\ninitLimit=&#123;ZOOK_INIT_LIMIT&#125;\n\n# 集群中的follower服务器与leader服务器之间请求和应答之间能容忍的最多心跳数 5 * tickTime\nsyncLimit=&#123;ZOOK_SYNC_LIMIT&#125;\n \n# 数据保存目录\ndataDir=&#123;ZOOK_DATA_DIR&#125;\n\n# 日志保存目录\ndataLogDir=&#123;ZOOK_LOG_DIR&#125;\n\n# 客户端连接端口\nclientPort=&#123;ZOOK_CLIENT_PORT&#125;\n\n# 客户端最大连接数。# 根据自己实际情况设置，默认为60个\nmaxClientCnxns=&#123;ZOOK_MAX_CLIENT_CNXNS&#125;\n\n# 客户端获取 zookeeper 服务的当前状态及相关信息\n4lw.commands.whitelist=*\n\n# 三个接点配置，格式为： server.服务编号=服务地址、LF通信端口、选举端口\n</code></pre>\n<h6 id=\"213-entrypoint\"><a class=\"anchor\" href=\"#213-entrypoint\">#</a> 2.1.3 entrypoint</h6>\n<pre><code># cat entrypoint.sh \n#设定变量\nZOOK_BIN_DIR=/zookeeper/bin\nZOOK_CONF_DIR=/zookeeper/conf/zoo.cfg\n\n# 2、对配置文件中的字符串进行变量替换\nsed -i s@&#123;ZOOK_TICKTIME&#125;@$&#123;ZOOK_TICKTIME:-2000&#125;@g $&#123;ZOOK_CONF_DIR&#125;\nsed -i s@&#123;ZOOK_INIT_LIMIT&#125;@$&#123;ZOOK_INIT_LIMIT:-10&#125;@g $&#123;ZOOK_CONF_DIR&#125;\nsed -i s@&#123;ZOOK_SYNC_LIMIT&#125;@$&#123;ZOOK_SYNC_LIMIT:-5&#125;@g $&#123;ZOOK_CONF_DIR&#125;\nsed -i s@&#123;ZOOK_DATA_DIR&#125;@$&#123;ZOOK_DATA_DIR:-/data&#125;@g $&#123;ZOOK_CONF_DIR&#125;\nsed -i s@&#123;ZOOK_LOG_DIR&#125;@$&#123;ZOOK_LOG_DIR:-/logs&#125;@g $&#123;ZOOK_CONF_DIR&#125;\nsed -i s@&#123;ZOOK_CLIENT_PORT&#125;@$&#123;ZOOK_CLIENT_PORT:-2181&#125;@g $&#123;ZOOK_CONF_DIR&#125;\nsed -i s@&#123;ZOOK_MAX_CLIENT_CNXNS&#125;@$&#123;ZOOK_MAX_CLIENT_CNXNS:-60&#125;@g $&#123;ZOOK_CONF_DIR&#125;\n\n# 3、准备ZK的集群节点地址，后期肯定是需要通过ENV的方式注入进来\nfor server in $&#123;ZOOK_SERVERS&#125;\ndo\n\techo $&#123;server&#125; &gt;&gt; $&#123;ZOOK_CONF_DIR&#125;\ndone\n\n# 4、在datadir目录中创建myid的文件，并填入对应的编号\nZOOK_MYID=$(( $(hostname | sed 's#.*-##g') + 1 ))\necho $&#123;ZOOK_MYID:-99&#125; &gt; $&#123;ZOOK_DATA_DIR:-/data&#125;/myid\n\n#5、前台运行Zookeeper\ncd $&#123;ZOOK_BIN_DIR&#125;\n./zkServer.sh start-foreground\n</code></pre>\n<h6 id=\"214-构建镜像并推送仓库\"><a class=\"anchor\" href=\"#214-构建镜像并推送仓库\">#</a> 2.1.4 构建镜像并推送仓库</h6>\n<pre><code># wget https://dlcdn.apache.org/zookeeper/zookeeper-3.8.4/apache-zookeeper-3.8.4-bin.tar.gz\n# docker build -t registry.cn-hangzhou.aliyuncs.com/kubernetes_public/zookeeper:3.8.4 .\n# docker push  registry.cn-hangzhou.aliyuncs.com/kubernetes_public/zookeeper:3.8.4\n</code></pre>\n<h5 id=\"22-迁移zookeeper至k8s\"><a class=\"anchor\" href=\"#22-迁移zookeeper至k8s\">#</a> 2.2  迁移 zookeeper 至 K8S</h5>\n<h6 id=\"221-zookeeper-headless\"><a class=\"anchor\" href=\"#221-zookeeper-headless\">#</a> 2.2.1 zookeeper-headless</h6>\n<pre><code># cat 01-zookeeper-headless.yaml \napiVersion: v1\nkind: Service\nmetadata:\n  name: zookeeper-svc\n  namespace: logging\nspec:\n  clusterIP: None\n  selector:\n    app: zookeeper\n  ports:\n  - name: client\n    port: 2181\n    targetPort: 2181\n  - name: leader-follwer\n    port: 2888\n    targetPort: 2888\n  - name: selection\n    port: 3888\n    targetPort: 3888\n</code></pre>\n<h6 id=\"222-zookeeper-sts\"><a class=\"anchor\" href=\"#222-zookeeper-sts\">#</a> 2.2.2 zookeeper-sts</h6>\n<pre><code>[root@k8s-master01 01-zookeeper]# vim 02-zookeeper-sts.yaml \napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: zookeeper               \n  namespace: logging\nspec:\n  serviceName: &quot;zookeeper-svc&quot;\n  replicas: 3\n  selector:\n    matchLabels:\n      app: zookeeper\n  template:\n    metadata:\n      labels:\n        app: zookeeper\n    spec:\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            - labelSelector:\n                matchExpressions:\n                - key: app\n                  operator: In\n                  values: [&quot;zookeeper&quot;]\n              topologyKey: &quot;kubernetes.io/hostname&quot;\n      imagePullSecrets:\n      - name: harbor-admin\n      containers:\n      - name: zookeeper\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/zookeeper:3.8.4           \n        imagePullPolicy: Always\n        ports:\n        - name: client\n          containerPort: 2181\n        - name: leader-follwer\n          containerPort: 2888\n        - name: selection\n          containerPort: 3888\n        env:\n        - name: ZOOK_SERVERS\n          value: &quot;server.1=zookeeper-0.zookeeper-svc.logging.svc.cluster.local:2888:3888 server.2=zookeeper-1.zookeeper-svc.logging.svc.cluster.local:2888:3888 server.3=zookeeper-2.zookeeper-svc.logging.svc.cluster.local:2888:3888&quot;\n        readinessProbe:         # 就绪探针，不就绪则不介入流量\n          exec:\n            command:\n            - &quot;/bin/bash&quot;\n            - &quot;-c&quot;\n            - '[[ &quot;$(/zookeeper/bin/zkServer.sh status 2&gt;/dev/null|grep 2181)&quot; ]] &amp;&amp; exit 0 || exit 1'\n          initialDelaySeconds: 5\n        livenessProbe:         # 存活探针。如果不存活则根据重启策略进行重启\n          exec:\n            command:\n            - &quot;/bin/bash&quot;\n            - &quot;-c&quot;\n            - '[[ &quot;$(/zookeeper/bin/zkServer.sh status 2&gt;/dev/null|grep 2181)&quot; ]] &amp;&amp; exit 0 || exit 1'\n          initialDelaySeconds: 5\n        volumeMounts:\n        - name: data\n          mountPath: /data\n          subPath: data\n        - name: data\n          mountPath: /logs\n          subPath: logs\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n        - name: timezone\n          mountPath: /etc/timezone\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n  volumeClaimTemplates:\n  - metadata:\n      name: data\n    spec:\n      accessModes: [&quot;ReadWriteMany&quot;]\n      storageClassName: &quot;nfs-storage&quot;\n      resources:\n        requests:\n          storage: 5Gi\n</code></pre>\n<h6 id=\"223-更新资源清单\"><a class=\"anchor\" href=\"#223-更新资源清单\">#</a> 2.2.3 更新资源清单</h6>\n<pre><code>[root@k8s-master01 01-zookeeper]# kubectl apply -f 01-zookeeper-headless.yaml \n[root@k8s-master01 01-zookeeper]# kubectl apply -f 02-zookeeper-sts.yaml\n[root@k8s-master01 01-zookeeper]# kubectl get pods -n logging\nNAME          READY   STATUS    RESTARTS   AGE\nzookeeper-0   1/1     Running   0          17m\nzookeeper-1   1/1     Running   0          14m\nzookeeper-2   1/1     Running   0          11m\n</code></pre>\n<h6 id=\"224-检查zookeeper集群状态\"><a class=\"anchor\" href=\"#224-检查zookeeper集群状态\">#</a> 2.2.4 检查 zookeeper 集群状态</h6>\n<pre><code># for i in 0 1 2 ; do kubectl exec zookeeper-$i -n logging -- /zookeeper/bin/zkServer.sh status; done\nZooKeeper JMX enabled by default\nUsing config: /zookeeper/bin/../conf/zoo.cfg\nClient port found: 2181. Client address: localhost. Client SSL: false.\nMode: follower\nZooKeeper JMX enabled by default\nUsing config: /zookeeper/bin/../conf/zoo.cfg\nClient port found: 2181. Client address: localhost. Client SSL: false.\nMode: leader\nZooKeeper JMX enabled by default\nUsing config: /zookeeper/bin/../conf/zoo.cfg\nClient port found: 2181. Client address: localhost. Client SSL: false.\nMode: follower\n</code></pre>\n<h6 id=\"225-连接zookeeper集群\"><a class=\"anchor\" href=\"#225-连接zookeeper集群\">#</a> 2.2.5 连接 Zookeeper 集群</h6>\n<pre><code>[root@k8s-master01 01-zookeeper]# kubectl exec -it zookeeper-0 -n logging -- /bin/sh\n# /zookeeper/bin/zkCli.sh -server zookeeper-svc\n[zk: zookeeper-svc(CONNECTED) 0]  create /hello oldxu\nCreated /hello\n[zk: zookeeper-svc(CONNECTED) 1] get /hello\noldxu\n</code></pre>\n<h4 id=\"3-交付kafka集群至k8s\"><a class=\"anchor\" href=\"#3-交付kafka集群至k8s\">#</a> 3. 交付 Kafka 集群至 K8S</h4>\n<h5 id=\"31-制作kafka集群镜像\"><a class=\"anchor\" href=\"#31-制作kafka集群镜像\">#</a> 3.1 制作 Kafka 集群镜像</h5>\n<h6 id=\"311-dockerfile\"><a class=\"anchor\" href=\"#311-dockerfile\">#</a> 3.1.1 Dockerfile</h6>\n<pre><code># cat Dockerfile \nFROM openjdk:8-jre\n\n# 1、调整时区\nRUN /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; \\\n    echo 'Asia/Shanghai' &gt; /etc/timezone\n\n# 2、拷贝kafka软件以及kafka的配置\nENV VERSION=2.12-2.2.0\nADD ./kafka_$&#123;VERSION&#125;.tgz /\nADD ./server.properties /kafka_$&#123;VERSION&#125;/config/server.properties\n\n# 3、修改kafka的名称\nRUN mv /kafka_$&#123;VERSION&#125; /kafka\n\n# 4、启动脚本（修改kafka配置）\nADD ./entrypoint.sh /entrypoint.sh\n\n# 5、暴露kafka端口 9999是jmx的端口\nEXPOSE 9092 9999\n\n# 6、运行启动脚本\nCMD [&quot;/bin/bash&quot;,&quot;/entrypoint.sh&quot;]\n</code></pre>\n<h6 id=\"312-serverproperties\"><a class=\"anchor\" href=\"#312-serverproperties\">#</a> 3.1.2 server.properties</h6>\n<pre><code class=\"language-'\"># cat server.properties \n############################# Server Basics ############################# \n# broker的id，值为整数，且必须唯一，在一个集群中不能重复\nbroker.id=&#123;BROKER_ID&#125;\n\n############################# Socket Server Settings ############################# \n# kafka监听端口，默认9092\nlisteners=PLAINTEXT://&#123;LISTENERS&#125;:9092\n\n# 处理网络请求的线程数量，默认为3个\nnum.network.threads=3\n\n# 执行磁盘IO操作的线程数量，默认为8个 \nnum.io.threads=8\n\n# socket服务发送数据的缓冲区大小，默认100KB\nsocket.send.buffer.bytes=102400\n\n# socket服务接受数据的缓冲区大小，默认100KB\nsocket.receive.buffer.bytes=102400\n\n# socket服务所能接受的一个请求的最大大小，默认为100M\nsocket.request.max.bytes=104857600\n\n############################# Log Basics ############################# \n# kafka存储消息数据的目录\nlog.dirs=&#123;KAFKA_DATA_DIR&#125;\n\n# 每个topic默认的partition\nnum.partitions=1\n\n# 设置副本数量为3,当Leader的Replication故障，会进行故障自动转移。\ndefault.replication.factor=3\n\n# 在启动时恢复数据和关闭时刷新数据时每个数据目录的线程数量\nnum.recovery.threads.per.data.dir=1\n\n############################# Log Flush Policy ############################# \n# 消息刷新到磁盘中的消息条数阈值\nlog.flush.interval.messages=10000\n\n# 消息刷新到磁盘中的最大时间间隔,1s\nlog.flush.interval.ms=1000\n\n############################# Log Retention Policy ############################# \n# 日志保留小时数，超时会自动删除，默认为7天\nlog.retention.hours=168\n\n# 日志保留大小，超出大小会自动删除，默认为1G\n#log.retention.bytes=1073741824\n\n# 日志分片策略，单个日志文件的大小最大为1G，超出后则创建一个新的日志文件\nlog.segment.bytes=1073741824\n\n# 每隔多长时间检测数据是否达到删除条件,300s\nlog.retention.check.interval.ms=300000\n\n############################# Zookeeper ############################# \n# Zookeeper连接信息，如果是zookeeper集群，则以逗号隔开\nzookeeper.connect=&#123;ZOOK_SERVERS&#125;\n\n# 连接zookeeper的超时时间,6s\nzookeeper.connection.timeout.ms=6000\n</code></pre>\n<h6 id=\"313-entrypoint\"><a class=\"anchor\" href=\"#313-entrypoint\">#</a> 3.1.3 entrypoint</h6>\n<pre><code># cat entrypoint.sh \n# 变量\nKAFKA_DIR=/kafka\nKAFKA_CONF=/kafka/config/server.properties\n\n# 1、基于主机名 + 1 获取Broker_id  这个是用来标识集群节点 在整个集群中必须唯一\nBROKER_ID=$(( $(hostname | sed 's#.*-##g') + 1 ))\nLISTENERS=$(hostname -i)\n\n# 2、替换配置文件内容，后期ZK集群的地址通过ENV传递\nsed -i s@&#123;BROKER_ID&#125;@$&#123;BROKER_ID&#125;@g  $&#123;KAFKA_CONF&#125;\nsed -i s@&#123;LISTENERS&#125;@$&#123;LISTENERS&#125;@g  $&#123;KAFKA_CONF&#125;\nsed -i s@&#123;KAFKA_DATA_DIR&#125;@$&#123;KAFKA_DATA_DIR:-/data&#125;@g  $&#123;KAFKA_CONF&#125;\nsed -i s@&#123;ZOOK_SERVERS&#125;@$&#123;ZOOK_SERVERS&#125;@g  $&#123;KAFKA_CONF&#125;\n\n# 3、启动Kafka\ncd $&#123;KAFKA_DIR&#125;/bin\nsed -i '/export KAFKA_HEAP_OPTS/a export JMX_PORT=&quot;9999&quot;' kafka-server-start.sh\n./kafka-server-start.sh ../config/server.properties\n</code></pre>\n<h6 id=\"314-构建镜像并推送仓库\"><a class=\"anchor\" href=\"#314-构建镜像并推送仓库\">#</a> 3.1.4 构建镜像并推送仓库</h6>\n<pre><code># wget https://archive.apache.org/dist/kafka/2.2.0/kafka_2.12-2.2.0.tgz\n# docker build -t registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kafka:2.12.2 .\n# docker push registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kafka:2.12.2\n</code></pre>\n<h5 id=\"32-迁移kafka集群至k8s\"><a class=\"anchor\" href=\"#32-迁移kafka集群至k8s\">#</a> 3.2 迁移 Kafka 集群至 K8S</h5>\n<h6 id=\"321-kafka-headless\"><a class=\"anchor\" href=\"#321-kafka-headless\">#</a> 3.2.1 kafka-headless</h6>\n<pre><code># cat 01-kafka-headless.yaml \napiVersion: v1\nkind: Service\nmetadata:\n  name: kafka-svc\n  namespace: logging\nspec:\n  clusterIP: None\n  selector:\n    app: kafka\n  ports:\n  - name: client\n    port: 9092\n    targetPort: 9092\n  - name: jmx\n    port: 9999\n    targetPort: 9999\n</code></pre>\n<h6 id=\"322-kafka-sts\"><a class=\"anchor\" href=\"#322-kafka-sts\">#</a> 3.2.2 kafka-sts</h6>\n<pre><code># cat 02-kafka-sts.yaml \napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: kafka\n  namespace: logging\nspec:\n  serviceName: &quot;kafka-svc&quot;\n  replicas: 3\n  selector:\n    matchLabels:\n      app: kafka\n  template:\n    metadata:\n      labels:\n        app: kafka\n    spec:\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            - labelSelector:\n                matchExpressions:\n                - key: app\n                  operator: In\n                  values: [&quot;kafka&quot;]\n              topologyKey: &quot;kubernetes.io/hostname&quot;\n      imagePullSecrets:\n      - name: harbor-admin\n      containers:\n      - name: kafka\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kafka:2.12.2 \n        imagePullPolicy: Always\n        ports:\n        - name: client\n          containerPort: 9092\n        - name: jmxport\n          containerPort: 9999\n        env:\n        - name: ZOOK_SERVERS\n          value: &quot;zookeeper-0.zookeeper-svc:2181,zookeeper-1.zookeeper-svc:2181,zookeeper-2.zookeeper-svc:2181&quot;\n        readinessProbe:         # 就绪探针，不就绪则不介入流量\n          tcpSocket:\n            port: 9092\n          initialDelaySeconds: 5\n        livenessProbe:         # 存活探针。如果不存活则根据重启策略进行重启\n          tcpSocket:\n            port: 9092\n          initialDelaySeconds: 5\n        volumeMounts:\n        - name: data\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: data\n    spec:\n      accessModes: [&quot;ReadWriteMany&quot;]\n      storageClassName: &quot;nfs-storage&quot;\n      resources:\n        requests:\n          storage: 5Gi\n</code></pre>\n<h6 id=\"323-更新资源清单\"><a class=\"anchor\" href=\"#323-更新资源清单\">#</a> 3.2.3 更新资源清单</h6>\n<pre><code>[root@k8s-master01 02-kafka]# kubectl apply -f 01-kafka-headless.yaml \n[root@k8s-master01 02-kafka]# kubectl apply -f 02-kafka-sts.yaml\n[root@k8s-master01 02-kafka]# kubectl get pods -n logging \nNAME          READY   STATUS    RESTARTS       AGE\nkafka-0       1/1     Running   0              5m49s\nkafka-1       1/1     Running   0              4m43s\nkafka-2       1/1     Running   0              3m40s\n\n#查看kafka是否注册到zookeeper\n[root@k8s-master01 02-kafka]# kubectl exec -it zookeeper-0 -n logging -- /bin/bash\nroot@zookeeper-0:/# /zookeeper/bin/zkCli.sh \n[zk: localhost:2181(CONNECTED) 2] get /brokers/ids/1\n&#123;&quot;listener_security_protocol_map&quot;:&#123;&quot;PLAINTEXT&quot;:&quot;PLAINTEXT&quot;&#125;,&quot;endpoints&quot;:[&quot;PLAINTEXT://172.16.85.201:9092&quot;],&quot;jmx_port&quot;:9999,&quot;host&quot;:&quot;172.16.85.201&quot;,&quot;timestamp&quot;:&quot;1748162470218&quot;,&quot;port&quot;:9092,&quot;version&quot;:4&#125;\n[zk: localhost:2181(CONNECTED) 3] get /brokers/ids/2\n&#123;&quot;listener_security_protocol_map&quot;:&#123;&quot;PLAINTEXT&quot;:&quot;PLAINTEXT&quot;&#125;,&quot;endpoints&quot;:[&quot;PLAINTEXT://172.16.58.205:9092&quot;],&quot;jmx_port&quot;:9999,&quot;host&quot;:&quot;172.16.58.205&quot;,&quot;timestamp&quot;:&quot;1748162532658&quot;,&quot;port&quot;:9092,&quot;version&quot;:4&#125;\n[zk: localhost:2181(CONNECTED) 4] get /brokers/ids/3\n&#123;&quot;listener_security_protocol_map&quot;:&#123;&quot;PLAINTEXT&quot;:&quot;PLAINTEXT&quot;&#125;,&quot;endpoints&quot;:[&quot;PLAINTEXT://172.16.195.1:9092&quot;],&quot;jmx_port&quot;:9999,&quot;host&quot;:&quot;172.16.195.1&quot;,&quot;timestamp&quot;:&quot;1748162649250&quot;,&quot;port&quot;:9092,&quot;version&quot;:4&#125;\n</code></pre>\n<h6 id=\"324-检查kafka集群\"><a class=\"anchor\" href=\"#324-检查kafka集群\">#</a> 3.2.4 检查 Kafka 集群</h6>\n<pre><code>1.创建一个topic\nroot@kafka-0:/# /kafka/bin/kafka-topics.sh --create --zookeeper zookeeper-0.zookeeper-svc:2181,zookeeper-1.zookeeper-svc:2181,zookeeper-2.zookeeper-svc:2181 --partitions 1 --replication-factor 3 --topic oldxu\n\n2.模拟消息发布\nroot@kafka-1:/# /kafka/bin/kafka-console-producer.sh --broker-list kafka-0.kafka-svc:9092,kafka-1.kafka-svc:9092,kafka-2.kafka-svc:9092 --topic oldxu\n&gt;hello kubernetes\n&gt;hello world\n\n3.模拟消息订阅\nroot@kafka-2:/# /kafka/bin/kafka-console-consumer.sh  --bootstrap-server kafka-0.kafka-svc:9092,kafka-1.kafka-svc:9092,kafka-2.kafka-svc:9092 --topic oldxu --from-beginning\nhello kubernetes\nhello world\n</code></pre>\n<h4 id=\"4-交付efak至k8s\"><a class=\"anchor\" href=\"#4-交付efak至k8s\">#</a> 4. 交付 efak 至 K8S</h4>\n<h5 id=\"41-制作efak镜像\"><a class=\"anchor\" href=\"#41-制作efak镜像\">#</a> 4.1 制作 efak 镜像</h5>\n<h6 id=\"411-dockerfile\"><a class=\"anchor\" href=\"#411-dockerfile\">#</a> 4.1.1 Dockerfile</h6>\n<pre><code>[root@manager 03-efak]# cat Dockerfile \nFROM openjdk:8\n\n# 1、调整时区\nRUN /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; \\\n    echo 'Asia/Shanghai' &gt; /etc/timezone\n\n# 2、拷贝kafka软件以及kafka的配置\nENV VERSION=3.0.1\nADD ./efak-web-$&#123;VERSION&#125;-bin.tar.gz /\nADD ./system-config.properties /efak-web-$&#123;VERSION&#125;/conf/system-config.properties\n\n# 3、修改efak的名称\nRUN mv /efak-web-$&#123;VERSION&#125; /efak\n\n# 4、环境变量\nENV KE_HOME=/efak\nENV PATH=$PATH:$KE_HOME/bin\n\n# 5、启动脚本（修改kafka配置）\nADD ./entrypoint.sh /entrypoint.sh\n\n# 6、暴露kafka端口 9999是jmx的端口\nEXPOSE 8048\n\n# 7、运行启动脚本\nCMD [&quot;/bin/bash&quot;,&quot;/entrypoint.sh&quot;]\n</code></pre>\n<h6 id=\"412-system-config\"><a class=\"anchor\" href=\"#412-system-config\">#</a> 4.1.2 system-config</h6>\n<pre><code># cat system-config.properties \n######################################\n# 填写 zookeeper集群列表\n######################################\nefak.zk.cluster.alias=cluster1\ncluster1.zk.list=&#123;ZOOK_SERVERS&#125;\n\n######################################\n# broker 最大规模数量\n######################################\ncluster1.efak.broker.size=20\n\n######################################\n# zk 客户端线程数\n######################################\nkafka.zk.limit.size=32\n\n######################################\n# EFAK webui 端口\n######################################\nefak.webui.port=8048\n\n######################################\n# kafka offset storage\n######################################\ncluster1.efak.offset.storage=kafka\n\n######################################\n# kafka jmx uri\n######################################\ncluster1.efak.jmx.uri=service:jmx:rmi:///jndi/rmi://%s/jmxrmi\n\n######################################\n# kafka metrics 指标，默认存储15天\n######################################\nefak.metrics.charts=true\nefak.metrics.retain=15\n\n######################################\n# kafka sql topic records max\n######################################\nefak.sql.topic.records.max=5000\nefak.sql.topic.preview.records.max=10\n\n######################################\n# delete kafka topic token\n######################################\nefak.topic.token=keadmin\n\n######################################\n# kafka sqlite 数据库地址（需要修改存储路径）\n######################################\nefak.driver=org.sqlite.JDBC\nefak.url=jdbc:sqlite:&#123;EFAK_DATA_DIR&#125;/db/ke.db\nefak.username=root\nefak.password=www.kafka-eagle.org\n</code></pre>\n<h6 id=\"413-entrypoint\"><a class=\"anchor\" href=\"#413-entrypoint\">#</a> 4.1.3 entrypoint</h6>\n<pre><code># cat entrypoint.sh \n# 1、变量\nEFAK_DIR=/efak\nEFAK_CONF=/efak/conf/system-config.properties\n\n# 2、替换配置文件内容，后期ZK集群的地址通过ENV传递\nsed -i s@&#123;EFAK_DATA_DIR&#125;@$&#123;EFAK_DIR&#125;@g  $&#123;EFAK_CONF&#125;\nsed -i s@&#123;ZOOK_SERVERS&#125;@$&#123;ZOOK_SERVERS&#125;@g  $&#123;EFAK_CONF&#125;\n\n# 3、启动efka\n$&#123;EFAK_DIR&#125;/bin/ke.sh start\ntail -f $&#123;EFAK_DIR&#125;/logs/ke_console.out\n</code></pre>\n<h6 id=\"414-构建镜像并推送仓库\"><a class=\"anchor\" href=\"#414-构建镜像并推送仓库\">#</a> 4.1.4 构建镜像并推送仓库</h6>\n<pre><code># wget https://github.com/smartloli/kafka-eagle-bin/archive/v3.0.1.tar.gz\n# docker build -t registry.cn-hangzhou.aliyuncs.com/kubernetes_public/efak:3.0 .\n# docker push registry.cn-hangzhou.aliyuncs.com/kubernetes_public/efak:3.0\n</code></pre>\n<h5 id=\"42-迁移efak至k8s\"><a class=\"anchor\" href=\"#42-迁移efak至k8s\">#</a> 4.2 迁移 efak 至 K8S</h5>\n<h6 id=\"421-efak-deploy\"><a class=\"anchor\" href=\"#421-efak-deploy\">#</a> 4.2.1 efak-deploy</h6>\n<pre><code># cat 01-efak-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: efak\n  namespace: logging\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: efak\n  template:\n    metadata:\n      labels:\n        app: efak\n    spec:\n      imagePullSecrets:\n      - name: harbor-admin\n      containers:\n      - name: efak\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/efak:3.0 \n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8048\n        env:\n        - name: ZOOK_SERVERS\n          value: &quot;zookeeper-0.zookeeper-svc:2181,zookeeper-1.zookeeper-svc:2181,zookeeper-2.zookeeper-svc:2181&quot;\n</code></pre>\n<h6 id=\"422-efak-service\"><a class=\"anchor\" href=\"#422-efak-service\">#</a> 4.2.2 efak-service</h6>\n<pre><code># cat 02-efak-service.yaml \napiVersion: v1\nkind: Service\nmetadata:\n  name: efak-svc\n  namespace: logging\nspec:\n  selector:\n    app: efak\n  ports:\n  - port: 8048\n    targetPort: 8048\n</code></pre>\n<h6 id=\"423-efak-ingress\"><a class=\"anchor\" href=\"#423-efak-ingress\">#</a> 4.2.3 efak-ingress</h6>\n<pre><code># cat 03-efak-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: efak-ingress\n  namespace: logging\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: &quot;efak.hmallleasing.com&quot;\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: efak-svc\n            port: \n              number: 8048\n</code></pre>\n<h6 id=\"424-更新资源清单\"><a class=\"anchor\" href=\"#424-更新资源清单\">#</a> 4.2.4 更新资源清单</h6>\n<pre><code>[root@k8s-master01 03-efak]# kubectl apply -f 01-efak-deploy.yaml \n[root@k8s-master01 03-efak]# kubectl apply -f 02-efak-service.yaml \n[root@k8s-master01 03-efak]# kubectl apply -f 03-efak-ingress.yaml \n</code></pre>\n<h6 id=\"425-访问efka\"><a class=\"anchor\" href=\"#425-访问efka\">#</a> 4.2.5 访问 efka</h6>\n<p>1、初始用户名密码 admin   123456</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/Nq16u4z.png\" alt=\"1.png\" /></p>\n<p>2、查看 Topics</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/9Bin9cr.png\" alt=\"2.png\" /></p>\n<p>3、查看 kafka 集群状态</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/U76YIck.png\" alt=\"3.png\" /></p>\n<p>4、查看 Zookeeper 集群状态</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/cY5LeWx.png\" alt=\"4.png\" /></p>\n<h4 id=\"5-交付elastic集群\"><a class=\"anchor\" href=\"#5-交付elastic集群\">#</a> 5. 交付 Elastic 集群</h4>\n<ul>\n<li>ES 集群是由多个节点组成的，通过 <a href=\"http://cluster.name\">cluster.name</a> 设置 ES 集群名称，同时用于区分其它的 ES 集群。</li>\n<li>每个节点通过 <a href=\"http://node.name\">node.name</a> 参数来设定所在集群的节点名称。</li>\n<li>节点使用 discovery.send_hosts 参数来设定集群节点的列表。</li>\n<li>集群在第一次启动时，需要初始化，同时需要指定参与选举的 master 节点 IP，或节点名称。</li>\n<li>每个节点可以通过 node.master:true 设定为 master 角色，通过 node.data:true 设定为 data 角色。</li>\n</ul>\n<pre><code>[root@k8s-master01 ~]# grep &quot;^[a-Z]&quot; /etc/elasticsearch/elasticsearch.yml\n# 集群名称cluster.name: my-oldxu\n# 节点名称node.name: node1\n# 数据存储路径path.data: /var/lib/elasticsearch\n# 日志存储路径path.logs: /var/log/elasticsearch\n# 监听在本地哪个地址上network.host: 10.0.0.100\n# 监听端口http.port: 9200\n# 集群主机列表discovery.seed_hosts: [&quot;ip1&quot;, &quot;ip2&quot;, &quot;ip3&quot;]\n# 仅第一次启动集群时进行选举（可以填写node.name的名称）cluster.initial_master_nodes: [&quot;node01&quot;, &quot;node02&quot;, &quot;node03&quot;]\n</code></pre>\n<h5 id=\"51-下载elastic镜像\"><a class=\"anchor\" href=\"#51-下载elastic镜像\">#</a> 5.1 下载 elastic 镜像</h5>\n<pre><code># docker pull elasticsearch:7.17.6\n# docker tag elasticsearch:7.17.6 registry.cn-hangzhou.aliyuncs.com/kubernetes_public/elasticsearch:7.17.6\n# docker push registry.cn-hangzhou.aliyuncs.com/kubernetes_public/elasticsearch:7.17.6\n</code></pre>\n<h5 id=\"52-交付es-service\"><a class=\"anchor\" href=\"#52-交付es-service\">#</a> 5.2 交付 ES-Service</h5>\n<p>创建 es-headlessService，为每个 ES Pod 设定固定的 DNS 名称，无论它是 Master 或是 Data，易或是 Coordinating</p>\n<pre><code># cat 01-es-svc.yaml \napiVersion: v1\nkind: Service\nmetadata:\n  name: es-svc\n  namespace: logging\nspec:\n  selector:\n    app: es\n  clusterIP: None\n  ports:\n  - name: cluster\n    port: 9200\n    targetPort: 9200\n  - name: transport\n    port: 9300\n    targetPort: 9300\n</code></pre>\n<h5 id=\"53-交付es-master节点\"><a class=\"anchor\" href=\"#53-交付es-master节点\">#</a> 5.3 交付 ES-Master 节点</h5>\n<ol>\n<li>\n<p>ES 无法使用 root 直接启动，需要授权数据目录 UID=1000，同时还需要持久化 /usr/share/elasticsearch/data ；</p>\n</li>\n<li>\n<p>ES 所有节点都需要设定 vm.max_map_count 内核参数以及 ulimit；</p>\n</li>\n<li>\n<p>ES 启动是通过 ENV 环境变量传参来完成的；</p>\n<ul>\n<li>\n<p>集群名称、节点名称、角色类型；</p>\n</li>\n<li>\n<p>discovery.seed_hosts 集群地址列表；</p>\n</li>\n<li>\n<p>cluster.initial_master_nodes 初始集群参与选举的 master 节点名称；</p>\n</li>\n</ul>\n</li>\n</ol>\n<pre><code># cat 02-es-master.yaml \napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: es-master\n  namespace: logging\nspec:\n  serviceName: &quot;es-svc&quot;\n  replicas: 3           # es-pod运行的实例\n  selector:             # 需要管理的ES-Pod标签\n    matchLabels:\n      app: es\n      role: master\n  template:\n    metadata:\n      labels:\n        app: es\n        role: master\n    spec:                       # 定义pod规范\n      imagePullSecrets:         # 镜像拉取使用的认证信息\n      - name: harbor-admin\n      affinity:                 # 设定pod反亲和\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values: [&quot;es&quot;]\n              - key: role\n                operator: In\n                values: [&quot;master&quot;]\n            topologyKey: &quot;kubernetes.io/hostname&quot;       # 每个节点就是一个位置\n      initContainers:           # 初始化容器设定\n      - name: fix-permissions\n        image: busybox\n        command: [&quot;sh&quot;,&quot;-c&quot;,&quot;chown -R 1000:1000 /usr/share/elasticsearch/data ; sysctl -w vm.max_map_count=262144; ulimit -n 65536&quot;]\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: data\n          mountPath: /usr/share/elasticsearch/data\n      containers:               # ES主容器\n      - name: es\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/elasticsearch:7.17.6 \n        resources:\n          limits:\n            cpu: 1000m\n            memory: 4096Mi\n          requests:\n            cpu: 300m\n            memory: 1024Mi\n        ports:\n        - name: cluster\n          containerPort: 9200\n        - name: transport\n          containerPort: 9300\n        volumeMounts:\n        - name: data\n          mountPath: /usr/share/elasticsearch/data\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n        - name: timezone\n          mountPath: /etc/timezone\n        env:\n        - name: ES_JAVA_OPTS\n          value: &quot;-Xms1g -Xmx1g&quot;\n        - name: cluster.name\n          value: es-cluster\n        - name: node.name\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: node.master\n          value: &quot;true&quot;\n        - name: node.data\n          value: &quot;false&quot;\n        - name: discovery.seed_hosts\n          value: &quot;es-master-0.es-svc,es-master-1.es-svc,es-master-2.es-svc&quot;\n        - name: cluster.initial_master_nodes\n          value: &quot;es-master-0,es-master-1,es-master-2&quot;\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n  volumeClaimTemplates: # 动态pvc\n  - metadata:\n      name: data\n    spec:\n      accessModes: [&quot;ReadWriteOnce&quot;]\n      storageClassName: &quot;nfs-storage&quot;\n      resources:\n        requests:\n          storage: 5Gi\n</code></pre>\n<pre><code>[root@k8s-master01 04-elasticsearch]# cat 03-es-data.yaml \napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: es-data\n  namespace: logging\nspec:\n  serviceName: &quot;es-svc&quot;\n  replicas: 2           # es-pod运行的实例\n  selector:             # 需要管理的ES-Pod标签\n    matchLabels:\n      app: es\n      role: data\n  template:\n    metadata:\n      labels:\n        app: es\n        role: data\n    spec:                       # 定义pod规范\n      imagePullSecrets:         # 镜像拉取使用的认证信息\n      - name: harbor-admin\n      affinity:                 # 设定pod反亲和\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values: [&quot;es&quot;]\n              - key: role\n                operator: In\n                values: [&quot;data&quot;]\n            topologyKey: &quot;kubernetes.io/hostname&quot;       # 每个节点就是一个位置\n      initContainers:           # 初始化容器设定\n      - name: fix-permissions\n        image: busybox\n        command: [&quot;sh&quot;,&quot;-c&quot;,&quot;chown -R 1000:1000 /usr/share/elasticsearch/data ; sysctl -w vm.max_map_count=262144; ulimit -n 65536&quot;]\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: data\n          mountPath: /usr/share/elasticsearch/data\n      containers:               # ES主容器\n      - name: es\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/elasticsearch:7.17.6 \n        resources:\n          limits:\n            cpu: 1000m\n            memory: 4096Mi\n          requests:\n            cpu: 300m\n            memory: 1024Mi\n        ports:\n        - name: cluster\n          containerPort: 9200\n        - name: transport\n          containerPort: 9300\n        volumeMounts:\n        - name: data\n          mountPath: /usr/share/elasticsearch/data\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n        - name: timezone\n          mountPath: /etc/timezone\n        env:\n        - name: ES_JAVA_OPTS\n          value: &quot;-Xms1g -Xmx1g&quot;\n        - name: cluster.name\n          value: es-cluster\n        - name: node.name\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: node.master\n          value: &quot;false&quot;\n        - name: node.data\n          value: &quot;true&quot;\n        - name: discovery.seed_hosts\n          value: &quot;es-master-0.es-svc,es-master-1.es-svc,es-master-2.es-svc&quot;\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n  volumeClaimTemplates: # 动态pvc\n  - metadata:\n      name: data\n    spec:\n      accessModes: [&quot;ReadWriteOnce&quot;]\n      storageClassName: &quot;nfs-storage&quot;\n      resources:\n        requests:\n          storage: 5Gi\n</code></pre>\n<h5 id=\"54-交付es-data节点\"><a class=\"anchor\" href=\"#54-交付es-data节点\">#</a> 5.4 交付 ES-Data 节点</h5>\n<ol>\n<li>\n<p>ES 无法使用 root 直接启动，需要授权数据目录 UID=1000，同时还需要持久化 /usr/share/elasticsearch/data</p>\n</li>\n<li>\n<p>ES 所有节点都需要设定 vm.max_map_count 内核参数以及 ulimit；</p>\n</li>\n<li>\n<p>ES 启动是通过 ENV 环境变量传参来完成的</p>\n<ul>\n<li>\n<p>集群名称、节点名称、角色类型</p>\n</li>\n<li>\n<p>discovery.seed_hosts 集群地址列表</p>\n</li>\n</ul>\n</li>\n</ol>\n<pre><code># cat 03-es-data.yaml \napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: es-data\n  namespace: logging\nspec:\n  serviceName: &quot;es-svc&quot;\n  replicas: 2           # es-pod运行的实例\n  selector:             # 需要管理的ES-Pod标签\n    matchLabels:\n      app: es\n      role: data\n  template:\n    metadata:\n      labels:\n        app: es\n        role: data\n    spec:                       # 定义pod规范\n      imagePullSecrets:         # 镜像拉取使用的认证信息\n      - name: harbor-admin\n      affinity:                 # 设定pod反亲和\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values: [&quot;es&quot;]\n              - key: role\n                operator: In\n                values: [&quot;data&quot;]\n            topologyKey: &quot;kubernetes.io/hostname&quot;       # 每个节点就是一个位置\n      initContainers:           # 初始化容器设定\n      - name: fix-permissions\n        image: busybox\n        command: [&quot;sh&quot;,&quot;-c&quot;,&quot;chown -R 1000:1000 /usr/share/elasticsearch/data ; sysctl -w vm.max_map_count=262144; ulimit -n 65536&quot;]\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: data\n          mountPath: /usr/share/elasticsearch/data\n      containers:               # ES主容器\n      - name: es\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/elasticsearch:7.17.6 \n        resources:\n          limits:\n            cpu: 1000m\n            memory: 4096Mi\n          requests:\n            cpu: 300m\n            memory: 1024Mi\n        ports:\n        - name: cluster\n          containerPort: 9200\n        - name: transport\n          containerPort: 9300\n        volumeMounts:\n        - name: data\n          mountPath: /usr/share/elasticsearch/data\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n        - name: timezone\n          mountPath: /etc/timezone\n        env:\n        - name: ES_JAVA_OPTS\n          value: &quot;-Xms1g -Xmx1g&quot;\n        - name: cluster.name\n          value: es-cluster\n        - name: node.name\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: node.master\n          value: &quot;false&quot;\n        - name: node.data\n          value: &quot;true&quot;\n        - name: discovery.seed_hosts\n          value: &quot;es-master-0.es-svc,es-master-1.es-svc,es-master-2.es-svc&quot;\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n  volumeClaimTemplates: # 动态pvc\n  - metadata:\n      name: data\n    spec:\n      accessModes: [&quot;ReadWriteOnce&quot;]\n      storageClassName: &quot;nfs-storage&quot;\n      resources:\n        requests:\n          storage: 5Gi\n</code></pre>\n<h5 id=\"55-更新资源清单\"><a class=\"anchor\" href=\"#55-更新资源清单\">#</a> 5.5 更新资源清单</h5>\n<pre><code>[root@k8s-master01 04-elasticsearch]# kubectl apply -f 01-es-svc.yaml \n[root@k8s-master01 04-elasticsearch]# kubectl apply -f 02-es-master.yaml \n[root@k8s-master01 04-elasticsearch]# kubectl apply -f 03-es-data.yaml \n</code></pre>\n<h5 id=\"56-验证es集群\"><a class=\"anchor\" href=\"#56-验证es集群\">#</a> 5.6 验证 ES 集群</h5>\n<pre><code>#1.解析headlessService获取对应ES集群任一节点的IP地址\n# dig @10.96.0.10 es-svc.logging.svc.cluster.local  +short\n172.16.58.229\n172.16.122.191\n172.16.195.21\n172.16.122.129\n172.16.32.164\n\n#2.通过curl访问ES，检查ES集群是否正常（如果仅交付Master，没有data节点，集群状态可能会Red，因为没有数据节点进行数据存储；）\n# curl -XGET &quot;http://172.16.122.129:9200/_cluster/health?pretty&quot;\n&#123;\n  &quot;cluster_name&quot; : &quot;es-cluster&quot;,\n  &quot;status&quot; : &quot;green&quot;,\n  &quot;timed_out&quot; : false,\n  &quot;number_of_nodes&quot; : 5,\n  &quot;number_of_data_nodes&quot; : 2,\n  &quot;active_primary_shards&quot; : 3,\n  &quot;active_shards&quot; : 6,\n  &quot;relocating_shards&quot; : 0,\n  &quot;initializing_shards&quot; : 0,\n  &quot;unassigned_shards&quot; : 0,\n  &quot;delayed_unassigned_shards&quot; : 0,\n  &quot;number_of_pending_tasks&quot; : 0,\n  &quot;number_of_in_flight_fetch&quot; : 0,\n  &quot;task_max_waiting_in_queue_millis&quot; : 0,\n  &quot;active_shards_percent_as_number&quot; : 100.0\n&#125;\n\n#3.查看ES各个节点详情\n# curl -XGET &quot;http://172.16.122.129:9200/_cat/nodes&quot;\n172.16.122.129 16 33 20 0.38 0.56 0.38 ilmr       - es-master-2\n172.16.58.229  66 33 22 0.64 0.66 0.44 ilmr       * es-master-1\n172.16.122.191 52 34 15 0.38 0.56 0.38 cdfhilrstw - es-data-0\n172.16.195.21  38 35 19 0.38 0.53 0.36 cdfhilrstw - es-data-1\n172.16.32.164  31 33 12 0.28 0.50 0.59 ilmr       - es-master-0\n</code></pre>\n<h4 id=\"6-交付kibana可视化\"><a class=\"anchor\" href=\"#6-交付kibana可视化\">#</a> 6. 交付 Kibana 可视化</h4>\n<h5 id=\"61-下载kibana镜像\"><a class=\"anchor\" href=\"#61-下载kibana镜像\">#</a> 6.1 下载 kibana 镜像</h5>\n<pre><code># docker pull kibana:7.17.6\n# docker tag kibana:7.17.6 registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kibana:7.17.6\n# docker push registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kibana:7.17.6\n</code></pre>\n<h5 id=\"62-kibana-deploy\"><a class=\"anchor\" href=\"#62-kibana-deploy\">#</a> 6.2 kibana-deploy</h5>\n<ol>\n<li>Kibana 需要连接 ES 集群，通过 ELASTICSEARCH_HOSTS 变量来传递 ES 集群地址</li>\n<li>kibana 通过 I18N_LOCALE 来传递语言环境</li>\n<li>Kibana 通过 SERVER_PUBLICBASEURL 来传递服务访问的公开地址</li>\n</ol>\n<pre><code># cat 01-kibana-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kibana\n  namespace: logging\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: kibana\n  template:\n    metadata:\n      labels:\n        app: kibana\n    spec:\n      imagePullSecrets:\n      - name: harbor-admin\n      containers:\n      - name: kibana\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kibana:7.17.6 \n        resources:\n          limits:\n            cpu: 1000m\n        ports:\n        - containerPort: 5601\n        env:\n        - name: ELASTICSEARCH_HOSTS\n          value: '[&quot;http://es-data-0.es-svc:9200&quot;,&quot;http://es-data-1.es-svc:9200&quot;]'\n        - name: I18N_LOCALE\n          value: &quot;zh-CN&quot;\n        - name: SERVER_PUBLICBASEURL\n          value: &quot;http://kibana.hmallleasing.com&quot;   #kibana访问UI\n        volumeMounts:\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n        - name: timezone\n          mountPath: /etc/timezone\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n</code></pre>\n<h5 id=\"63-kibana-svc\"><a class=\"anchor\" href=\"#63-kibana-svc\">#</a> 6.3 kibana-svc</h5>\n<pre><code># cat 02-kibana-svc.yaml \napiVersion: v1\nkind: Service\nmetadata:\n  name: kibana-svc\n  namespace: logging\nspec:\n  selector:\n    app: kibana\n  ports:\n  - name: web\n    port: 5601\n    targetPort: 5601\n</code></pre>\n<h5 id=\"64-kibana-ingress\"><a class=\"anchor\" href=\"#64-kibana-ingress\">#</a> 6.4 kibana-ingress</h5>\n<pre><code># cat 03-kibana-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: kibana-ingress\n  namespace: logging\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: &quot;kibana.hmallleasing.com&quot;\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: kibana-svc\n            port:\n              number: 5601\n</code></pre>\n<h5 id=\"65-更新资源清单\"><a class=\"anchor\" href=\"#65-更新资源清单\">#</a> 6.5 更新资源清单</h5>\n<pre><code>[root@k8s-master01 05-kibana]# kubectl apply -f 01-kibana-deploy.yaml \n[root@k8s-master01 05-kibana]# kubectl apply -f 02-kibana-svc.yaml \n[root@k8s-master01 05-kibana]# kubectl apply -f 03-kibana-ingress.yaml\n\n[root@k8s-master01 05-kibana]# kubectl get pods -n logging\nNAME                      READY   STATUS    RESTARTS   AGE\nefak-5cdc74bf59-nrhb4     1/1     Running   0          5h33m\nes-data-0                 1/1     Running   0          16m\nes-data-1                 1/1     Running   0          15m\nes-master-0               1/1     Running   0          17m\nes-master-1               1/1     Running   0          15m\nes-master-2               1/1     Running   0          12m\nkafka-0                   1/1     Running   0          5h39m\nkafka-1                   1/1     Running   0          5h39m\nkafka-2                   1/1     Running   0          5h38m\nkibana-5ccc46864b-ndzx9   1/1     Running   0          118s\nzookeeper-0               1/1     Running   0          5h42m\nzookeeper-1               1/1     Running   0          5h42m\nzookeeper-2               1/1     Running   0          5h41m\n</code></pre>\n<h5 id=\"66-访问kibana\"><a class=\"anchor\" href=\"#66-访问kibana\">#</a> 6.6 访问 kibana</h5>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/sUXTx1J.png\" alt=\"1.png\" /></p>\n",
            "tags": [
                "ELKStack"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/626047790.html",
            "url": "http://ixuyong.cn/posts/626047790.html",
            "title": "消费租赁系统微服务应用交付实践",
            "date_published": "2025-05-18T13:42:46.000Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"抱歉, 这个密码看着不太对, 请再试试。\" data-whm=\"抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容。\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"beca52c1bee433b27ebfbf02ccc69b138b53d009d5d726e8c18dbd38ebc1465e\">d025f0d3bd12bef569594886c37488b3f72b0f85e79b466e52addc3fcd9d37040620a284022a260bc0d468289c428dcafa0ac6c4a697d3934c92c6d7bfd61b9c1f7c31c16670a6e6ca5cf9e1ce4f165ac8e43337fd15f477bd9c15b624d5ea32d3906a4bd62d6666ea594ba018fa761a6c01d9b08ea2e6e5d8b6ad4a36fb328d657a755699aaaf800d1d1642a4ac2597ce769e23118253dc600426eefcf9ce22ad5e1d6e180859ba075cb96498745c9e69f116726d6e3105b58880bb686ef47885659aae01dc657d36600ff95172f2155effa6853de3cfb1703fe1435da03291ebda83675f420210d5579c173102dbb33f485dd107a59a62144c188ce02b81be4d70ae7f77cfc067aabaae5aa50fa1da07936ed476c50f49d84a62c28952e64227663aa6bab5e9fafd3c67f58a72d8192bfd99f01321f79636e77fcbe8dfcc1db46da5d623601df82d907111a8362ae534de2913d194c2d44c0ddd02474d32f5fc65f5d874a68f9816f490151b4c4a488479f501ee45194c44ea5fbd188eb97fb67935ae8cbfb986c038a8fd722a0295ab7bec6d1cf2bb68c873bd8c4dec9a8c150c7361573854427b5e132ec7e37822149126ddaf0768b693d14cf9c5a91de8085da2c31748ac401ace3d0003de1a7778ba7be09e2035daef471dad6bf82db806653b165bdfde3a1316b6c98d12b4c848c0f34755dfa75bbda60d41a30cd5fa217fd4678cfeaede5c07bd14424de90904e4a8ec5c1c6a34e1d79bcc1ee0ae790de49841a92baa0f17587fc5c450ee883e6f957e2e61a2d442240af91e6f619abbfbc497aa93e70f8571a1e4ed36c6e673a0ef485c2b5730c03711a593cc00cafedf98b3e0f5acf3b8735bf04e17a20bf3e971f18cca6994b889368333bba5a2122b191995f73da50582b89e1c523ce7f9eba2cb050bda648d65c8960aaba5abda07aca4ce7de18067b88e97b1c879d9eed8ed10a4a4978fbd6c248be9b30a98738123b0b334e4849ec15f1fd7ec12725d2d8d09a20f7f78f490a20fbf321da69c1453a1a5ea9e741e2c09ab66663bc0e1ee8ef799e1b6d86c59463df1123ab3ff40eabdb79012a147503b64dd4e655ab08b6bea8ff7fce97ed4e3d4fe0c28696e3b78161d9749cc78d337ab24f17086b9559532e7b06f54ad02ab6df375b2441818f3edefaf8fc90caf37eb1ced44c2e6aa7ae4e8c92f8a93914c57b616ed9d8e85743214b8e018d3ac2dfdc1f483b3633436171e8ac6cd7ae61b9671aa201d89e8de93a75d0994e6952b8461dc5cd8bf72d3662a4d71b8014f9420844504a225ed90998da5fe07d7b37a6041ee1cc1e5b80aad1691661c8b8e0aaab179d21434f691771064fe0b56317ba0d8a3889e100c311bc8eb5c176cdd0f25497df5823f24a5394abb7f477e657d0d84f5bb506f9b5a0ee79e3e1aa4a412e30a7ab56eeca0d4acbd2cb29d953355ced1e0f3577c19d0a8dc3d1ace05d9d7846d1e31a3d44d521262f841f8a4af20d954e77ae04b65b34601a88b503de5b61b74a51b19bbf923c12349c38b2c3e1e386dbcea33be1741b69f4cd1e37e67d4b04d42c4088d31808e0c8a1021915405e5169ded944eb66b85a6d2842c2b29911f4ec95ea412d1e612de26591ae5d419f87e53f74194e19ed66f5a2978ca8414768ce7d2c5bf95b2c69b01f739594d0e3040f56494238e680601371e2c394fc7a8cf4ed7ea0c2b146a6e3de1519b5d3c635e51143d8bd3025e7e3318502d0f08384e49a90d8aeb96c063507a5906960252cde0cb441bb3a90159794150e80fc487d235445d438d69eb2a9a20e2ee0a9ce2fbdb64e07de81b27f945c8da674cb3423af637c5a22e0a825aa68e6846f9fd5a54581ce55c8b7f5e5b153269aa17266e4c660ed9d434cb003da96161996e785b5a933dc9a0da21d2a495e6f71d2f84a9b3584105bd9badcfbad2291b0d746567cf94f88fcc8f94e909007cdb88ae4c0522f28f84865ed677034e03f68ae7100da7dfada2538d511195f33e5736f3380d1b41e114eb8370f9b443b022340400b136c0fd3bb1c36ab1aa47280d4231b57a15641809a301b5dbd4ec256e4b64b8a1b7838d1ca530676fcfa7d7770257c9a453d80a7a4ba0068ba6bfc87e7d890b6d8943c234d980d695b7bdbfc5c593cee44707717a6590bc612132959b7007baf7deb4d86b433b0c18c4f88b752421da0723ba67ce7deac506a049631c848e485813f5febd3b39833c8d683551f7e06f1f3abd5da401af333eedc0d3df666fa523f96ddfb1884cf91df8644424abe8009a6fd0063cc4711f3906c4d9f86f75ebc8904179c15fddebf5aa2bf1907b85661332c1c1176f1acf895d0ff1b883d7f116d7c9420a1e225b73f6d676e8463a2ef7dd5a338c84fe5c18dc3d358c3211c50625e857acf61362c10e8220d9398fc8e9876d4ec9046e5b86f6d17b5857975987dea340d8895b25df8586310249f4ccda42936fba352921fb15032ce9742f48f1975d4d48c085ad41fc2e990a26afb0e004ecdd17e1159e795144136b26295fd223d578ff5dfae1e72bcc2cff6cbe48c0d3e6825ee92197f800f5504192b3f882618009457c60f73d039e0ae5372bd4e9e7b9f6047249c0ce24d6274a01d92c87c28cfbcf658964a2ee6b141dd74e528ab169c386d41b192174c3a41cfcc2fbd322c023cf83a501e8031d4cab5069023a609cbb4267245f9f827ec640c9e70f824c3fbd911259c1db198b91de95e482f4d3caa9325e30ff68f043036228a346f32a6b8c21e7c8e1dd8173b59de5ad5596964baf5df4e3205e6df9ffc6f0a995612c3b1d4e0e4d4256265982d53d664b302236bb0292d42202f8486da2084b22b3fc92b6cc2eaea76c00633d126b5130397d58ac906e57794a5e754f4cc4ca23fbc0b12051870a0cf382558fcbaadd622bb32e2fc161c62a25c301b9128da3d9e266185943eeba4553f96f9ab27f5ae063e84f4882f3187f0335fd266db8db01bb4b7b84e48d4aee5397be870f1f296d88808155b885264145d7aa770a02b958cf73f13cab006891afa745e30302f00f0c4add591a4381d32aab558abd2b831f36e764246a7ccbc34902095f81125c166c87f10b5ae5d43869d98259e04d7712f66d8e11ecf20f6214b8afe18251808a9db56c40685c5b06d80573a0810acf9162324338b92db9e5390a6351d35b19f99a5aa5b71e2f5fea9805afdf012c2fac1f6a5e1f9c7df94c9556cb852b7b157abaf78d64e9785d1fad8ba49b3211bc822fdd66a65143af2cc458de3959f6ac04a64a0f4b4962594714b9e18f68d5cd3eea6e85c91ccba266436d6fa68947bda92d505d7f3feabd40d26d2ebe6f17025c6f444c022f43a63b0049a897f1788c71a8a456b7a0fe345699be404ffed39be69a1cb860d58af9be53e0ab8bad660214023bf4abb14d031f258359f4fa0655c0da6c4fa3331851160f60961be84a5c618cdd71eca7ab750ad855549b80de803b4b947843c24eae9e0c22103af5b5c9af7ea99131745e56ba2e80ed092a0a08989bc2e5da0f8f9ffa3c1092fb6bf808be7fcd19e9064801af5c5c4be5c68e76f15f89fb0e1194bb4877576dab271d25a0ee28f8f76609448b7c576b5564b91ac29fbf01c2543005a2e5b029efa521ec0701c280c318af69d9684e42d6e5d07c835638a9464251d79b774b7961644eac850b68ab23f00f9172c4b76970ba1029bdd81d971422091b91f4c3dedc0a23777f01816b5a1b1139b3dc1eedf9b27d91e6ef126622fce89a3e1e94c070d2636d31a43ae2a34ef975660ab3f78af51cacc5feba8d82596e4225623f138c6d5709d3d0611c0a4ef3b2852b8faf33aeb842b16a2e0a7fefc4c488a13e04b90a16b04fe34b2feb44492f0746cddc7899a6bdb502bdc8f6d87a597584e8132144c4789cad6e7c018c21ee50d01e20cafab83a545df1e608c4afb5ebad3575141e281a4f0760450a5ef61586d63262988b9de25ae49d0f0d4a8f76d2f79f2cc33eb8d826fe7762e698c44ef9cdd1667eed25bc1ca28302f89bc6474fa8eb9d817defc5789ebfc60e6dd8f85a7080f2ffacc4ccb5df148b19afeec91ae6c4bc62b65372cdfe8787915f2a1007ddcfa6845def04ec0add480177b2daddc36b040cc3f2a5657e5c6e131863b1c7c0c4a794de5a65be9c8cef72e22b9ea796c3f1331aa174e6a8b587b1a2d94ae622258f571c40b9dbe07f40cba52622f420505a659aed07dff8cabdcfbd1ed5383b538a049dbc8bfc1787dcd9b0b855f73bab1701faad05b70cd50a9219520e2909f373e6d39493eb13a0486bd0618f13d24ef042a0b75a4eef0ae4b39cad41f6e45c885e5ba95ec8209c07364b7a8ac7a6fdd93b2cd5890e938b8338357350d6191deec876c1ef7026e3d34dca906180b6d2e6e15d6d4642ea4cf9ad063ff1beef200faa7dba172ce9380c95f2ee49d7682e0fc3e19f94c10168e86599f46feacf7be1c35c89f44a55ef134f4e4d056dbde02f35ce67127fc770cad0236125cc90f7c706acb5e053580cdfa871c4289c4541b3e181b66b23c99c2c4d5f9e08ebce3d4a40589890b94880cafbadc57173538df6f8ca7c9eb9c2ca1995458776db0a360ebff5b111067f39dfd8ce0db70fcc7c83850733b72216614ed47e39f16dd54802ba63a174f7977e55309d858cb949359afd14a6d579aa54843b1b1e50afe639ba9925ee2af5cc4a23868c9e391144b2b90d5c706ea0994e6e57451d4a6566668cfcfb247916245c61137a6d62ea41e72022cda4f0c2e0bf1f57bf0ff204b24e9652dfb6fbeee995ca36ec66bd6b9c6fc13dfae6fe60eddf89a6e3fdd06b6ca79d55e1aa385494eee3cf14ae51ecd73a8c3c00bb4af00a605434c07f1d93e20829b2879eb8978cf4f5697ec071bb28fe13768c31a86db8fa7ef50852f8436172a7f56558d22e9737246a217e63b808b4b26a012b3757086e4e78049ecb2ed4e5bb0814a9cfda9e454eb0fbc456cafb4c345d2c1726160802f28c456272b9a9cb4a2a1ddb850f2f1084c9297bf15c7dc2e454ae32a0cbdea14ddbe1133e1b9e302f7adeb64ee8bcb21ef75a31fd471cf606d150436a28ba55ea7718800ccbbb21e36c1fdacdd667dd041f2eb2cc64cbdbe43ec47f33af378d374bb2814ea79422f9579a09a9747701a6298aecdab5d787099e4317c0e521155831757690ff394762cc3fa336d457f29d2c53014eb11ebe36bf3185d33d71d585020c7b74bdd4960f24fd8718fbc317c4ee28bb914d87354a34daf46fe1da33fa70b5103a256be638ed6bf8807ea39fe50b976c4984d6f4f4e4fed4103504aae416553b5fa3cf0bd32a5b77bca945e3139250b66b769cf56f4bc3c8e11e35bb368b20b0fd4b520ff82814762b38494ebcd7270c4d6910c30d5a7f8517d1fa168d6883b80b6c12039e9e19fb50f46817cfe477f9152f6f88ce37de56612f054dcfd21c66c654e21a937b571bef601e11ce7dba2fa768bf7ed58cd7f8d37f6ac90d0f6a55b4e01b45bbb371b17010df24344f7da95c5bca960e80cbe3c24a6fc87066fa6dabfcf0657eda5d229f82580232cbe00d1046dbe070e15f4dbae2fb68b5b4dc5c9671eb2d06ab9d822f45a8324bf562c491f0b11b7452da064f7c2e69902023a4f7121447124480ddb7d6cee4d79da81701b37ba5e831cfb395903cbb07ac8df9376225986871376131073b285ddf3c5d98e669f5f618e2d8e4d9d3e687a7d51d9e0fa8483adf9531364344f64e0e514814584cfced561a233510c9a7d46f8d7bf407774dc06dd792431309fa663635a3f70795d5d3dad6dcf0c00cb91984058535389776259326168cb8276ab4b74307398e2a3a62e0efe61fae5746d91756919208c0f7715999806efc4ab6743be84712fd75a9aa0c3924c6f8e17051166dc6418eb3847c622de2c28e90b00ab66763b2a222e9e533333862267f9d6e1c854f0851878d8711c5bb593400cf8f48379b451bbf1512ae174f4e293a7423d09a73b4c4cbc54c6b0107fac16ae2bcf828f8d97047c3ccf4806ba286810d13cbd3783cdec4ed370fc70fa00316e90567dab8a55c0adc1fcf4d089509cd9d0b89dc7ade66078fe78e22f0f53f04013d477fa11fcbbb9c11688775308809772af7ca20d622c3d00dac67577d3a6c5220f1483eb7f61cc40c5b5075ebd18fb8aeafedb7cfe82423be1b9bcc193c9e25bbff0d495d77e8905925e52ef341a1b94dc78b178b937eb8f2c0a7f5936a5ea4182b26a94ffc6383f5d71fd54607af48c10c1d9ca0bf6c389a3c0e868a17b03840793f552a1c38ddc56d38631dfafadbeb3363adcd44b3dbad5ae475cdefabc5890e537ac011889f9ce7592016c09f1fa12229bf6b8f2a0bd2a123a582696e34de46b11c9891820f29e22098ed6c033e7233009a6266559c62c905baa82b5138efeb7accd35d92a77b29f52274b92362a2635004caaa6d50e852f84892c36bca0a851f7aea6fb39a77d0a66aa3587c0b6bb828036eea513ad31a348281937a7c12951960147206287f885534dfb1356e4130d3f0e3052ba1ed439cef9f935fd9ea5d5bd2e417b036d123d81247c7f4fbf6b7e3d593e2cd378ea5587c4cb2d907c8c1ba59f7a616334f293767ca9117b04c45bab9fe21c97b5fa6066bd5f7d50b61f2ac476a475b6d451ff203ca98440079be817503912839c8da6375ec6283a865f1b7ad769b987c2353afce22266fbf9b0b03a760e1245880d03910c290a0cce8b7e1b7c6bf99be6a9df452c167bb33dcda617113f4167dbb56a26498d5b1a193b344ba602a65f96ec6eb670745beb19cb2d149e0305746c9e8e5500cb5ae67cf7cef710216dc21d06f0a14941dca07a8a79b52f3f861baec4f82d6ce17ff5d33a13a5d29397c606b8b6d23ecb4fa91a4f6d88069e9c155afff7a72428a5ce35c1b93d664d4e9956264cd84c2ce35edf955ff3429b1f2b6e539dda7adf32307e159ed5c68c6459883d4ac9f45f1d4c9139c67d1325b046ff6087c08c8366d705344b98438961e394106a45cce1259a2e33696e9c7f1ff670eb7192a4991c9e5d378bcb5a2cd68d544d4d8919b1703899fa81acfec82bdbe9d318f901ef97eef15fbf2815e2f2707d526aa5212371744474269a11e6e3346b2367d58162e9e8b3303e4447b611a9e66c265166ad3a7ae9b91ab4364468bcf11f91b3a59b5ec549ee2f3b977708ca77c31fcb6714b0e31a5e64bd2a6b3b2205df5e4a5292897b4244f94fa60da3f5bd6a3945351df1e8cf769d46a97189589f5f8f3269d7a5afbfaa0d1e30fc546572044fc8584067556063cc506adaefb8c22ba57c569deabc72e2d512eea1999ac301f94eb5f8ea662d490ce0be59efa36b1bebf113184fec81778af9586207ebc5e4c674627524a1a3ef04baf8802ae56ba0418373f7125be641d8ebb874c53ebfd3116c1ac9ffafcefd8a79c1d047167587b592b1cfeaf2f91b1e796db9440eedef165bd9d3dcfe3e3abff6c9b73618831c80f39350c8a73f7e8625857cada78067e4fb14d5b007cf565c83341e375712717edb2faaf9b8d107483fe0519d878a22e0a9edb6a9cae4d3895dbcd89b471510ff5283b4d3b291b5aa59e5bc07af735cea255e153755a8fed534a1ce22a230c37195d1177d3ae94e21e7c0ec354cf0b9405381b22e7b359e6eae999d5ee861f1a4d4b4f297a774abff8a64829e9c7ab57e6e5d94b5124adb22a35e4198f9d442e76c92db2e534dfa8f494977128344ce85ab142c296901aaa82e57f175568e77f3ec931f1c3295e62e20a6536192d013742daec0f3ee5aeff34657087ae55294a25de175b9ea057aaa22a279b8863198063e58d5a69c77e86cbb2c6f3cb2cc9ca265d5bc3cfac78a457b45fe3d73c81533b687477894b3b129c5972c057b1eedaca9870e466739f84395a990f0798983d901fe360d0994e05e776cadfae18669c5bfd7df1b9e635d6426663e640e5d2e43a5b5afab181c65b9d1d1fce0ffd331f1f0e237ed52484aa1920b904e1fa7e8bc0d1790bec0178079819800c0979169a08d5e8720da7f7c95aaee2e2106fa42a0a1e0e8db907e9a56ade9fc13c72e05129e9c254fdd78cd39f295b3b14645424b5231f786b3c4a17da9864f0a4e74355e06510d1bc2c55db4d96a01595d861b7225ce288f595d513358dd2125359042a479206cc2cc62898e62a43f2ee36f427d437a28821761bd5a62e65a1d8c054bf3695bbdf6e4653be4129b918f96acef487b059ad8f92ad99d26f24ccfc86381ecf5d9dd818391da5b3af3e95a2a77236ed341f1ef3e159aca0cbeee7e619d074351ff183e85073f180a4f65668e1eb82b179b8541c3bd75ca94db15d7e024104b44f3707906d314585b0f38cf3235c3d938eda281b8fdc2cef736d118a51cac92b19b73b305606a2d3b2c0718a144df3c52214e41def07438d4d11d65482d2341b21ba112c436f3d548512d7ed77f190cf6af1b1e93ecf844eb8d60775bccb7e3c4a34ceb67e1f0917d3febd703dd15187e1c4a11a2e25b0154e52a342a3afb49b2d0dc848732a29da1f09983805527c36b0a1e9c913420f0b116452c071e5f4d118120027cd6ca545c2fcf82b5ed346e5b0784e6b3257f065ba5e9a1ccdddfcc7fe0c3fe4cc3538738e5d07edbec29b2d79a4b571e7d7ec2ef7132a50f1e17b7ff06694c74dc56bc7a6496631e7071ea9e844267bc4fcf09fb4291a370e71db9b90f177a2646f1de9103b5c7dca9f5ec8c758c173747867ad504f124e453aab3bab9998b302b84c53296904ab7d0dd7d2029a3b27f0347dafbbafff45388a9717fd5202925610e71aa036e2db7de86e59700395d82d10d29d0e8b378389130ccd00b02f3b34ecf36a015ee4fbaf919acfcf3902a9ec9562fa2d2d05af0d72deba5418dc9ab0597f7bdb4be7f16d7c52ed30c0593a7fd1ba5d124982225d6197a25f0402e1f5ab973aabd72051b5c397e46a4f00458772d93bd0a123df5b138cfa292b70f1fdfc624dd435ef3c155d7cae8dec30e1d4eb4a238d0a29fdc89a9cfd2f77b2baaef6a6ebb98001178da24c4e7bca82f03b2143d693313a4d8644a9e28ba746f9116584b7d87bc3845bcd1e11393e8deebeb10092c510c5ebab39469778e76587292948ef542d859fc2c46caee777835595a0652953b11f48b592d828e64ccaa839c89ff58b12c49c84078241ba7b132443e056f92505b7e244dfd2817b2432490e862f861a4b360b84ac95c38ce201936f93bb6f5b048b395d6c8a1b67957c2b0604619a1e8226c31edf1295a187ea64bb57794edbf4983d02abce140e5d9504e2400fb7264d13d8b1bc2af0d8625a7cfe29ddd18ade9c9d46aed0232d63092f7f29fb1f73b026f2765ddbbedf7ebb6e3e43922126c07c52bed5d74eeb1d69980a46e98b1e8c5d23058652ddd01be61f5359ba31290c198fb35f4666b1f130c1c42bf36f5d818468ee2e0b876aadf49c591da6ecda5578463ccdf829d9304465e8a19a9651efce185448e936093098a17cc6ba0488271000b73e8b3d0180ed9df0ba0f32175c30c28719e7315d9acedf79f497a63ab705dfd34d8bf194e98b5f34f382adec22d7d67cc0320be2233b5617096703a394804d2728bef7bbeb85ff80ba67f2f9249d7cc87e141b79dfb69affef64fd0f1fbce3b21a23d588a5e640360312a7ce90f725417e42eb96807074b75deafd965076efeea73c235bd6c00bf74b59f0b78b1427e79535633685c4bdb536cbb0781b97cbe7d376dbf8d07f0b2e0b590d29a790ddc3e87019035e28fe673e7bfa3cb99f9be1d61fcb17f014d6e6acd49544d443e8456e87ee91bbfe3b07aaabb400be072f084d3b2187ed36e86e04cc9246f96b8d4d0bbf5461551fc3d2cbd63ad0320828b6aa39681b653d8f89750dcd219b78951a3e46902cfc1501a39d5e23e593752eb0a3bf9d9665507acaaab3debbc614fd7adcce1fe10fbefe622561eec974b970b3628b4860102b5aa3a9685ae349d143909277cbd7ab3e1330e39aca23ce9a786dd8c1b9604d72dd0c4281951d41f25c97c5d3601de0b01e255d29dfa8a4d0e67a1da278c3c8ea2fbabb4b890f8a44d6b91bf436eaf602bea95515bd1c1bd8d51e028cafac94f42fba8cb46552c4904ff81b1886d37c1331c36a1cf9c4db0ecb1a769fbda6988c7c682ac89458f0f1e90e671ebfc4e3fdc0e69c3c4c518902037e21a6d72fcc15edf9756c19ac558be21fcc3ad4c51073a50b26c5915162854b59f9665e01800ca302a33192897566c777bc1e988390e926bffeb3ee347155405c1a4f3b04a44e64797d61c4f674760f5094f23f35e77b6c24bade29f4df3e6ab9b0813a89500a52983f540d89c9c120a289a61af724fe7ed434e0890b0d956c9ab28f38d685def9b30a89beedf0c02b8a94523111658856821f800317de09d5e0c997e107c3c12ff49f4a8643953694fe6611556c8debd208a496b8b1f03697ebeb766e6a173999b23385b74db0465161c04e9b989f8c4a96c26839f0b9a8942b6ed085089d4fe2f61cc911ec9d118f2efd1bb170c72791e805e7ecf102823d8d16f4529e96ed486a2d9b4531cb7c62cbb0426092723ccf57c9d823626b34d310ff608e726916a4b0e1149481f6f534da5abb25ef64e68309ffad795383fafc3b56c5baed3103d90d66ab25cc460fbcb60aadf0f194f02511882a05d74d5202b4cfb9d860889f23469da2941f9b45c7480dcedf5559e76c8ffc6ad47b3776883e1ecfd27472914ad725f8a7ba66d3af54405e66b54166445ba0bdfde9b1108f27973bba04a7ef5751137a59b4b4b17b2359f3b572cb460c2c237fea05d3be0acc1c2a77ba838523899eec8bbe7c5d634349a35dfe70de729eca1091c37bebe2b98c44c621499a90fe33ba14f1cfbfa3fc0824de068862d883833b3024fdd4cfc2b8c5b8541ebf34fc5b2eae6c52c612ffcef520dfc2ba498924d06f5d65208ffaf69652ff08260361b8764549dc88e2d5365ee4f15c3d014abd4b983cdb33b485d11cf0ed7fa1bc036f0337458f86a11f2c5a4e23c346e4d3bb67614ee991eac473b7be3d6b2e669c8a18dcfc88c43aad5fd1101bc2f232735ba371631db3a24484113d022b22dcd730070e0c68027797a94c4d77b3277362cc8c850c6051b1848219f605076db6ac6f5a855f17f5d242d1e6508c34baa62f2cfa1f0743c4026e02eed4ba046b83381e05a45d88f12d8d29ed1f4b33dd14e883b39ec93a32d0997ed1d15a423da5be2c43b1df59806d081a9463d071a0b6bb7f74b7be687180b727931d7998da7750de8e269a9469ff26a0d3838384479d370cef5c700c8020c6910c58ac570f247b1aa272101f9dae14b81dc59d3dde383fe4e0ea52a08ac0e3d0e8daa6a05814c05b9fa6585c289b5a74bd8059ebcad811a1490aae1910ed9561b27f11ae469198c0506129243aba9527902637d1a7ed3e6727a4083d98d182ae3928dcb36ebff12c5058a0bac889ba0175d1e0f81ec09085e7f5f2e3659e25d8d868b1d6984da2dbd382d78b0bf9c1a50571a059e271b71cc3c5a24d61feee4948d1f7884a3c1fc24c14cbda96379149baf22e2bdb566a56ff62791d25b866993a38079f8146f02ac2d216f5a4e920cdc93b952694c5406a99d4770fc70d0df921fc75062b6cd0471ff8db18bcab58aedbcc185ddb0375b54ee2816d7cc7c9c447046e2b666c16a9f0500deb32a4e8aaa073eec7f5679332d0fd889105bf82f35e8d6b2ade0c28e62e66ebf165534a4798524748a1c04efefd2c0c60344def6a7e86b4e9529606197ef0f1770257205eb5909288edcbcce966e041354da53cf3fc14bde91bf13e38e9cd4b966d4fcf9f375c8bf5910318069ab16f5060b7749ce613b0632ff1ede93bec8b16044a54d7bb8e88ca3ac5bafbf84de327776028b5c660786574b87320efb3a366f11a850d5444663431c2747cbf71df24a2b5c09f7360d5cb842c675f82fab22a97ae68739f2551d747512b30325b9fe76d2a714caae9d1eee1fc775875968296410bd791ae0fedc2b35595ab9f07ea104de702968d36b6f18a1c20dcfe373ed3752ff806e7cf414f7a9892d9b2492d0164b9e9bc070f83fccd966d44f7a619f745336d32532dd461876936699b45f1d045eeed5ce6ce6d7162394f77fc0869365aec6af6e20b3faf105a16f071711232fbd09af498e69f9d2714da9e77a68f5ef0b8ab80b0680e6dca065f0bb93f485b895c74a837c69ae32dd9c30d296af07bdb52ecd8c5791a7cb6c0c46faf270200a286a187d4599c291594ed913a28d138977a5c8d838f98f21402e2362158b5b7d054b85f36c6cad966b23e633b826504ce7a9f8e7809568d85aa332f798a9ebae09a2064d69a6d777924178f855ea4ce8fe0d56708c68617fe6ab03d71d38fbca9d75ed68de677e7817ab072d7f50fb50a84e252080ee780f148c378a258fa7fa402e1ed4d4638787a45127ede2da11af305faca4fef5e3a5abc6cb8798c0b61e1b69a93900ad1a2f153ec91840aff61b8ae99de31ae3b3e8b6b0f24e7e72ae8a65df9bd94960bc006a0f8355beeb6d2fc103be10ddfb430724c77d65267e2496bd6cb18a18212e3cda56123ffb2044ff44ed316186ef3ddf48da435354957cebed70f3de8f69fb64d7812db69db9e25009141808f4bbf37c81783e6584c56729a7b8fa6aa0b985d7e9ae7a0e6aa8a5ee38269ec5ee476243ceb37cc74536ef81e71eb42f9a33a1b8103246c732ebe60e684719eca5788af564f1c4286a06fd91c299855f489a95843c991456363e9074bc37e047c13d7316c3f35f7d49f9b8375497d4a6cd82090eb9ee763e7b9f1ccd9bd14b2f51f944a5ff1a521797ee2a97b401c50c5680c792a975b6e3993a3fdf2bf9d8fd12046dd7dcc3991bc3e924f9a1eb72db8313d866fc11fad8c01ef6143dc52a8ef69d9728ba603715dbc15439145da23953a1945622ac668364a7370041f86283e9b3d2020b0912f121683ec7300e43f8a276fe9852e105e035af7d6b7ed145073e0b920d69622e708e6ac4771a58ae4fd7304bac19a641359b05f7417c6ce6c078db8ae831fa843f2a184697de8f8d5fb5f82b4bd8e12528f5da80ef26f1593fa77ba7b324191a5541ebebbcc892a81518d7061519889c09e3464ad50124b5cd6319a3be6cc4926a54b59f9584e1c24c0651a0d51442b6181f983d5514a4e54a91b03bdf0f196d766533b4a3fe78553a1f3a9c06f68fb666fb1c7a18d033bc383d77554c62ff83dda0a94b8f8c481ef75720775e1f8e5212320530f041ada7af4ae1d0929409775ce0e0cf7e335d2178907965945b22872f0ba2ced969c7f03b1b5553874c2f641696155298d497b50e98acd0f253f79a40f326bd39aa42bfaee4777ce81e7bc2c1f4ec89f84288b8dad74e1973b287bc3884e46701755101409ed7ed19c753d85b3fb7ff480c005978da1880e159eb48911cecd478a60e6eefb7bc3b20f5be26cc184b13828a8a0fcf2c535df711c04740dcd7e5944c3aa1d3bac2fd0efba283b1d0e7a148adb5264673155a84ab10a665204723ee5778e66ad62fe28cee95105035e3a796b278534ddacf16984a436ef4f485803db5e9cb8fff6dc2d1f74445977c4ce86643e6f5d51c36d266b13a5277e093c2faba27676e02b0f3f3beab8c0e63da21bc00b8800010aaba78d47db56ac46784bfbb5dd05b989530267defb4ddad3f0ea7cdec84d5d68621a3be1e3fe38d998fce1aa622b19334c73fe08d90530b5db0f8b1acdc8c44bc9d93d0ea9374d1650baa7215b74aa6452e5108e43fb67db8fae34c89395efb294694dd0c9b76b3e4610bf492242b559b5039cb6f02e76b2812d453f078fb028d523c236b366a0259c6ee15464f70774e65d3160153b598e803c51a9d7aa0ceb269a02b9cac03fbb45a2a889e6e623031249bbba32982d0afa3ecc048b9a04894a2e362ce037f2fbb48d029fe4cd239056806646fc6305e193f815221f9ff3bb991af37cbcbd13a292a5ec7fa0b2e3928fead10ff17f6e322a110ad5e01ee20e24296fcaae4df38ab479219d6b03015c322d544d511b30044d8faa471bb107032d7596b1ebf3dacce69e40134e9c54fc13c926799986871d28a04ffc2e3c90a90f1fd792d5e8581f13ef5a4a94b9876fdbb18d1c6f534ac8cb4772dde708defab5573293e4667fd3037e8d95a800b0da95ac9ef2e364e98e7fce985e3dc61ddb751b22658fd0838d18418ceb3300127b12573d6e0310763a2ae59ced2608fb29fa79295d5e3b37928b878d2813e2ef224066d63874741d329444b8c21cdc41c823857ba2fdf626bab74fbd1246e61833047ee967abb385abb2790dcf82ba50c645e61bbe0105d4adac7771fd188aec52c16558b50eb9b5c960112e1084e151c6436b3a3dbc7326b3bd15fd8defbae4794c40f0533cbd455db2704ec82792595b531a2cda5e331e7ba9b821f940d0dcce4e52fb91f8d7921b322c7bf5b3edc2de57294db5d88d60433d871dbcf66a826bd3076b17d3d4e4932366a6715e454b2258f739a5ced3e25ff9653e9600fe0ae1efe3b77d86e2b138fe98752afc155fde60b799c59e5f090583a6d5f2fd5aec4ee9f61fb04447e40a09a7f821471e24ce9b09240351e64ed8e00d5791b7ffbbb328ff9a35d21044746eec349cc426c2c414010807ec8660c077c662576d8a05cac6d1230d27810c54967657a266f5105eb0817bc27ee95dc0e637eefa64ca581fb46a468816fe343ac008c51ef9943190b034394a36c2a6b7c8c08491db07684f6b7a65493c933e3a95d62a4bfa7d9c16137cbfc6e5e52b6a7a30f53af08287f434c85af89578953769e182bbf3fc5428dca703a8d1f8ae1d03aa2f963a11c636f1e702ba4af54d2e8d9d2628c2f64d4e711aeef4c80eb12586297d9e4170d6257e14158f88df53ad5de93a97b8d1e39b9b0bc38ed8d2c2822b1a689767da330e11b865e916ca2c4378eda68d105d2b155bcec68cbc7f80ffaf068de7ac4149099153847672024101e9b8c6c087c943f36b2bb548ea80fda61bc6137ccb38103c4586011540b453f94a3d094a5ef4797f9133941a9956268ddfcc26359d66ab19a980943dcc6a51c9a857ec283e4ffb5cbfbc370f4d04e8dba5da54ed3bc3f5532e879c64e0e3bcb7dc410751b56cc4e03ffdc8b002144ce5307aa95e7bb0f6ea471cab32f83feebf82a1518810fd6b9cbf39a1919c2e38d81a0d42e6c841c8531bd411752fd306220405568ed726064befd5b6fb78cefa3329bdd34c2823fce86f52c5d6b17772aed2446ed8c3ca8165d11ec2db284350849692b5f2ccb33816c5ae2018b2bdec943b1cb7c81021b38c2a91778795443a5b4670318005f13696ce46178b4dc9305fb92aa12df0d8d07a26da4b121e6b4c3ec6f2eb7b0b999f32aabbf27d1de8d54c5014826c397db24dee64cc98ef7a974c28234169fe466fd60e829bbf8b81dedb40ca391d69dec19cf666d05cd966d8cb05045b8511ae972d7b1a01cedff2131c9e3d50665efc5c21621f1450665906bb18e16242626512ccc6722789f903d3dcecd42b6d73b1b76367d5f5d0397102a53312a0e0cd544b6a9a7fdc90ce5812bc50c24dcc238e727329f2ae09ae878a0e4abe0090dd27fea667d7dc8b490f3c9366eba70406201b594ec8f064aa4e217af84e2ead64da2fa0523a3ab7352b4b5f36c27527c40e05f5f36e369c9020b1076da3b97cdd09964895459003535c55c895c46ace7cf4cb89fc05c97ba2441a861b19a19a5d534a2b966e43e8827ef8a1700dca078efc6e81100d53ed37e0cc72dade83b30e411c1907bf0176264e5a13cc6dc0a62799ec10980d7e627713b402d93dfbd6b1f717ef5e7e426abf73757440c32e808351f0e90f0ffb960fccb79691a3af450ba590220d0f43f7c269df9d96288ef49b26d31b9a261cdf5f91daa400d4fdbb3b4009bfaebd50b280bf92c86fc2a20ce59f19cb28fd83f686a0075244fad82abcd36b49efe0bebd0a87aad9313cab94044ed723421808441da120ae5392e2fadb337997b91f9b598f899280ee987a429bd2bc7dd0b1a41cca1eeaac3bdbb949ea3ea7e6ab92e48b08d58eb3e930476649e507dd1b05a8a8f237edc914e8a3d6cc978713b84a7edf23c3acac28f2f49cfacaf296e2d050983f9652b97564b1acfbdf68e74aacac19ba82441bee6ec5111b24df9790f930e44fc610c61eb9e0c5dd15e979bf3db33f97d34c5b8d26dfacb477fcfaa7b322dd5c1993c10e1cbbda7dee539699822a382945be83286ca26d90648a799191825ad9bc00e324859942585ec17392545cf4a97faa446fcd435e6d3aad126863b55e04363eb476713f7fbea507df4ce9168a8f3f4d3e58dd7c744d3535c811cd99ec37151171f0fefbe35f455c006e6120a911dc011e7caf0c79b3002bc981f125a3ad795c9ef77cbb3b8998faea8ec58579c174be994b1a81e90e8ade3cf35565ce171310be2492c87dc12e01c464cb84f2b3d407d44ef34b0e0107b528258b9eae4d1c71398e32bb202443c73555a701b6422f38e3b8bbeb112769a5f632fb5c9979ba8294fac4f870a8fbbfb7273bea356d933327e199ffa2c64767ba72501a967628fe9b6c4513970020a29ff8efdc38f243bc204f4ad7365409903fa3f4ca2b505407b48dc911bcec95fe0b5a7b68d9670c43c9dd18f24462d825b30232e51fafbadccc680f4cce73ad18302fceb6a3ab61ece0083c2775226189b3765b2df97694d516d3a3e2572b601a3b9f73a71c3a59032aff627756657b884e2901b18d7a47734374d19adf2542b20cffb6f6c18503f914f7b92a2c11371656b13fca3d8beee828633e00933e3085293579c3df211b3d2ad374bcbd15bd0453352361b10b0809962908fa4371aff10ae4b884e632ed0b1a09de59f3e445a4f4d5984ab649ac53ea94ce91e8184308d58c030138e18107a386fd75b6dc5f6d14d65a5fc4934457628d87df748512eb40c28f6c63340463baf31e80c82f78e42626a665637cfcf26754513c4201ebb6bd81fcd76218cda12231774966c81892ad75e94e547ea50143ab05d3e9952ab66a2c5355bf05fcbe48e3204ece1a1748070f0072a89f71652558b796949ec0f2186c3fe46d9af957f3659d301a98b66d1a959f4ca3d05164286ee974a726e0fdf3f5bf1a432c69126e5fdea0703bb8e424073132aaa3baf6c3761b7ca3a9281781c2ba433af65831ca9205c562a50d783a4f18c57c03852f0e00d2e45e7a1c534681a833bce4d068c3279b97073a32b3f97ba894727db248cb4bef733c5fa2aaafeb8e278ef6f1e9bd1efd11ac877369c164d0e3e37b1e069c3a0703bb27ff9983ea47f0fb61bd5c1bf3b0cd4dacc6b2fe313c2d30eb388c74a4a71214b5417acbf3dcd5069a99b8514b330b1747b82431dd40f545be7c8573f5da24cae8292251d29185c129a05b9857f12ec1df8d008a09848b23c012b3d3138685612d3621b75868b31cc63a287a302b6049fa8a5e8156380b09b9ce65829a638aa6b797f36b107447a82abdede3d073e602b771f05d779e11f3d2f4a1f84815a2504c4e4207043b9f5e076c1ada48eb3b4ab7a6bc373af8e5870780361de7e5b79b800dc679eaa450bb57bd137994d23a22284cc7cb129c444ae783e78d6615a1005a4e89770d60e98c1a08e297911fbc32af69fcc9078b6f121318ef2a87234e878a2218142073e4adc6f04bb924d0a06c4f14884478d5635b03bcd41f0c70a1c36c3dabae4eebc0c21019dd5105a4aed7e9ac1042a83a9c0f124648f5f402700cb26be20e0e05a68a8c74ca2bff2264831a51222424eb5d5b64bfb9a20a22d28c9fce99049ea7158d2d2a544d415e2e22929fe97f448fc978de573fb49fd03fd7193e0cb6308cb6e6d46d166600e12ed7be9c65dd83aa08db71cce956da8046bc40449c48cfc2c77145d4ff1f50609ebef8012b25eb1da64c493bea37213c7fe493076b2c9261415411b958095d793fc3260c04fdba575065038d5202f0f3d42a93b6e5582a1d1a1aea8608355b7bdd61eb8d632e4646a06ed6d3fc470fc87dcc2359080cc78fcaca711f12dea1f0622f6d78a09a327718205184ccbf09140a3a3cd30555fbab42b40d53a31d281606ee3cc2d6cdb7981ca3f7ea8455f463613decea2e2cc7b6c8cf028d64181251d41c962f7e1f7592f93845e8e8ef10dee06320c40a9c91c726197cd71b3297249f3761e37868e17692409cd98d4446174fac50dce4693739966c6b5172834719f5c5db72147b6fe343f0dc6d454df3f93cdac6c9bcd75c5b42858d155902f4fd24c1c105fb0f6b3622f005e59023fdd8694b9c1582814a1a2a100e9b70198b7da24eb780d09c1d87abc9b8b8f65dc70b328f3e03223a1d920f1b0ea500c42109caa1182b24132290ace801f816be3858e5345e0955bcf0fa394e67c4373c5b4b1dd706030e056c9d0a43c5ae18585be7c543f3ac8b9672b51f4b35daf0b957630775a1b9b315fc88a52c91faf9a8d8db56a295741197910462bfaa9825b2b4110abd19098aae2bb64e0914068a202562dd164c6d3599073f5aad01a2d7c67419ed72edd490644cd5b2adaa16f6163330d1a9d9db77a770c540bf970d1b9a2a504cc5955287d0360cd6b39a15480e57ab243fedc4e566d8ccf8a15ebada261a1c4be4a6753b31c256f6fde0efce3844ced63b8ba17ab56953aac84370539402e3bb9193dd58b9a601629575627841055f589d36badd4c76582ebbf9f30b3a3193f10af345805d3d5e1fd906a58e89abafb8f2f291ee326884baa730d494439f5eae1176da831a570ea6496309d5aec0f6248166d7cd4a1f15ae24134e293647cee0bb1632068c8796ece6a4ec01cbf7cbbd441643671702933f9fb0f2963d1a41c1ad15ee842a908b87b175dcdbd2d35be2306f27d97508e2c97d5d1bf9fa15548f146207a765a277b398ff5b38f605c76a477c17e22275d1ed759bae8c60188cf2c1132810e92326b3a7d28b78ac553ad4fa8fc76b6bae95788c9911c613bb14124e2f2609fc0575cd26c95fb432c1b5595627590457b92afe062b78512f665583d81a02111f8beccc39393945d927f876a52bd5fe1bbd015596f05d209882c4cda78afedcda521c85582596868cb1a6ca9c5238c9d26744a9de67d742ae08cdaf1686fa7c32268cdedcde580a7139c07250333fcdbaf5351a06a949a8de59a81bf68cb5f5d7a1e91086a2df7eaa4c959de8bbbd6241d0af201363eb6c7b09457de7fe6965428991364d4c4f7c6390328adb8bb5fe5ae846fee58e17cd0af0de1c4f8544e1c38d9d0cf4f5ac7299a5cf3c259eca26248223e124afe4f899303d18e24bb83bc15fbf8a2418fdce74f945315dbfcea1ed7ff11a128947f07ba44f6f222c9682c09d5274791e7e315a9eff5e3b0106d98bc20a128974cee2a83ebf314fa3eed2e1adcb4fa3e07e0ac8f101a4fcb112be9fae493330c5bb93827623022530e5636ef624464e73481239b387722c4ecc7febc971cc6e20aea96a85a0cdf65d4b8d16799f80031c5e4410756470610905645d2e4b9a9d0e10e2a22b8fa0432322d3b06bc78e848b0f04230794a084b3dd2d32cc482a2e2bf8db61143106d3144123c22fb764df265a6a44f83fa538c35e19d4f985325011fdffb38af1c580b091f6a0e7fe85cebd85a0f6f6fce77cef52ae438faf04ef0bb581f3f4d615616b8e157bc43418e4cb3e71b190048a7eb8457eb29cc2bc1967bd9d290e768d36eac31a7c3de83963bb6acdd8c90227797a1ce6b89fd7b0375e157c51c0ad7edb7c634bcb42d47c8cd410e4fda4259d62b93153bd8362c817306b174600e2ee1761c15d52a2155a204ea86839101fc9ca4874335c0422152a45ce9a1603912052041d647e0fe6c24ef965af3df367b7a90d4560418da7501bdc5c2b634d1555a2d3f8d938f52a941eefb2d42645354a5cbcdfbde442359a250759a4f4b0d085ff7066f073f4cfe1f640bbcaeba8f062b231042e3016e2f7544fb9fe15af88cd45b7631a99346591d2173f0334c4cc925e37e9f31deb53d2810f50ad48eb9364d2ac1cef66c8ca9b04bf95aa6f0ff08c4e7a4713186fe99a4359ab229a85a8f16f61f420c37a2b456b5489f1a7cd5443cb86b9f7bf4aeb4f3e726cc30fbb4e65b14db3477c4cf74343443e015a3f0aacded69934a54f8bb708e13c3b3c0a3c4a4d5c96f999e7f7b928b9d634366bdb22f52acd77c0ecf7c40dd4ab28ca8c300614480c0809c128e6eebb290f8ce25920fe599c61c0687acb012278028955ef0fd09438616d7f327a6cd71b402bf0a000f03934fde499c3798741798b2b01a7eb5dfa7cdc00ee566ab1ff2e1726fd5aeaee7ee3e3f4d42b19e15e93a994a437014f13541bcfe6110c2d314f1dbef2a542b7029896ff28fc5f0e6550278901de8ab2ff7abb16200f3e2481fbba6d0f4147744bfc3f26e8cc0b39d9addf17f0f2f09d1410a6e2ce8c88662e6268a595729f5d5ed9aea66748faeff7666742457d37ca173e1961b6406efbc3bc2ca5ea6f06908a70779b9e45b7af21c91bd19b3e9c4261656628b616249cea99a098c543488b26c4df20b71a48f41d1e9e015ba497810b221f6adbd39a2d1047b6c7417940d07d55a1018ad4b5680a4c1dfa3687bcace89a0fe407434d1487b050ec0562c3540ed00099c0bda04de391dcfda83324149a0dc5981744d8cbdf6a33deb63a0d931db3ca2178cf1b56180fb7f6348196b77c20d217b998f773f5deefb1daebbdba59745b827defc2894abb63c0f5b1279bbc949b50b20f42fa717ef227c10a94e4e23f9382ac2e3616e48cf6c42130113baa9c0fee9912d2b67605c7de3d76c6c24e44a20e4102dd4384e3e4456847718c8c74d86811424beca27e8bf32702edb6828496dce8beef7fad7d27fd47031fc7d9cd2b4ddbae302ce22363a0ef980766e96ff66ec56088fecf525145a1accde67458e0bdc1b0490dfc828a533dff5a57fbcb14c1e6c6fe219638448c0d06cb2f5ccf1e73e42b34e14ecfc7f9a1adff19a3794d86f820639d0ea234c3c3eead32577b82df7ad9a60490951a562d779de7279c68a39910238d739246b73c84e8f157ab960e2690de104affbd4bceee5a2b2c2e3b77d24ae2f39a7b88ffb8defaf2def6318818ce44a5dc52e66adbdd2fb73fe1767554ba6e76bb95ccc477aee3ffdc844baa76c67b33dd46be0a02a6c8b8cc382815aa566b2dc4dc948cdf15912afd5923d4419f25af76f7f31c633a13767a94e2748bb358cd14285ca1b6021f963a59eb81c7d264826d84bd721e606ba799fa9ff4798760de9fa37e101c8387cc39c28c6b0148dd58a83f34824c5611b8dd7bef520bc406f7f6d8e2dcb664577cff6737ec7ce4908ef184a83c600768c674b14fc48fa61e9e99aa17d1bb2aea3d227411b1e49c54321ea3bebfc3b1ae276e8f1f1f10257e83383a7733f62ad0fe455dac4d40d4e8a0a5eaa1793b52ffe5bb2001d8bd440e3e10cf75b77639092d9cc9669e8d1e89328f8c1be687bd8a391a73e3100e921f5478e26d4fa0f6e4eb192d147a07feb8a4d7dff98b0d8092887b050ecfc634a67ecd74f9233297680e866e4f98d357abff125d7cc20f82174c15bfab61fbc47c55665dce5ffabb84922a7b4685c0135e99e0083f522d0203120539f9a2b2cfabf9d53ec9915d41ff2462d6b3e6c631a63b2c16f5431fba84f4d3f357fcfee92397921da2896a76b81b5c46fb4e30d3a2ebee755798770456e21526a257ef27d50309178adbea96201365ab44e18f1ba0d492b1f0db6f31d918d2aeeb9cee21b9aacc5814344ef3ffb3f7cd45cb5132bf16bf469266ba4eb20001981a0f097f71c19d6e79caf6f3ca081d44bcc793b97d9389c18aa23d1c6bb392dc766311f1b49bfd8c33e8d155abb14997f7bd3c41111d2b16fca94bc80bc8b10d2acbf27fe217ef52671c987e7fac23254ca22af3bbcd2b12fb48033c9fbe09d889d5b373ec249895b76e454305b221e20d331d8f4c5f77e17f2bc2a3f0a886ab85456d4364ef2c760cd34bbd2deeb60b3abec972bf24ee3ac58e80c94ea4aa4aa1f08a58c91fbd6c985b6215aa59f4ba19e4526f10bad463f04c5d2c7acefb494efd425da18a0bb11ebb4d9bb0fd67e53a83b76105fd56eb5a4201d84e69a05c830ac435da697e2a04bb4bbbbca1b40f4df794dd548f6eb297ede2b44ff2a0062d9a4e4cdc372c16f950fb3ac1c25f18eb47e1133835f30e6cacf396f54df146c73542e8f1e02da792db91d6b14db63e8e79397c3c41f4d1796d0a4170495e501b18e7686a3ba1dfe194282941cb9fcaf7cbe97978822044f18f068d6bc1193df29b455ee6c0cda0185dc32f4c490a8b6a976334cecddb6bc51007ff6219b90dfefc4e8abde413b53fd1aa19f10cdf3e0037251bb10d59b932992be2b059794e36014d800a84c2e0d2d81866e0c609d736a578b0b23af79dee022598ff3e5aec742278a9b46f6426441e71132b563e2628c88b5c7678c2ac7a3d46ad60a182d07d84c39513a10c3d2a966d657e485c54c9f5a55856c2721069740f93e14e04aa2676bc4fe8906aab79272b7b471837cba000e683c843936d51f5d94cdb10bf00b475dbbfbb3fb49e902681c5e52718faf686059abfa7e8f1e5357f395013013912a1dd9a10afa13f6fe0ec0ba1b4884afc9b71b48bd87216c0b86550972e455e547c104ac53ab278c0374583c26a6a1aa4d0e69173ebd0e1b753c2f6748330d9a481fc06ea3001c495c63d48cd0a04abc3969dc7770f847682912d1db48671bc5a922c809e2b66572927e9b6b682dbc95ac55ab01e881b3127392428c35f776715d06a58b0309eb0111ddd46b1ac7cfbb4348e8cc3b86d1f5567084049e997a833e7a73e3d694908ea3abfe0049ce0778508ffd5a1131923a9d8e0e1c7ed2e59a140822a3f87aa4f07ca442a3c22ab2fd3837b6866505ce789a2baf7a827b1b30af7f13a3343e9b52072089581ab35409d6904d5afb6821d2f000bf4bb0b546eb2c692f721f198b4b5022caaae59710b5c9b0a1870c9e016ffaf1f98b6355e95b20399ccb9e5a3fda7551e67e152d1c876b778b3158ef6bd5fa769e7056c0e28fefbb43a2229c88ba44bcd49961f0b18cc7c13c45b74f7a31e0214cfd6d9069b06d3193fd6d9347a0f87a3a04fc1547b8d7bd2c68a8e4ab643dedc878551de1d812cd7967be9667858b4003d8bb80cce7f7eb985d247cc15ab2999e262c82d9e379db050d58b6757677e90001b23105c19a26fab729486dd06cf64bbf488159e1693462caae4f016df393bb3a39101397b3ea99f8a16f7d0625a6470a44cd92628d895624d78241da4ba8d9becc5e4d7ba65288dde6d38f44c40fa355d37af0ac047aae0ec20f38803f0485f561983518b10573682bce95885d363b9bce740eace224ae5bb4304bfaa810979b66df4144dda5aa0e9cd9a3765aeb75a4fdc6d6cd925bbc31c626a61dc11ec857ed5cfe728fd2fb7409783f5e392d2b912923e433916529f56d9d9fa59fd9ba9955bdbb1db2c8176db829aa07b92db0e737be1254c8182b40899438f38f2d9186cb78bd1cb8270114f05684deceb637b81be2e94927e4a6985bb6a7ba554f574aba7d57e449ff38a857798a33f4a8343998808e18467816b847ea941a21a8218da536e710b8cb66bbe54a9264b1300b0ede6a8f876c94683ed7ce54ce68081184539dbc6b533ccc40831f8cf044013445e64379b16b390e5f73d3a5376d4de2c804a173b88b59df831507b00867ad03902f5ee90b9c21d41b710497aaec354f829e8cb07d368510530255528367ccaa71d9cdfe70eb0a6c16d9967891f14670223992016caaca76747a2781829b78c1e55abf89b70993756e4de113fdc28c0d89863ff0b30b5c53d5e072c40846a0e8da0b298de564f16aefb7ed00b8b4a841b93f028d75e91dbbf56c1bdcb997b64c779bb80217618bb40b48bba61b51ccaf2c2d6253b24ad396349b5bf641c7ed4e265c88c5bb7426dc2ca6ae6f1d9bd99e954d1be14945725bb6b924359de12b14c006aac269f0d4d9791f40a8b5a4b199c2fec0bb52d71c2875697a5d95946e0fb6d47a3fcc90d7cdb4fc37409256a2dbdfacdebbc4a60bd22c6bb2fc4aee82c0cfd05a2fbf50b3ad3503bdd32a4b9f3bf28bebbc23605b6e719fcb6ede02eca886bb826495aeda6795956b3b95d78f6d686a2ed79b51383d8fd3122e8ea20a9d1a3813f4c25b070651a0bede7bafdd1f1b845fa7dc90bba5aa518c8bd21cd9dda6111db0bc95e56ace35d034734e8a9be80f8b2f05c95c999d443368218fa30d2a828f80629c7f1458db23cf704467e84335dba6cee7c17893e7052c0c34c30e8ad5b0138b42bda18e46d0f5f831dbd7620c4cb17388f434b7869afb8db70eb4c64e7f54c138173f1221cbc694aabb5a543d656b4110e68ee5d483aac2a6d59f98ce2084888265df8be835170bcac5918dbe94c00c3b190c79b8811d843150a4e7e01a405e6243442139ac775cdecb20ce7f720bee5d74ebdfe95465fc71fb0223bdc819aa61d154594ed5440b7682b255fdef9c52d5c4a950bb3ea8202e54918ff3feba37066c019a9968744e61189e9836232cf975f8df44536903155f45b35e1c08a58648ffe3edd4385af31faded16168df47f266ef9d00212b2841526ad5578f6cca0a778902404cc321d574de374011c716286fb00e5faff51bf23ed09467c6e8df2c9ccd67f69ce0dac7a93ab5cdcfd2a4d4b1071fe85a4b3077f6f31cdb22ad38162783d8e7e3a3e566cb78f293342df849f3d4ca9a3ffc0eee85e7c02687f97f43691a98bf3d5fe227b847a50ed1c58668bf76986f9a1c4a91f84d2668750e55189efc29356c9337c515cb95ff73cb9553daadae6009b59cb7d1745de6cac4db71c27fc8c6a84c2dfcca3e4dfe95e31575d7db811ed000b3e6e73b254812a0efcc25c3283aff0fd67123601ecc7e93c2c2aa083fa2ece46304ba8b39cee0b18277a95ca20a853cbbfc935b444611e8ee92487b0e2887ecafbc367f53fd05b0fcf3888e081ab2af2119d14f3b171927d9e2a6779c8bbadabd39e205a1350cb65ecd8c57bb31fbb5f3ff10ef34d22b5b5fc7f221a6d4dad6cfb7d91004b5f1835273c72972062117db5f6fe93f17ff044ea1b00b2e8b37370d820b0e175a7603cb0e76b3ca8d5b703e68c598036e6459d991090872eefbd8550bcee180928040a378d9b85a379d0a845880284ebccca064882bdd5f458f3043a0391d327b6256a25ed797b2004b285eaae3fc55a7eb04af8a77cc20c9ed78fc7d503569da43c17ea5fd8156ceccf55705e61d91fa5cdc9f9d25bd0d02bcebbb8447bdfbe3a655ff948dc3b4221aad6b34201c4032369003b2148ddce1f11f1bed655bba3ddc61f8bdcd46ccc04309d41b08f8a010f3338107d39a381eb531aea5c021f7cf80b063a7ae68bc0133d2946c3ad2bb81e867c4142efbe023edce238c83e9e989698deaef13980c90503b9377c9ec91ffef6a0d103dcb71c1a680e8d88eb0f3ece623555070600d4542502fb8e1f2c11a2219793c597dfd021bc448d10d02f9d517980021f08e6a8bb0ab88d4962e0b2e7624eafdb2ae88e2d78dc3f8c891780ce1371817faba5b6f000914b62050b12085fdbe7b97a642842c07f8f35d0af701f9360c5c995549b72658288c0afc24ab0a494c1d0d02cf29482b7786002d28c159f8b8a8b3010f4ec7b34a108b04d9cea49dc4344c6afaf98ac917e55496f336f2b6e5922984337e4ee54339535d6fb8a223fb1c60ec010a6561aa0adc9e9c9f571753aed8b40e35581945b8ebb82b1e582c47d5c2a7eb4b0510c5dd79f2d5cfab3a842549cbdbf931c2144295f5e89756c13639493aee229b02a596cdbc4ab49c4723ce0f739a7d5afd99d107bc4c3baaa0064eb1f04efde22b58aa9c56c17d8f7082204ca9088a6520c14f353ef4fc00fbed44fa685c6d62dd38ec86ed9423a230beedbcc7e6db4482647c406015a08343332bb76dba1195f3921c4c8aba5da5cff92ca8c17d28c05be2445e736012b4c6bb672bf9fc59d9e72245203f43329a6dd6321c13a3881ef0ff244b4afbe566fd8acc06271c8214c5d5d1c3261e8f4a56dec7013711a88860577b451ec0a7879bc4b60921ccd3a20c642997fd7f6f55108a444bc67a902d10bb493411d2857f32c33e52c45eff3fd8a72313290284f0d19c391e59532bb20754a2a09e0444d354fbed36a1013369a9edcb8154771776efeb4569fcc4b5eac92fec24ad428b6daa2a8330817ab48f100d8d02cd8b36f00f6fbe0c0b561b3a7e6f007fd32f2eec283de71114ee2cd5e57293b9618f598121b7aa3b3943bd2f6faac2001c71eacb2ae374c2271fdda2b05eb40aa980e39febe7ed5d61c5ddcd069c299bc98fab4d746a294054e6b31646f13cb68ba04dbe9453a079bae03a93dd744622245d2c1e7715ce9d4ea9eeeaf3061a44b4790e05a47953d539e2d6ee52363ad5565d16e20f47a2282d252a34b43c10b40b17b3a0870641349d2f43fa109cc74a589f46fef2f862bca4ad9c91417de6cff71d10c1d660e522d7cccea0bbbe409d9cfe54a5c66350a4397342eac011f4074f0cabee047086102d58c8d8dab9055771f4bb3a7dc09c55786e392bde46c7066dd5f64d5f9c9cca89f35ae3410a559e6ec44959c1f8ed595bd33be0570c0579896849990183d5c5bfde04d739bacfe5963fa9951b658fd14d897b308d1c1c396b08fbd16a573c9c0bcbf96431d7ddf45eeb3c9e4670de74c98351c09099a6d3c520a00856d9eb59e2940881d75548072b792379b401f6cc1d908123efbc720aaede86d6e734c1ed94c649b837145f81132da4db5a7dbcff91690e5fe287d83e2147d4dcb09191c3b89d730cb06a7dae2743c10a321a471a942a2b690be80025d0d847fb4add8784f33277a7cdd6196c986f4c367835e3d6627a76d0cd0d7afaeae782c978fcb7b658e324b9b440284a432dd5856bf7c87a57c31951acec34042a300c7a7f0adfd031839a4ea70f90dffe70d8939a2d61fa0984f797e728cacf3dce9666a165044a36fae0c530179738b2309374a0479d8d963f727f40d7315987abda61a5526eb666d19e5b0f97f8177c2a426a0a7be73e2dc44369f76ed28d46635e210e6fd933c394d67cd8bcb018e8dcb62e290717b990d78de1577a22195263ce0227bef9a69056c1aeb02c25b7db4db3a27968fbf7d14b8b83548c7fac20132a9d039e21e94ccac19aede1f997f6799d6e97927b07014d10b3fb60651cebe7aec6e83b3120675e202913b504387eb587fd29c04af22afc79ac301dc5879f577136e33207ac7e8fccb385050cb0ad607c38e22406964aabd525b867ad4af5298b15808401fd67ab2443ecdc931ad586cecd328f1d6601911f4e003a4fd37fef1479a280a78540a8fd52c6ade4938c66076ee696f597828e86ac2eef3538868b7bd9ba4f4c80b89f8b5959fef8fb231afd4a47499ed3ef8b9accf38b570d7945338b8c306d7ba9068c11db560a39203e59506479e01d5c2dfc9e8534159bf0959c9a10680b46080eac4be167dfdac0d74275c9eb4f6ec79b58dd1d53b824a8e67ef419b8d3257f066a1a82627327057838bba590b6884a1a1785b67e593059120adabb5421978eba0dfc826884ec229a2b3a1a65ddbf9430b05888f935bc9890e48e4536f52c4eafc41e4fd48a43ddb4ef9493f8d57a7514b451b7f93545f30184820ef8accdf352ed24bd48bf667c1dff61136d8af47f4ead7e2c619aa8a1fd730cb89397798858ff907a88cd6caa6437d62e2f9b9d9df431159f37f959ff8bd2fac23d4949202f60112403a82f28d2a16ee0e8671211f03bb9b9ed47697fb5759c88c805a41d0480b04b756a23dd2c9fbca40375244528b1c80014e211f7b9f41bfd6cebb1d4a67466929ee1a7e1a45cef00dbd88820d685eaedcaf36874cbb5dcc5edf5b27121778a02b84eadfc9b1eed72b43680402a954f0112dac49e1adc4c6fab8b60a3fd8627a32240893246ec3affb497648d696416ed814848ce30a4227e42982e46d7c3748a2fc0d8b8d20dab7df8a8c5ceaedeeb088e9741a661537e2e21c0fc7033ad55c68e0d79dacc8ffb7ec9c7d27d35ee8f373ca9af11ad8d3404088ae36b2e1a8b2998decd204daec133c7beb35eb6cb6c225509f85bfa9de02fea12b5e7434c795765e4ae2be7821469944a03666cb41f227beb98d6829a24d095bf931e6da21dfde154674ce2fc33fa45e23357b8cff1d5de5027c84680a8bf46fe998e489884cf8c60963e31e99d27e39b6084391fea6bbc5c2f21d5f699759b1493a0de63eb4db7fbf6597f90342fdf37784b6e32ba64840ad7b8914945752dba8bac5de9caaa79f637dbc686b7ff7136db788d1893ab4e9ac7b10f8ca7131cbc54a858126d19e9a1c66b68cd9567e654cac4cc78ff39bce37309c649b77b4b7f45719ebae78e6c3ae9e07b8b0f5a988b8d41eeddaf601ede00e6b3ecccfd5d3e6fe185ea8dd479bb53c2b94d054eaaa5afe8b62aef0f4ce21ee6b810ac73de0bfa6b7b43cb57d16606fd570dc8d4d7d545535c3854eb77d113e70997606db14ab2a1c9638c457871528dff645cfa5b89f3d38227fca0cf89dea5496c6c4d7100dcdad893c41a2ebcb6e180a2ef1d11a62f6954fc929bbc42c75d43e482a331b7977d4cb5f6714b85c2293743988133587dbff8b37e1a181e1c4c9b5896db5a8fb9a8137e4584342f28c547fd0a73aaf86afb6a2415e5dd6aa6c510bf431077ee07c73853843103b90ecdf2ad3c1939bef23bc69537f8a6f9c4d48b2f213199e569cbf68f6e9c56a1892e260d6aad213b0b4aa6279b9e41526fd79f7637a5c79bcc4d5fa2929bd14c47ee5e725c69cc66fbe4d65b8b46fffaeb13aabb467ea0bc353a5281f81fdf619e2e4cacfc4af2ba6dc3863862af0735cfee1f2619a3502eed69be1e9a9ace8107d87ca321dda8a9a04b42ca7dd3a8a5bc53b56f1bd6e9b69f833da88bc591806227577a1fbe46e290c353fb701c99dfe54aef8fa46cf1d79cb0c8cd402cc34a3c10804811b23bdcd36c77b4f8e88b885567c28d5318aca382911c428a093bc952af395e58e05f0f295ce6d4633c57c007581107bf7a61b2dde130e0bcc64f783807b9ddd01e627b8d50b94c83550d379a112947fdec9865a36db0be0b662ec4b480e56d359fcbb5ab24cddb8d8f14182a988a45a9127afaa5a88d80910997adc9171a60fa8bd2eb9a41d8c328490ba2af57d60c5db04da2c10d84a31e40e86c11dcc29e9df81eb52a4e38f6c37db5134df8cfc4440c3120cb690be58cc21c56535a82d5dec0340d382dccff6d13b1eb7fbfe50a4ffee6ae0391b32376c7e98f9ce839e8f5f7a8b158389a14eef436b711e11f29a64b704ea456fefac60da177b816876ac8b2ea86f40fd6e6d2d99f2faeb515796bf4b6a15330c30dd7b00aeca72dcb6ad0321c8328ef6926fffd05f5df43b04799233fead7e768df6c0015951b2b62601dfea41e7a337754a9be14ba620591e522da3bed2b7aac08268441d6d5c5e50bd57e4f79492e0ad1c71c190a6bcba3d314ae801aa36654da42dd28e0490581f1d143b5aec551de7057bfb8e63fdaf256095b2c4e91c551ef34e8e6f56c5060585ad778b7090b0a936d7d433a32e1cbf7aefc0c042db744118d61f19ce10e7857b891bcdb56576b82436b60cdfca8543cbf8875dd6a3d9f83bee6ff99109885d1f23651362ccaf2608d8d4b74f1712087e6b76e6d4500cf39c3d974039fd0624e95c8b22df105a6d9935147402e3bc985bce8fd1f89ccd979d3c68eb10864b6183cbd93cb57339e62532484d046ee9b24c76eb1baa680b5e85d8f5a05cba0d311d4523a38c3cd7ea0c419612d3be0694c2ba997fd05c3e4b8554660bf5b29bab7826af5d32a051420c174c260cad8691c6c7cfdc694aa076a6bc5ec3b97bb669e83bc3b1a2e1e9b2ac60a68ef23d1902b1694b930eb08ca639bcfc5c779563aa9b1f73abc2ef1efdc05d9cc08a44f4080f208e1d2494b46f4af75bc383cf467337e0861121efd7052f05e9026fec7f82396420b1ccfbb7bff4edb68d49b3cbcaccfca7c2d59c9255d6a1d716de956afe700af35dd42698493e8e1c65975d22ca4ca1be8c6e680e2a051987e9b6d203e781018f8de85bed5e54f03611f5429019c23da2680d372ee04f5c6d2172e1ff69863609e88766378eb363330912ca3e359ae901b51e7060b404155d4bdcf5821cc9b8dd305c149a41388e945ebdc8b0f23c4dc3f44c47257e477990e66fb8e756511bc620cd23333e4109b7e42e22f8750cd07ede0916c05275a315cf673b1d21cb8f1b2103a620b4ef7f91a1ba77661787e8c29d326221123662f5555306b52af566b32068c43a8a7e350f764a0a77842b13196fda600d19ce3131f0c236d029b15faf3af37bd58c9227c4e76550ce2265d3f8f29a09f9bc29d269771e260e872c9433a9bde34b8ff31b67d19c49017247ebb847058199f70c426a2e5cb1601e3631208ca7e46b0162c975a7100e0b8177bc26fb8f32d98d32bfc1d970bd542d4b764d500adedd5a0755c35469911436dd6c86cb6637a8bb9ad4a64f7bca446d56f42b3c0eb788bfd8020e42ad045c33bb029fe92c456aca8187fa7be8553f6a1dffe61497d42b65854cf5a9e23e29228ae68db44a2ae2978ae89d66be7d604e87e1f198e7d7afac6a35be05c3ef567ba966f111a0ff985130a985ddcd26be0a00e609c7cf4dd6e6a086c8f28810e80471823282e427e8aec0beb1e58e024fdfdbe6d32a95f46c131a1c5ea0e19dd80ee22f7c0546d18c2a85205b113be23a341f5f3985750d24ef46071ba34891b4efa387cd4f0102c65a6214392e50f474ad5a1118bf6418e6c18bffcf30772d69506be7d3b40e0ca6998d6708c1ec1c305fcaabbae3f3b1ab3852d47b15354359f8841d90987eef398fd050069a90f61ab1915ebfcf7f479c5dbe153af92007a972231a812b6e3d24d51cc198ab28a2e8d21ef8a77734920355fbfdd37ce77b8da09bb11091f804bd531bea5b07225bbd5a32d94543b5d47abd3683cd588f00939c608708d9712d29282599a5a557cd619ec5dbfc2ca2a7d5c14b559aa173ddd85fa5d80be168d97d00cbccb171790e5a08c80af35f94c9eebf7bc6be9bc39d8640d0df7a490fc8dea20bc88557fb901d792957daf329ec62cbe30386d598ff0a21cc77c2570577e164f44013ec5f39f49f0e00426bd4faca6b03c1c70988e11b8be40e378da128594fa4c411474e8e9bfc88a29b30d6426d3cac90334a23bde01dc9d771353112620e21bc580905e5ac2b253ac6f5c0c42347f4f696b3c608be706a48ff388f8c9d4cd7eb59f3af6f447c637c0494dbb5adcb7cdd487a9f7e99bd08484d42c2cf8d1d78259217ac4a86ea84f48cbc89b23bf753f56e38f893011bfada2ae054eb31364d0ef31d86de4741fb88a2783d6e006fe7b3b8299cf5b392d076452fd37992e513054becb76f2c27d74fc94414c87cf94005e9236e7730cc8d520213b370a9d3baea31ad76f3c906d51b8b63da636a9bbec6fc45876d54e22694042fcdd30f6346da1e91bb726eb7074a8d9f853d7a33aa4f974fb1afd64ae8115f0f82e2729b966c8481ab9f4c1983659b2849869ca2fc8ee8368f9b8f53a6ac4bf13bf207861d742094298e0eeefacc259160a393e6460c87b69a4bb8e060a51baf6820d3f130fde6bd3bf4aa607966ab6c83452829c6189a8126e13d773fccb2bfecaa92eb7a734145e2aa5c77b9353ad2ac9dd572ca79612caaf889b014bbf92c683d6fd701b7014af4de0769ddb7b91669de4f3be0b598e31f247170cdb15103f24f851cbe4f2c0de83fdbcf2d3cdeae17ffbb2bf57d512b3a7717c52ccdc066768882fdb8e51662b61e53e60f8589e8ae60526d4e7629ea8f124ebed20f03045f55ae349886a28f05f9fd1a259647c108ee6254589ed4c92c2ff8bf7761604f9a346961b12db6adde7a9bd0c43f9bf893d92deca5c310bda8f7557a269c49106a285552e1d858e1ac7d5ea8b4920d49d00dc73e7c6817ffd46b27f348154199a3eb3e2b5c04fcfde57f191b20c915d3a7028b72d7ed5ce3d7a8b731ecb6ae435b7436b7f67ba4022e5f212648332e45a4e37ce9eddc994f3000678a747c048be1409718bb1c5fb8a1fc6cc9df66f8f1bbd8e2e479c38d25766c3211775bf913c59abc852f4ce2c0916c3cec8cd7af2446717acdd74372d53e437ecb25df835fdbf674c7b77e727c63d47bd3919220d94aab709dd354497c44f0f79edac61b7d1884fa97127417cef2b12f8cca1557b73d540d399692c21db925a7efa34a6ddd42dbae54ba83012301ff330c70b362316e8d46329894b4c3cac2c21dfd30b3e0d0877ef66adfa9f530d212bffab556ec29c005d1ea64b2a3a3d42306785bbf375b0564ab0f5f27ff5537ae1dff5e2a3fab8b10d6bad84bde5cf3cb69aa783643fc787a500647c7a68591a9bf4b708a54864965bc98ace36569a2233b0e7cf4044dd16d167e73666c86cf6b584cd5761567f72d541a67a67e0c975403323acfe2f970481a096e8499c96689abff4f360e8815f5441dc711fda1b2b6e5db9096448c4b5a06a5a6af5de54a434eb8b2460e8df36fae98973f85ae750bbeaa37acfb5cca977555af84f417921fbc69670602c88efb9614013a8336ec832d1b897c01b936fe77675204e8662b56c15533c96a43e88691b5cb02701009ba732eec193a5fa1a9d452099e3ebdfe64b2179556e0862548727829f3dd46acc8ff293cb2f7eaa0899df831426d312c310d4a1762af7f8604f96cbd5f2be5b08bf97a2c394ee2987e62cb1bc46f13561f7b169247be38cae1b4dc65134f71909853c73daabcdef3526b6c5f13e1ebb2f12dabe276d4a74def1c4540576f931fce5272c84d05f4c0fe5037ebbc66542e7f75755c98dfd792e3b9f5b5e27e70588658bc9c2c557e50a4c93405c07de898e82aaf803a53a1fd99ebf01fcfd774da336b10d6ba3f8e53ef324721b731e2b28bf0b2e2a75f6c5306b52b4243bc8127ed680958bbb60cea7105a33c1ed61e046d8ff819ba8a28fd2211906c037a2339ef625cc3405e0b0c660374a29ce4ba8cdd5a5857d4bcf885e6c2ff4a6bb9b014a773320e7f69a9b360281bd1d6aa06e1bfadf0f3bc1d106bf31d82a556168614b1de9981cb48378415e66a6d0591fff11a78efb64562306048ae7532e8bf05a2e7c6e61f2a6dcee3bbc1299d1ef9621bde7d3caa177822f4104b20f8205efbacdb82e4568480c604bf8d86cdff1f73ab52dfbd6f8ea76effa96779340bed3057330bed029e87c900a602aa744daa56ca43ac1abf13cde94399317299cf1db4ba0410f925199ac909727da69b98e52f69617abe8343a623f3f77439bba1ceeec7eb02e975cc33540d37ab5538ab5e86efc18bd56ae19c474d98f41c90dd027ae8545179b0cda381f8af628f19b2bba0d19f1f495f6a40f9a703ff07e87a1fff2b4a9f00b548f2732a6d0794c60a241cd799d8e976d3aa60874a62a7a784d5a6ca1078ecad34ccc476ca59f92b1c9a0628f2e4d0146e6ce1d7681f56b6a51bc16d8048b8ffd14a070d9564385cefc2efa0fa099a277a82440633e49ffbe4c0483f5622f56fa566a0fbabadf11d11738ea6c6fc69af222e100c3f42ec0093e395a19838b00782ddadcb5d466caeed93ff46999e2c5b4e059754b8b800ef3c2117537597cc2f6ba3a3933993b3634405eb0f7fd52fcaaf98850ea1b8e8d4d18f8b0f34b642f127090c34eb85087777ac51339a256b2b3a412b0fafe96962bb29c688712a11e52843c3b3379b7a7d3d15615b9607a80fa1bba4426ab268c50b228a0421f3cc451ea73793d82abf7437a3bfef840ae32a5a5d71176f7f2f088d18fbad4597bf156b489f64dbbb695d38fa28aac44e910a7c9530f40c1fedce8d428a453d8d5a77d60d237cb110072c7ccc3694ff6a858794131a21258616d60fdcad4cdd7ef3ee730b1fd7fc7730195ff6fbdc4f9be55efda1141375e6515a8599617455abc3885f3b8b70f61723c5b671738f543bed7be91df1c3873b9c45acb6dea6e29a7d9e5ef245bf4177cbb17a64c4eb6380ed2e927867f8a76cc46c6f19d76c0371193280e2399e3216263df3930c6704fe23a48df91071207c463320b4689b2a14c8ae7d830dcb62a9989bea1560c48f6c4441f821e4a6662fbf261999b2fffd4eca98ffa688a263893747c996176453be34aab7f30a66922d122e4f1f7eb81fff323f3292b44f0a501503db1037e8443d937792c0cce3d37b20d96308af3fbdabd76468b24fa7e9e1ede6ed0c7afa8eddf72005f90508ae8835a962cd98e675e5ba53a4cb86c94e69775b1e7103fb7d64e24f4bc520f95dc8a8d8c4238c549b7f4e5b568a1aab8fbde08dee418a7f873127d9462b6280bb084f5b1a3615e6144f08d5f987a274521cf54944a459610ad0739b866c0c7b35ba02d263dfd70fa3fc365ccef263c7fe72f70c01438e981fef3450c04a9cd622a3173fd98ca0d690be880ba5894a3af64d60dc1f51ecf84ea561abc30e73c4a17a61781ee6438f05cdf9b19e659fb283c38d7abc639da1f010440379f3832b1c00bfcb2f27ca407e04f0aff77c0f6615636ecec91099d6de177588ee3919fe0fa88c6be94d61093342d3936e601b1c461de028c85009cff5242f83543acacf7ea74e90da7c84f823b75f3953ed11021434d14bbd2a484b3d94c7011e44db0ba62f699bd2de57119ce4241d0879b9b15ee8a228a2b3df639ebe8ebfd7506aada55c4b98c14bdc027af807f6b9030c0375681c08fdaa0844e850b9e5d64031c49429126ed0a6fe74cd66742d171cada67e7f4a12b75371be3646e3c3f7cd0cb832e0b86daf47b7435af4ec191725a181a86c12048e7ee2a38a6a0d6a7f1174d1376eb414e46ecfde38679149d6b99b7337456ed76771fc888340eeea975d158d0e986c6b19506ef0e0c640bba547a877180cccd6d9575d1d0ae484b84178eae848ca6d97dd3d2e5f29d61f402034187c773ef9e1a30a08c69b613ee780bcea17bb6856d74fdf62e7a42354cc6a88a2f45cffdf8220ca3ee1b5a168915c9d6ea0d872b38f455787231668091d48b1550e98eb014dbe20e57e75a469ba87a4574be76d46c190ce42a4b72668e2bd5e9bc96674fe1a075906c17dae799e99bafcfbb5ccb457532ba9cd0d4d87ac252b45bc3155625221ed47c5908e0f27e7bc2e478e388ef16807f13a216c8d5021374260388ff74a9cc7b115b700782fdeca96806239b17a8e5236a92ddee7e3b84bdd8f67da215c4106f133496f3e97390d7fdf1a5bfa64fd294396d5786c6959849665e0fff3c596589ee4de20f134f64624a0be7bd4f559d3f9cb3a4e901e6a400a086454f4eb024131a2352270db0c6a401c6afe1cd6ca2c9ca435783bc5d8fb143b1764bc92d5de4312190749e9386d9a2855fcfd34aefc05ecf25dc840188eca8a1ba48e3e37878633f2d38f2bec75b58c7f16193791f3a10b61a89928742a73d842b2847300ef127bca46ab78da5d73c846a463d2d3b1329451004fb877c05ff2f6332b34b37e31690c84cf29632bbc25103fa02837e4df3311eb70b32d25343bca9a0afba7694782ebc82f8d532df9ee49444c82636a32643e940a520a96a2575e6cba24eaae2d2692dc32848262897e40158c34efc6420b52d36f68d6e44613a5f06aeff3196912de8677214f667bcaa4d2749bf44a63461a4eb84398f2ab2ce85b8588825688b761bfe4ca125b7de2db6ab239f064c5a0bf27305adeccff74bfbdeb06d223e1aababb23bbf42c27acf64ef9e48c1a297d05a19c8673260a90f9254b2e10793be5e2901b197989ca4defd7dd8d8a23bac47b697c1ba9abdc270b78c7d19af9c695fca59e559365d9a34437f48ad118e4c36a36d64b038bea50e1a179589e0d65c89968cbb85de4bd2cc438776c9f0911fa58bd370b7a999c5f6852cc4afb411a58ba332e722e94477d6e78794065d61bb64846e8c4c51b756279c1b9255d883bcf2a5df0fb94472e34c20aaf4da64f36a383216fb0e8f8715ec02a2f305c9b1cbe613764b82be1fc5f49944992a71c710aadb85519bfae0e15a7027ee9f3f2279f2e15e751e2af36a6cdcb0b83a9cc24a810207f952dc9f0af5e273c30dec72ec231e38bd0f2daf800a1e9dc92ca68ff351b581f179ae812b16914a5ca934b2dc133968e9068ff7bc4164f46a7efc8194d1368034d83905ea3d0d320f2e25cec94610bf7c0321c1ef671b0bef2235f74af6df780282461b7880612563046252ceb381c4cf0a6d9b1ae160f9a38449ee5c97087534e2dfab447b236b660b9c9cfe07b6b7c1e6d6e6f50d12589d3b6631be2588a27b6e7e49589f3a9bb19e7e0e44921ed614d3894be4427dc19f334483bed6d60ac8c52c65622a40a1764b466b3d58b64d3b11d1f517a479d13b520bdf69ff0d19432724d98aa41616b63719333adc2b05c1bb3e9943e2868ae02bcb93076bc46c64f70756c08481fa95a53533ab5b8b99db2b7854dffc3f3d529e59470649528958a89306e8a115f496f934283a785bf8d0b82168bbfa1417f5e2abfecbc7bdccbd085d6a006574437fd3d8ef5e19bd904b0740b1a36d93b901e1f55e897796bf498a905207074d70465e52b60cb6aa08b22ca203f87df2be967bf76af7c96e9b8d8ae91b54bcde811b55ae6f72193714e260273fa787a7f1e0ae10119da118c25b00557f71b273d4ac0a0e61ceed095619157add18431d3049318128a013e2b7ea296b8f8917b743312b0055e32e61e04f4e49821286a121b27ce4642f1f490c8c88d1750dcf841182f790d9e3df9a95aa413c4e191d77c97e0cab97d01c0d4a9f04f776cb1c8fae479e0a1b650d8164bf94e44cd1e984ea41a7624cc9b6a6a23c82e96a14f5d9a24d776145da585edb882e999eb8c98424cd19aa6d6258d4b609c031f386e6f1181abb13451f30618fa3bd311e680671cedcebba71a17b448bc203970301bda0200f8cb0fb6dc6472fa01b0429e2b029680a536295dc837afce866e1600329327ef8fe46360166baed5559d6a161606a7c77dbcc756f052ddf91033bce1b264e317f5ed1e391544b4b06cac27169990c5ca25639acb651d2b7a8a267822d4054684b5fe9ab06ac9fe1e5bb8538eb10edea48ca8a0ac9a53a6100b3e33f26a6ae176293f4a7fc21b061ba22b5a1e57810eb81e3b7100b7961dba1e9f9fa73c9c3758b6b5a9db967bb5e0dfa02e028f449a0098d6e13d054a0e35ce40d1ab6261799b3b3436305631ab47a6833e2013386a7ef922b8f8e5069e4da253eaa8b16ea314e464c4df669fbcbcdb6600a8db16ce1526e39c00f19ef8115f648f1c295528cf77734e54ef68ce562ae9f4b9d622400207fbd4e0557c0d4a86003c66cc450c3d3beb6b11a78b7fd01dba19a194d6a166ced1e83213cda4fffb1027159d1290d7463be95d9bc377109e687559f32dc2cab7d5491c1bbb80008aa1dfee4da2f50123692b66b7e1a014ca66aa82bc0991d939cdfcc51b691601c2c86c8336ad5e9c7b1ae9bfbbd601693e175e465693ad1aef88783c5cd928225a3962b48095124be04aedcc5a6b21b60e71c24faab555a9cc656b19b473e4364dffd34076996a0f0a2bec7bdc36c3c81b5c90c3e7cbcb3837068ec831ab0f8621e689057dd8928b643bda5dd93f8c4d8c5da29475e9f52276b40c2d37b1bb325109b6ecf3ef7853504bcb8aba5dc3c7bca61a3b91ae3cac5aca0a1383a8fd50b47c86c5754213653b8c1c7f4a9c696144a73ea5be04743d0fc71e58d8e05cd62d33c7051122bfd9ca7d2e08fa9d82560a6b9173e37b3cdcb87a009a639c66b76aed9e4a607c43b284c64416b5ce1edeff7bb290f51dc4b70e628ee381477127905fd48f81cc7eea9b17a1c1dc490e0a00a7a1e833422b2cdeaa98e6bb77776373afdfec3db4454daaa39c37a53582cc44c84e9521eb15798fe17931f8c70ee45c996095fdc38d4d0ee8a5607d9704f5c4b4cb2d7b28bc3f29acf7f2c9355418e88394da043555e0c90d837c326e309f9a8f7b7174093010a80d258a4432554aebdf7ea437054fa12cc543026d4a4954a1e821eced5f9019ef2eb8068fa60d804dc18706250b030e0fc86875de71d9de3391eb1a831abebc0c13d2153b61e704ae733f47774bd7f8d77cd00616641eacef4923c43fe327825b3777ba60292e462efcfe30bbcba61ca3e379f06b53bfa6f16cb532a6324b927a7bc9d0fce02069d0588b663a50b8293f8bb1f400815a2132aeef15218475bc543dd854ddc5125086f0da557bc4b600db4f9216aab53060009e424ab09649a64aa6c57a5411a84a4ca3a1cb7eed5253d84fd6bbbf97e2451d5e5b2a6dd7d6ea4c225cf06f1781e4c5233aec2b5510e10c39df6194c965c49d9c14848bbb13d2b543ae712b1073e3cede94970786215aa0e7670d4dccb924b6e6388a79f88cecd08db25a541a934b98b7223edaa834752a950a9fdc18eabe8a79a6143747138152d7f2dbda0a372bdb12728f70618188dd06d2ff462f60787d07255c8621a6a5861ff634e2d59534a4c537c213d99327bc19db163f4de45a5652c60d4975132e6cd14f6d66f44d354f635fadcc4077969a2ae574b9dc0eab5bcc36a56fdc69a5b208b2e8187ca04a5acfb56525670acde85d1504dc990f15b0eac593090db0ab4a35be889f6041f4152e96843600c17fe0c54190a2b98da9c5a9fd14a24360baa8b1b28d68d56df0c5ce4dfe4df6bb146b68e6d72f144d77f8c5c7179bbfc304b5f770343de31d4734d4de30f2f57caf568479755f7ff946c5c3011c241b8613287f4a61f0cc8acfe9e2bc06413291df6e45543b8dda6a3b4f1d28ecf845bf49d26957cb02aaace31ac1859fdfd85454228675f6696c4d692cbcc91d7e732794d7ed072ef87ef965f60b2627b63fe2451e9e4c739f0996dc78ecd0c0fe8441508253163d3f0d8d7372755fc10b29cf4aece68ecb8271e363c04002318cda47fc2abb4f1a530c7ed27ae3107bf563b83822855193da5320fac5bfe1fee6a9a855e6c406d3aeef7ca985949d99bfc2f564c337e7427976afbec374a7ad2f803b5353adb8882908c06cb3a77014d6049dfe2750208f8dac90c84025e50bf1a0346cfd088a1b93ca4c4cdcb05775975649ab94bffaa0fd88215de0fcde5d9882b2e0f4cee333f94b1fc2361c5f8479e2153af6cf492f490b9fecd7f542749c9774e3ba610cda816d901b8ec03fb7b2dc574f05598855c78ae2113af0edd045326dde10d5be9593b473f1dc05c10ceedbac8278a01b06abaa8b145fbaae5bb6409573618e3972f123ce741f4c122df0f210311d197ec14f7fdca65330fb906108aa3341da678264445c5df4c33f067bde11756dc0d20d8fff6656e6487852d11f94edfd6aafa97e52f1f26730d5bf08a0ba10422b90cafd5f8c1d11bc6c4b7a109b60719c53e92f6bf2e1e9607d640e535440441e625075d504f9dd7f1c7aa0233e0cb8c65bbf4c7abafe29d6c5cb8feee6bc64f1f8bc729abd30dc6e59991f6426248725f7884060855c670f28585c1ac8a107a8f8be2c4b80b7b409b85ae9cfc36b15345b7cbc8407c42022f6d8486a481bc6c438af971b6d49b5aa66a44c35819a486702ce0e71211fd30fd1f2f5220493bbe624e25c868add939a4c6f2efc92690b700d3e80a84279ab9ed6ffbb03cb591c91b9c41fd4638d184f5839a5197117f9cd4aaa9681c116c291307856b87402dbc4507d53b2b22272db152b01cbf12841c4e81b3fbd4b67389822d8275dfe8d3e22ccd76e42af5e39fedcdda4ebc25f5f7c83e5674867c13ee35d5bf2b006b763ce39969ccc7b855265cca521c8ec19a0645316b84c0f1656f3c8b204f3c5d406d5eba4bff79117d74c9a088471509a33260dd86b0c80e4281697c27d18f063d51165fa1a0cfaa7ee4774265617e5212a2399f90150fea0e59ad3893d3ea8b06dbf20c5636d2023ae1e85e01fb94a5df2641e52655322ef1f10f5cde2cb90f265ec036117e4fa2a43f9678fa4cd6f1cc90620d02ce2f428babfa976a397d15e7c99f91626e371f3edfe571215f251db977538d979aefe75373776dad1f9b8122ffc8b2ec0d71f9f80455603494c40bc1d79b6b2d26aee679893b947111dc3f3675ea12ffd70044cf91f4491aeaf331ac7fc2c91bccda720e01cb78719a177d19cbd744fb9bd48946d63559875f03e8916aff4ebbc7347b1638c76fc12abc04b09e3d1f5f3a8c37470340eeb7b418e513a09084a72abee8bb539dcea8a13d997685528705554633fc54f5cd1c4c945ff73c7434f9a0b1e09bb6fe88c799eaf3c9964aedb071a7a8901f9fce1d5c317b13e2976a64091d6cfbaa8e63af56ac23270f01e96b66cae75e429abda957133bb3267869136ead06ac040f91f581451b002877afd84cf3b9180f4e0a722486c681932c620ca985ff1ab4cf40d964de2b4a2dbc5356968ef2ad9bffdbf579aa096be504c733ff510c3772c334f2f527992163c4f2c9dd15a3700b5578536e8cbfd4030720b2898ab411ad4ad42c23a7df945dc2172014284077c1a93adf408d1d230876d4eeefa2b95bae150ce304753c21fdb23d1ce7ad5e73ed65ef6d2eed941a19ef80cafd01ca11e182d6ae3c9bb562b351b4e14924c276a8fb7f0c9a657700aa34760f2b2d7b73ba371a01174dc342b1b6e8ceba999e206ca93754ae1bb5deec7ac8742f6606f388eca67f9d58a7921e5297da85d3dc06f5608095a124f1418487e80a25391a5fb10e3bcc47b9f9f9128855df19bb6e80bc44a0e9e7895894011962d50e9223683ef626908411875873998767b62dff8a833ae92a244c9114e3c1d67cb1074af7823791807dd2b9c00af16a53b9564a4ef1437b71d827dc8909712f9a8fdf1cf3e0f56909066ac0d285a1daafc5dd40c325fc818a1f2e31d94b4d00dc37f06c3b2869522106ad930b5a739f8ed35be00aeb43bd5ff74d180aa17f03bc31b3063ea50141b40fe46392fd45f255a2e846338e8b3f37a26a33f9e96707c4d5a84c2ac9574efaf504c49070b58335a39f859ee1408e286285d4b848259eb2f260642f7708c45ce7d3311c8b878e5a3f6a5b08e067223a91fab477d92ea644a951f9fa0efb49fce8b4d83cc74fc2f44a2b571d0a4ee23ed0296472c695d5fad0392c199391bda6af1c046ce32fbf73b8ae8bc095a50a511e3ee7aa55881a808b9241fdd8711c2532383cd5e62fa15490b45ec0aab52f9128386fbebd10effbfc08dd3218404de363bd48ea92d5354559d2c49532a316337ca9ab96148f6979b51bf9f9b0ee2fb2302811a524682225c7e7e31a793e1727cd329c948cdce80480b4d7117a03587bd02896b393e4f6666e23a5303216b3f445612bfa1014785e3ab43012b893406d4f6fdcbd62c868f3b28398bf1103f4e31e376152343b6e90789c31ebe7faa41a1671b669e2f0b90562306f7076b83a0d8c27f9eadf81526771f7fb2bec41c82e4f1ba1cc3e9596a917b8074ad184bb2127280508a577817fb8e74e0220423f4266c08cbde6c709c9b06ff006d828d38087530fb84cce7b69a11c77c9649fdc57d34fc56618cd5dc548dcd2697b7ecadfaf891f9c786a8b789846f76bfdd8bc552727c81bc84695203453e0f8f21652bbc9c752004ecf0dad39ec593750b36e4391ca024940b1a70c72ae0ae908b1bdab968454781e2ad2a3156aee18de3d6c37ac6311fbb94c8b7efed50be5446c8ba65564bbafc5c8966cd8819b690fc5a0f6f263bc7d36a4bc9c5f866d595a3770b0d98bbedc06bf132a47805fc43eaac91f05a781b75c4d3cfe8f2498fcdfb14091a8b13864f4a240be3e8eb3f7418e6b7686c4b4633a11fff84f118b210957e542443edf855faff78a5d9b0c575e4eaa0398ea49d241e7e1e4539ce47c8cb26b15d5b19b73b4969a6baa99751d8de59f7e986cdff617adeef1fb11d22191566585d5603b8fbc06c8fc9da5974665ecc4502a5c05afa4f27d7b39dcd331529b7e7c5147ea0c6926348c2ed5332fb491c89726033adb5a66879491e1680fb8a5625911357cf9227a2b2fcfd39243e762819867cb0235bad53ae51e4e3b4f735a24784ff17cc792f8062ed9901ee78fcc999341323eced4908ff1759b95c604e12f1b911706a4d98b75944f4b3abeb49511d9fb28320836db6fddcf9f3add2f318b6fda1b18b79081456c072f0915533e85450a8a84ad3bef9b9e3af0b813f60e4ae911ba535f4e7e885b663b6fa173a49938c6aa0c2235a0cb6a7602a10b31cf323e256f73637e70923a8ef0df50e60f359e11b75b6b81d0b78dedc6bfcd7568a3b456594fbd4bb2e9df45e0734fbd7b4275720c76e9c4e437c447233ef9c5467cd75750b0ea51c1430bed18a06a64146300635da3565dfb61b0a60a903fa351d7b2b5fff4568253fcb97bc81bd711b36c97a0c0af9fde29386710a9e823130df2ff495f784b79eed87693f01eaa6b444d3251aa3e41bea0d4cea129ba2d023f834cbfb9126d98e30ebb7d53cd0490fb17fa33ba26edce263a9d8ed05839c326241e6e1649cc96da0762fa2ab39a00f9e103f106a88ff8ef761e708c84abf31aa0693d53a90105e4ae5ffec869c45f7059df974787891faf483b0ac19a7e9dc5383a80d9be66dfbcd019aab6efea7a2888c6509c19c8d4cc8e893dbc118e839efcff5986f5821c7060cbd5e2e8443838e3640285859dc1749d8723f63dbe1c55d3eacfd75342b634af063b5dd57e6059ce8e45a3a92c9c2acd24b2c88bea3ffa88a532d4ed1b8172971b169a70bc1b0240658ae6cb4dafcb6d0f3c0b761ecacb98b4ae210209881e0d5caaa6e0efe81317557b25dd126e974dd268c0f8d2f38ecae78e4f187904646527cae25298cb4853278ef621c511660cfc7f2e421150bf93ba26407ab8f2c109374bf2abc663ecb020e3cff2824fff021be8d69e489c013669b7cc8a5bd9db02c621534b77185bd30f390d3aa4476a771394b47dc0c1fecb5abc0fbb50a2d99c44b5820d69f0d9a560b6ddf88c781ff9933970747a86b09994894bd5106c471d824e5566ba88498b54a120159fa55f2aa676f3c579fa07ab5b37776f214c1f2d03503504f31946dc0e0316bd0109597c2b2da1c91fe8d96108fe9bae0953a85893722c5ef9cc87ac299ec05b6d79c68becab77192672a7e163dd2f000697d4bffd6b23974517483f87b2e1cef37ea5f643e7dfef67b41adc44b36c66e3e75b80e72ed6335c1ef797bfb1e866f878362f697239e5e8230aa6c6c26748654076ec851b6af86d91f50920b6ce938d54a6e02bb32f201a9f6d9e0237938c8c562430474a8a7e2bb3632fbf4567391f76a47aaf75be9983f96c8c79ee37fa1c82db09e8357a6d72b69df85afeecf2c66bc680449c31028b97356bdaafa06f914dd29c6436caffef38dff657c931e3563a503cc44ea9b4d9710b3108e1e11a3b68e9cb39aa2361da7c5945978b13da16a97fa70d33ac187af85d1fb3f4b60f342abab13d4456debfe51e85282c5345e3bd629d02bb2dece70de89781a420caff1022feeaec826c17804f42f50f04db1b43f2a66ba8183de45cdea21ac0e06258c91759355b0d541d725a5840ba8918c318d28a447889bd886657db0428ea6a2f022c5c0b50b03d2d80e0d7266f273d21116ffcb4b2c51fa9e1323ed3c3353d1f4ce29b75f51ce609bda08861bc17fb9aa36e75c289616da372da700d393d831cdd40ec6d87b16e69caf1eaaf484f72683f49c3003127d35a3b6c1bc2463507c56cc0ac7340304af994d3e08fba87bc57267b9b1fdebbdfcaa22edd0b29c0d94ec63907f603db81c9cf3ba94b261f9eeb82c47fc070cf0f82bcf51b542565622ad2a41f41b129235bee14950c8ed1eb3a2707b8df1f0d5ba6652bc1f1dd328b24910b3bebe972dae6246b2f57ed84a08014ed324c7e58e91876b8a8e1a5d72eadbd295fd17f09c2d0973266604b849ee9c7e40a9ea902024932c40f8fe4f9375e0fa7a0d41af7efcee4ec56c70cdbb4ecc91c09c1539ef4680bb06da147be36d0cd08aa28f30de1f9d598126f33b0340e1a8254b274af3c477e58cf1be8137d3ebe5ce59543cab20aa452ea6b3df3d40ff0a520ae7f4a738fe2788efe52df2fd01aa7ba7d731d46ea98004d52aae02ba78dbc912fd2b33486ff552ff26717beade67c8d4e8c1abb90fa999c93b35d13f1bebe6f75844b066c27f7a460cec58d131f4c6e5fe2d1a68cd6a8887551ec6436b1df60916a289da96753620e090a5ccbe7bbfd3dc7d2d1c36083ebf1dc5b856fce07cdc07fca86a70e4607cb1b89993f61a7ac9abdb48d5967942516d948b6de9dbaeda7b8c963220dbfadc8a839c967dd7ba0410e3775ab705288946236d96fba2671fe700ccb4933b696f81e16012bb5a841329e85c79695ed7cb9511438f9aa2be3fbe2d59cdf426f06324bf93f845e547e2067525388e3a4deabcec6268d5e12e57e8cb1ed6eaa78f311caecba798f9720f75f6545be62dd75eca574823825ac7e45262f3af32460b2a048f049a71b182384d5849a45ffd158db947f35080a76ab976f65f99b724f9a72a73a6a2f87fb6fde5fda58cfa06cd5feaee4430bad1915ec4811cf4053ded4ac12adccab4d7c88d273ff0d69b5d3957cf4147a1e752ae8ab784d616d5f04c1dba6b8f418c67db81b39d53002b9d7193fd88c51c2c77cf371013553a610209b6b12448bc11b1374293587345a4c3f0655dc37f1ef736688867f3f8c4cc6b8a7040f32a003aea4e20b5502089cc6d3971abe3d55b48ee6e5db14108246c6b7decff3db041735b65a96ffc5217f331e6b3740f4c02565e09814ba7de64a10f180545787babc074d4a269bc5e47ce492bba26395d15c1c570c177b3e9cf32a77bb9180a420d319ecf14d8f695bd131f7d2eb0200244c00a9e5f630843417bae3abeba9cb06b10e32d54cf2f198ac4f19f8e88cdfd685cba9f6e4098e04dedee668f29de6737fe110465a8a592211a3f1f53797f877b3bdcacfa7308782cd43717102615de85a851e70cfdad6050263b21da02ba07192678d5439b5868ccc9361f8311b27c55e8c83a544d62d95b572c812392b927719ed1d36e1f5922571526a861240f4fd4fb028e74a02e0e30e56a3be2484eaa04a0a884f65984c6c53b4d3735463313b110f253e55dda34eef6a262ff7447a359633cb22f8b33cc129685abef9477d43251771a21c1eb3ae97be58996ce800ca1c867379bcf47ae15032f801886cfbb76e2cf48c14da0395c27555e7d550563eed4aed9b2763782f11588eb772e85fc5d3b8b3c49ccab85b1a07527f53b27eebeda86b54d785ac10f471afffa896fd5de54343dee135fadeb6e2bc45ea45f7592e7f20fa2ac7a07d141f0f97acf9f7ff3e3ea79f65ea51f7b193a248d2044fc73f559c7faa195b858ec6c8cb4463e75350cbc0f321f58e8ad319c45ad772b02c0523a55cc221c5110ed02896ee042c74c61a01eec5926087ace3cd9c0cde383ee939cddc3193ec254143a2f914b63e304499fe1fa294b628485f9b55e0313341bc7081e40faff19faca206db061e6215a431943b6213b40d49a45d27cf600027f3805bcfda77b1369cfad1fb897f43df5f854d707c686f11f037bbf549a48161ad2452ae1f6030235fdf25f6c34581415d6f10e010e3599db66b40bee5ad4d9d02270c125c4d627d04beb793d154022fcd4ef705078019e354c621a48a873967ce66ce328f4d62bed8d4888ab9806a24d33413b70789de5215693c39c4b2fee27fbf2e88da47c800517f4207bd6b1032f48e1391d708bc9e251e1332871a23d6e825175ca44a2fde578879803d69228a6dc99b8dd8bc60f96cb12820e9988ccdcefda9879fe4ee2edc3e50ba4d04b39aa92f97500028a43c03c5c5d28e960bbfc06eb91097903262a8d1ef3ed516ac1eecdb21de9ebc7e5050ab2b39142d5496ffca874e7168c3d6796f86dc447207f4384222266ab0f46e04846c17f651bfd37d7a4e157f441269208643f999a37a960b117cb6c7c08fffb36daf98d838e9545d0c364f015fc2dcfc4b5929724b8dfc807de4c303b09819734ef451d617843028f9a9f3a24fd2c34b4b6bc341b6a99daf84116d0f095d8694122b086ec411cd5368eb07c722c072e6a410d7a5a6530112fec4090aad9366b8c33c3117b921376c80eae0f9be77f47199bb1d0d36d03f22df223ab16540c30febfd9541157c1f087723beaea8f57b283a3ab92eeff5726aa0fc99ca6454972d7afb416dad2561129b930f6a3dd2a13a882417cddf100d9057f150ff70c73f8bb20026ce862ce5cf4c695fbbf3e31172d9a91758119cd79aac9c5fc504bcd039af6126e445bd43f44dfbba3f9e711cecfbe1864eb0a093f6ba284a5552319e1760743ae51f8a405f852eb6f2494faebf4bca0d829ac38736e5715340a678d84a95e9712f33bd5c9c8aea60abec1a17fbbacf6f7cc900b8238c54e6619a39b91f6c0a965d3a54cf49070924c8f9c3ecaf94faff457b5ff7c14c8e8d253b046a202c959a831496f7cbd78a5655218ab818037600c1325f6821be97db58c4e5ba753a58e1be1b3457a2bd8c2c2ad36de34fd68b4372f43063c2c6383fd43ed98f1a0fb9adcf4dd28b7ffc097e469af83d8ad1040102ceb9c959013a13d829c89a31c0287911bbefba78be49f9a90908703e9c6f37b6189fded4e2f64c4a78cdbe73c509661b3a9280183dfb7d05a706a922bec9d1d2984a979cd1d0b74dabc08afe54461da0e3afe59806bb70e601f46a19d857eec75b5dfb112f421638a2beced100ea1f467c89acd8ce8e2b5fa97b6f1a953721f06031ee925b6a1c301d7a7a072383399a374dfbffb3df4f264c1b9bbb6a81b95ebf0ee0bd924072ae373e0e742c0ae9420d0c3bd32cb6170f46672bf8905dbaef5e19ddcc115aba376712bf4e03b0a12dea4229ab88bf9d227f900d953d367e9a393b1575ff3a27435c710a59ae3a67d60157cbee62359882fb3c9dbd0118daa8265b8ad610fe02a9694f0eadce278ad3aadd51e4ecfd192086b472699c26dd6feb100c40ef6e70107a6e50b0cca3fcdbb5ee000d59bd42a4be4a8694162acef58a08d04dad32e294541aef5fe1e8887eb04474c3cf4d9c8f9aa4ed85f0cc030c615b01d6aeb68ecbbc9315da4d4c638e6c88531a92c87448a652143fc71a72797e1632fb94a93798e059f1b6f3d92c2bcfb33f3de733ec9ce306a03efa667a30a553e5e77f0ad028607f42becb3204941e39fc2470346ecc4ea6e0c213c8ba05d19f9e31f1a004b936dd038afc54d4d332dd2e1a0f1682d9459818b3d27d72fc0a2fed7ae2e66c8058f23611416aa80b6b02b5072eb124d3fee3cf2c744f7cb7b9c04058d6428608cc4121db1c5724a71a1486e9c144ab8a0a24f6d4ede8632c3bda326f0a4461ec1cb05abcb9ca3098e205e1230454b00d6693466ddc92a6f0d69200b194adf39edf2744dd3e0eb27af1fdb613e5bdb3f529a0eb41db1c1e8c9adb35a59917a11e9ab65eb0fce3e02d17c14d6da5e218f41c12c6ce03bb3e4e1b6c6e639f9270ffa78e6d0b23981260457391ee2cf4910a31da8fc37860ebb57437a87bf690c2e8e86f38122a56f6bf2437c667a1bc7031d50b96c44b486730f633e7e85028a82d7eaaa09be6e648536fcfda0e28c18298d7e0b77fb24254c270a4aa77dbf0620267db109f692e864bc9e2af4f1fafc329c39e1059629240f13def579887222a4a4ee18f5f8e37df1492fe7d04116bb9a22c95c6e41771c27691773f035d96a59d2c4f6b6383b1b033090cfb9fe4e0cdca2c8433932d371351c82fc2f1328e4cc6ead8a1fd6499bd2401e88af3dc0158bc9dce983eebed72a690aa922bf09e09632eda2183732687b5abb9b161492fc9045e55b2818aaa8ad41c6e3bd845ce553f8b2b531cf547bdcced1d42b496ad6d983e55545146540ed37a272d3aec373b6a64df3dfd803489850db0f129a64499b7060a8efdac0cdba69896c5c88c16a0915ff16e9f87cc9f2eb25954f90e2b9367b32c940301c75c07b57ba15cbbb3ca222fc9b988bb64111b5de4a83872ca99b1172ba19454fe12908d6d73be81070b40bfd90f643d538670d2882c1dc186ecaaecdde13dbfa06f2d56ddb79dd8ad04e36b797f80ba3a04cfd05c4ac0a5458c2723260d3209d3cf5a41015aba532babdacb616f4228febe7e9133c008916308eb059b806a5df32fbc338615f499f3095e4932b6e6c7ab59674a67648afa7184757cfde90b81b8031ebe30767b1ac57d53a5218e26558142a718baa2170f88c60afe7201f775c5ed03380213b5b06a2d4cb5b7f451ff0f3d968b850778dd43f4b06323dac9db42dff24981444a9681d9d6024d2085874ad7412d75447999deb351188eee8742f32b28c1b129f43e5221a24781b0c137961bdebf65a1ed76d52068431c3b9dc5fe368ab3ed679a5f1e9432e37c4465548a3189279201c02b0214fe18ea8cdbdb88a98c107cb52526da52b71ec56ea57ad1323be35210459bdaf59e583533083669009736311057af958136010627795242f4ae9f062b1310d23cbb96b4e2d054c23d46cac14f890664ad096069fd45eeeb4bfe39d97240f4328b215ae1fb2997bf0e6e47d0d9155051df268e2bbc4e1dca0b2e5be739c707e4f91e1311edefdb612a67e1f19e1d720fbaeba3de1e1aa5a9c513adcff6e199a9f7535ec31d9d2b28068e2dfd72939ed3e8f64e96b9ebc159d89bc2899adacb792555b78dde32529c5b2964cafbdbc70731a4b54666f09050cee6ff25dc0825d87d48ff9e42bc98882cb6de015237035e3b8d0af2b6208e56ed6f03ded6958be7f5893667b7b164e7468f935502d557a7a31ad4584db1925a82ebc9ee53d278345749e7887da0214310e436d24f4f2840a7696f148b93df7a6a9febd0f3153c5f7b77fd110d7059af5a4cb7cd30c051736f82e96c49ca490b4b59efaece9f513464ce7d9ea2eb87380e345ce8b933b53848048d2eeeb2afe111612d32dd1aa56eb7076a780bc15fcfa545e4bf400001164999050339f6f3505b8ec403e25844ba2502fcde61c72d67024cb841243c70bc1f917d53836829898062186e1760fb302480206eada1c15e0b7365785b8f2967bc8d716cd946696026ec013bf4828ee3f39f088b4b98ec2b3ba61ab2e16128b6f7967fc007d3d14dfbaa8b9809e931cb588b8dc9c915e97bf27f07b355ce1c0f4abc69ac6ca63e968e357b55804bb678a17a10b01b8e4c71a215440fa08c6bffbb325b0917bf3efab0c16ec9bd85e1998a947b9504361fa92c67c5d3c095f8504ddad5293faefb4a5900fdbe55225a2c3a420ada97f86771e5f1bab255da72c26d8c85b54684438e80107ec8701f2e8834e6d0564308de450a142789dd5f9739e871936d561277c1c18bb47d919c86cef2aa47fc5b0829de91dcb85f3abdb08829b7676c3af6553f8d960ef55b58ad5af1fc0245db3024e080e927bd3ba48ef190085fa33f7db32c30b20fa58f2f25fa18ad5cd25e0ceabb3ddb79f360bf4f2ffee3dde8f3417feb33fd5bf45428c08becd9999a5c2d50a3e10476bbb416e0a5a03448e518673bd4bc4c16d9005640cd9ab0bb219e52017c71923c075bc32ed036b26decebdf9b7ab39715caab03f04ebbf80d6747e23a66af67ee932d57e21d292e4c59c2d7d1201969434e037b57ce4e020bd822d019b9af89d17c1c66e7783e36c078233d893a08f0d13174b294145d95c3ca687a5f97e0ce7b1afc87368cc137248a95c11687c3a5b79a9a4b7b584a36e7fc6f811bcdb5f069c38d1b5f7de02cc6d78dcab4734734b678988c790b496c87c9411c148f3d1782c3628cf9c220212e2a0d064838e4b43452d69ad9aa8a3a147e3629abe9ec9acde25898c22c4b61140161c9cb3f8926b3f3446be083df1e3683aee4253e655b677f072e904df3fb835c3ec3402fa12b80f8e62cda64da2b3170246836cf1af810018f499aa0467646a86eaae96dbd5205f7331f4b58d95346ec823423dd60816d31a7afa071cfb3dc55508ebb18cba238d5f17b5753d36552d0e272c119e8545e4ed08fae223ffcacbc798be009effe65f42472e660c63077be032639207f6382a4a933d2d5661fc98050944c7de99e09812cf457f023e644937cdd972b5bdf408c2d14b0d689ef79c58f4e7d19a379c40ff021c02ce4b75e44068b0a5d551a9e93c518490f679af0846d058d7ce5fa817138cf461617807480a3fb0e0e0aa43f6e9c16675bd8edb410c8a0290fdf6ee64afb0e83e6d79c5f95dd3314e88aa7032fc4a4f2772f7f4a572297be9eb1eecf3adb43eab865abbf0434bf1a2428693b8a1a09f113f798f6a92d3b51eeef6f24f6a0549715fc52c6a82413db2703b3c23ab2b903c55690cbe354f34aea762be8f0c99c5f779034662c861db8ccbf94cfa5f0a366fc50ac7db0f07e9d7f96ad315024e19c7e6bd8e2aeb003026304063af2729899079c316f3f35060307cb180cec12dda2caca313313debdd5a5a8e3ba697a336395f596f93882dfb18ae6fac65c168834b970973e1a07fea17f752f0b9a3bf82cf954a005e6b477de30489d787e3a2ff008ef548b8cd6220072b0bbf4db56056f7b0c55f02d441f65f2f63d6ba105aebe97df66996597af5c801c743ea03f60c4a707119e1fa034acc8f2750e68d9a3ca67a7f972c5ecedddc2f5c51e1d40b5fc0963f5ab12cd2efa3d9f2f996525de56f6666ea277c71dc5e03a33ace2fe08772f8c90e9181933a13d9ce6059c0812455062339dd0f6a34ebeb5548bc6b95e965525b91ebac4487f4a94613353baacfca02811b694bbbb3647d01cf4e0180ffac9012b6040085aa2687f49ec1baade04c5086b234a48666ccd3cfb43abcbf2f779f821996b896ce9878db3dfd163c3da2cd320b8b6142320367ed38aa68e0e8be0bd7a767467125094e945302220e58c73571dd2fc905ba75c26d31719ec549bcdacb3d723f3055fde3476993ce2e6253c22843bfe09161dcd3a909df6ea529ad0268f22312eb69ed917340076a394946c007599bffb68f3aa9668ef8f499c38f210c3ea5f68cdb902aa853ca9794fd7913368f2301982596fc7f0814bd9f8e1fc33ce7c0d353dc49f167bf3c35fb3c119f1806ef49207907240d3fa121590fe5b2c54714b15f47d6380a355837770c8061f1071d2a2aa94ba2bbcabe685bd5c533f3c5d97ce60a416c818138dd71dab93e4e04da88cdd2a9c06b9920ab0c88f7fb83a12017b06ebb88e67721cc958a58346251880a80c5a81fad657cf40124ff1ac2406561300877f334a018e4852fb05781bbe697614aa70e1fe8158352df8b83cc5909d4e3dde41bcc50b2c851b912c8370f1432ddb80559148cfbede3ddaadfc8151354b91f0227de22eebabb799e0552f17099687f873672293bbc8aa373f5a6f68af87180b74873e89d9f741302c3d24d0e9901727c6d8d3976a9ffb75737bfa22e026fc0df5c3436f191f6f700f98648c397c0b24005032cbb78f822c0e5369e6d6ea9ec4dcc3c55ec031cabaf5bee96876fa0c8f9012a8faf1eb19e73bb06c15ef26c7aa659bdbebb5d78218217e3ef9fd6e516f5bc29d62c2270b12f33c9694dbe01b5c1bb8b6b4bda504eaeaf5dfa06499857dbfb98b31207de414d087e345b80613ec00bbb0a68a061a41f39f547a18b0163234c092c9fbafff30067e50c0de765ddcdf3be796657231f9b149ac5f17374d5ab0399d7f59a364355eb4ddc96001cee9e084a0236cba84ee8266c3fc939e6b8617ebae754c46f439e785001427a9440b992bc48399ff948a7e9ea9ad4b199e3068085ee572a3416c3efde68789f70f4f88c7eb8b88c58b15e4b0d1d8705748cb47d6ef7731e91f660e00bfc22f05dfd815767d45b9832d51cf36623c8fa773a9444db506eff114712acde3d25baad07cbea2609968be66b544180fdcd450c6893768b10bd781c71494081b51c121cdbe0246f6e3529e3d4ee387e85035909d4f72176c65a693ec6dfaaeadd582e75a1f0d40547860353f9161e6af66c008c6c7716e2a3e71139488eb51f4a497c5362cd179cca215b3476bf8aa475027f2d6d99f03e69a1a09650d70bcaa4e2743f1a5eb1302bde1c7e1de3bafd9e1b9de05c2cf5cd6e0a21461b111bad1773e76a43ef25cd733e0d87077c301758aef9c38f772cb39b99e5ce42104d67a7d902387d2db87793fd45523ed0a1fa63dad2aa6e5a7b35ce3a637bf9cb2d9b5ef376f0db8456e9a6122d95dc02f7c63c9becf357959caba927db40571e41f41bd5f52fce1f56d0517f65d803cf97587fcb445f610107f415fc8d4ed6b08fe8b44444fbdf6d1835991a3e010897ace16215effbff9d31448985ba15cdf21eefdc9e4d8e1a8a9831cb2989c1ab9a716e827b8671eb9d73e15619516446a0db6ff9843cea4eb98f263a9473e634aa1ba2e9aee7338f657d2b225c542cdd59175f6d852890654a1662233986133b88c33a656468ec6b44cfff8b816afb28d5fed6070d609f0ab8eef085dd5fa86c5910b69d5760da70800f6250e90e467451ff2b186db5126cd66c6bd435d12e86a389d0c695677bd7c372fabe13636449e033f84205b75d72d2ce94920f9c84f14e6db7bc4631bc723300dd2cd24cbea60ae5eae229569034f55b2f40916861e6f3c32430cb2d198a0273ea35b27c761710463fcf8dba4642a540aa006039b0f58b650a58f9550cb16500429403baac1f1d90ad9480f9d464fb20ec2166f5d6217a7c4a864ebb1e733d0a32dbf41f0c4e10bbf3f6958d778ae8134c553db6a4e3ea4e8f177ffbb8a959a3dc7d983b10249f86b9f371f09afca1a1cdcbe99a16496b397b0cec1c45229292a5bab1ac58ea048e24f12ae1160b3fc2075f0b69e90a1622f95be106dd0a3e4278f410c2652fd1b12c9e0bc7713ffa5d13de8611c8e26547a241f0f83751e5543226432c88c1ad09fb8d563757fc436ea4d67ac310e9a4e12d19886352a58214400fc42f6a703a4f75a0ff0e6802b4862c5e3f7edf7ea011e78e66464b74b323dec03a24af64ef105540e9b6783f3842e7439c50ba07f82ba8ff8db3f027d0b679aa34fc753e0dc96393e8da661ac5e40308a3392fb1aed2818a1ea5f86d6d9b779b968ced3ebe425f6d2e25ff74b6c67c58c08baa7542b0e697320c6d56d4c950cf52a0b96f9ac487c6048e1a0705af40350abcda7522caf93e26374fa89632d1e96af9f19b6d477e54d99e0c55a00402119536cf80060831e04e70e65ba87f335254c0ba4930d303ca1c11bec4a706fd4ed74dbedea12ee280cac494479174dc3a88e5ab40bb3da8dc9da11a39035724f8bf51a58a33b463fb23f67f06c29e5a67c83422095d8f0cf144a4e2773606a07afb48f08d35c8abc0528c65b357704c57337db2cd3855c95916bd15f9d791acd239388e63052945663b60c5eab7c08de5d417f05267a9f8dcdc2e32feea8079bc61df1587c4ab1230d26675ddf0cf6ad4fa07b4824844c4582ef64c83a490c79c083d49757e5f58a94ec46854e43b16eb5bcdcf9b98b32d3802b70b65cfa038ad2ec7c051617f7ca4420809343adacff604f17b142961bfda0bd835a83f5a4309559feceff6343ea1a3480faaf9abe5d4b6b084e15bb362383a7f29128fe388a82d66e377221e226ff35b4c41e48c25503e14af544b1f0878288030529e3390ea04a17bbf9fa3be0e956751a148244ed4fb171dec6f51db7d52b1a8111c6a9061167e785fa20e870e25f4b427dec06cebb4a0a6587dc0618ca81f81eb76f8f22133180b17ed52640573ef777734a16ab752b448328bdd2e396998ca4e547a2cf8834eda52ed6d9a9b521c0c0a13a1042faad9dd9f1abff6d73e389f761474a935f691984790c84553db3f154e9fdd75a357074e6a6a7da0590f886abe591a3d7f006f47de508213be70f1c50ef097e7779867f16e7053d9f2c311e2037e09a5d0881db159c3f34adb51478fccb524fbba0a02d82272b8a85249ac46e82a9508cc0b6918d0ad167154731222de52749ab7815f61551b9f04bd354a3d5e80e79e2ce78e5525f676e9aecbf5b666d699ede4dc1554d909bb015863c0c7773b79d69413439bb415ddede1906e89f67a25ffc79ee4be6e89fb89e6fa1715dfef2865f909a0c564d5e17a9aaf392c6dcd122c43eea3a60e20d3eb9e29ab560a24d3b9c232837e0afbf4a210ef8f7906cc477520322e1c8c088fa2f171c1cf61c7d44e91e3d13ff9a29bc9b789ff51f96625b3fab09b79dc7884b2ff5e3d2552273eeee866131318ab23449afe497f1e8f9c3acd9c8cfbc792bf48b32ff550b0ccbaa0229f789f024e468e21ec327b9e836c592c04e694896bf3f5392047296e0cb181b8dc17f4cc0e798493a9a91e34320303d29ae8a3a0ff9b00c66129176aff63983fce951a20cf807de6e285ac77224c515bcc0b400387378b7c32ca2e4b0881064a701d94e68ad67a7ed3f7dd8b3952615e3b3d827b0a8c9827218589787f69fb06f6d46a056731cdfdc652626a25367f8ab9ed9222590dfd839946e27ba150835cfdf1155c919a74c2511312f598f623aab25d3d3effb193e34f1b8b830388c8004a2c77b83259553191e9a06650ac0259e27fde3c8a5aecce6f1ede2381861482ac0ea164896aae5e73a1fb7395a71870e1cdfd54148104ebb98b5f7a2259b14c7262bc55b5155a4b27aba84e47dcb37b33337bba6b4afabe86a4431ab8c42cfccd6f55731a3cfc9e5040a1493d43082c541d2367a706dd195f5fd1984737c5a1e652ca8b49b219af22a1a50f2e90b02d337fe4d08f8e4bfe4a3373d1fd4dd67bca579ab71f8a4475f5f6315a02415e4eafd0b8bf76679a59942500748959fab3680fa942f65b69921532d49cc8d6b1c460936834eb2ae336f72b607b0ec0dd3e65854e254fff8372c64b331fa1959f0f2044bcade668fd28ad52e6fa849eb0d2a3bb99f8d45def389eedcc45c698186b5f9c98902f94d974d1e07afadba7fa54c7355569623dfb52cd18fa91d4b417f6dfdddb88e68ec9d14dcdf11d9ba7bbb6003a16268f02d9d89b05c644f2242e0fe31cb086250a9ee2e1aada0fcd8ae6f4b014a80d6a030c031d341c3931151a9a6edc1e7eb73a27c4c0f0ab0d405afae08c588de283ce08b8fd5745f96b1a0e38f89ed3aa555bb2c28fff66573fad4c1154d6a48e8197eb4bb7377ef77ec59548e6aba38459c2a7459fbf7a33354ddd99b1ff70ee5ecaae256a3fb92a40b54f28d01bc8d44cc59d3edda67af681ea4c107c1dac70b3efe1258fbe08d22fc591275e2c2977677f27f3b37c74f097cff2f15d3dd01e872ad2da3f20800844acbe82348390a88900595610fa8c88f1f7695738d88e20774d0f04bfd8ef0ee491076a61b4028257c18b1bac2978925842833d6153bf7771b499221dd81fb31d730c7d6b242f6918dc92e834a56519df135880fe1e54631502940599fe5eaf89131a01e82aae3da158ff91bbd40f51d6593deafa23185ee1e9658a6cc5d63e770948e96f1e9218ab9c87a4ad0064c18f07f01765c6119842a902bee56eb01e3a98c1815fc98c3fa14a8fe6a8886a0dc9000f7c1656c632be82434267c3c5bd225e54bdff808ef07258d21f359ec69d0af5426b7202b4c310fadb042e6dab2a4d142af39dfed12a8b3faa958a3e90f2397aa0038635d1a286758ab10d1dc4ffb699e00f81a3662ace93dedf75cfc1df522ee73d89068fdc8da4095d7205c4e946922b469c06e3caed817e334ad8a2dd79a7b805bfbed020a9817bdcd5c1ce244d693b4982245c25f11c0d9278c7e7ec337f2b3856ddfd042219d7dbde46b9f4c40c147e014cbc740c23828b96f13f9e7ad5d747cd028436297d029d8b5388d51c5afe2315d6b78826d9b8ab1903fcabf5ef340aa793e8e9b013f8c92459fb7f458f500992283d51bf6fe3ee53a3282f7d8d2992407264547cf701a889b909521502c4f68f986f6efdc2d16b2795bcf967286d87ea8c4bd62178baa4168538a923dfdea4eff01a7be70687c7351c9f8f54767920fd8cec2dd18b77e677c70466fa3df54e14f3306c31935bf86df12208e57ed81a244961e50017cf0353885a2a12777523b0dcfd4076e578c9531ccd9d06ec179987c5fb987b71ab70a8b80a87137905e0ee888bac9fb1c79b5e2fb6c73a6bf7559fdae11d6ee91e6ccef2537fea8e9cc66361992e849088c4eda0d6ad7d51bcb665f3847b6d147e12c219f7750d00bb920aa8968bae3807de931f705f5a0c11a1f7df3ba89be09fe7d451f5c315a3d1dfa22ebc2ecd3e7ac3a4f856d422b0b9fd01a64661f4cd13a73c702cf30e994fb65513392c710e2c6f63d0c3f30fb6dbedf617725b25aea71c25c6e53d6e77dd28327caee0034704178ddf0b44dc7622207bdbd51efdc717bacbbeec975cdbcb8f5ab8e7428fee20de40fa2c5b866ca0f03ff9014c04a2b0fd8076d377207ef322c3ea8f35cd469be011dd6cdf37b0765beee41d6c7dab87635dae46f132b5aedb29ff653c037dac98c4a7601516a285cf2bfee05498dcdd03477dbfe8c7f43d8b6e29eafb1513c323a140193738cef3b3727038fed0ce9d1e7b745ff048755f974411a1eb6365fe9319588a714331943a4330abf4a19b2ae1da558993c3b018b032682b437e34b15b80550d0401aff88d7caa081067002e288cb7377af4287694870912585bdd5903a6bc1ca59ae803090a84ae40a5f4f2ecaf45052c2bf9976adf2e12bc59d307e8d169303f4298bb7e90bbc122beb8d6c33fbee7b2455ca50ac33852f03b25a1e8a906ef9b4b0ff121c5b898a626fe75890f1c52eef177c6120dedf357656649f302bf84f96028b558efbed07fa4757947f5751d0922d7ec15b64b222c705d896112bc8fd2f6758b31fa2bb8286d889fe3e4091e7265c8c0d005f14614adb25f4ae473df1c2aaa7cc417272fe6c3c7b0f5d346487e76cc4062aab3432ef4019d50761a377b014eff78b778ed69f6c47db2336462540fd6d0b4006af3446424a51d90a4d794ccd50e01a4e846d3322ad83561fa3e151253bbd116e3ff909b748bf52ea8637a3c95a502af9d62e15f5845c4afebc4b54f2d2cf564815a451e34f1179420e59b246b8d3d7ce67e52cdeb0b3842d29f347a0da1cfc7c7d6bfe6b3229e7858f209ae1fbef788017fafdab0534472447739a1dbd4e1e89aeaa276573daf4a1d7fb5a16eff7dcbbd06ea93c4531d86501380bb81015405b75ce62e2f363b826c8256da101ad12a00b5bc0078a06e06960d12680087de558844231d26d0a740abe793b725e9389cd66d43d0f117adeadc4cec14247ccc08929edf09b3fe0687934702380655012289eed645e78ca17f1642cd5f3099efb5f07bab1b061d2568e942ab8f98de1e067e5d8b40150a9cf684c64a3fe828b4dd3249ce9eb4b6b835e79592a1b818f027f9ca29a4b5daa407344cfe49b41f2265d07256b4472dd79d921f61bf7e2db6dc1d39014d1275dd922876d0a6443fd2e21289d5ae12161665ce9284476ef1bb639a6021042ff83c6bcd2caae21e91bd25672c246e19a3558d788dabd4e602bb9ecfe11157023ad960b5556e1703f33f1779b3ecf0b4048ac259d4c16db25f897ed51ed013218b0fdc45d3871ccd044d68fe0016c36dbc53d62345119d641a0b399994a060a40a90e77882aef88c2b3a8fd2962401230a2aec824a69903b67de2ae7f71c8e0a470210f41082d8e58ebd2ae3b671ac1d9e0293e9ac444c08c4106f1bb5bdb2686bc38677cc2f8f55ee486aa02928ffa33d096cb070d3426121b7490a3648aa1eed2a88f03063a76e6207d2f0f0eaad6a32433289cfa476747ee69367d5298c85819ff974ee640435b224f72dec6d01cdb7cc9a73bbf2c690f8dda0902c95dea1fdf81443c878b828fdc1fec317ae4115348938bd8a0670aa7ac8e49efd6a961fa4603b098e27a38a0d205dbb91ada206426c0be2c8fd9350afa3db0d4932fc8dacb4f451f6ba1c642d57a7afc75cbaca268aaa1c393a95edc9eaa69cb7e7bab9ae08012fac4f20e30f2c4ca8f0655a94e887dcfa0ea31d20125d45e9ba68bc9cdee33b08d6554d37c4ccb41b8242360cac19d1fe55987f7423c4dbead196b483659a3583aaa02537e595005599d3e2d1faf889503618c167acc58c1aff378e30022f709a8087ccb7e23c043ffb349cc111e2997214b78bec656027392d8e220ac42b69691fa4e0ef4df03f9ef361ff90559f18d1dcc9b06f3de7c729b7e505bc41f2a44ed7069f38c9c2cb256e7c9a255da9808c55ff428cde19c6c2ddc1876f89ac275c6cc5b1fd260139541eece48ebc7052881f119f7f542c2fb2b681bc142f9ae0b5b9921ad3661570f478a2033eb0559ffaaa49bd408fa6f3e94fd43872d9ee1de8dccad830d35af25ff46980f5ca9e187e2bcd0a67bf73e77ef95c83341e87be3483a4d95a55df9fd996c34c6a9c9182073812bcfb093c68d9cb7b10d45b8c77e2c7eecb1a3893c047b4f84e39850b7cab0b42450f16b84773501cf90b2bad0dcdcd6d56fb12de877300976be74a29b156a1f194c2c47e0192d6280a4c4391cc36fbe2d2ec228b5ceea7b4bb01da7b814aea03bd0355356e9378aa1cd663c2d5c8a5c4ad175c02ccc2c064ad0e105863525fca94d0e14e8007c7681b611c2666b222b2cac6176aecf60e4001e8ad1cda40ca08775b7fdf613f6c3292f29b887ce74e41875c6a9f19f9ca7a3a8726907a6893bad866d5b4937dd45d21b0942fc8ac0f9c3a8cc864407a8d7104e72a9e4cc02d001f3065314c0aac8e08e0cd46351aaf44576523256ffb0a8b8c0d78b4e7e540841a04830cb6df7684b0990e7c944ed8ccf3a03e88cfc7cac57fcdc084477fca30124139c301f96ce81e865e3026dcf1660d9a5bd6ac1e092fdf14412f8348a703c92986d6b86ecce71bf2ab855b918bde9a408df3f03fb09700a431065db35afe46f29e7bb19a216126fd80c77508424128fa26fccf57f3427649e56f6e6d0d4bf5484bbaf416486b1404a2c80bcd65af158cae617a7c32c0f795410b66cc98281c99af9be7348f0cf3e55f8384e7cdef6f197660f207b045c27bacd68da2ef2ae8f7bc5234940795426e65380c140ac481e5265888dbd475d4bca2ebe7a663555934496bdaae917b8ed41ec8646a2fb876231642366e485522548d17a365ea4eac8872eb63b1b66ef6550ab9ebaf61ac1f5a43c7104acdeb703444914d80fc929954aa37a4609dd4f271c0033bcbe7131def8571cc58c064f5ccf4d64c287a26fef43e9515ccfec92cc3516b05a6467d64a0e1318819f11022fb08a1c3d1de8c0257cf22c00b8e521e0023eb1912e91e71933d396d03c419442873ae2b415c950ca231adeffeb7f6bb4f0216fde706baa46d781059f47091f7e2a85938a330629dcbc73324cda0e1d09371c249d06e80045dd54fabb26f8031906f529a7f70037756013780e7f56e9439f0b8dd81c0b88ffc989a1482ffd627995eb3aa3ee65bd917b6e98f9d5919361193a8e632d2fbde8cc8a4e6dca83769fd55c7ef01000ffffe5ff2033f5c946229e3dc0cbc7fa2a3d17a364cfe005a831da9bbed95e81d8b0d69160351330f8c8769ce6c1d3bd1029a72a30927b76b2b956d52167e517cfdaa366cedda22ad0feb3531758665373feaa41cf31371c862c35fb693aae66911e404134e838b2d2a9f47d1d82549f7b1c90b9b4e0f1d1ee3360f31839cbe44a20d2b8d28910cbab07398dd759df8dab386f66ff650e10a2becb4f921b17c9d704f291ba8a24c5526c29d6d72592e08f2687d262077da7b355bb6fe943d6f463749d7507f5e909764f39533d7eeedb266982848693963d396cb822218aa545cf8b9e28cab89869f5d2c43abb5dd70545e089e06cb1106c78eba1888eaaffcafed76ef995c92d58649f45912d92017f322ba5f7cb884d6a646c54ab76ec5e0582c11e8c58d2c576c233f7ecedbf55391cdc374eb4f239913ee3719d74dc4d25677bd9ee4cdddbf190d7603fcfce3c0016b7392b74aecea43ae0717ff4942a08b70173147bbc3b57cb2e0d0fa007cdd96d76bde40561555d07caba20e04104969c2817bf2a0bac485a9b5503cd615f2d390a79d822ce51d2e76d49bf47c049670d39e51a0413376b0ae086a1792e6ca741af20b2242a6be3001ce8ac8cd9783cf4d010cbdc565b4b7c52d108941a48b9016a6e5c0f827ae10bd2c28937346fd53903073449ce7db92f4c698d668c87051aaaf403656ec1690b6051baf857ae39cb59e4c54a7dea25594ef90bed78c4ee0347f9ab6b1d4ed6a315ed7252ffe05049ff1263b193ac1c734330e228aca3c26f127fb84ac5316510e98c117abd7d42417cf83bad273eb01fb9cc1d5d8a578e95f4eaedba27f155efdbfbeb23d418e76e918e3baf45f1804b0f969d2113ec05bd9202805c23e315c3c0ba50daee86e63041f53600408b7a2aa94eed109ebc89aba72f6c11269e7fc9225860ef9d37e96ee455204c3c19a34fd14ace204aa79d3c010d555f36a32b98bd76bba6f72ac7b701b03516e9f703eb7e1e27e74549b690bfd27e6b45bf1a88a82119119f4a91fad2ffa8180f05fc8bd2164279a83f093e50e4f1aab4603be28527dfe0f7820a163394e7ff18e2f5ef79a54c2d3414bbf124bd1296285f1a01a226afad81037654301ae89d42e044fb468b97ed5a40310a752dd8eefb6b72355853f55a449eb3aed149574cc29d0c634df69430d53d49cab5371b0d45db55613f58d66c86432b701a7e890f70d2f288560415bca22f0d39641c7eb78ffed957e69cbd8e0414e998dc57ec2447405e548a2dea714a9503bd76faacbe26d250bccbb74b606ac58f64afbdb2de791931bd872daaf52bf34804f20c6d161fd68d8d7b1e6a626622c9688b9be9e03d64f5046d94df6765a10cefe445c9d7e6ab76bf832eae3ced4d40e331ece7e97652f670231dc6b9c7fe1c896854dec24bc488e22cba681923430f79da8c1ed8e192dcd54bf8921198eb5ac9fcaece1d18377d673552f798f81f433eec0bd2bf11fa7e0ff22d47d3072e766dff88d9c84b673cc3e29bba6e04f73899f252cccf4353a00ce0a8a0c88f18ff4be48daab37a7f601a636096a1f260e560268af0daca180200639c5d670bbd4736a39e961832ad69f958d50a51f1f19ba22861f9dbef627b4df2eeffcd40d8d58401e41916907396cd1533ef8f7da23fd292c926ddf7a39abe2c1fec0ee058f0070f7ef34061c3ab1e4eab9610edfdb63f737df5d0541b071229a4579d1b209cdf57393cf2286829ad649e999db11bd44e9a24c1a481cc7cf5ad1d7c8e6e49fe6f0e8479bc8609555c60f738cbd33c4606bddf031f62fcba1b731fd4268d29275de13f6ea2bccb986613fbcd3e2820aaadc87f29861ab358093472be2f33d068fb80fb539b154c03c8af97349d647c1174af528d13ba8f66739b8d1b57c11ffd1b92071207f6749781ef7243926aacddbc58c00d4284efd7eec438aa1ae97cb089453e5d529f77120863a8e6796afc942f779e99e571067d9ed47b46e5865ac8b271e21477457b5ff095700d2e5af12acee5779b52a15b130860a87625841ac8cae3086d9173b97785e689a544e219a184b11ea9afeb0811cf2ac32268e3b036aadc09cbbdd4c934a7c5110922859ca9eeff8875c042026b0bbf2cc48cf680de7d4f62db3e97fc6613f5ae8291feb0215414fec77d2a9a59da682fe663bc72c34ba58f4ea77b94a3d68a2e17fb505e45c7d9865a7bc42a3591c8e679332ede3695d21aa462809846b659ef0cc3e2b6668c47ea6b7dae7c1e17d3e1dc80e5c1f7eb876107c45a6f768fb57aa9e201f62e4b43c90c84a295b77b95296b10b7041ddc08b7fcef47203e121dfe0e27c9b9a560ff32d3ee3e95310ca0db411dbd17935004130cdd8970aac7ac67b50f282a1d626149d4a10313f396f91f26d00a63c54f7317222d2ae36c505872c62375807985fbd516473aacc9c06a213bb46eaf1aaa9b510cbc3102a0a63c4a6e836eb6a0cfd8017463f0814f183789e2a7e2ca984c266bd91a1b0db9a02769585ac2df4e6bb280adb70883b840b8b06a679fa4fe08291a9eb87e14b8cebc4e21fee0b1ef8ce495413cf209aba9b3f23675d9fc94ade401fdb1808c372957c34bb29e610b61f368c7b823233d3a0290997bd8855a8f108494a8d2f0e05d271fc81f915d1e76823ee47a2477bd88a13d3963ef3c6019080314c39d086c82115e5995a214022e4fe2024d22fdb2db436ba33d167a166b3a4169c02d867396f42cd41338cd738812b9e8add6b23aea164df3afb6a2d199e03c95d99738385bdcf3973b65672756c5c8cf74882037ace2181316b12521f28085ec9254a2e22a7181d2d608e09db7251b03ddd7a926e73eac40c86822aff452d1e51433f891e6df21854dfe47200ef8303bf8c1c28d04b0f5a154e0f807c1e1df57d48a470b19328c2d2af4d12801836babd28af2491c771b5b8990fa04c56256362dc63fea906304cb2f000320f10327a4cb35d7e32ce9cddbb459c441964a7b55b70ad8d81ca09acc18067975bdbdbc491ef0a7e103ddebbb312bdc9c4b834a1b7be5dc63eaa70f32fe9aca929b9bb52b11e9813934a41437ee2f3ffcfab97db561f6e134b2e1ceb6be291fdfea3bd7e2fbd97d7c0f3041f4049a3eb33e074d0459a5c5c1d5e936e248702a00a31b90fa86b66660976e971a8338e192f65d651cb826641f0f3db724b0b8d13f5c76750eeb98b617fad25800a18041b742bcdb74ae59bb9e04651a3bbcbae1f6823e363e77912f2155f80b4fc381d8ee277953510d911a0f187c4044a03d85354e099321c73cc38b230fd47d8ef1974e3d834688121809107cc791e7820995445f9989a1b8ef697622fa155c70ae71567f0f23a37de7ce89208ab677e25d83562a7d367dfe0bdea0a9eb9d40566c2339cda1ef37c421709300090d24e86c75fb4e8f0b5da1600927d53c1ad2ba8f5764c31af35f2b5e9f86c400548ff41dad4a3597b28e22266b1705102987ffe4953c853f5d011b836272f4a21a5cb9630f5374c894a80e385a926fa8b1eb1ff004cb226022e9cf64a1c9c5bf455b144c9b5736daea0b6cf0d0930ae8598cc1368947cb019d7a1d751ce05c21f5beb2e2e8e22be958a5970220588113b968fe835799d347a8538c5c64297478282e51934a3e0c3eca8c2aca5f6b37a64919fa2e9589c2a798527790325f0a3a9242f58edd06bf584812346e7f32973b213ca31140b0ab6db3f9aec81a47557c7c84c75f972c98fa81644e14bf259419e9cadb814480e776f4ca85e4ae6dc296d80218341ba60a52f92ca4a58fca07c1677e00e5a70f85a8df9d8db1899d1d2efeb386b9a6d2fe63ddb25cb8af7416e47d7651393b71a417350c9f341996d798f2b11ada5808938837dfa41d0ca66089a5e02d6d29179fd8ae1402d36925a47ebc8e20e0b11a206932cd008a8aaf84ed3b9b8a50b01a94108c47cae7177ea03c597ad4f22357eae45cd425a0fd8a8e57469bb171f94230c4ac3090518d7d3158786f14415a005ac8ce00fda4a16cdfebbc0e4233d25db6b4fe5c183e1047cfcdf29fb0bbb00330c8f8621edc2f45b45671772c22b43b951355a2f1c3ca0619ffc54ec9f34a18cfe34b898fd1838fe07498b2ab0a35fe8608214a8d7c863b075debdd5d2f75607b12773a93cb3e7f5a8e3bef0b0eaa9bd9c18a4f7eb696ec7bb807745a405ee0c1f81e7c2b11b1ce335a577e51d238c0a8a3f90a7a0178c351299c13a451a41cd7dfa50596ea5ec2584c6ff466b29e62237b4e5d61f272cf895d0ad06a0230a3fa81ef25ac62f0300f949fc616bebb4c6945fdfe573192bd919b5c3452a4072345092997f734469eb3ffacca7148a9f1812d9420f316bcfacd12847e3030ce72aadefe7fbb1caf9bc95261f941c6a1058f9445ec92ec7c4b9f9867755ead862afc7f60cdb8dbb05e4f7a866ae62238cd89e6202103cd353a61fdefc4a408204eb959b1480b2af2611886b9915573ce4afd1a325eb7c23c9f6e525915ee1acca0090238a5d88929203eee382b602e68cacf5057b0fba48e68191d3018d02d452e1105008b3afbcbc35e3aac741317a18c068fc5c8e76aa5d5e425f535a09f83dc3ed07a7b78ed2e8acd079c1947b14b3cbed49f204a8c1b6a558f342b707cd1f412abb6cc7cb426f658b7e69297d26aad9a4b6ca1eeaa22e371bb1dbd93f9b9b4b4819433748b26aa0eb8ce966aea9aa2b35d4485b19a8045bcb371c33dda9f12838f18ac479b5daf2031d6714a4e6d3ffc108f5ebb719ccf3d8354818508ab2211cf4c39282f5c59c1fd9bd0d490b847ecf9ceb6543a570b82f8977debc83109ff97a94a577ad7ee1ec876d7f42f2d4c0df0ff2c6799057b6e41516eab561f8f487520bb2fabe3b334724de32d98228409057b9510ddbca5f0ab9c0971d41ee0c2789ed64a518aeb5eae348e8e8efce74b2e081d7aed9ca19ffb2d5d5f0d2be4185ff013dfd43f8e3caef9fcb83c5355f70f34459f32051780e6112507edd526498915093165577ce7b462be04f57b501db7faa8e5ab02ea2d89f2150baeca3102b3efe8553b40a015f0f5a5fd087dd7e8ea2893c14169261237a451aceeac8026cc492952bbd58ed9e0d6fc9c0839c2455957b0cafd6d59bca939270bc3af323c3c63eea130a706239e34c07256f7309845ad65701ba8a335e45c7210e46cfc17450ac68a91b3571ded5bc3ede973ee609b64a453a5c5305b6b6b978ca2922af8ee1bf21b1bc91ff615e6445a11d5e86be232d489c68762872308f133f9ca13b74a92eb37af3dd3c5cfeb11ef63056398fd1b1890060d5d34b128d6744b91909d262e8aa409fa425e87b64b729b54e1ee811d9ea962c7c36148da892785ee3607daa95ef94bc35bac07018b0263b4889b4d97c47751d13d90d425d0da277068f3e9270d816960e594fa9bf2ac7e38ffba834af6c9772ade3026a2403aa578342c4580879124395246258635c0ae38f55abe93dc2a959ab9cbf160c8125885f6fc4d16925e839fb55136a10f8dd01b9d19e8587e40568c9fd233fef28040df83dce65011b2e343177b04ba814d069be32565bc8f5aa189f46dc77e7d5cb4384254c6c295a01e9bb2e8b471fb990320ff87e96672cd1978c062d30773a4b82d93f30b95524045139db684063baab79eca6ddef202fb64abc87921c9b045c70c73bf5caae43ca8fb4f91c5739f0bd0c28cc0364dabbcd4ca9b4f985d2032ef5df504bc7d66c17843cd0e1254a62681351d06e691ccb6517bc13fb6fe2c53cd3ed27b548bff2d7bff09c1b54b68b0854be2f031e5f20ff75d480dbf9e926e8d2d13e3913b689a59bb5f18ae53215193b9888a806cb43468994815d9937f166c587b150ae651f3f0be5096aac2b911c6295e4d2f676574a78eced4a9436178b6f051184600a6d391396fc0adcdaa7069abf3ad42552cd5832ed5da00db1ee1f5b46f1d4325107e7f054c99002639306e50317695abfd34687da5844f8eb08305a724d1d3005e3f79065ef3a5dbc32245116740fbdafbe4e8ab77f022ae96148284edc743f0616cc99c631d1561646ab36f9c92b787812acc513c26df1e529ed023ace9b284525d55c85566429343c70912829fbd4bbde07304ddd16a8ec5f8aa5c26471c550aa0dae7dffb9c57a3e476ebf849936af75630dea780afaa2d1422f3f122a337f2250f1de482543127a809a81f1b256011201299639dd74a102aadb9b4ea28d725c804c5505d54e9d8245b101ad0a8a3f3c54e7ad9a9020d4c943a6da092ee4037755d48097353d1caf9c3c722426e55d59a24be191f0b9f9f32dccad4777e12122bddb40cbb2d1c6415b7cad9ee6819695cd87dd62ef5369f57e2c1affd2cc423edc4e4722c661d8505ecd1720a74da08f646cd6e1da1f6aa361bfa634ea7eec33ebed45b797664f2d32e39edb8488eada110929cb070a6ef2afabf0b8feab4daf2936165a531da6dd84645545e029f2f61fdfcc867f799af45c722e560ea12d38c700aeaa1f052f7539dc178086627e7a34ba765066626924e381762e7ea8edb068d88e2947a3aa573b486a1de2e1c8f5fca03d1b6a4309dfe924423a5b4181875212d334b9434b4c3c07bddd85b4eeb6ab4da0a61e6ec131b69d8d79055cc7f750bf73e966aa578db25833268f1a4cf1c4ffb1a955eec25e87d9f6c88a594d9934079086e999270c918943360d84d141e3b4ee2e878f36b344c20d2c251b8472e6b6a5cec859a366f7077121414e44fac86ddee810d638a95551119b5d982d1010617462cfbd44072e302c4afb211a9d7fb5ca088730e6bc1fe8498ed281e4ac9c881fed4f88af6ab190554784f59649cbbbc00b628c0fad8e5cded3a563d9a10988397bf901802754b87400779562cb2c337f5e29107b1637f948ca245cea5107deb16d9358092ecf2c843a8a56f1b25b1d113953c38fe6070b7869d3d590823df587e7884d8ab1d2fdcf421f90c72ba75a5a970083e6ad004b4e55831fe4786c6a07ca0ca1c1dabdbd4a75a34738f6e2bdfd34ba0d87584b5b5033e4e3a477146275d986145f513b25ebc3a02c526073a05c977375b4ffa42df4f43ceea767a26dd37e4cc88416bc18598d34e628c28b82a7ed14ca494abc554d282c5e4a0e4cec62c2d10eda513c05543868247c0992a4e5e8deb768efdae552acebdc96e2a8ee96168f74f0db5e8839dbe3ac8e7d38c1fe74aaa87fe4326f1a685c8d345031354fbc1024525b44bec110acdd41152f45a091388f282df29690dfc3c87cb5a9bbef611eda9a00a7008e8652d3a643ed9b1e79071fe1135025c15ce6293aad2091ee5e413df3ddf4a5c3cf9e61242281513c2c2ca7eb88d44080b94ab80a7a7b97fefaf84c5590c2bf3d753d10a4165b2b183cf3288738eeb1860e82ae9cc3ae512bd6598a971ece75445eedca4fd2acd3670dcb1327b09bd04d895d4398eb07804841dc138c11b672c3704a6c60b9a7ea690325843c3d13e84885ef9f0bdafccd4629c29833fa35ffb9b432a0a7e9724a1d8c65e83c7d7a08912982a80f348a620009873e70465898b133e2e46e6c2469546bd909dac861c0d3030c849eae3305b16b963a15dd6a1c647dfecccca8e77d0b9032a6dfb5c0edfd88626addd146eb2c118fe5bb42bc6587ea2213c7d685636e80518c7a3bba4be27e0a8873998f802ddabf6c3b50927b60329bc04de95a2ae82868bfc1c7b51eff0c045f4f8e1c615fe24d82eec50c4eb7a5959479dd277f896ae5b43f0a49f9010d2f4c7d3fa78d5e11e5961f305863be821ec3c28d1d9029d0f7a6f3fe1a7bc0cfb780c46b207b32add1fc04ea69f13ddac82eb0361ae73b708225b95b87f940c716ffba934d168b206300bf324df4ceae7cc37cc59435abfef83a96add35525d490843e589e14d5055a99823d5dc9f76e7d50e7165f64503b55ba81628d0b85965b6607f266ff4d1e319279ae6e92d71a5451f794c811d7654c5d5123ea051066af4297816713c525ac2aa30d09c759e2487aa48edd47d470afc19770b423e585c6862f45574ec1aebb60b2c65b22c0a860a99c018f61a892de1cf0d8f3714d7c046cb51f11d944d9774eb3fea088343b2c2859cbe0f96ad79955f16cc3c64baebd4e06ce29731abf27aa77367a3a8f782ee45162fed8c704b47fbd5d052cb62bbe6ea91f6a581c6b16e82821880c94a3562679653c38c4ef09433e3efe44ba1932e3967749e2b8daf153410160a718c6c0ee8bec99f0759525c98f96f4997fed4f99c00a4ffa6d83240689207ee3e1457d715f0a216802909fc1931065780f6a450cbf571d8fa11c165d0e98c96a53fdadfd7ccfb6ca102f7085f15582edb8b356213b984bba007ddcf230be7b704f016809e8966001a02e242d3675e7f7e7873f957e4fe62be6d0ca17ebc59f4c5a477f3b640c09ba7a4789c56f3dcc74632a429520152545cb8907298d9ec37a605311826afb87e30b7041145ed10c416a8cba81dcef4db3141ee3ae8516b01ecee96b0e6754fe2b00a4a61f3310a9e63722de647ea465d3d31ad7c4843d53cef692cf56c373b4bcdd3c5af755ebc7da479e95cd351950feb308ec2cfc44767bc2924af4d12b86082c722dc4d0245f7817b2029f01e60ed5a33f65841d026c1bc5881be46eb54b20bace792fa273ea13479a15e56edddef410576f1c7f9187b09b0f2aecaa88f8e5861648afe049f5ed75f201b69cf4cada4e3dfe64ae1086f2e3d25e7abbfb0da78b162ee6752910bdfcdd1c54098c8211db1fcbadf5ba9fe372e9e76010073a8d711505f20f1caab1ab1aff89c128f1f122673524273c2b9dbd1b7bd7ff853d4b68c5d035168c5c160f2f55b939d13debaf6ef0ccaf9e49f6291def10af381e5108b6eb85ddfdf5cffaef739c882c0b6273bc8e5c53323fdb1a31f365066aa85086eb45e9ed8f64be62264335d692ab5494c974a3fbbc3c4f34a5ba91db8d9db4fc24f993ce71f944706d948292e1e9903dd913a9c7419954bedc1c73bb16b3b248b7d367714b1420df57e04ac19a0b8257d2bc62bf6596515c8845f13d3973cb57545776ff9f44b41ed9ba80b70252b1cb7fa25441716f2b69260f076e1277bfae9d0b8a5d36b023fc877673885c66d093ea63d883ce25d7ff27c900babf968993b0a7f3465ad47fff7bab0c7fe5b0604068c56cc042d2556f22fd7b935cec31bd38f9ded018b556a15427ef2fa5636858f26050dcf13a7204c57702fea082670bff4d4e451d0de94f3b426ddc69c2c459cb801bf32d0cfa0c848d0a2e4ec008e53a8fe11676af2c08b60e5e297b1045eb8a36e4a953568905451614980ed7d231ab17bfdbea598732e116b4433df2fef71bfb6608d443a98dcb18a818ea78aaef621eb7d5a3ec507072b9222e1f85f5901a46d9e9a636b0e9194d15b854a7402123e4b2846c59ae3c51dd87a38854cb07a4f87f8b4a8c4160faead7cf19a9a24c0f422dbebb481cb18662e6cf04c6866c77aa549f3de92f73c1f19a9508e44f3d57335d891390688a6ee8bff3c944188a4847b3fd59655b2500b3939fff203e06cb3a5f848bee7e9e765f58034386c06d46978e09170bdd206a5e64319602d461460619bfca2bbe39409af97f02090a93918ce61ac79faeed8b8ebd91e3f05b355a99591263c4e5eb5adb508d452a246a175cba044fb113c620dc933673cea12561096b69ce5a24efcc53d5064de4dff7c04370a5526941663394ccf68f422a29ddabb02ab077ef0adaafca2370cee63cdb1da4727aa61e9b3f45903b398e1361ae8f6908ef8c840e47a07a5085dace796bb69b92cd0d2a369391534b99a7bb0d94ee957ab35e82d5577f060c9ba8c52f819838eed00cc85b32d1db12e99e4ef74796c242f6f64b2cab3db930f406ab824c5e9d4330325d6851b1863eee06a141f09fa193678ebca4a1c4ed37af9d8ba829aa4f2ab199ecf097494b94e2340335e1742b7fd28001046eaece2db88ce87f6ef0783374fb1392b452435743d9ccf68c9112fcadca058a83b961ded83b3a0012ab93133bfe495c202930113061eaae854158f6d1c2aab2506d4d1f552ff46320a4da5c943aa8dfaffa5d5e3456345f5c27945dbcc963d819de688310a1a8b00df8b32e5662f06513d719d1d21dd02ee93da640b17db86ef0566713568e0867fc8151ded172f50ee1f709684833be045a927fc32661add6ba6d2ab4f2211bb734ae4b864a6c2d0e61a33a848824f47b3e26c64547ed24f6e624c847b705d2902db8d8df285d72d24f5f83a70c5395bbf2f7e30a3cefbbb9a90410a3ba7c4d654230c66c1901dc6d9e3079c70027b885b0d97970d865d619c1a4213f0ba44fc2c1d2e8f00f76092fe6cc8a7cb2026517d8f071dd8f9c75f93fc3d9ae2fafa60de27c7ecc352f1fc1489f745456e672ded118ddfd5ca15346b713590836ec3f920f62687f996166ef7d0dfefd96d999e63f1ac54bf19d7365f6a3267459752de3bcef2e72d67b387105f3b34d6f0403a771c7db0c0dcf3552ac2c14f19d07840bb13fbb2b4373e8e46a6ae01157260e2a05279f154dfbd610e5382aa5e609f3304f149554c3b377a39ec45e0ea38aa456b54763324464edf59c13d8f957c4cc789e96ad33970471b29a1b1080d78385bd5e2e30e6172814769ad8824290709cd35fedbf2855788f90308a65e9fc5ae199cbe99eb503932a62ed4ee1484cfd13054f37aa5cad60ed897ec93a42288e4c7eacb4e0a1989e5c26dd426c5b21be30ee619bd0b0d332df4740f69abca39bc5ca0767eb01310e6ba2604e64d4428e8feb0239e5ac1a26a5842c7198e987368b6baa52562d61ef6c66b393fbd883aaba9d16b06cbe3bd43698211d7da9fa847cf5e46dedd8d6c93031b1b352ea2b8e38747fd0f091cd0606ba9afb98d78118b4c32757ea7da75b9c3a3876a795b02e80914ed17b223bd905763720042b957c3817c9d2998692fec5d2c622cc0a20b55c9ab75e3e127858084516cde0012fcd3e41da18db9fa247d364cbddbb7ed51fe7fe1e5405b52571a71e9fbddfcbbc4515f0cae648da691500799c7734ef135d5059eabcb06db895000b16e28a3e79d47b9175786f2ed50f42ca1b87399db7236816fbeec65676c11f0468c22ade37319f2021f06a743386811b121b2a9375bcf3707bc8ffc188bdfeb8f69fcb0a94125c187d3a3e9e0befbc49668113a528f338cc5ddc198b64fcb5d6b359113b49af43fae9e76b1ceb9526a3dc5a946582319e3bec7ea6975f338ac4df493449eb5c1cbb5d750dd282da2a954fa28b40f460626c921c315597e0ba42616505ca9564d49a093b020edfe240cabf1740b136fa0c73f4ab3242daf7f758324c5989fc93743516ec9b36075dc23f916cb759599cb8b9482e902d2cbfd3f28c0699e5f0230a7cd11f8b3b06efc54ffc081297c45d54a8c64bfe2f8c0bf160e945d666abe52c70b04bc5e8ba5628b11a7f56bd937c0557788f882badacddd9413ba7f3ec6db53fe7b6da86461bd34a859c8e128994092751ad88506e3d50450e8695dd54d36f42540ad936fdd92f5ac4cca4f743f52e03b18a8504ac27cb9c3ee798d00e328ee4f18b4b5833f3266eebf0ca1793d659c97fb06d62d01ed29c6fa9464e104543519b8e500face1217e359f1950a1fd5d2cf5738f71d298a9eaa06dea8772f4aceea41af8824b4afa04048de7b9ced9cb1ae9b854d95cb5be4f2f6af002a2b6e24778f23c210e2b8bec5f7a1b40d09ae41bea5bba786eb92158b0ab0fbd8904e13ea178a94cb744ea98292a17b397dd266f6bf5bd2088267e5dc49148a10f0615f87660f0bd607fadd7c3e6d66f380e15e08cb85021e229166a190d0eca6d0dd33c50bdfb4a9671a40a6fb31c8d6674bb394e7dae5a4df26bcb443142ba36fe530e5adfa9d483eed00d82614edf5872b4d17099ab8a26ad117c5658a717c5f37e9528dbf7e99cbf445160ab268c5b753d795b761ab4f601dfd37e7edc11595e038205337de3c110f6e9d576fd2f5fdffc45cf4a634c5a2cba53e1e03b0b65b882ee7e988a1f45de16cf2840030a495a5124211a8f8dc26ff0672f2e9ce91808235eeee0662300c3a713aee57d683987f13b36821fbb7dbe9f8b7406e0a0e6212a2e5b2c9c17d2ce17297b37f9b7ce939850e6105f5f9202f273aac9db71dabc3f7f944d8a099bedcf8b60a50cf7ae5e1e2ec53b8de3cdebe6b1a3897c1a9d2b3356f447dd8d715ed8a6b20b60f0656599082161782a02592586b54eb7f67d6d1e1e42efca9cc0ca1133a92a3174fb251e04e0b15e504a1f29904a21a323955a11300f0260416729c735e68827b90e948b9b41d38c61861a66997d950918e690b8c2838e0c29566f82e5cd9378e333af75ecad2250f3eae6fcdee49bdf0e84755a08f3be15e07df54a56a4495382dd73f0ab6d893e5e18afa2cf4c0509fd059d03beb0d9e2ecbf2052bc5f4219f6bebe9ff74277155e5131f80f4d5ef9af3fb33b60d25af9bb0f8af9ee929c0cc50f801af85c358d9f49e40500f039ff69612aa5cdbc1d7e31d4106f061e63450c2a6cf2504a2a24d063a5bfbb0a502e110b79e43ac9b187a61614231489801e2bdafdd046ee4204d719c65a954afab1a998be8868fc31a45bd8f9cdf6e9bc6d5e24c60178a0775c65510ac9a92f3a34acda2534d58b701517302e3ad3315c81f93a83071fc9b7b8681de6b48e8a816eb126a060157d657f28c3c26e2a1b4fc622fd445b441e2d5ec349e2cd2653d4f41396531cf5639f387e88668c85bc476ac13c4736589ae7623b7e13bcd3cc8c6224377cfc06f5c57a5e570700aa74635bf45d015547e3dcfec357cde6c36e1fba54dafba12cae36d931d23c2e84fefeabafa73b55df06daf277760f136fd826afacd7b85910b4571860906259adf341f9dae86a318a721e4029df578952f63aa849b79e2a3f9c953b980355fdbf353afc91c0943ac423a0b52ed44c4ae754d85fda37b061002d8d64c25833111af71d0a034653b038cc0a64697a33eaa525b8c53b66bd3942cb977fde55509749e3a3593343d94580e0cf7431915a19cf934a9e6656e5696f40acba534b14c8c3a122e4f1ab92a6ce60e2567db0bd912abe1aebbae428a42cdfff6771c1d7e85c2d4b37cefa32510c84700fcda4701d51b1dd2b22ba07f94e5aa79a7b6b85d060d2f217e7a73544a1ca36cf48495db8348d1d48d53339ddb159c45dbc7c3ab52ec5de8ede009a988754ae82d6c257124a00e3e2e40525601a0b70561b21fcd3b9c09af81b7ec8067164b7245cc8988a955e0fa19f3cfc74fb8c6529a1d93c1a570a3a724369cbe1241015946462dc9744d239c69f955a4cefb671ccc8e3f178d723dcc54197d9afc2f5bf65644ed5a319a50d401987c69e513a4afb8262d417398e4a05d5515ac6511080a4f2a244ea8a2cb82f7a3e9d5c63e62ae3ccf7fc5bdd50683aeb001beffefa63683720e53bec7f8d5135e1e2414da1921df6dc39eb05261b94efac599d62250f3fabf26d4c2bb07efdc22e15a3fe2ce660725d6526aa4b8302c4d05db454b271c7d15b5d69f30a1cfedd1cc135357e5d8ed6b3d7469d29d67500ee1268f42b692f496849dc5bf3834a957804c0224c758e95056526b42ed5e79292f0e701749e73bf789afc0b261a9b33cb4d38425c976d1aa5e45e78cdb79622c778ada5517cdf0f533590676d40a7a67d275009e7a4d80c2cba4d63d3dfb5447f9a1d49f6b5341b5f0b474b5137656b1761a128283cacffc15ddae79cc89c88ea794568ff40b9502d396764794f6b6af93eed35b7d23829b3efdcffe29a35cbafae15713fefe35807d8d6bd217933db717fee97078765d3d653a1349bf8476b619e28d81d8a0f280a23f01752b86842bae3e42c1d5a936c8957e50376e1132076d49af8f97a34641fd8ff549f22d26e7ba3e42ad68e63d0e6a89fad021db6a215066fe884dd5d180444f09cabbbf84025d63965a331409061fdef7e4cfa78cf6abbcbb6dd55b50b3a922cb5a5608475de9fbcefb0fae1b87d8c590cf663da883e8f2aeb980f816d224ea1b18eaf32e26e3b44272c78f2fdeebfe1d7091b2d2489f8399c23757d29ac50e0588b651de8595f1c83eed612cb10700349c288fb10378210d7876fc5f50c752d06602ec17b7f03dbb451ae44e3d146b79b23c15354a763557038191917a28b312339b002e74ed06b5885dfee094cb4f33734c538ea6c065e78ed648f4fba84885b81b299f1959cc844fe45757413c81b297a82ecc6dc06a05e078349df1e106f953497005bffc76d470c43103051d906cf6884c50499c3caab5526fb7e306467ab5837ec911f33ac7f7e2644d96a85abd3991ce38a5e1da319ecc0491bd4349bb7cd15d052950cda7f723b79a5abc53fd34718ad429cbfd3fa24218c5616f28eb6913983332e10cd5a88b560eee30d5a04a078b587be3790d77ff2f405eb6b4e7ef9fd0cdd66177053c08d3fd5e86e1553e21bb88f12c4fd7145e93baad58dd7c424298a8841c9ba045971073063c7076c754468a7acbcb140616b1ae506479e1c9f27ef43d570b8c5be93bd57c8f4168e74b6561c0925b8c7607983f9229ca1df6fdba0e59043dcb71b7fdba5185d009333ba56342c15b5ff15c7fe41af4b9f00868fc6dff09eb5ca5ea8f122c32ba3f8a2482da19870f0de382463817a9b0564bbaa4a4313974f629cb56bdfdc5583983abaa0b09acd7ab0c4494823d7e82b51ee1e5be68945775d171697796d2ebd148c966de52024a141e9e4f44a43de9e0e47715301fecbc300100ca2813fbfdbe7953870be593cc49c26fded21cd89da0cfface7d1c970db1ef1b038ab0bd444208c9e9bbec99517daed8a267c37aa60ac0159b9f3af7b7fb656f23ca3246adf7fe47b34cbc8e2477092ec7ff2f46e58c3016f99d2fee31fbdaf68f9e205db4773dabd08c652c2e81c2a877b8624603ef9542d3b7e84cb6c39a0ed623e35e62210b421b740b4f0774875f17ed5cf546caef2323e2fffa522dab99797db35fe9f5adfabfc3303caac38dc1fd6c538f9375d31e4cb757ffded4143ba5046674e111560d66f28eba23b195d86c5a2dd77b9b7be9281997b7af92d2ccd002c034bc3e5074a2022aab7c491455368905acd19423ba89a1604fdab1e12c3aef6ce85b1db208a5097ba595391d662dbf110dea24fab0c6fa2612aaf1a7907ab6896b0758f5bcfeebc5cea4cb56a9341d11acb6f1d0453a904a15054a518180bbe8ee87b981d09e8e0fa9a102225a085b7fa468c1d06d7ed5140a715b069760773e45492291e686ec4a07d29d23761bec795373b05bee3d4c291c6ac612d08cb74430deabe5a2e76bb76ef1b42d2024611686a801476d98eac0c2f700df5275e11fb547524c7ac8d74adacbffdd14396cc8add9967485a5ec769a6d2cf6e6add7347de1ce5f05c8ce5f85325850171d1336a83bf2f21970ea6309c8ee6cd7f6ecf54c7e3dbb0b284214d0cb5f3e056324bdde4852e7ac493b8c445cffaa4248604b525b4566230e49e7ad574fe9ffacf846ae44a221fe2707ba9abd64c547e6fb0dc024651384bd9f5247528c54853a7869b8ead67c7dc22a308a5c210c37eee6ea9b76500c80c9f3a58c3a8bca6279a5a7c66a747691650bc1cd5582f3cee56bda3e3e65ea157abe7336cd6b9d50aad6c8dd6b2d9223fce45b21f4a64343859e5463b8221273d0dc4ec2126b3d964fd7dc49aaf575cb8ab13b7ba242299358016a8de86605ae84eba7c111b33f079b4bb565f802f2cf61ba9e33633849bd855f5c0a74a95e846301fbf4a7b94ae5c0707a5b9e9a2bce273acf3950ee8599c05194286ba2a37166cd5af391875616d8877c73307df8a666584797a65a29c4030ca827188c7bf56caa778c200a4ab1cf45f53681735ce81768253dcc94f5ba1e2ec9102cfd1bb31e330ece15f1894f78674bc641d9a132a265f7a0af7ea38fb86b042f34c2d2cb7e684accb1976c3b97817abfaa19a12ae10865147852d6aec4f3a3f1a4005eab851141c220701c335db692dc63903ff70179609239dfd80c8f584fea75249f23777bd6a210fd968be067e1c455e281b55bcfab4242c848db04603186b4282243c08d8e0406fe40fecadbe97177d52e91fea629e4da87c8667e4ecf6e79512f7c6052f78dcdce5a739698b5eb1f557cb9b66ae1a440e4250f3667967d05e52a1c5d62160997a75e513e6121f80376d253de1c77ad7abf9a0b0aea32c2f86fa21d0855e3d46d778dfa67a61d8edff8317029d9ea5c488d51e38e524886e5f5fb1a306e3acfab4ae4b5ab91b80d7fe31c2e26910b1669a0d35b300df966ade4ae55db7e82d7927a9f91cc74edd8cbb98b2508f422a0f32cadb37b3ab9183107f26923ffe96b40857a8442c7e479bc068f87e46101cdbc47debaafea829eed364fd63b43e42c094a559f8f1e22ae0e5758566bdaee5deea33486f9db4aad47d3e820a2fd7741cde8493760cc0757645d04d3a78f4aeccdcbeead816a331ab39a3dc1bad883734271e3d6269b8dddb506531310672424a311010c602e8ff8d0ad1a3196df51c934ec40025520d056c09d89ae5164314f193f161d0d9d5cdc7579f0d9dc044a15d9b23485e0439386bae1d6f979a7ce9ca1326fd809214e099c1214000912bb54718ac9473097a4c737bd00aa61bba50eb64d44014db7c0636880df6c180cd2236a856037226fe707d237a4e54eb867db940787bf15569224a923aaecf0f89b97639efdeb8f4ab283795e0b68f853fbf0b550a341e9049e24b9b5d72234cffec735e114b2085d63de588b653f28ef4e5231090e742d2847559e4386d249871e1b3533b2d1d9ce079c56e3f0f04b5320ddd590179ded498edcf9eeafb3590c86db53d36dabfda64e5ecd628141fe6b30779edc091e0178065a6287aa2e3d40e4d3051680d95d414b8db4e2658de3fc38f38201cc05daadffafc9badbc0c2d78b8995db440fc3b1254c2d063bdc8349e9230df690b87f588e6648556c8784902ba36a4da88728982f0783844175db379ef59e535934ca2a4fcfdb590c450b359e98cf5c927af0114a9eb840656732268bf2c461ddfa4e85fa7cb7abeda43e45976afc67fde4a467b4e5b7e5f8c274fb8ed90e3ac406b8862d6c5ce9cac0cac2729389372634adb58740ad9515c24b012c00391a8a483fc52d6db17d1bc74f97a9d09f8e225a359629d95b2dedeccc218449d6436fd9aaeae7a6632b8d9878ac677230a4148fd2d2d9b050f6a926bbcf445ea2c6e60968a61f5ee40de4303bee03b6a9da657bcfaf83b377990682d7ab30cf4b4ae9a17da1a1349b1dd5914610c241ee96cb76a738cbdc0c306672455a1c81b34ca3cc111ee02bfed2f3481888b1c55753dac5b012095678c407825fbe0c977c68475b538681c2d75c234341813540dd043641c04e29ec8f2deba23054fbbd711f4be58f8e9ab722405bfb541af388f8a6e50030373a42ea78ac3e6ec414c15cee02b8fd055de8eca6088dda1de59fdcbf8d1f1aabe9cee41c036815577f48f7418e08c76af2a3f16a42a51f1d7892ca2e4aaecb49be3f3d0a90cb62959392bc953f2dda316a55f45722d5200f66e66031d75ea91250456fb23e440bb1b8f9302c80e92a3d03c53cb4585c296877266778073680d70730d63c14bcc9c05638106d1dfcaf16bf038c380d44f0d032a7b983b986bd0b0250196664e6ad29ba33fdb7bd5575c8970bd20ffd2e73370a243078aa665579b82ec4ba6b4d44820341d8619602bd93556145f28342b6767e2a789e495a1057dc418ba26895cd346ffd44feb9831c1ae4a44eb7befa44f2e368bba7cac29ff4f0fe38a1ed6b33e6de16c96a8aeba96df37e5f9e82d77d168a772de5051914c248b2219033fac79f74457c2aad15bde9dafc9719b2d95b42d8366a82f49846e1288859e59d9b599c223676bb85800b8f0ab9a3886b0768055d7cafc97d0623d349b721c0a7a4df299af3a89e1a35fedda014b48b2e50e71781b11d817e6464ec4212b9e47bb2ab527f866e692387dc3639a9a64ea32b5166a271f4c211777c31b6e0c8bd9d6bca7c374a46db255e4a6a2670ef951627ae00947a73223c56eaf2305b0f7b5595c33691ff469e96d8006e4197aa4be0fdbff296fb499764f999f8edcc05f95e7ef722f226cf8b526d7dc86b88e06114aae307378b8531a9e04a4dd2b9d5a5b4fa687b56e9b6874a04b2eee3d6ba36755a25ca35d39e36cd095d7687f0a7dd275beaa2a30ce1903d48760824974ab9fe39f1877ff2f72b274d802a6ba1d558b2f720130cd604bf2d08bcd04724b5b3ce49ca4a49896113ab00e9ecca94ccdc77504fbfcaff8fe530aad012a7c940bf382390fb72105cd45eec82ecfe07d9a0a42a1bb21d29486846d1378cb69c77a67102576dfb0c9ec28016a03496d4dfb04cb0c6689eabfc7847129fac569a3a14b41cc56c1e7662eb83ae6833262a125f67e082401e665411d8adb82415a69a3db0a89985dce3f45d8e57278420dce9cfe01c4f6179c7f5fb86a6ee5e214615d3417195e2d73b1a273fa03366abb51fdda0c947aedfbdb2cc51fd2481af9ab971a3cdc2a5662524d7ad46cf7f7dd5bcaec0d68b25adc86d4760c4cdac266f0109a7c66609f1145a7f1a2c88b45945f99c163fd112e9de224148a73a017cb7f0a3843db54ba62c33e2c5b915d64ded7bfdaea8ae52dadc25ea955876c19dff5f02afdc65c8491d8eed0cb602837350c36982e20e8ea317bf18d2d374e519854f3d63aab632658571ba4965e2546f3e77612e70415f5e0a473511a1f1ede967a2e29e311ee9798c8a3ecb905b5043065760fbd37218bb5276822f5dac5ccbfb77f062d9d47cb91a5c5f3c59cdd8a614c031fe99480f6bbd8f82fb8ee9e7448f7c092e6b95d132b2c9a5b37f1373facc270c0513d8f6d7666fe462393090ba4d5123a5dce2fecec58935a37befac8c7df9255393d9d575a7f9c26ad5cd223691fb7b46c653374f1818f7ed60f84bd5779db1987119f5fbe76b388945c6e4d52c3c040f95e0fa3322c683f4fa23572c770d46fce22a52fc872bd3158ef34b8772dca75a7dd930fdba5d5dc7365c3a6b38ed02a8e6142af4c6d114c45da4122183e9cd58f96361a24b32ec6ed404bd1fc974ae683f495a5a4168024352826d56aaca78c7bbf9b2c72b6af5005b80b83c26cf9670d1f2ef35c2877a09d06c550309fbb74861a5e055b43ca1447fb4073ae0d9e036f8edea61008263badfa7d3809f0d19e162a7cf16183eb32c620ce483890a57758f3c3a1b0cb1cdca11c082b0e0383b210a9bcf91e11f24649ed97bd56bcf0cf479a74c3dd2e6d3dc67854edd8a86d90b73a94ec7aea0975c1d327fc3e712d5125af0d81297d5105e435735d0763bb7dc07a30bf79603aa97c32f9a4f6056f1e8e2aa2bacd82a0c7b42aebc7e60e79611ac5c52c89d2ae36c13932224fb809852713115bc45a58fc289f6b2e238a8fec2a4d889a2f12f91b4b8d545bbf69e600a775dd39abadb2ce999156b19d7a1e508642489f273570c4e95550fdb76a4736768c8a30dc8dc013686db52c3744c5a59127d4e9339ec5e23191c95384236c845026e2530ff3a53f5ecc1a701eb4372961d59467da89c457d0020587652764284e3b70bb7b04d0e0a637d6383ff1978cf9efa14675734edb602c87a8ad64e739f6b868604f0647e4c81cb9afe869380661896f483d685020d3728cda96cb31f5f8efac57d68f59edff2e9ccb031756d2f681ed9c05cd9186654a82aea7e84243a7eb53e4048e0de5b20b9aa9fd6e38b831d1ab30b070e3bbe9b5e97229a878ce2164884dba1ac464f76e2b47a0e5a4990d522e7cb57dc3cad0fa77c4cf5684de1baeb4ae9458d639728ad03e04bb9dc064a6b4016cfb80b3bf1d699980952d1e049267cb833131d173e9ec026eb3cafaaa4a2ed6861b042804bfbea8112478bf1e842de150abdb7c41dbb7f9a3ae6bdf93b8cd654a26bca1c3950f973750952483c4a30d9fec7ace112d070ef9fcb6402b199806b2b862f4bb987fd76b70410f589bbd8a0d1a77215f49a12dfc4526e9aeebb92978559c6b5b5509571d7acf25cf71204b2fe7e32943a1378d7bdf56ab530bc36090263830e5ed5fa467e52e6d2433ba65b9dedbbd42d74cdfbfbbaf9ad38a764d6cc512d6270396afa92236d4a7a3dfb429960b3df7582b144269c50d7d3f11dcb2828c57b62e769cc968b6649d4b333e3173fe6d4a92d62cb990c0f04fa5c3e8b758642ebffa4b494d1f6a0c8565e787d35bf24eaaacc651a5ff13215cafef9076bf1a09e920f83b9c87be5bd5e55e9de252be67424869f524e1a76b0b007288c9fa82f1b4a6a03562ad0d36420a3523358deb73f2cbdb47918580132e41f5ddcd0a69629bb381dc2cbdec362dcf290fb45ac8faba62e4a07f107b2dc1e28259df281fe210a274a64317d3a48f4528fcede4e3751596d4511e262a9cb8d675ef2cb7248e08a7abfb36424e78b09d54dd486b1324e877ad158aa224ed433c916699c387dbc5e35f2bcacaa932bbd3f095e8e4228bcea0440f907ffa6db5b057979fd33885bd070f191b4f26c55aa4ab37e720ebe89c2e5105e475dbbc42609e67773881f03657b2b99b278b58fac09139312b70adfbf7fe1e54fff38e1d7b4d0bfedc1c46485bb0a9da76d146a0e057c4a5e6ee3f14c35146c9ebfa2f5ac74e3c68e9086ced56c591b3e9e71e45dc1d4e2057db9ff5397dcd3aedd4af874059fc43d2d7f67cf9030dd40289fa417b6aba7e4d489592f279eb5a53b43aff9c283ac315ebb74ad63fa2e93370bef0d896fde20590375dac578e127ba3f6ff94ee6b36387001a3818484d4ac3af2d08d9bc834a8322ae5ea227f0063e5d51433159eceec19d9be433f5cdb8ce47e488dd1e1f8f9bb01d88faa71f172018bd186135351967c67a650fedb8ec945fd37f2a0b4de642ccec78b420f81912953f68ac66767f922e0969abd6964a4852da09501bc1afdd9d3a856b4b121322f616a18edc3ede035b94b55be43736f3c757aed3ef51914c0700615f4dd20d32137e03a4b4666e26a7fbfe20f6f8117b86f7953b08e2c2df2316fb136771fbb424fb85497a7db3b094e9c6df511edc2bdc1d67be5ef6fe84821550f705e8739c7ff58511cc71d566c108c25d5018e8bbe28343c5ae61587bab8909ad09b807129821fce74bd7077129483f15c817c11b7bfbe154ca883e66be4d769ecfd9c726f8ce0e79f15fbb925ab475a0be99b1ce7ecb3c5fc22f4ca398bb6a2fd9ba05f18047f70fa8a4984273d8a5ef091ae9158680029fc28d1dbd9656c59d2b658ede83800aa81def7805f1b0f3c2be3300341cb3df6f128aa36d9ea623245ff579a493c2df21e796cfbd422c8e082aa218122509a2c48385319d9342e4d94f6994811ce7ca6d01c7f50c44ad1a2834c18ccb31806c6aa0a8d914d49221cdd4cd9946ae8afedd5b6ebb75bbf5633c345e762e62331b20b01dcf1055207cbe504389aabc573e9e3f65828c65586eda9f3723f0ea4975876b5e89a834fcbdbb35821aaa975acc09a8544a5a87a8bf447c2d8337bb8f21c9588e76d3a90356ea407bd396cf930c96beacf3eb42c5100ef0b4fa98e5138e883f6aa6536c98b22411e05dff3a75c3016a87893f0a0ab5cc6303487a87ce64d74aefb1404c2260c94ddecb795fbc50ce41bfd7368f079dbf3dce3cdb14b7afe14951a402ee3a9dc641cfac58c2895bba9c39d87abf48c6ab5cc7412c210043008718c41c99d0daf71f0a223cae7bd410b62917d66903799315f4a46317ea1251b8059c89addf05c6a047a820feabde42ff37c527f6728cdb8407501d02a8c722e7c39fdc171e6127d3e4a52123b28ed22d957457ef7708dff53579b275a15216738af1f94a0c11df83ce5eee1c25f796784799718460c1009066fbb5c540030f5bcca845b475315fabaa20864a7ad975bdd37372b3010cf202421d571a1fe022d2eebf8b68b56fb8a62090276090674a7bce4db107dfd0783395452bc6c9fdb1b3aa53d53017a44f63cfcb8a097d29baa5f7fd963d91096de566219559dcdab94a187336bf383fe6c4f38a589ff286bf228efa257b9911bcfd48232ce4d5656e6bf24575a394aea47dcbba33777a7210db7b78c2592381deeee175c4a6328e8774a3e2de1356e4bbd019e57a132cf124e2797e6561e9cac3cc0679fb4155c339ae613d6488db9eb8b9d864bea2948b28a805268e59e3218b15979275845d705582fd99496c69a12905bb5f1dc83baa22d07a4440ccc903eab051e56178fba9e0b7bc48a54c4e6eb900044fe6b9c111afa5d8ab43d1ec8bba6ac5a888d7e0eae03b2fe1942f3dc9f283e08ee6b9a508d1488d3058ea6f62c8d4c9f55c8597d0067fd55a10b988287dc7205cfd0d757ef0261efff5ec8a2c3f14f1e4fa649687fa325af84a69706f5f329758f6896316ffc2db9ca2588fb4aee502f559017b7c51eff93d7be8911c8d2616bad5a5e96142fa76c5342d58b3064e5381bf7f5dc0f13bd487df69a1474f765773c3b5dcefc51672561572f74d838107f1885827ffbebea3ed3b599116b2604c58ffb9e866e800c46f60428eace0ea7828336822ca25b3efec98718c7c3955477776bbdd74f194b304da0efd9fb9636d275d76915e5c48897c134df2b14f6f33e2a644f61b2265306cdffbfc4fb0310697de664a854c9e8fbfd5953e3e116901c4a8a505de88b26d1cdc38b60421ac68eda535480cf77fde2e462f1e93ecb1b1dcc04bec9cfa9ba6721117a84cdceff146247e7d37aeadbba963f0a3a4b929be1c926e1b6dd87479f4476bcf0c71ce179d8b118a7aafebab7d1e6de2cd50d153812ed04e3545486a4563b6dc34f1b1eb7be8b13ac1953240964c1f1f4a4a3574d109cde1c149eb9601467b124aae9aaf0746eec315818cb142da9b53896b588d5b524978bf0f42605c33ffddabbc0841f332572e9a8f77e9a8b8bcee518da4c00a2ee1a987b987e775c834dba237fb9c9128a2e53f73c3c9358d3b92362a934bfe9f3090b28a2d9aa45f70ddd5d057b1852903e610df2d1528562986e3a61b509856894d62982c0e01956c8c0e876fc51bdcad6ccc2c806e05f31a98ff189c3d51ae22bee39c80cdf1da2dad0ee48a0b72055d57b810fc9697eca6ff42aab73c4d8b464246abc9f520a76325faecfc9bb789b8e8a06f4eced2148b6397a385ea5dcdd3f9992f56039e12ec226e4257ff439f51e90883d744b8de3f0bb3c9fa43402cf0109f545b333a7ede20096656dcce156e7d0df78f90b9879486505c2d8193f67d3eafdb43007570c51a3e24cd188cb69087f3d26887859718abf5b956f40186df8b5da97b1d496dd1313722067572f96bcb5bb73817ae81846a194c1c691f3bd9e20f1f04d4846dc99c6494dc6778ee97625ffd5a67ff627bf6e05cdd28d95f77160d37bfc31785fab9bad85cab546e9fafbac551b9655d744e876f9c635d13b54468fadc87eabdf20b796d222cc86b358825adb43b12dd76e37ce320a24f2c7001a964236805347c229fe5cdc737d14164f40d0f8052673a146f8ebfde6fdba82e541e7f7a3881a101b18d2512b5c37496b67246939d24e48473e5305ed9897dda304b43f5b6997b63ab039976907cf639bb1d5dee3d0846e77b207c9a29fce7dfd46e31314080460b1cf1c8781bc55ded5ef17e99d9dbe671729dcb4a3fba8e68345a9b6726e9d6f9fa03573e92b7964b719180a0c1aa0975ab91024459693f3c3b12ea32d0dd4b024dd909be2fb2a0da392ff4ee792af4a4e2ba7a3d4f4aa05d290e018c5c936113053d2bcf2b34288af7aca38dadceb74b4db50f474746e15af0086671fc060e66ab1fc3ccfcad8d76d66862e87dc04177e97252fb87ee07f4fd0707932a51d052d0b52df92b91d23bd6df9952fdec00b328f58d91a10e5ef1f2e71ab0a41baa000ff7c4c821f607453bdbad6acf609b67f2539fbe52d9645eb806cb9d126c839ba3e5e1ea8b200e3bd28834b273071244d84305c9eeea69778048788e68ed81af2b978003d847f17bd0f18c217abf939b50dadf288227b637c04be7ccdd482f6a507ba9e1afe18b82b49fd9bb58e7443572dde8d30d411e1453629b3160844052aa4372dcbcd2e1dda8da9de7d4fdfde37116f8bc47d5e6cbf34da382ba3e126442bc6127a2c143f4da71ddb76312a0d7e05358ce2676ab2a42c9a4c08bbda4bada3bc79b8e9c98323016533123ddeae77f509edefa2d48869598bf29dcadd5cef5938bda670b64620c8a02cc303c4f53b56a60518ba9f6f24be9d3b5d299ef3f2048abf09169e8f4ef7a3eb71a1d74687ed5e5a69feaea873ea4e160976c137ddec7a01d45d82e17d774a19be212b78a02a3aed644c2212942fe839798f97b5cbd78ad3c5a7929c4aed437b3476da94fdd79a0ad4aa8038383a06d5ce2b2476a14fa5a232a3c7178b9443ece68aecc5255043344d8469007744d933e1f24f44ed88740e6befa336c26559c961fa11eab74faf0cd8d8c75abea8819fcf99460ce5bfd8bcc12ac3f4c62d27a6400ef7b73a3c3b8ab7f95d069a563a0dc143a6f369ede29d3cfac6d460f5bfdff5d566777490efcc46f30f98113800492ad904ec560f5e3af7ff236ddfd029be1a22265d8d4720aafedba64dbd67f4b30e6f2be3fc855ea90c470a5d1b2e6d996afc196d93ee5c1175c673cb35357fe34218de8d61472aa4a7da088c618c53a4994bedc2fb35523396897652ab1aa4db7a62cbd720ee9c74d66957ebe56f4a2492fedac2a44f6536504ccf05b8a03655c327a253f9f996f08d1e0e0eab6750fefd24f8d0bfe91643374a0bf09b45edafbf5212ccb3b381a67ab9f02213b877f7aca795777aaeb365bc8d4bfdfe6545d24babbd4195b95f15dd672da80276feddf7e27dc13d563f3e7df1725e582bc4ceb79cea1a19adf0e473f9ed41b91768f39cd7678602d596d12de5905e9c3e8271f91878ed43952c0f94a6bc889e3014b9c8f38d2f5b02be1af883bd9e257fbaa7b487d320facb63553418fe17f48b87b806064167d573652bbd8c04d17a9a1c72d3467f11ccd96c690945f9f686f3cef4067e41c5070d7e4c7914368e75b01d10d9f3baa12f89df6c6555565e83a3e19755e964171b1984583d12f1eac44ef865978f7fe4d72cd5680adc0ff80689a2332bc536591cb4781a8629caefef18cddb260d49f672d787a2f3e603e1382f3ad645061066cc085d8a00106e7076c55e90351ed1378d7ff9df280807e20873c522a0d46184a2c45da850b0d6d72c4637d20be874d64b7c4df9008799c7016f9e6571a70fb741b78b7d8629dc3461ffb8d45b758ff7c076ccd9c1a226a5a8b6bc62da7f7bd214b3f32fa0e62a92640557d609af110aa4e3502f0c43942a702a339709e1153b6c1081bf16d5263d1e888657784f15618cda4897a6dd11b20ef08ffa50fc3dab5a7acd8bc39f5a3513bf1d060a77f082b8d959394c338caafd69d3204d32c3bc162db97c4ad31b49dedec15436f61443e65895bf77423b1581895ab8a1a3789b86ef67741c67b75dc026990560745598cf694f171146d59b56c1c7a38206aed039742fccfedb1221907c8b4a916ce94d1c2d57c7b43e7b4e161aa8a55579642ec3384ff2259791b4248782ae438f039f0ba1656b3710c82200274454202a1dbb77533487d387d6a479c6a40b30cd533d71e8ec0c0828b0325a666eda09cd222ce81e2149ff2ae5371eebfbd9b3e6d7c6c547aad0d9fbc0a353fe76dbe31d4e773d427d75497668d52fe6f3bd21526f86b3598118a6c9e7cee47613382098da1468cfe46037f4397a14a47ec97cda7e9a520f6a8f00ca5a39a2fe4f5f2aa545817c62503f60226a18052a79ec8f880ada1d8435f8cae821443aec5fbf88d85a1c1555d356dbb4ed035536bdc43c60ac59db13163bdb849131372e2ff6348d40317f86348eef4fe7f810dfbf09c8002bb6f0663dffe800ce3d1fc3607e27bbd9096644b61f87e95db1a1f553e23a8eb2892195d6e833e9e767f526fac3fe32a626d9ea0f127f1b299ac6c8daed021e106cfa6b0ea5da3da9ac4b8d7aa327ed27500ed7c89cb22cf342caa79f1f04e49972df91d5cc4e2ef45f06b7571659e422f2c070cf034200a120e28f2ec8c05adf5fb22a94e85da06702ddc70057334895098146e7326d7611978ce703547394c1e802960c1ad49ae7781030660da83c95450e247e267973c0ffaf5319f2ab2e75b5a33088714641f4eeb3c01313db2515b85afa47810ea16b18933fa2dc5823957ddb11393dbd748254e4ba59184f0d2a84eb06ecfdfd8cf7646a3c4f1a7912a4d3d31d704bfcb3c47b407aa018ecda459c2c65eb3fbd9e89accfa5a1f80eefd43118dafb5a8a3bf5b71b47db2bfe816a0a13601e051dacc2223fb0be4b23fa7ddfdeab3dc8da0c1f7725260ac3cd13cadd8ba8187ff35e2465d3f2fd1285286342b7b0f4e6e8568b94008d416df0cbb03fa3a5d926db8ec26e833c275826fbf29f913e006f5c0eecb36f53175d01ab1eada969e8e3da171b739f52cb85b9dda860f22bad44a62e7679cadaf10816f1cf8629641b0d509545582f50b2154376d2a727d4c49fe52e7b1e33803b7a89d2857f8194bdc48b1a0a8cc72bec03e7124e37cea10e68059d9bc122679fc25badc4e7d4eddddaa9f484201372a61bb81ade7be48b7c5065c61cf7086aad9dad73d96bb4f43d4b16b13987bdfc2ccfcfffad3cfc98461ab69f0e831457b175f4bc87466c300ce7109c4be695e2173d8b042421fd8c33dd300ea5d83361ff6bfaca1d208607d3a1e7df5338eec8e6654278fcbf34569e3e57df025cf5ce6bcc51a6d4865a85b1ffbe6492370c2fb28b3bb0ea396f15d48ecb08a0df2c40102bfcb4947d1b0fce5b158deb940fa66ae97393a65d899ecd451b35cae7401a4a9d7187e06cc8e15e6779ce1ba863c2074528c42f6f4a5ee49900c6caf177c6018fe5b8a2980f876670a0ac932873a234a802317d2c376785757e510642011e21d285fdbd1d3590fa60b72eca3479fff6ab9c1e13e184daab7ff5595b45087d261f0625282a1dd72a1089c17ee43079e920b25b895110ba625d8995c91c6196f4acdf583eadf5690ee85b4349f9368049e71feaf7a6c7b375b3c639f1c71083eb3051228ed2eaffee88935d82cb8f458c5f3de25c048fe77c168f8fd54149ea7ef1c1996ea8fd47c53d19cea866a91a3cefb2fde3208fd290ba62134cccc564441b8aad09ba8d5503233d3dc33dc80485b48e4514ce1dc7dff183d96d49b9ae1e0796fd3e46ec568ad947584d7ef8e760ad2c7adae7afa9932a9d67748f3fff680648ee4b900c4a2cf95d2eb539be5ad0f37b6068e0953494325a14e2ba6ac04e95c85d6bbe5f91f57e65670e0fd338ea4e9c9b626a01c5afa259c2f50b31b5e49971beb4835467d8b6c19452df70418eb1130aeefb51a659e6f20370ee43bf271ee5a495efa58ba8a3031d19d3efa9d84c445d70a2cae4373cbbe1ed23df8a4a1e85b0ae992d6ee58941cd9ef0fce4a3024f2ce6cdaa518aea3cdbadc3b676905a97d66f6152ea3802e1877b45388330a55573bc6838b7f1465387c77fc01bb0bca231c25d8df659c52b64617afb39f131259c7f5915d6783d6615c88ff8787f7c79770bcca386a008598d3cb527d3d3122868bd5848e1037d8a322b94a6bfdca66191d0c9e8c5b66a470ada4444496d5f0779735cfc840f4cf3a4c4b7b50e1bf5b4f8bb754e8a476436df6f6067b6c8d53e252edc909d0645d18bdd0dce0b1ea8255975f2faa5b1589430fc405d15859060a79f02c9686bf0357caaca5db484494a7f7e1310f67c80cab249cdc7efa1f5e9f329324e3f8d18801a3b145a7751eb978fefc7d968c27b023397dafb54fd42998dc89135ddf2458c4f63f5a2403bc152936a7d5fc3bd0c5d686641b1b3391aa49c60a36217697f7fc5fa8c3e6b4035060e6626325ad55c85f940a3f58f670e357df8f4c8aac705ae7bc19d86799619bee546661c9a1930bf4ff7a66eee3f7ba6f6f8dd9768356735394225399887a0a07c6fd71ea49f7b63f5ca58d766a9f42a6cd05be567443ccac920c78fd6f6e9c54f2b522f9cda95d86efdffe802b1141ac294833e8384691053dc55c2bcffaa52ccc2c76c822120ecf73a9898e6bae7d3826f821c97e4274308287ec3d2ebbf75f29aa29e16b3df6c9ef69904e182080572fb8cfedfbaf2eb0ddc037539ae607e4edb9367253a5ffa9c745826b9b181b6909cd3d414646898f0f10737e8db8cca172d70e57b7888e27c5a4892655630a5d9f424e0bb1b479f0b24b25386a0cb04c6e1263a31d8d1f41c4c8529edb7f0b939eea2f3320e9c8a136620fa6b7c9433655b74c2a59caf3c8e179623baffe6c5b11b2ce9da91fbb2f589b53149f31c5ec6bf0036333d7e26a0dabd6753d63d632fd260e14090b67a4f66613f3199586a31276dd60b24fd3e1daad38155745bc3f40c400eda49ce902abd4a458f4150ad60abc2d19b5346d2832a98cb2b04cbcbf1f72ef4b045e6874e819d471a39950160c3cd8c6dc3ad342856f37c5b9d04cb599f5cc017b964f4aca3cb3a8db9da26acb3f6e1bf4ca8ea710f46ed324bfd0d28bb7bd16a26c380c125880392ea2f123cf02bc630951059cfa8fac6325633d6c288e55592eb380c9d7c0fe5499ef31c668728629ae49efe1695c32655096dc067021cb172d21c054064a860002268d458d0d2d3ae6cd66c617566532e490c55759ae71a7c7a1076ceeda30e3f28b599a51217901cdb7c54383e02083741020b9b5ef736a846bb733ec9ebe6b0369e911f0603e659093f3496962ec8bfd181fa77ab3b4a453ccf152a097f8e84723b49706c3f8377b67ca701c87e1f22d7153cf86f0c3aa3d4075a82c0d93b3fb11edd7da175693e1d305d97dce2611886a57b1a55414baefa4016ad706e6300f2b683bddd7b1b99daf71dca11a742ab68065c37116a5cc56b0b1a82c5a04dd109e8902038ae6bbfbca05c8d264403b9a1355b03da2d1c19c59cbabea3a189562245696939df30a07b5269783d1e1ae0d8224bc19afaa3165947ae3cd25bc7a9903b7c67f9f61b51ceb123848532d13196354f3885354272e21afc6852081465aef468a8c0447c1d74a2c7aa1caf298dc7a6e45082415e0ec97e30c82eba387ab891dbc3b87c9a708cad64456cd5636e823a48c2e2d9f4cf3bac1cfff35927ccfe158d94f9991aca4714389bee5977e6ffb4ece4126ae07ede0a7f00c958cc693898bfdd6dbc745cd4db29596b8da602f5266571e076bb7c61d7b74353fb7e7ae33dfe71917342298853dfe00f082f2a4b60565db79b6e274c8f6bd62dc6d73ac631d6800cbbdb6aa210fac64187d11ebec37dcdfd946a140a2494be1f8940f024e6040629f441b74ff1e1caaf78dab74e6b1ccc449fa9d2f97528f710289510b765abd8cbe3d820bdf217dd02f8875d8ed0fb245ef50e78c12e5d7e4aba8595bb4a5313efc09d719702e2a9f06b6a282251ec4e85b01bce53e6bb10254c91031bfdf958004f04de76ad0bf743109c792f102754e8b2198bee72920775fc77eef8a6d5578c139b48ae49ceae70d9b4a38fcf571dfb80d7bdf9b2de2f406c9894b96884e90283fa84a9d1a8ffd8737701a4f7bc23a40769a605542d8c14a0c7cf4a2a3a56ab2cfefec191df53d611d76b15991603778eb4f0665898d848597e5b5455c25cde907348683acd93dffde27385a1f12a732a59a02b2b5557bf2f157c922cf6e4f1f014215d3e9293169bc4641e55ea3d868f72bd35b6a5ddd2fcc80007119f4b1863d683f762143d0d90d9d3c875e098b7998de5db878f56efb294f2f1729d812d77725a1d08f4d85e66054a6ac94de44797c7b256e5d528b9810b0d29ce97c5bb9e6dbc747f126a98ab17dfda1f696ddab0338055af101fb7f379171852e56d88f92ff0d7f60f2341801212e6a0d0f133befad0d4552c97ab277d2a41a5c9258040b5d585c1b15b22bfb9ff498090d38aae0dbb92063ece3de99e0f4708412af6f84719a0096858cf6243dc8ae545ae662b2ede44e16cfb350603d89988a8d05ef2238d107a5260a0fccbc520f0dc883ed217a193bdb52c531fe40994ffa75e2d3588aae62e0271402feab832e5a1044525447b222078f12379d199bb0aa53e7a98925f034abb601eb0e7c273f13d6d5d2222af36f830bf3c399843c281f9faa5df4dea193d0572c049225270ac479474024a681ec89032d582b918d03d8589fe9e3a07f3e0dc4f405191246203205fc41c4f27a73bd3444b15e4d6d8ecf5c7600d9382e1596e500ac38843a5e3626d8fcb02710f5ce68c8ae8b7f0ec186cd417eb4daa4eb37823ff84b27481faf4d6cfe287ea0786be00b687baf21f009aa93ab2f9071d3aec35124539ca6e1f07abde678314278abe48fcd3b6f6565f4480d9fe162d6ea8420bedc855744f9adc7e0dce17ab6e39685cf5b613854fd23eb65d78f73e365ba99ec7d15e8d959371d929bc59149b3b32ed2ebcbb0a9deefdc961d443e7bc3d5d676b2fcb04b2ebd33928bc7f32c8aa03f85322c867390105d8370aea66ce8d9d6b1aaa5951e7f1bcf4fdaf7812819b317fc93511da13bd5fe6083b87de9fdc203624c9e9b8c6a9de959640779025e61bf29d31e2659dea0f24c53f37b97866c003673158baeb585751f86db6732fc6fa5c1e36f6a181c073312c93dfe557524b1500b1cd537736beb24d81933808d4f1daf84d28378432e1ad8d2c039a50ffeefeef01dde63a13f69ab06262ec323df1cc0ba8e2ab73e56f43cc4cb6fb2f3931430d7decef56d34dd9803182404c7b818ac8bdfcb08d8b82f5fa0d264025865aa1fa93c3144eac6f9f2d805cfbb99cda799a5440ce0f5b0e337af2cac76910d144063f29aec11ebae7abc4dd899e406379fd2ecffbc98e22e836b223895367813c53622bffc7e65d7ae56580dfa512fb8c234bda34265f96c5f328aaf311b4c9efa6562a0d8b5a7f98d36133b669af702800145d6a347bed4eb9f6574f1f73c72a2311c68cf13d2f503bb3ffaaa239d99d0090a71d4fbaf859cc8801ad8cc1cd52720037ca0701d5bc0185b77064ec65bbb345ecadb0b0e707d2c9af489e8b16d39f4e8c5c16128afdd978c3f14f5dd26ca92523fa0d29098d561a618ce773e57746ffa6d333c7cbf615c3b5e6b8b7e5602e08493aebf7ea7a2335c3fc98cc32235acd13b90f91cd67ce54f05be5722ed074c8e6e19bb64fe2038d3610e19d0dd8d5841ee0b4235f50a9f7aad007342f48e329c161c056e9af69c79f0b325f10632612446dd4ad90d0fff22d69f67c604c53a08156370d47ca44541db86c70d3f33b048d3a286cd042e1357763a24bc71b4bee7e2c87d198fcd0b30ba45e64c8706a5e6fc7b91ed6dd83b6ae2db9c9e87a8c8ec182f1097594c390157d354d162c2e9882c3710776c88f0e590f92858b270d97eaff99ac02889e94db3607d7ce10d111c39327704a7f77425147b744b1d9d249f3b87081f91b1b5bdb6edbace2aac35f57ff9c573d814057fde58872d191c0dd81e5f5565864ae9860a7015fca8f8e768c4345cf708b783a1d854343729c53a88d0b3af9b921970c1b1a695d784bb25bdddf4fb3d7822ea4b814532837cb977e87c6a5db700db37a0cdaf00c9d50c35f732ab8f45c941463345d6d06b36b3d47d3faa10796b190f47d307b82a6da2fda505cac3c10511f56e6f9fd00c96a76f004ec181eb95e6b153b46da45ca4b4603d371a0c000a2dd11f07a249185fb5a7b837fac715721b58aed140b60237cfc6676e208f890914859f6f6e916cc558e58fcd0cf009c4559eeba92039911ee65fe0576384702c97945064986e8ba3f8b930803b8fe6a6ac780e18537391fa13ea2d6da918e8321e0ef4bb84ecc8db14a4aba7f45f8f4008b0fa4133e94e27299f3c46e4fa27133fca4b5e48cbad2efba8ffd7de2e3f17517994544411463ef14f0aed8b40ac396edd3d3cc2c6319a2636100932cda904af33677cfa2ec9196d2b7eb90bf5f19e750bd37e6ae5953202b95475898bcc59cec5ad7a90a9ece2fcac08df6a6f482c697bfc12a9723e812b5c3955866e5d259cbc359f602a957d8d7c79043c4e1044ce78535498306f1ff8a52dba9fe7fd1ee89aa41becb00aaa81840d992bdb489aed18bf92462a487c6d7c7624850c21e04a3d4bda85e00bc0ad0bff909dd5e022ab036d97eb4a73a66637f115ed56da66fdd174626defa61ac61b9e54f3cc6e8442d133d5379ebb0b5b76596673d6040ec657a2e196bb6cfb02b4e83eaaab7f6ca23522e438044488e063999f8c6df10846f8cd8beb5892bb43104b06aac868dc6bf32e39066d25941b9dbc88d96648b50fe0c91844794e1eb51b42ea7a7cf4e5821d7884194a173f56db9e9e0ff210dbd7ea9227506b179e605dc81872d7ceaba8cd7953880f5dfa897ba7923712bd42c3254c85098d9f4ca32655a94ebfe54e455fc1b7675e378df6241ba7e1ae14edf664c7310fa9357fe936140b5e6a31c6d089a61cafb711051d735ed381b1bf40cf6d1c38be554e90cde8ffabc51d1ec25553f48f30703e55d597cc50deb4d45e447a1881ed363741aad5b59ac94a7d12bf4b63139d4beecbf2d62b1721a96152871094f12fb626e48443c554c4ad0a2d786600662d4914fa7dd0f1a458a18ddf915beed9f6a6736bbd5fb0ef4e29afa0c9b265c1a912d68eebcbfee70620c175e2ff1e45597d2d378a0cc421a02265daf12bbf20b5c0adca3a2a2c71f863523ad00f9f110fbf57dda63fc9988f52e9b7459ba5f57889d489e502e4a4f69f02c9e3f54a2dcf5c3871b70b3676088d5a7d70c8b441ec6a13e3000e20ba66fba2e90792b9fb2c0c835d0d1f6af91dbfe8c37876a1e348db27000d0d3befc8e3f520fc2c1712e84111e3362b9b33ddaeeb0748e1ef08e0b2ff31a0e9c9985dbcd7613b5415ed5c0f1eac240443480160b90f7ee4eed68745186821b0b7f80c6d62acc0b6ea6caaaa4f9b65c58b1b3b2fb323f5f7ea6767c371e6ad3068f2725e4a91be8d7be24b438c2cbe42d992edee22476a04375218b7be39c6c0c2fbce317b5b49b0e2e0cf5fb07c988aaa3c44850d9fefffb525cb6fc5c3718de4acaff2e27351af9bb14eae7255837bb2f5be3e50dd60c2b438440b78f846579e6f05cd11e93e48ebf3ea80b38efaf7df2e7424e6405b7f81981a69a01e313683e8be3ecc490aa10652ca988c66d8f49ad4053890fdc791216fd95fd036e65f23ed1adba03c0059e74d473ec56aee8b21a3fa7c742c1f22ea729845e8ce35b9346683a78c749ebbcef3a9dcb76b2e87bbfb7fb841646dab66decb8f3ab0abfe9f3e433d8d7fff4d5cdd245c61304a5a702e90120f9a48ed875b1dc9d8d6f1dbebb9f09f5f341ac4950ca7b8aa664d4d5d65a2008843ba966bba11fdc23b4880565e0aea67de503b8bf7227247b9038530a2eafc2ac9c38b79681d20e9845689d0e02f90ab636df30e99a11660a7c28ecf875c4d45f357c7f81ef9ad340690c4e72875f4ce2529dbad210de58fceb440191bbb203300467aade34c62db4900a8c6156426c1371132c83607e2ad13bcfc965b4add2a171f0c4b459136f66026f8234ce8edc73c2b735edac8d5369755fb8c95490cf34f97f1a4573896af7101b78d6bddbb36dbd469212c18e1d57f0dbd9298ba3f7a2c769767c9552e0c3fbf1012cc14ab8944c2bb829bb0264da013c0c66c4d9b4ca109009714a993594326c890d904a2d5f44d7020e5663cacfdcde9decea64f83f43d01690017a6edcfafafa4800fbe7cdf9a2f339b81001f531ed189c23469162d06c81d40f38dbac83ba08b880e450032b343ab9d180652244057e0d02bbc8a2139ef7ea8e82b0c7098a5c241e49d334a6cba01e0e719de2ca2a12b1f21575cab30e71348645c17c94e497da10f58b9ef3e20141885bde28fc6b735dca9b9e9a01253a0ef04b75baa82976468ea4eb6d511f1a99f97ac471cf784132fa49fd2375a1450a50de4fc2a47264d56ff952aaff9b1bef4b343a1ac87f46832af2eb21364343b60122e11f085e81736af784937f0d9e149f30436de723dafb92ee490fe903c4ae999bb1229d6af6c49eba0ffea2c51ba7bab48a34b843e0af7f4bd175aa592bf9be8b5de294f4aeac26d70cd4733f8f9e725631c2f0119d5e16d116ab00f03ae6b6621c7c494b24006db3a308de40e978c843f733899d8e222c7b66e86cb6de9942384f0557ed2e3d2b2afe20fc06a616c606d9e700b02d26b6eba5d376bccd0de1088a3e3f2cdcc56e6b19f6d4fab05c55f71ab62b0f85c8d830ac944cca989c79c26dee84c0887383293377de499e7b1c4ca54b143369e2cc95d075e90df04286af0cf80bdcef354b7ea2d8dee7d9b9eb2beb63d7a7506f574cbfa779f04eb58b2172b71d725ca6e62b43797dd049be3a2a7561b4998d917c508854f53e4726c479227955557eddf77470b7a541add7ec548b272e7e4b78cbf67ff1ea831fefec6a297821bdcd1fc50b61df2e44fcaad685f1f464ff6dd869df998c6725f4c942302dff5847dd2207fd17be784715f82cb1dfaa91299e6ed0efc21149bab6b5f973273c6e55164b40ec274733d62723b24a5a49bb3a63dfa31a1f7c2105cc74cb91686c23cb0284f6004348902739ecf22e4cfdd3485674581618dbbf587713ec3eeb59992edf813ae64c690d4f3de6b2f326bc326278cc8e0b3de22952c884f9e18699918674158312692389e002cbd2c674eabbd75c228e1eaa75add21f5b5161730692b6beb4020f32eb3abfa856127ec3a22244568e6e4b4f82a23921e017fd55b1837ed22c1f66385d69722bcd180423c1c8c28baa83324a20e45e92eda11b4609f32486139a203faf7d127180d0ea0a56284117c46a59a67a1889696ae590e761b88afa2c51d08eacfa38abcf777338cb24d80ac433a14772bc7203f2280c30ed715570f1aba9f7842e375e5499ddc7d2bf7851f968c3e61011d419df794fd8758357e17e945b71dc0b3107109918b520aa5e3c68c491d9c706b747f9b767978c0c6a880b7063d9b66d8743b0bc158335935f01aa7c90041382de5f65560d9a97e30e04019faf944be7ba6d91bc0a3a27e568666f456b1c013305826bc6d1d5aa849b870b42a94033bfa272d7bb322fe166d178238a7d22726a38a2b56448f7910417e4d7f26f4c0381fcebb13bb6c3e284c1cca032e13ad57742b54ecfd95e96bee9f3bfc2825f582893f5b11ab780f5e5401b54bec6a3b39cc30a3f54df9ae995c180077e5036dc4b0e4031963bd52b4d783ba59d8566b5c79bbc60d6456baf1c77ae99986c529234b835f7fd8fbe935fa1422325fbe065eaf9d371ed1108d6915510f1d42ab8e926b083a59a2d9f0a81ce6bb1a26a4121275640e9e4feb5774180748b3bc9cf08603ae172b8cf1639d30a9285c11bc97b90950bd35723505c487851a82dca34ca31829370c91773719ba8923d92305b912800c2bd2c539c9d5aac3e3705f01df38b43a32fb061a363534e75a2b62c7ecf4fa4679c82589a8d87367c1cf36e2f909828129dc685273757743063ce9daa6e7acd3f5ff59a7bb1abc8555ebb04927e83662deed53645a95b662157fef533b6e71bdb689044d2af7dc7ece07e82c946f49f0c60d7bcaa67ad679dbb57dbc80167fa1b11c23e89a0dc494e536e09af04b23a955e98205efbd6bb819dc60170de2d7d273c31fbcab43ac7644154d3584a2748c70edbde7132e82f85c1d417cdc28219393edc9570aa05d759c9124fd2bc1e5335019658946139c7a2c1a56a7df60bde1790e60977aee0d600d78151613a9690acf1e8975049fca34716e6e1f4f5e8150cb7e088730c4f686c2ab1874d04cc7dfec8a7c13296dd2347fd036fe7762f6bfe6127af85aaed1750a17e91c9be4b1e07b2229a476259c9ac9b128be928a319ab4df4bc395cd1527722e71eb6e7100cee5d41269b053b1fb477bf6906451228b473ec8a58b273c5cdb7cf722ab200f7796e20e08fe474c4bad36f229ea8ff20c7a86fef3d688774fa6218ac2af75258d0ef24f0c792a7685dfae8636773255ff6a55902fb815afaafd54617874555eba65a2fc242aa2cb4711bbfa682dbfc860bfd4aaee2f24036ba493a624d12a41d5ba456afc500e6468eeed0c41edf1418392cc29b8be9cc34e4c5291a75fb87ec306391a22f73e9576fa189548f37f53e6694b4a9cb5e6dc51a52da7525abfc1e959d2150b2425f8edf9ab94effc35da596bbe3dbabd340ddb829ffe38a7b3e808328f33d616de6e4e944338949861a7af32c4281c8fdd75949b70c700150da8469f00f1afa6367715a0b0c74635ee91ce89d32445b1e52a2a96a740cb5fe603875b7aa9679c86ea7af446399c5693cb43050d0c1bb8d5c20c93eb1b7e5c5eed2ea9592e03e84e252f882a15ffbeb9e808eec43bbb0cf6daa0cc924e73f567886b5de92956a8a2d09f1c7a4ef2ebe4018587b4d40a5cb1f99af76e457600914400c770a63050638e43ef0c0df87b37295038dbdde7085c52630948a61cfcc55ab285cc24268a035deb65ab9b545f1eb09b48fd33ec6d1f680b9673cd0b3d9fc568c72685e5b37f83cd55c4e77da3a83fcf112e961b560eca64080f1deb3de8fae1bb82e7d599ed298a658c41add6f567f989912e90b705a9a20656f3e19982074bb310aae97d72f9fb2a9aedcf07779829af681c0065def5b9235745517e1ea78cf7df9bfaf67a9f27425730c4c38226c927c00abeb8f9f4e58744914a6a0e8c5c61c35bfe14b934c17359ae704085e6198ceb9552d0eaf8526c63ffcbe33cef2955d9ab5eee939cfb9aff756e37b6c38106cf0e38318fcf7ed086541264775e6c8b49e244f00815c36182210c500aeb9a83817a1d092c6aac6888cdb42f762f36b82ef8064c7a7ca5be16b25d978f2fc770a0ada84c5e31aa4b74fdbaa0ecd6f815927dfb1b6db662137da35020975a6155f26dd89a75cdc6e264e42b22f24cda4dbd0c15eb21f15a06690af34a77f93c5f93276a51fc6d335e31275f8d99bc9e95eda9c163a90459189f38497245fc744ac3a5d06218bbbc231915c6fdd8c22f7e016bdcab923c513691a81872dab22a0cde290517f0e16c010e82ac74ce730b62a229ee933147322d8cc58b210b3e582fe5a23d5b439b752844cb63687e41effae4d0b75f2f70d9071822e5eb8afb04ad6a0be86793a8de657ba44b19edac14c79533b1fff9792f50dfd58999b84083bc220a964210be3609cc82c0681b3dacbf00b4f6f3702d4efb858ef1bf42b597e5debb6937318f3ad59fb279fa6ffa33cf5e9d3626456ce16bfd798a2275ab5a259c003c56a26ad5dab0eafb065805392a7393118e70367c37a54829de04ce25460facfcbbb130030316e1f521c9ac061a372239d2521110cb9641600ec02b3cc3fd64f3ab8f1c9f9b90ecf05451114bddc677bbe5d3a1bead4622e262511eba45ced513c1e0600fcbf06cd117994313a4f3eca49dc4d7517ac82c52908924cbd1e84c2c1afc7c255b3201e8851289d69d092e5b12d22e266a71b1fa2c1b126fd0f758e2a792ec92751b856a5c12f265aae05b6a3bb0a2b82b6b40e93d4597711c6dbf32163dc991928c0e3006e8e44a27ac1925bf6898026251665ab0de9f763246f10694cf9d65f76a479f6a91f3fba9bb36e6c23fb2ff6390a92f33969f40e8ecd4a2c192825ed88eda8a96289b8a5b99f9ba8849170db45349ebcacc378aaad821fbcc145065ec775a8a3caa00094e11bd6571f2005a9bbbbca40c1ba3594f4f5a2a77df69e9765e21bf6fc05865378e1328d1394bf9639e94154d9bf35b3139d438c2d836fed29fb428bf8c5b27418c3a890066faec163804ff36bd0a6dc3c386bad39417f3e1ab37b315b5a628ff0bcf7338af0804e24cc8b99a358ddf6756bff55b7672c46e75f9cbdab6d78ce266eb5fa1e06830225338ba03f03e173cb507c298826a3b5fdb9b969601117ca3ee254477ba5066d4fba0917fe3813c89955e803287b5e368af24282cd1024d74a0ca1e488b1aceb4d82fbc7564f1fe0e1a7f0b034338814060ab7860d1808c03fced219663023f39d07943aa0681c011eb0b11ba0c8a220887ccea013582bd6cb5f704b66ee7efd9e59f20bba944658aa99ea047053c4d2d897985b347f150a114da74efed04f546da2b001c85263ed106303432863b7ebcf68912aec515f54ad968d86f08b96891a943c3bde672cef4b18c76c8f9367e3650eb8386d43c1230ed48584a7aba0d87062b2002b5b088f022a62de398f07352c650382222cf7af9ba91649e30fae5cd66657630e007dbb70162a8254b8d39a188e221d49a6961971b0abddaee6a1eed4206eb4ab7c3d800211a28e02f381fb1b1924a666358fe0e57ce5b7dcd6d6978be6120d65ecde061acf7b225a49df5f4501fcdd2ce35ec0d200d3f0d65337db3896d063510d4c4f73b481f09ba951461d8b0ec1ae6bfa8c0023622a624ad1a38404fc98a7c38d57a9a4a6c2d10487ba161010e9b7fa2645e831e7cdd5e9e8383889467723960c7ae414df32903f1468e6340e71da4e1231393ff17cec3dbd5b36bf14a95feb14599aaca9318afffcd810f747a31c69d308289610f2d96a0099f31c904228b10c7c6cd69f7fd42e6ee023e081c851597759fab5acb73c936da830da56c75c83bb0278e7ea30d1b2bd73ef47ab1ddf83efc29a7e8423615a915ca5222eb6944b3c265d4cf00d31a16d92d7b2adb5aaa805351b0235e1bed8bdee3ef4c845f25e54fbfb61504869f0ad982c9679f82bb32ac8d01ec32cfc803f55d126293e609097cd8660c0cb2ed4acd5a2f199572a86551a4c1b1f00fca3468593dde885a03b10d754d6c8e41c663798a9613223d6fef28a18c7257fed48ace9848a0c03c4f825fab1ed03639e6de5c3e21fb0226ab31191a1f1ab4911399311f94bfb96259f647b6ac523239f4c83ccaedbb1097fbb75daede3dad314699cca3e4c268393642174387e27d709cd094dd931e7e11ed3e6377fcff11ff3d1a3a591ef503b892751bfb7059f52afc6c43a61ee59a1da2ad048251ff661a9881c43de374edd2017cb96f2e5bb9afe16dfd31697da00969478aea80e0a629052d9d00eca546a51a90848e418e8a31033c7fffdbc00a6e49e57d04e614bdf86b1e7bfd84cbf7379e0b6fcaedb15b0f811ed5c02e8ef90bfcbf580d02cbe63d5621a102267f8be04ac3697290d46e65ac8999205b64900d606a6decd9978ddcadc44ad6ea4e6eaa8c998a94ba56480e6b6a5b8e4b01ea4586c79d189db5527215f994adf808cebd1bb693d8b55fb2c48f4c25f7f3b8b043ac567b5d45fae1dae7e2f950b526049d43b0c3039c7acd47bc15d9162659a250895b87a2272487cc954304f56563d0da3ae034aaedb4fb2cb433163e4c5b29ad8099bd2c1502d314c0ba5bcd2db10d8fbfad0d9884b95019928a32beb20216c28401427246409d4c2f88b7c4185093704fa00c4883c704e45c1fbf382c0c00fae7e9e2bcd809e3475fad196c891c497d174ad99340c27aaab5205a580fe32ed57ff3184b33904d03cfc83fa15ab1257ead422099e83bb31decc65badb07df7e3258c576855d74645aeb3e66e9600e7a4f8769f2d3b46527a0ce7b68eab16877fbc7c10e3af545b6cb9a2e927daefb0cfa79b46e27f883e2a92b6d07a0da90fcbe6446fdc1e99e1fbe4a17b169a0a81118cca05541cae33689414b08f6f60944f99e559a2fb0e6ddd00a7b6b3221bdc0cab1b179e23fadb79d5021d7df56095eb43147ea5c9942ec244940a72e5192f9be2ecf245b98a4bca595369cb26b0ce5e6425491425b6ddde7b221aa76e9cc63686e09280239911d1d38acf2b92b51e127ec52a1d6ff3e9c50d776c1b8e7b7127cf64071cfd546f7a21d1db9e8aebadf9cfbbc2b174b5ce709a77e89e4c8e82937fa1363b8acdd211c8f3dc49035e8bf7385aed331e85c76c1cbbb50588e5a96e164e920ad90be2a6254a6600b5b7dacd88836cfb2cf8b1cf75ef9584e8933ffa569fa7fa0f0293d66ea2bc76f1f6dc071689b31729ec0c4a3edf909d56778343ac59e8befafaee135cd76a1ae37bb1a0333760a0905b402954371bae25cff439af563c282f1ed27286046cd4d627af329c17d81502818f30dfd663a648a33fd38c4a797627492ee3e092e6703bbab83776ab43f5f4a95fbbe3136f182d6c3cc4db30dc59081bcf63dc40727ff56fd165f1861117307ebfc14f0024c943dbbb67d2e532b4f6dac687938de327771e996596d70b48226ca3f7f6723bff04f228b24767620a7f9ba39e779d94ca2a54e737d66902e665253edf39a9702e228fa7a352de6596397ccad701f8cf344f92c8bcaf04fd2682f3027d00818488ea3d90503d74ae8877b2bb08b241ac662dcb35eccc777fce919c2efa2c1e57ac76a09330cbf5032efcac2e0504118d60c4e2c57c93706547b7140eaeca3b26ccccb9025e14a9a93ea2e4e7dd1c81ad395860cc860c1329ead827f3122ff51cc6adf493fe2cc93625b6201c4de3a0ecac70d851a77abd6fa6643185f4cfe79e53c7ff961af7f0e081d2a230e75f386e1b61a4767d8e9e1ee0aa49cdd2469d47efe992d036c4d4b4091c46bddbc4044c4bd709f313308baf076f65f2515afd3f8aad9ceb58722706bf52cf7fa9e895436071ff99ebe612ff1fd1420409d0aa44fe09404f6b9a3fa1a7c81ce72278b040baa85252f3a642df049ae140edd516d721fc93bfd65844156212e7a7b0554f86a92dfc86fa564aaa9d2ef5d6bf87a57722ebaba3e15fd4037b99597b20fa507a2d1ddd8baf7dfb8cedaeb9bb967e9c666a27fab1d6e035207448e52c02fbf3ad96cb9bb404ba0d85c472bee9da20b08a7826ea1aad7061e7670afaf56554bd6806d2c4adb060afb859c93873a602e67c2413e41aa891ec79792eecbefa4d3df6266eabec7da006fe01e6fea326445ee73e98e54fb486f75a2003177fca169df9a3e27f3100f1294eee463e5f3ae45ee3e83cf915686a2e3d2f79dc3e5a5f49aa8d09f8f8e3f21875af8fb7099b89a2e208af2cb77a2c082e87da54fcfd30c1e3c85435d5d0723b26164414cd9c06512ce4ea8777fdb9fe4dafc5514050724a008cf0f0326f9aa22eb16d3e4c36cf897615a0af15b40a617342bb5efaeada50e9e81d4de971e0e04e3dfb624465a7e9f9f6a10cb21adafe34bb24b2181761b4322823f70fbec4fa3a64ee6df0e8f7c77c9e83d501c6cc7fa092241ad1f71d34e296e297d6dfd5997dd276422c96b6e17c6047f952fbdba4c35725c3b5646e6b3eac5a8dcf81f55afe550a919dd861b2d79a26af9edc4d01cca71d5acc013c858672b41f04878dd17301b00b358c87d3d16dec7113ab4beb7912d65b6c68d81cadf9113e66f78e60ba1f2cd0dcd517b9924ed8cfb1969a5a69e835932ad9559541ae9bc0d3034cec6e8aed5c92d1e201604c8a0b0dc45e2d53534b7e75be1cb5ac73ab2da349a9f392e8945dc7fd12589907687673b5796f510edda08aa19d5fa2c32179a12c0eb184ac9b17b403f6c00c0b579571ce60a43b6a18c219dc1d91a237069b1199f1807e1c01e0a9ad541be5dc4c2c276e9855c1998496af3362baeb500e88a33762003b5429ecc89ec35188840cb5af96d5aa80aaf4929bdb7e550f00839b810d619d091440d51b97e6c319aac70d2db3fc53fbf35e3441191312dd6caac156e5a3ce4e50c1314bf56edf952ce49cf312d53355122903baefa67ff7e0ab3af57f4b7e8b8c1bff37274d6177ee01f3ef31ae992c361822c5fd240c0b15c9af01c6f6108e81e884097eb413af2c67c45a5440684d3ab88af348b67da0693769d33f632a80e3a4e82d38865f17becc60a541156b528bad3ab1e4b76483526bd48c774db2b46695f4cb09254c583a96149e4b8c79565d3266db61b47c5ecfb18c6f0b4970dd280d33ee14f1b73a258cafc5309f7cfe11c75e3b4bc40550fadcbe2360cb987855e1c0e205b5ee93c27e8f3b5f6d7d0051d65316dd9e9c1fd185ef58b288a70ba02c8e2f37dc1ec7cb75cca24fdbaf5cf17d205bb495a1334459bc9103b0934ec78075425ec4abe431ac648e07848d9ce840ffe28819fd3eba42469a8dcde8da7b9bd4684f02dbf5aa6f0282432cdc4a148719e174e96c414b3bfd4604ccaf5f69b2408513b6d9c3bce6e874c35dd9b5db649706614b7cece6dd19217fbb491e1433c8165c784e427d77b4b6fa9d491cdda46dcd71e50b0faa5ec165b55c825ad1d0da055fd2e1b65d66de670d0403081b703bc9ea89fa84530f9c426504fa4a59067df45bbebc463ea7eb8bc850f8ec6bd8f252cb6c5427af956ac81ed900e173f0060a3acaa2fdfabbc463a71a1787ff62cf099947a5398c3c322d73f1978d2551e6614a766f08b5e1f92d722e318288fa48e50b85013736d77a8f4cdc2ec9c00fedc8f4784a23e438db0887b729fbc779c6216584b9e8b8a04e83559713b77e1807226bd0b8e3dda554fafb0689ac092f7e99b19ddd554d688a533324d3ce59d174eecc7526d38af2349ada199715182c8362980bf03b58063ea989b451b8f165690100b5600d48ed8188f1a7a581df3aae0d76e4c5eab401d380baaf710a614a4f6fd619ac6c99b556aee450b7b3dfeb9c4414b8577d080f845ee4b3df9e90af61bd7ac9b8b2ed90dd93cdd880f046d0c336d80a0623aa65486f4e51767a393dfa31d1abf84bb7257ad0baf98fedae77682e6a8fa8225082950c37653d9759482631d7e2376afcb3e1565939f56f0dc8a32b703230d1d76042cde7ead3d97ecebf25f7ceefb9f640f843be3283e4f6d1cd5288b6af4d982006631a9b2fc1d39d1ce5edd8cc6c7aff37be9673de3f52a653557e4f193c560b7c6b3930514c84373f3e8ebfadafc4108f5aa321adc547ff6d92455e73cde820e34a0e5eb2cc30203fd058482f2b5ca6885e842a2dc8eeab353b12ea9545fa88a15ad0e2ea8b54e3c2d891d11c83ae07023042b07288584514903667fe5cbec565bcad5959cf6d13921152fc7928125325e6a5492d3daa4ee865a1025e7cac05873585f02b1fa83cc21b155bf6bdca959e21a037aa731c435ff012ddf3c82c09e3e97ff4342d85dddccc0ff37bab885b1cbc1c943ba9814b5641394ca984cfd05ae021f1f0614d5ec8d2b15f8026e81ac06cbd7c7f950bc732e633f9dac626e90f2d5d5bdecf6145825a33cfdc8fd19dee18cb6810f8a45fe3865c8fcbeedbd8998c198363b8c12a3d4d34e9c71df37e4c473aa8d531141dc09b33c3fb497ecf0e19f6a959b7f095239cddc1f054ba69d111247ffdcd262c9ef8ceaf5cd5997e10ec150778d1e7120c6f96c97c364c1d697c28f091d3c308a2bbd2c582f5e056c50bf05045aa2a8cbf106db432fb5316b2aed7cea368ffe8d045075b5f63705e30b52cc54646e6dc88546f6b12404b26cce40a337873c3fe22d6b1812e7f355a8c4aea3c315a566b17023f83f93ff6f7d2a914b4b133128308fe0ddc7073d89deda30ef279407e02e977615bb298680451326643b92b50e326e17a4de595899be7c1de641603f2a48c146afe70c7d006ae3a06cba246d4059e4bb4da6e20cf00b29e52e2971a04a841a507071152208bbb7ccf1b02ab18984f24930a99a7edebcbe812ab1974d9615f7f2ae4e2af9a4dc82d3bab6a91bfc1a17a47a39652570ffcd0ab4fe211a0eeaf0a47f17090165030598fd28457778073f7e721ea20fcf2e1a32e4bee7b1c15a0493ba42c707fc0f8b7bf6cf2bc612bd2c916f53b7314cc362366f61a62eb0c7c159ba7c29e272fa24562258d0be3ee37a70e1d9b3754ce2bb98768b59d93a74bc5f958874c8802d838740c79f8842856874e1cf6c02383c49cd144d9002f38ddcc4655e95a66b292d0964e83d89e43ea3413755b59bce753007a193edc706cc186519c1a58c22a7d3381f2ae238a707dc96976e9a84a05cdbddfc73ae92254b0bd0c0fac332f99c1d1ee446c5014f61fb6a690ce4e59208fb776322f39402270e609a996570c9ae5a780d3cf3a8ccd79b7959e1f794a852d666eb20342373e2681b57a7dd9f196357744abb49d60ea57d5fccb2d0a24d7ad79f33647e488b2eb2041042b542038cbe4ae6d023495e2d822cb5181414ce8a0a85051651eabbf7574f7a54c3cbec2b6d6572e364ba63f0df0bd7425f0e3a54eacff95f68b6074bf54688c382936403d4a30da9d837218afaf3a07f8d0735ca9f138f783a683877bacb679de753d2dea526f6c81d90e64e8a49d17f2db9ef10b63d5a1e4e040984d453b6a372ae9230890b28f7560c15f96f3adb33b1767268256354a780d96124070d729739378dc7ee8c68996532f59cc9d6ff6fa775d6f0fdbb9cc887981a0747da9d924921a78cbe2f28ff81c6cb83e08e5982ff81cff3b2e91f5f2bba81efaaa56424edd89e22562fa4af0bb9eed711373b776bf0fc11f6b8a5ab45e2eac5d9c648c9aedb009555bcea1f54f619483f445f2ef5e653a1052271b0470f42e80da3a0c6904bcd492af510bf40a6e42c7900bdc70a60eb79dcb5c429942678c03390cf96fef140364b75fb618715d47b9e442be8fabcdf3a0cce752157c17b5044d3a68654f48d6687f77d367b627af01f09c802cf0902bd5470bab141dd715a33e4d35ff6e181c4b810396ca7d6231acc3bb553138aff013cca2402ade28bb71d12ea7527920ca80fbbd541a59118644f0878ad0e1e6cbab80b500c5bcd8b6630c91494ee402fb3095870d46a43edcf9610166a290ebd94eebe7f9b3d0ba942e3629ff8eb96011ddd73bd43f84972c67a47a9cd7e27f3a5c4276ccc2c681282d97ccf20bffe77dfc78d1486b8e1fd1e6ee0a912d9dbd43f5c616507f4f341eb04c1379abd9c458ad1c6c79b5566e201b5dc7575ea266586d8474ba49ed1aa050c8894956678808bc5c3736941f9e29b3514ec00ea414ced795b99fd52a43142a81d43d67f7bf91e8318c31555e10214e52ba800d6743f69510ab8d21e256be624c90ca8b54e0c88288b598a9afdab9f584fe8c7e4b188973e59afd1f03c89e73b2602f5de4b6d78edd5c5570e510a0e084e0d7d00852ce351d8dc802691eb97ffebd1aed831c3463e743aa3bb320fc6cb8fd27ea522b47cb378b4c57719d38a2e970595353ae01c27958bea5317956a4e3590e0838d7b66ebc97378b7e56afa5687bae8bab910164bc3b0481e371c752c6704599d0cf64fe8153d062ce350b61970eeea126b73980664a46f254a817b5281dada6f7822ec9385bfe70835578714defd4062709a1fe76259288dd84a2dbcae5b1b539d8f716c4bfa99f385d5c248648b4c6bbc6762a290dc9d306ae2b0fc38dd27f5c2776f0abc02bfff417fd2d1b1465f1b7144b94f02aa97d9fe76dd4c43852fd55b93523392184abab519486f344e8bc224bf36250287414d5f926f8abc17b842a02c23cc0a2591d3b38823bd2051ae35a3f6a77b554c2528f51fcdba9a92761387aa6396c792821f7f74328f5f00cdd3dff6ac749776fd5dbb15c066149c9f100d32d38d61c7864153f2f422c5e990e0b9106f889754ffae319a64da6dcb03fa2e0f2eebd3844a10d4056effaab9b3cb19e938023e05b2fd620ccc7afa3cf79214acac4aefa576e19d5c1471c456961cb6cc4973095cc2417cbf511228618a755293b99c32250ff1f6d5d6ecc6c8ac7c46020b9f5eb30f990fe4d385d6810b6effb1f722ce4911a6014133022d9b75c4849c66224e3a949ac9bc95629e4c40527ab9735ace8c3a1fcaf467b9d5e6d4bcee2df15490f0cd782e7bfab46e6714161df0d1463c6df714d046e59bd500ec707113a6681d6814358bb64aa2bead2a903da5357738544f27335b72e5d3e493f7fe293286c0ee0559d8b76f87f2ea4c7d37fedfcf5b4401935a7b78efa3fbe6a0e9bcc7879af8db08e9c0dfee11e153600e1b50e6fca558271a7f8b6c1396fee33ae02537ee70dabee1f89955e3ff6602163c0c6aa5198402872fb4e42d0f7f0a4e873b0065da03857a2b74e8d7cd9904e37f0e7e2992e9d8805ab435a602c6ac5e829dcbeb9e9d61180a7e233d7e36b823411f15070d186887538a1f7d134bff47bb50476a6692847dd51265f5d72ef6dfe2aecceedc30758491f39065ff96040d3bb3b63ed9eac0468e07b21ba4e4ec6023ed15aa0fd2220ee93e2e631d95db0f0e13b9b9c77e8ac1bbe8b97d27034afa59c0f519e97fa2967a3961f1a36fb6ced9c73242a255755ea107febc188194e840fd4763ee666c10fdd22df098af4cfeff48b3fb7ab1bf0d2876a67667b1ca62070b40fe989e48d178b4e624a0821a5f37cf1dadf03fc5938ddea06fe9c9360f4c0598de1aacd7a5ba636e6752a0d8c8673dcabc856546b85a24ef273e7775d7d3561405b72d79b2bc5d9631848c3e7f14b3e13a4db96a2a0f0f4ef9678b40063f80a2101617caeb54e7b4f1f2aeb9145c510f65c437e81f8eccb3301fe3243473c643115da46c69b09b0665749e508ca7ff91a82b9634d55e62d475fc235e85fa2f2b4c2ed4805b60cf6ab30d66a56fdfab6f0e60352582c46cf2aedfa300e8848eceb5fbdc3aa7002a6a317b4ec0feb456bcbd72674766fc74d890e35b8b7a7ea68a1126cdde472609b4be67b20a17564b949d60f3e003714459536d13f783c4b538aa3c367606d0fd50eb26e759dc4efada318161ab85e16c4b81c70fd632a4287faf589481d3b661b4070cd39c646187f7ee1d7558f8577abfb757204c96665ee6a5e819eb934c29aa36b22ff76b40b740ac6cf17e67fee847cce37f14eb2665917754515f4d913ef323b56e863dad6157b6e7fa8046e6dc716d91f7afef7be2a0dd4bfdaba988ce1c479434a6dcb0ad9da09caeb6d769314690132930f8a9c19c389194156be50aff0acf7c6cc54e27b50012b40116202b0992c531a08cd2ec545389ee3eacf9facaeee912e510e841a952972228de1e57b20d3a1ffa720c86d43a75b991da586f318e8e2b2179f0e15c53ac011547b67b4885332ec131a73263a92afdf8a1025a29e9e2bfd4c22ea9a9f2fce223ec8ed122f3ab632910f5c53d7c1c3f809fed517376d4f77b9e1e35e240cb1c1ab2a1154656d6b3a1be624130c6079e8d4fa305b0d1fc458d34af914fa231f2e84faa21ca61afc62c22980407bff138c0a4d0851b48100fe8700fa35428d9a9c74a1654fdcdd700bea4bc623cb3fe7cd5c9d49b2fca01c5a04694bdc805c0013f9b4573a4ee35d47296e4ab60a34a2a8e105e2f8f21a001df568aa1dfe5bc65459a40285367b50a233f2b6c9f2926e24deb5744f8da5305fe38801431ea72f122b832a055403aad6ea2c3e931ac897379215d451512bb0c1c5dfe3a17f49d697be4c64c02435d09306a056c81c6a60c1c86634e635c30087197a5e9852b84f408233371f19ac22a6431683b87bfd716abbad9b400bcaabb23cb8d8b0c31711e5a4cf08f3f53199ddeb0457a59d9e303a51e617c806a9bfd9382830b8f7e8837e0e1b3d6369dd17ddb7889b8253381ebdf7465effe5c5b8c0f7f27f542e5cf23f7c0b660da8240ebaa744a3a64ea1485b6e15db4f9548285a0dcacfde17ad2646241580b94c9fb8d36b2f97ff989e278143a539d2e0162e03fd68bf6394402f36510f045a16861b5949f6491de18843b6e3995042e8512d3605f3af8b0ddd9d75fcfb9f73c47374d6b81608775986b4bc28141dff6553515b499415da5463bc8854653730535ff82c757961652c08b9a5f6f962526c2b8c9bb59ad432afefada06a38b8b13dfb9a54434ef816f577910dbcc78e5f7b300329e4bea03b07b2c14e84303a90b5eb8704fa39afd6be3c5d20de060353fadeff197d0934e09babb682f11d5bfa73847fc12cff255b42c9a169c5565ebb9d8b75994dee69af8b82a14ba09c5fb3d7a708a3262d295bfdc7f2bc564dd73d8842e2963027da4cfa403c1d9812914aa9e104882a52046c7248c27a541823a79052009a73aea367dfa785f27a875278704ae8764f688892e11c13efda97a7817ad1cbb8fbfa2fbea4b9f353a6ce083e40546b172130667ffac917a9c52b430470ea43507a408e35d41b90ce18a5d74fd913d4c68fb82ca9252f93010c7e245d05192146ce3700ca9d5657f7af3bb8c157d19576e34636f005382aba2ba02df3776f4bee5eff699470d572cc528d62ec2b8fe913ec1a5ab77d8d05e81426f8f2806e9747619d616c0dff53cc4ef4094e2fe34e1e2f1da02c07374cf84643dab107b7ecd55f8b63587945018009e47ffe1a59d5e5f977de6ba2f9f40b420d1120f2cc7d4ef0a57fd8c4a2a01306f7b0918483cacf6d9ad4f113d3418f0fe1eba08f2e31cde002e1d68528956e6c416a0df246e714cc1fc8687693a0ae90cfb2e43fb02f55c394ff0fc6a989a67822e817b71801735b19aed5efbedf3ff130d2155f8e7f9bdc984b5da730269e04405d9b2ec63d1d15b8d1e6d13eb7358f4dc00e40727f59315da6e23a0eb2e0f7d48a3288440471d8f261aaa2e24ba3f27ca5b67ba4f63d22cbbb4b243c475950243993d2d1ad8f61c1e5df4f392cfcde576ed04a24cd1ec15d860737ba120decbe40fc50ed1208fc9e362fa30f787f9f204daf10d13c9213ece4dbfd682de271d77a640a75767be907ce2c703d91a530dfbbe047af34f27585955e8787b5cb95b9b9193346dbf0ef42418a71eaf730046a692f87bcbc76eff8782f7e2d92b30ee1180449dc54310b067e50491813f52a4ec7a06e393251bc6732aa65fb7223d6867f7c5a7e18dd6f2f86bd4be6dd3e2224e8335608e964189259d1b49a425399e11ec88a4b2b2920e307caba78708a010fd10f2b410976e02882137f64179db9247327f875c9e6ecdb416514bd0cd293c0ff0461c125fb25c7ef64d46d052f549da850aabde1e03087bcb535d61e5243076aa9254c98080ddff5cec991901bd1151dc5ed60fb52e294c9c3840e21b53d724a5bddce88d28a2399d78867f7115ead531046665f422814e3cc75705f94621ba3fcfed2b557f358fd79bd59d9881899bf0f8025e750a1dbd042abc3dd19955b1b6a65628a0b6cbf1caeb3b47d42a90dca08c51ea7347e93835bd01481fb1f4f0b26274f2c5234a95a3c4dd786d72df16251657d5d3b57533cb7dbf9948f39897abcec7aef79d0a157811e147f2ec70b39c3c800eedbd2c58d650da0e3f27c5f8831ef8b8cb5d64675bcea33363d04910afba597e00d5182806b7808ccb198273973a6f801286266dc7a15e031106d236d7914a71920022f167bffa76b71cd96cde216f708d9bd84f0a36bdb87790a5ede5c5397c1a1477b1df84bddc6a131497bf8735ba22f969f912789064b76be596bd594355fd6c2016cbebd74f3f92d146d7448c45fb14ab5ef75657fb7d8bed0ee084c6b9f2a3e0d553f4f5ca80062a8302e9ef78b4bb66800f5d5ded29c4c8e77c44f3bc70f41edc68b0a5a9c5f40e565b71f9e89c1f277ec5cfcf355cd052d13bc04d08003dd3fd97bb38b054822cb809393013f8dc7323f041944ca5b9638e5a480faf2c63e43c9ba46730a71d6763c3ca8a50a3e47da7a5572d832b182b060b1bfd91bbb3c4d521d1ed4426e2865dd829df88ee5f91898495176d6b03c881736ada6d0bc073405186728f99170706590998ca331388b1027bd94451e6f610e77e1a47a9adb7a524a94bbf37c5dcd9ee96734b235310fe2f700414bf175dbe4285d78111b753f03f4e66f72e392da46aee2106d8c10fdffd80e39fa3142f1040e9cb305185904e717e81161e708674d00b425bf6698e6788acbe36b92973e05b61f8bd529fc7fedf865cebed8bf00fc2077cf345a5966f7667acc2e071b376e9658e1fe60fb5566b5a929a55219153aa82c466346121853a5e1a26fcf0577ada8c205cec687b1d0f0143cd99b882ca5556fe154acf91d7654afe77b855e8c237dd6851c71ce9421242ca9911ffd39f2593def8f0666a4eb4cf4cd67b8be4f203aa76d8d331a3a1a50461deb30c6c130891bcaef61c7eb5de7a0cc984d902197a5234d856d6eda4d0526514429b5f4f3b4cffe152cdf04d25d7f73f55dc5da412e393bf37f3b0e53e16f8e291113f79c634c1c0922284322a9e898b5f0dbf526c9c1cac5827d36f686149db49dad2ec7c5b5a85ca8c18a90edcd2c7c47c0bb4f91a9ce845d8ae7cdaedb5d5223d0b5d8e643d445fa46beb29f4324195683d2812a9ea9f2908bac687d71d6549ce0de84212a113b3e18e211af52ca5a419f06825b70845517fe40fbcda31a0b11af646f18c90df1cbde76f07e8f7126d639d4286fcb33c63d00d76f9aebafa9d56cb947e188e805572595385dd69c57b83f169e062aacf75c3ef766af92a183adce8d61b37b96d697f6572964c3ab91e4d62a422b99ff4d065401474e8a3ae8330e078d61173ef47b9d2b2747111a98d4a6fe70997a62b6b00ee588068ef5035237463078f2df56639e4faecd970ccc470171d83bdcdae7f9bc11dcdb213855ebe3862242a8829f382127aaa38de776399ea0d32d62644f654edeee139b13201d067a8b8c9512de83569b3eae61434c7f59f494ec6a5511ae6b97d7049ef1840e1ed8a4cb43c2123cd1c258935df864c255a8771f937e47a513695edf8ef4750c51413859caa280f3f230e22b4a45d39cbd2f8be3597a77adb1be673ce00ef1ce4216f79784ca77a4d00fa35bed079684f6bd9e954dceb33b67d826c1b8d5fbde81983c988a627864984a0e8fc15a7e39dcb406b1823c8aec400c44fb01d077b8af98a68a1e4c7e263468569f21889df932cd60faa5d010cc0f850d2761e9f48e8b77d9f196fc765f7e5e2df64bef95265d7617875518ef21d95397671cbab1beaa7174d6cd38e9cac0bae489f61bfa0a8a8f0a31c7d6c76281e11c5984abfa869fc734227cebef703a5401be38d0c9b4735f96e93d26157143ff495a00a4bbe75caaeec0711f79e61e1b39b1f46efe820dfe3e2077dd5c222a2e6166506c431479b85b578819d6e87e11260e4f28e757582925ead39e32846b546118e548901673d4c2447fcfc6bd47f04328f7038ecb0906ae6ada22bb70ec644858550475bd815206567c6a2327b0c71dba0d02e28e7a182eb5101c8b4eaf3608bd7d910948c0988b5e057e96ec6393d46ad3ebdaba3bf316eb67387fcd3dbadcbfa8fe0565195ec76097fe918aa339d63baaf6beb5b1b72a98a95c6d57b8d1ee667557a93267acfb3e0f0797e0e94bd48786fd78797db0a74406e552c7c75d423e165f6af13b08ef8912610398d8699ad576acd71884bf9712058663e9f9f9be8f28f8c2f98bc5abac5dc0e75f2ecaecfc23a9a3e756beeac2f9eb3f9d5fb1abdf39790adcf1fc0b59ed9d7971620f2cfec48a88d124417f1d61a75cf55c71ac659cfa1d6fb31ba0e40ae2c4912fa6be63ae6a2c2205bd51ba9910ee00f19a08c6977744cc18231296b28583a3e353660d69cb1afed5c46c6e01d70f97497d06c9bf25dacea30a0e8036d27f14cc7d7f355fc3a23ae0ac0d316ba2760c4036a8d799730c69d8f5ca44058db11eb105ba3f70a15053c1e6a99ae2e53bb6cbb0650ce8681fa5db1246e4944d0bd10b4f564dabb32f80fbc9e10b4b761d40e8f8b99560eaba2420230f0840bbf60ef0491c4d0621d07b65283724063937253c509ea3ad039d25c3e98b2a3f914c43d3ea9523c42740128d9912a3ef68bf5f62470dfc5c1e87b7bc5338210be0bfb83e67d4b954ad2e8c9175acc94190f4667bce06be51ff8c188af86e2fa66b4995553ecc662c6be4c980f15fe262fa560455efb81fc446e51714018757143891bb40eaeff5bb7195ce688e42bf9407049fb95c66d6c94f796d736a903036b1da5171cfe243747e848de6d7ebfd5104bf29b260aa0524f0534253be31945f243f06a6e812d7356dd36b6af104ca515bb3b1b3014add840104b5a760739556c1ac047a72c0f760719347084d05a89b04071301192236ab77c3f40d6574315135c7078dda0c9d66dc3b2e680ee0534ec9181f66862268a802d6394ac3b5967ec964828eb9d9b2d5526bd78a605698d49d2d521af5d2174d34ddea6a1a7d4a6baad5bf1fe9e0bfd8232a5dd70d971305f5fc6a46b43f6cf315ea63c2cee0c9192266ef35eb4c5a71ba8a5ea336c2c60723932d8c0672116afbbf102bc23df93b89662619eda70cc670fd525f3ec6917ea2240b9a621f8369ece9f53c2b25ccf806aaa1436f3ca6780a77efad6558edfd8b7d92b1a507cc4287d9e4536d3bc461214125bcc1099476b834b6f4edf96b76b35d5a160700fe1e1fb689463166834ab2528320b8ed5c420b755062c47cb78012b2ad9b19810fcb4408d17d781c8cf5ae3c0dd35b2493adf02d4da17ab14629d15771ce6d95c1f694720664c841039f3378497a4c5f6146094928f4178236fa6a94097f0681e30d4d5e829c5108cc91e669564667a978f30d60fdb99f3a251310ede066c050f4dcc25d6446433db5499b60da9943938a243fe0e33b98170cd67ae0857604ceb1260cd68cdfe8dae96424c19671e209e6dadd13bcf6efe1d7711a0532121f2fb654d92569edae2ae80e12f25eda616600366099ebc928b980fe86bf6b03785dfb5848d6d8f5da0cfd4ac7f8f96476d20636cb3444c82fc52d024d36267d1d7ba5ae7241fc2e0eea99d2d13e6980d9238130e79c7ca05ed8fdc86cfec0573636b8740fb5be3d0870cb95bd5060eb4aebf03a273a85d453500f7b34a0f198ef1235f25aa092c5534995db9ea4dfce8c38d0ba302835da8fec7761bd97370677adebe7d13b7db98a357dc7e06ba49a0e76648d7b6c8ecd39735d0aa6a3b3a3ba0aee1dd4f237a050e999d65ffd2a942a60dc7aa86c1025592322081f2e3dae30bfc1c7e749a24a571944158e0944e5b91fe017c3f2c89e6ab1f95367daddace37a87f1c61f4e7ca8f532c41388cb993a23b338b099feb118e1ad6bdc27222ad7b27e7d75a1845c586f1853ff0951f78c4eb25705ab04560a2f86f42591290e980dbfb997459f27782ad678f5eb8840eae7dfa1e825731bdcc99d0d610b2249ffcf865258d1820d049f343b8eb6ad55cc4ca51259d430d4a7724023abcc61f3f1ea48b38ab823f27d9a86050960cbcda8faf625439656f17694c4612d190602cb5f4cafc8140ee6c0125be86939e906347fbdad7ee9ce1965482fc34dd36cc6e35641bf2dd9cd6504a3406801336e072953a317895e9b0a933e4613a066bde540d94ca6e50d5ffe1d67dde4bbf2b6aadd6fea26c6b21b5f4934d67d49ff0157af300f6ff59a46659bdb35c67c28149e02c3179c951d211cb18dda017943242504d36a40ab65bae3e0167a8521de27113a1a704578afa547c444636c29784718d43771c6138974ee98ea21134b016e6b4d4b20d7ba23740c491f1e32870bd9a2761ac60332441937d14f7231a638a247a31be9cefb154f6ba6df1855a8b2a6973527cc3a6755e3b9211098824541db62bedbf71bec50405e6393c972179d8e951f810158a0df3bf1ae347602c41b64878f2a34ae3f868326e5d24b4fdeb275bc8052f3af3e953a527eea25df2b726558ffcc9d23640660c4b1a6ae99636353756686347d45d84e3285f70148b1a5cf0fbb89266751b7f3a61598a27a08001f2457bf0b05d7387dbee664cc0c58031210f26436d9e1b49ce80dfe0e3febb112d63b8ab35dad9137ef042d25bb98b1c951cea852f22bdd7edc010ac53e0cba6d6c50dd3a8ac0881aefdd7bcccb10a5e13545cc7356d6f259bcba6cb02aa6ac686f82d2bd51823905f45832160fdc73ab6d28e9cfbb4bebdb94065168ce88361eec4cf1d466be2362a036afcd973f1b9ac80d9a0d57777b17d3dc1d40a32ec841c8559df26478df86de16598ea4357cb6e4b12e1925dfd560b209ba123375f780037ff71329369af743c4e3efa9bbceb99fe6a3354bc27144c34ededaa99c48d1f337e490882ac43c665112c2493cc5c561c80138d57f638c4789a502b517a34102aa2123993d98f0eebb92fd0d71b3819ab03b25c71971a78f12bbb3beb0feb431fb3cba84adf156703dc62d1f61df2dc58ae1ad0ea5085aa9edd1f4a329ba02df6b3edb35474c2d6fd455b2cf8c101625c843c6c78b37bbd1fa148a72378a909d88333392b45283da64b60904bccfdf7bced9acac5e468214db3f7e469a6448fefd941f052d767535176e6bb606f583c09dca8528f0c9712afef5aba7499944d45ea445beba380868a9dadd5d699647812f46d725caa192e707fba0f72091b5c951938b87f3130774bac11a50598ae25a5e20137f10b18cb464bef02031779fb889cb7b65b833613ef23382bd9bd8e1051164534d2509b5ac081571042c7002ef61cb0f7357540d66709716eaee1b76ad46c9c0b24b15501764b986f3b46f9da8e549d73024f5bf63954725ad6d906526a377e2e37a839ed5b13ecfc35211555746395f878fdcd9872c97a8f789717ec98deb7e118aa67c07406a4e191ac9f07e2eff7cec69d07e7f6aeb56e9631ee5e2c45dc4359bafd63eb7d48171d72a0e54dced18f61d2b9542cb51e48ad457f2cd6cf59e62c92a773149659795b7ac97882a023f78f1e9ef289dbf0141ee0c6c1575b659ed9d7ca1d5eac77fcef5596316972b3142cd9ef9259387139a8aabe3c942a30645d2f8cfd3cd4a77e7ce64092bb07bf902b4872aa8af03df2ae179ff6443a4c79b265ebafc8066673d5c6314a5e640a71dc6c7b9e91f7ce9017d76b3df51dbfbde83759582701d6376fca6ca9bfb6286a3a84888f1613da1f112894259e07dc3fbcb63e9fc9c308bf4c5260a7726dcf90d60ecb3efa7fe878e5085dd9ae037058a62a2931433826e118471a512fdf9dd11cb2c1c2259112100fe6aae12c1bef322990f2c69e77f2b3de74c25138101967c76ad6f5627812a6d080753cec6c52cf4b81b3fd16e5c652c50404ac6ffbca655430aaf3e1a99e581e1be46059c4dcf88cbe033d8e2e21073439b31a30733e19a989e7435f0fc6c72002c07dd9b1b27b373e6f3eb9371208515cf84cb98b167949c51c320ed53b4e20599d468db27080a4f9480626274600272466abe63ef69b4b5fcfda2adbce7706e0640872306e5e49c812e282434c7ce17b45cf5188e968d0967b7d7fb456d6c105f43c834be68449e1b77727d14c9a2c1026c362a8bfc3c1d622ed0b965d907295960e7ea0c264c431f034c5b626e2bf0d5735399995bf5a7416b14f657a8bb175e6a697e2325437effd1a6961cb040eeaa804f37d6e74db14c9d5c06d2b2179ad1de5d240553e1c51d8ea96453d2c7de6f30d00641499a9b91b15ce5e5536b12f97f677676c07d246e70d23a42a1d8e9fa6d11968bafda5f4d380824fbd88a4e2f3347a26d583063c42ce97729fa85e234f85829b52284eec51e81f553b19dc1ea63f4ad0b054e4197743680e4d11731088674d1e49db292f0120b8f64615c7ba1102573b06d351c9ef517308f1aa621ad96cb3e2f88d29bd5432b5eede077fff1761cdbfbbf9039984e57fc889009d5face3899942800f27d9e9519a338bbddbfa559a75c07041c13f1eab9297bc8b5f4812cec22248fcaf05da2663fc288501533d2f1c1b9da768e1e29fcda02da4baf6b4461a95d99dcaff1d00542357db742d6c796c541f81baf38fb3c2ac5dd4a2878b567f6f815d15383a7f5d6b92d197d9f57d9ec3a4f76571fc4f10c929a938db72ecb5b721240cea96faecd2d5f3971e51edb8e3a26c28c3c466ad91a63acb2367d337c9082a5465e82c164c3d64858c76da8538187f4cfee56a121536288227e5978453919f468b0bc0892ba9a09b8ac61bfc3e02389f3008a4e6df87f42d2a24f4969cb0ada7ffe276d51610542ac8709cab72cf6f85df6737820e7a8374a6042c13b412d5d2d5350edc341a8964027b19fb67254361d3d668b193cc6bfbe2437238eedcfdb44ee1ec36940734ce20083d4d8e12ccfa6be8edd51f791d72f416649ec49409a6086e549678ac2b5a82d81e7047727cd5a1a87eb98728891d518a7f3ec282adf158e5d96520182076226d4130b717092c9d23cff69c456af902acc0bb78df884f4efc7799386421043b365d6798b480c61b4010a436ddd8b43f4de768fac2626119e298d271d3097748919775494810893ab215384cff3c8a623b34251b4f149a6c063b247e337cea4ccf40cfd8236dc0d02648c76217f564c1e738dfa13e6e2e8a3eaf97bcc7c95cd83f1660e52b5c30fc09d9833070280dc9025504eae141882c4d54fdd303113ad7d227458f06c358f67a29326dd72e6081455b95a6b785c2917935f9abe590af5dd7879be06ed4a80fbdeadb6cc3eaae68cea743136e4ee597173df7d1f2caf6adbe45546a84827f4a9dd2f4a754832d0e9ebbe17ff0e1485768ec7b2f86e7e634ec7d95d5b7069f73a4b15c01849a20416537d1e95b91253e746e6f0a0d93440fdcd14ad07c85fd01d2fc0d352bd35dab9de53194e94d4e88ac7a094b794dca28dbb730d17baf0a385d9a39cf1bcc38b9c10c4cd5983e6734218dfeb2dd8f5c0082abc3d8ab3e7b18e068c0488c616fbf719cdb6b689a80b542879e0d6c4c49548291f559e081c35b9efcdff7ff619d1af77457211b598f218fb45fc9657b029169332223157906382e95fac302b6fbad3fba0393a53af55b46ca4f17cb359adfb99f2682ba9391083b88b49aff4d5fb29823e5dbea0ef240d8f7401e5ab057cccdc94ebd43e668a592f945c13002cc644d691b3bd12b21b74d4e49ca00f005452a66e6f77188f1cb340363668f858f388b2c01029d935e76d41f267a563fa6af34ae8c8b0a4200e87d75a62b72100232e346027542f1a10bca962c8404ef19eb10579df093a83b62baec280761c0c99f611dbb33ce7cab03e09c45bd6e5f216174dce62c1e4cc90c87f7827610a97b15e95d94870d0432a94b09853b79a93e0b4f65962947e445cf83f3455503954c740d322f8e6d663b84567644181be568d1028efd5eb19def28880554a444a83286dccbf59b7e2c9e0692f3624d6cd28c1913ccd14dfc536d55f11a04bc830212ac05c67f359d1bc96f0d0f8b7850e911fa2e46a76b263f1eb7484016fdaa73770377d445b87f8e6bf9318d3f3e54ffd3d4fdfa85d161b97ef01a542258645b29b722c9d2dae63a6f980bc90e74a798d4ea1fa6038c2680c328fb32d1bb351783ef9c36ab0a5df70b9d7c6b002fcdc7b097eb272b9072b11bb693378591c1e1b94d6611aaa42ba1240dccddb6a89d89c6466fa1600ffa3836dfa5c669aa116e8ee9fc85b2ac7639460c173d52a78129f86951e5ff2883519584436025535a9b3aff595b04c48aec6aa2eb001099ec335ab226d15c55e6e3b3f17aa724b09851485b948f9aa7382724130594db239ca4d132a3b239f4cd4bf9d3eddd6802a563957d460fcf7fe0473a09e2867f8f9a8e8576e7d33bcd793fc2e18b97136309def084c11e5cdf65e692fce9660f6f897dd612ae6576d805297cdab29bc92551f20c8708789351f89e0cf8e73affd7476a3b32845ef393a98d0d6b92b6a0742a630afad1a4163817b5b23da9559e57ccf65d9a346fb5c92bff07a672310269cbe4ebcba12378cbd36955c286423f95fe03508e8e40764bbe4b84adc63b10a0d750d1e98d008c92ebeb2a201ed11ded93b6eb4e1dce6d3e76ee2ed293e7f9786815598cf6b4e57d64221b53ecbf65c900006f00f850aef0e04afa5246600a4e1cf446f0bad941bd9e6b4fae949b66955f83797dbb01ea6fb6e8e2bc1cd5b64b8ea71083e9aa4e39a248de6c45a8436839b74c72a650becc9e90702aa69334bb0650a7ed72ee365cc2aebe399ab947ee6c407ff128e4a7a54379381941a31c5b243b658baad4308b9d3e6b42ec6703218291f3a83dac9c5320959e4bd88a0f4185c8d0ea252f5715e800a0d9748be48db5fc6b5c04e2e85e01282c847fc7336d09143141c3ca081e07d88abd4d24e793c1a4aa40bede1f2336c275b6b34a37d17176248805336a09f72af8cdd1aff0e336f828ec7b291a9cfcf73845b3012a046dd2110d52226652b20f37f70b9166ac47f444fa7924ce7848f640e6e7d36193eae48ec1658d82e652fe5e3a53cbce2d619478bb6491697f58c33f252036a856ff92d159db567db30bdcd699357e998a27a749a00f3e85697fdc7ada26ece2f6a7f355200501f6c8f788c3468ee9afec6402f241537416f8defc79fc4bf80b33903997650bb863c96bade7a44fd3a1fdf2f702642d7758e9fe91a0c1635e6ef3748cd6c6b60b26a0f8d21be23d1f31898711d9c96a354e139605d1ba35e4f103a304a84fd3ffd1f5b7f9e3611951d91d7ecbfb9e096d1f24955cbfa193ffd5495c775b124603aec632ff257d50fbf7f4673e64df965fce0006b7c65a8b292c633d9b726baca2776f04651b3f1d4d9e785db272fbdba90fdb14c026f717713bfe97326aedde8cf7e314fb427614567f7f435a93f32107640769ea500579904e34e1cf0b2e46bc00132e6bb064ed80a1517500f37ceb45d6da31a6a96ae18c2fae5e135ba10a00f90e3af662b8763644f612760352f21ecdca3c8e1be27c73f18ac213ec48bf613f3e977e8992ccd189bc0b4af2ff5f53d8a0bb84740f9703519a003f7287ad4e8aeabfe92f4f1d59f8f51b9338d9ce5b3ef08864ec3a761c4b6404242079230361a0470df914d3b58072a7987903df6dcffa749900b2df10b591ad0253e16883e3015d2e7232d14aa1219e02cb7f50dd9bc0ca7aafffeac8f93c8c1fa44289d6f510e8bdfd12ccd1394705ac56bf16afd69181f9a156b47b9090e00b2babf817d8860930073a4dc299e7d90b8ceac5e84bb69d6be8bbee07f8afbe11f1d715dadaa3072400b744975166eef9abf3e1876006adb639c2f3d09233cce333d070b0f9189d4a3097999630db723f143aeef80a2630ef076ad470866fd63e92746dd080619b46249e08bb20904a7c5e28a751f0752363f4951c9de2bf0a147952714df7500954234256a5b3ac58cf76cd2f3dbbde1671085763c229239cce827b2727e0f046390556d1222766191eb74c12a8fc8e630bb798f837332ec4525818c820befc71fc4f60a1d81502a654eba362dd27086ed0a7cc5b30b91d4dffb51e21b93618e44062a99dc0731b3ccb483345de5f2ffa9db3fe36d0509943c28168bdccfe0ee5ff6c236f3c13ffb0a3350bd617dc278b67329fa9a5592de95c9b4e084566eeabe45d3666d8ebc9ac6ecb73f75eb48d06cb2ecc85f621258516cc436305fbaa400d5d3dabe636232764c7d3138d528544df95e98471785e90469c2a4e097e8f786b205ff7fe713728f94a8e100d876f02d5f11d836838d7472f385ad2713811ade51dc94cf27452154a4323bdaf6293da378f0a0a02562a542a2fd1a0fe9c14fa7535563103305a43cffd5eceee3d672df0ac1188c049020e741a8d1b58013da43b56dedc7be664bb279bc135aa32cb456e534013d42ce626a07ae9ed4035ae32eeb1ad4b34a3fc0966081bb7b9e1b919b33f0c97d957b6840938e27a27e865836895a22a34355d0f90e61b66324cc02cb7a4f67646060283f2b885a31e25536e95913198fecfccdbdb85832232ed69b104b6aa3c5ed4a4918f9c332034d8c87679ae185cb2097ce815aa0dba62424c1b7eb43b0aabcf8e1131e98b25bbf28199dd0b93cf1be2d8ef043b07e85da6e13322989db9cdd12c9aabd50a157a20814462d5f349cf5e50d2a568dbadc64d42ea5711602dddf7bba4c666c4bf1a96019a621ef87d39ab4c573f53fd11f7bc0c6b2b584ebdd735bf78277ef8a1e664dec25f37d568e48ecb1b3fa3903444676e1a8b13fb4667e3a52876473882fdd1f66555e3924ef20f8406e6949da3a644bfef0e6c586dde96f71598acc1d5b9d14a5862cd74254baf46a846b9a56e8c8eb04e456c2600e67ec9ca2bd54ba98145f1273c54c41309620abc555210c32ee520af216a3fa6a33502764572727a5595b5102e1c494d51ad705e65d200b14976041042732794b728eaeb0eec83ebc390fb5405f8729663b878cc2f734b63c48b93925ba72a092b5019700e5ede54f5f273772d3272489b417663853d53367939e132ef7fb4c46d98d7a14597cee332f59369f590ecaf28031b5fbfc399479140b8aeacc500c2f3266ad0c13d222352048e9fcef91a778ba16ec6b0429e444d40e7fca5a3b78c7c51546f811a6a906da190c63c69d07ba48ccde01dba0f0cc481dcbe7a87ba8bf683d6e3a5074679b14059242ab1d4e65d2b8cffb66ae169151a632cbec315b1df3095c4139a4f49f368977414e70cf0c758a9b49246e8857f2e33565ab866d671920110ab5bcf84cc65744e108fd2a55a2cabf6c3b1ec44850a19e516ae9d0af0b8557de392ad8bd6a6178589be02feebf9c3227faba2a61b46a5f557a9f757d2a6273c910e3a70dfa291eb565de1a0172261cbe2b2826f0b2f11a8644b88e6a3969db7d65c0c9a67ad0bf315ae40806c6e3f1ff1ad60bb3e4d8777925187a9b1c5f09302cc39780e5886434a22e1a02c736ece3b8f4d6ed86b7448116064978b3411969890c66c7e56e4050e771fdd1fc27cd7b287a4a53dec98ec11a2c44ef4d4744104716df2bb86def6f7e0e455b5e9f24fa9c35e9565b13f2515e2d057b902db7a7b117620febb2aff8181118460effff37d09354e94683db0b6f99c0bd6a0ad4da5e3a6a988c6de2857405df9fec16ba1598dbc7f98eacf076a963cb6e9a8c5d3d2725f6020c9e365463ae0fac68574443417735007772c7a737639329fe1a3bd0c1dd8e4bf010e57111f046daeecca75948bcb3be2409fdc4cb5cd4eb661fdb9736bef2eda8c1083eab9d6ae8fc3514bc786cd25c53c70944faf57310a3f455f9be6756658f51b597f8bab0b8c31f7ebceda3f742f24685af63972d4fd5470f66e68a1567cd7763a7bf4934a24cb2b97a43aeebd5e257c8f1e4ce511ca25f0b07dcd8a8535f4eef1ba2687cf92cb3d7c51da73d0be9b71893e5ac1757a1db2ea53bdb0831525ce86bfbf189d7b854af8e2fb258aafaf7c547678d9ef770eab6511c95953749fab421875e677039cfe83704ff8fc22423ab678c8e55502488f110d7b8141b2eb5c6fb0d20b4c2c8a007f33882a3bd524657f7b72bf0cdc3091e902010b97cf86e1d9f6eea1a5608440568462c754255d20592bcd273f7eadf271bd511fc05005b34360f761fdf21bd364b4fde13bf8961a2f31b5785bd316253359d408671470a09ab9cdd25b3307d255590f9da60175dbbb631f989b57528a136a964f6ba6e7ed3b9f8cbd9af6252d4e493a425ae43874e168a48f6a43a8a7def19da734474b39c84c8a0ef7d01e34de0fdbe5c1b2b860cdbeed9495d33675c966a8d2d5529662ef6f275bf50a18bb0dd2619792a33e1a48f9673eb395d8dbda67d3e796cb9aa714fc0bfed75bc686e703d7776358aae81a7f1a57ef5b736c57157ad0c5f80cd8746bfb555210ca2afe9d352856f5e5f83082f8e527177fd0edd10b9226df8feb50e9f3e9fbd89a71c6ea3b4de71c5c491b4c670abaf520313fc098c4a53125d5ae6c9e4ff8dfeb248bdd929ff8094dc7183867b2c8882c4fca98d3eb7cd193757fb7850ed5f62c69eb5f4254ae80667232e4ba0dfaa6fc15433a0f5dc995cec347139bc83fc442548395fa24c64281c31857403e786de6c1bc2a4a66675998f01547a0a0ca442d6c4e4755a00afe5118f1b6ac1e0ddfa57c7892f2f85638c297723b9fdbcabb9ecb323febba4f7209ff71f392ab0d25287bf37d4cdd71a56d70a76e78634831853d227d22e4f3fbffbd3256b832cb5fda9b0922bb03e92ebf75481d66f97b1e0004685843f7b0a42dcb84da495f7f4b203ef66bd8250ef234f01dc7d602d3571924a31a3c7a4afabb3a7e90c586a5c9a43736114eb95fdd36c0b15641fe46fcd8fced08701c567e54d1e249a851bebc9ecb4d3ca0719602bbab5b1a471aa8c9c6e993e022b59619bffa9863c8f9e0344ef8ea7609533faf175ae8c1135693d5bf561e32139da337fe038288df78729f12f38cbc3964cfeaa0744aacf224509b573fbaf00035035f84219110d132b75ebc9e7646f9b83bc8ca782c06a34b623e932fecaa68ff146b3d1ed73c8c3a406a62d56f33281726cfb3906b87ee218c5fd6828585892e0a681dddd9fd7579de9d58a67418d2ce8cc17c80647b0dc4d287f5e45954da12865cada3413e343a912249bde59ad6f1e4771a3de4f6c2c825d29d33b46d806e7589cf23d845b92d6685e199072622200b307579e9a42d418a7e207d31a22469544c3236f7dada6eb9fae10d7ed457e0024dc0811409994e79d8340df1c6ae868d9e5c6388ae11050c399fcb670eb8e007f0abdac26eb7181416d3c3c12a419288bb9b3a82bb1bea5201e43a4c6a78d4db2a36328649962d5cd6d4fea566db750b9a9d76ed3aaf37b8e710ca4268b4b2e232cce995d5be13f07603bae8e221044406cd40831e0e4bd5d59c970269dd857c278bb0f26880312bd1de747d8eeab3efa595e5ef5129c7306098c1e228dcd611b4d83db7dd1db0ab8ca059fedc62e8116c1483a95959489beeb643fa98ce19b9445324afe1db20a0766fe49a805994affb74f84decef018a5a4cbbd8c123488d35375907a466470d8b79163d62a518b8b71bbb26f13045fc9cb5acd5b2cca2a183fb3ea7b9cdcad4c3c1b600cc30e8b359cfbb45e87d7670af31ea46f83f3f18fd915bb788e1f6fa79eeb8b584146ca19e0ef1cf8588e648b43adfbc0ea24ef34bb4622e5f58756e23c818772b05336a9425c253f8cddd2a41b748a1517301b670bedd1553c72fc4174242e42b6725817e0b1ba3ee66c53d31772f58d19bcf01d823aae5d7d8108ee2817c5ca0d9b205467979bc31b716fac2e979f881b468cecfb9ed1a4971e78db5a7baf4f8521b4979368c0806415e1256f9c75b78aa7035eb404d2d7917300ffd138d59f6cc87b18f28ad5a465baf2845026c0cdd18ef347c5b118073cef37ba20a492ce9328ac40cd189e8da38bdde02e13327766ef9888338b6650c66c86daf51fdac2e7ccd22828db992be1f50ef64cafb7222be1b473580018115af2404e3676be2668c49942aec59871bb03293ee184117e72a1c3d27d8c9264d82241b946b3d07667b6399345467715ff1da84b1a3152639dcc98c9df9fdc531beba3188328b063c18f9e3f5a3b0a8011e8d9e45ecf319f09229d54d10d3decf844fc2f5698aca803733a07a8e3acc498d9827fdfded95b3c3062991e24cd689ded2ea4ca84b7bf7f2fe97ea2638557d66a32b1dd72958dac05ae7ebc9da5daf589359b47eeba331096811f51e4eda2eea7157010c75fd239e1a86cfc0ee16627495c91e4437192d62c55ad330c3781834272ef996e8b03c2e4e74ad62e5022c7c68b12b8810911994a9ff747fc173c70cc5586ddbecbcae95b4c149b60791657b49055a55ebd5e093519a40f1f8c55b3c484426ae1d1674150fa8ecdf5ccec706b5ac7293bd5e99de3c52e3eb49f0b7465f049dff22edc48612eaf3a36308cf01dfba2b4b4722687418ca39e50068e7637e0482759ccf55994f50d410a513db81963d7d722f3d307778021f3d3c82b62a8d98238c074d39ef3d5e94441da470d27ffc4e0b058359a236089e895acd598aeb3664748f726e6698ec4491d13e72d28f475c8e5d663057439ffa23dc336629dd47fb6cb866b579dd3941a646014fcf48042733735e21b3528e581d151e6b94d36018b20309b0f38672bc80283b5e26d3e8cd6bf493bcbb0f4ce8f04fd885ce0af9aa947d85c6942d53e5abd791507f872beb63a4bf9c25228542e2dae2c48bfa6616297844622f2e8b330dce5f3eab4bb662a1a56c04a79426549f96712e732f862d289d6ad516e5e2abb3c65713a298c60f3f59f51dbe0f35148d73ee5562c0161436efeff6fbabb67e1e0205430d69b87fa76ce7e85552001ff2f7b0bc2baf83cd1af9d1836692b01aeaf465b5aeec2125cb545dfae960c9c375462a7af1c38e60c3155b9c53d12ede06042e7098a57a43cfa84599ac74db5783209a195ee5c690477f7f2903793072cf89dbf1c9db66ffff8abbded3aad3d05a88356277ff195c944a1b1f337f1105d187b05c60c3135c1da70be21c2bfdabd170259f6fead15b45188fbf5af701649c53550f274f68e97638a367bba31a619b12f7c6d368dd8ca6c26aa69fb2b901401c1eff6ce078acc0890ebc22975e178ca9bc4b9d81424a8782937044f41128d6a2e177e1858089ee9bcecf806a7139f7d8c5c9360d02590cd420b7ca4c1853a7a9f610d45080603f6c129e3d3d21a5245ea3b62e07f92ac6ddf42ee2b32b683da0fbb84931715010bb69bee0c34625dc0a39e775d1bdf9116fdadb2c3cf8fccc2bc72a0183bc5abfd4d27d05d5bf19f0f70460afd6c2416fecf732ce3ca70fa058134dbe80ed8877410671ca7c7bd946b99c58b64b02cd100a66e8c098104787471c50a813dfefc572261801912fd43b87e5a4f0fd22cc5e0622ad45181649ec007b5c9c0b67f205677f3fdfc23c0ed34b6f01cb63a69ad67e78282a6a88ddb4784d0da585f6624f4ddbd1ddf87df5894ddf04f04189d8d7dc79d5b6d433b850fa5bc19e4f4d41b9ddcb1620f1cfaee0f190fd1fbdcc5e2330c445bdd586d434f8c8d4ec98a67a18335150e334d380da86af5c5726d9dff4ef71015fc220b676f67442d11fd9f942325add19f633c9fbddbd4b91db271aca8cf92c84c0ad187adea30a29373e884b1228aba8915f3482ca41c4814793c421b86f975522b4c53776e54e4be6154934f0ec17b43623d47af4aabb9d8f3f532b336ce8e67a3d2073a0032e43da251d214e65f50d4de9b3a698f8ba0a9d53a79278fec39446c1adbb93708627321af3f655148e4d6d639da8a7cc9555282ad28ff1686c3940a64afeddb564b91e185e32ebd5e63ab8fe127e775e3751d606d47a36f7b889d6b9fc7f5b8ed0f9aa91451e2b80c3468cbab9ac4d014793d2621503d2a76d599536cc57a946d819af00e8c7c6238805366eee3ceb130983c3c05c2ec3394d88e30113030db31fbf54273bff52e8ce00ef5ace8e923b858601f0e44beaa5f0ab769db49a05624894bcff24a67cef18714201228e5c5e0a52ea1d11e4f99e47c0594e001e8b561a40eed9e6493c86e5117607e534faf9ffc1e71dc2fcb9843f6f55a47487769291d43406850e8a147bfddd36a2cc0a67ebb792517626649e1cc4d8af7a2bcb060bc002b5453cbdca69d022ed6aed5f10b30311bc67f078014208131797a2480b366f32abf00f0008df2ed74c14693ef8fa98a230c686d71d1d39ef9c773b95c50801bd5562ebf02c4b515a4e05d0723f67f4d9e9ed62f87cbf96955660823f18dce8c67ab93bfee6ed885841617369a837a32cf6ab33a875b84bc08b77dc4cfce717b90a5d464c7de4b875a09a226d8fc7ca54ee9eddcab50e202ad205ef59f1a5ff36242d9e4c99b291895e31f0082f1fb60278078725d042a35a69a6cd31133ce0dfe7608c46714f47fd5c6011f27cbe900e7091a32487f19c3def2a0708808976363959e012cbac0f7b70c84a1f7c83a6ddaccd34bb2fb81cef572c6125c9807f19b2e675035dd83ce39be0d53c7ec89122af6d1f37f3d0249ff60495c0fc05e429e28405f763e3c4c8595afe9b58a77565c1b2ef0c3b6d1be06634beda61a532cfceaf0b495096938735c5440e69af7f30d3aa0c2cb29414dceac001f21624923f22ad5c059c28a42986c96c0149a0a842f27b1083a1659ec28f296dcd8860499e2d7147ff88d8f0dbd4c936566e66fdc593ae525b3e3898a2dedf06f7299a8ef275dfbfb90fa231875dd68c3e5d930e5ca8a2da36daefaec59487988b29ca1e224c797144ea88385218d6c27da03a73a60521d455c4a6f4b8e38f4e10a336613bc53d4e3207605232616f18cde4ab95970f6a59117182775c1f2c6b545eb8a3d194860476a00c44751eb2137b098a6372f9a5976ea01949baf30f514da43586df2fc3a923eff96c9dd88cb2165a209a6ae1dbe8a0309183da7421b1ef99198b5a177571801858f6a0b171c40bf8ad1e1d197479e921ca75a84348ebe2dcd99a7a274a3450d2cc117080599be654bce2a20338e111e2e24d3f5dfc0508b36c50971b68bcc980f8292929140c3a54379de96ec7742b2b9b0adcfda3b37ad089c0ffc3e8f835688ae711b7f21ac70acac866b56fe422aa91032f7d8a58f364a8ba3224c830b0432ba9724ac679b2014c428842777e494aa74aa4ef88de6f30481b3e89cecd0fc5fece0a4069c82ce82213c710ff7917ceec3dcbadade1f4dc79972535d3921efa62140ca368b0eec1d9dce9a5c0fcb4b4b328c30f45ec25505fbac34f9ee0081405c7b7cd5cd16ddda2fe9af28776d3eff275346c9f15d5a9a9144c54d23780f15c01a0353452c9a0cdcb876c0a44dec349e0cfc3ccefb50b06824d1dc597a50f93a8390bf350e6dee495210ffc022c55adab381ebe79d443cf29912b5e4d0d3fc5ee2e81047b5312502255fe5c2d6eb159364d1d3cc092dffba283257d3fff35f05c591caa00ac1b1cb6d48b52b30c9aeba98ec8d46e1cb73197c430b77cb88d09f3db6a3564f8a069b8357111a93c4776da12d589326b2d7a2f6470dcbe1c72a414022c0e47944c01427dbeb154a08f1ad3e81f768a320b42b0af0d694a191bb15786723a36757e7ff41652301113f60fcfbbf24fd9fc27b3331fe35c377806ecfd5ca450f344b3dc647df182e9ef9510653b2e97f81e9f41e4375e1a8ff7be646f83edb32384e14c9164bea867c878d1649527009813ca3981046eb7ba5d670a5331da22142e17656df5d4ef5c1615982d2638534a9a2a72e8afbcb03f209c46d9453d51f8b0ce251cb6bbce1145205833c02b2a76b18df2df4682d6f128f32a0c9bda3e3257199fc7c731134cf690ff7338fd86471e5ddf2bff7091491ab9284c0e92bb4e1043565e1507f094d11d1479915d6910c24304acb1c365b1e0d265a360facfa6c7d4246d696304e5062fcb26367479a3fa23342596857a010cb1de71bf676e6586357bfe72631bf03b291fae00ee0559e5023a6c70c8e68bc27e9ee00e14404c17e8422536fc3c24da0a9b5685f98a3348a5f9e0cc2aa5c74980e9ef427abc7151413bd0f2b33f79f8b3984a8913b4eb9c1afcfe5d962d9b7f431f827847050b520f40042a4b1b6d9d2ae4ae3b33d28c35eaf8bdbfd351b3a5cf20b6b645aa3ff5e60327cffa1184662a51e7583c65e47a77dd24c2ced155c73e869f08c0cc34469fc80076326681482acc7a7f1505dc67b734808283b3b085900adca691d4faf4cfd5812594a76813ddb156c91779bf5716b5bc792ddaa1466b4174a69f00e9794575fc8d34dd0194dd3b440839675212564221589953a6f40c1c68eeebb813c8f2601aa97b387f01cbdd10f702d6857f1cff14232caea615a8c65f5585f75be4f39a5e4ddb8598f3bf41e8bd7725001328dcdd9bf7cf8b1bd83538d782f36e33043cb123cfa108b8537cf364f7a66471226c2139b00199378aa20f787977a6df6ce1f6d76c1b664a9eec3a61fa88de2a2046c8821a6bdf2d2639c2ccc2174c16dddc3ae25311c5fcb634e9756c8d4cd88b1b3ba193e3e31cfbe7bd23162edbc683494dbc14f63a060a2c36cab8165dd35db25b18be46f710aae59744b3c82a3b1e451a053fdf57d001ebd3d7306c10dd99ecd572115f0b887e4d4e8c6e8866f92a1d01114045db64e408bc22e7c74109c7d96a7f361e79232cfa726f58caa3cbd63c610a381c500112bba9f5e4f502a57f78b3c6dbcda64bf91c8271854418ffd93c9499d960915dad6e92ac75f09a2f83eca2c2d3c75b95a369ec60e91d6dc6a7c32cd6e8630905a4400a42cee78003910964be6cce0b11a7d3200b22b329726b6d9b017860ed16ad06b405d2d466e2a19dfa26531099a3742c7a5bf00ffe0d021e37a35c57d853633c3d9be65e28bf9aefb116f45c4ff631dd6078c651508ec8448af54df46e03e8d026e04ca65848dc19d0c83568abafdb6750ac5500e85766acf1b0c45a786c6928978468df62ba89a96e97cea8f2004577a5ff8a50f873086f629199d2c3eb3e9432322cd7b67ffbf562e4b57d37e4fd803c2852407a834fc35817fec42eec35033b24add8bdb773c7a6fea94641ad24f7d0654b6669ad000c2299fb38c9b273e5fa89c64978cac4ae05435b492215afe96871b3be9cd72fb9bc59e3483b3348317a70a78fc21f11f39ad63f715fe4b39848bdc45a093f4d7010a3a60ddae6e29c647aae53a0b38036b7709611800631d348c2a07d01f52da84220c08d75cb52bb2ce635e4bfa96647d6e06029cd39f302ab9738443618aafc8022a0621d7e4ec65aa39cca43a07ce80a2018ede1413587211424724b79702bd2a5e2cd978563cc84c7d5e5758522e7da125a2e29270eceacf4a327ea6e3ce22b0be1bc5d38a4634c66289140b7e9ed8eb97afae652af43bc63cf9101b6336d60cac1e0d88291a9df030ab332622a07340e09b4dc7e7a71dea537c0f79e9dd58dd286aaacd17a3ea693e8392ffa49fd11942d69308046af1ae5b42370c507bc0e42cf6ba1d6819f0a64119913936fa96df14d323b5e42066dc47e8e034e22d52db5861ddb6dfd3c9ea8cf390ddd45c9349a8ec0156f9b07257082720c1f5aa087ea72a70699b703886304c0a3acc35cab0f1e1ce64e75a4bf71d1fe2ec839eaf4c4faffc9118ad6ee9b4056c155abc94cf4af11b530745edb2c9f912290a8e1356caa5f06153ca50305a851f0d014e8eb9268b3c5c0f196a82b3a31f161b786fbede1280879dc93491903130b8bfb74771e70415396cab36174b0c80eafcaef6dd01fc4709e76293f3826a4c455023c047043616c0be93e7f4f7f0d503dc4a7a2c1fa52986d58e8f7435e937c04d6c75c8ecaa49ccf67a10016b11823ff477557b101dd19f2d1b12dff8096aa62faf28e6d9077ad9e671d554971a7e76689ab3d4e68ab54bb8ecc117fdef03a51ca27652873f590d8277c4cf44dad49bc11e8d344c02b92e24597abf811dd2e52a91c40481c71ba9adf5e8b714d3fc05d9d29ecf99454d5bc37389f9e16923fb08cf13106e5464b76f2a0ee3226ff9c7f43ea90cfff8453b5978e59f755887029079ba088bc73968e2a91b55ea5910626b9ba3198e7fb45a9a30a5a78bb520f3d591da23da1b33c07187c63a31782dd8d1d3d0d96b429b72782dbd8f60115fc65f58c555b01b2a65170ae77aaacc83c2e8779c1a060932934c595b105a0e4700646db653ee367d45fdab9c9561b83c90196d19bee6c591772fd3ae99951accfbb5f4c6902f414ec9c23e78b914728498d5e5fe1ee0f96d7944e446f0b0ff7d30ae57de3e89f1ad36d4263d28e23d7c03cc1f9708b0b34c08f50a857ba624bab084caf95202d47bab463d162674b5a9df117354dd69b21c7a4fce343e0f4cb1739aff5d1fc0684935c9e51237565e3a7f3c2b864cc93b6c78174d6e66809c1760a7519eca2c6ef76ce5a7a889809e5108944bdf5ca552ffe77acd6e5e38a0a437b9642e61d0a8f34a4bae0fee141623fb3e5004872ba7aa90547ee4a5db9e9206bd84d1848250eabdf2d5f0ba57027e1895a3ab656002cd751513f7483f3dadfd10bb2a85ceab08a07e75535c6f0d774ef07d35dd2a4aa616bf48d165babe79b6ddf1bfe5f8b04bb8d42a8ecb0b281ddba9299cc69b365c3d8268770a002e3a6d7ae99ba228de16f3e87881d1b24566a690f8b480d3d6c18f08cea24817a2a90f2066a7c90db55aeee499632cd66935547f6cbad663eb59b46c7b2c9fcd66866bf3d6f690029427a8f462e50c61738fb2a8258e60fa958d3b83e087eac4739810f47f165344dfaa6ccdf1f2b208df5dff910f8ba9e13eb7c5f7b1c5ed0f15695480f529de30a347266cae525b315f34d16d75d4ff3aa907171bf98dc0948ba48bef544b61991c37dff7853e5b60ab8114affdb276f3a5204a329372715e3ec048da194cbeb12b3ef61a351966986ced48e51f14e7d4b6d7b15d0a2dddaa663384ebd800ae5990e0d0f83001fe07850080c809bdb9d3a2543d4220f07efccaf6bc91cd1796629269f72dc64738c3782ac8d67fad78d071c7c4b8c76ad9298ef29cf1b63e82095b3beade7087e2e4e4d1b9c9b5af1667fee6759c38f9f1d060f7ac36adc7d20a809f3ac9d5a3610917fd1b7ff83ef686ad9d947283a7653505ca07b3cda3859d016143500cd150b814477a92b63c32c86f3ecedcecd5268daa5acb5d04a4f2409d0b669b1894abe87c33536c47d5ebfd4ea920cd01051f9ad01d24831f09043d9b9e22498ffa7ff70eafffc746c5c64f59680ab7aec79fa2ec7873ac4479796fe1b8b281e198ca88aa9288f4e5dda405619b6089bf96d0793402f9f607e732ce21e48c6da49e6bc0b717f4d0161927c916ab0351f994abd7a69e4e471d33b5d9f0f1f273d94c23201d3c22265f5e7a9ed0f8e6b09f83cec00399a6852e6d7af9bc9809bb3112647128f685cba700c474acfad94c992b13a0411ee3d3a284e6cd0378a87c79dda6b8b22567dc879877c73e10e511eb9380a9466cafc91fb5e0d6d19f40e1e2c778be7778162f0fde5fdec680f27bb45a019a70e4ea5e48c6e9e072ed68036fed1c35a58dadcfca96d7707b171285863892fc92ea28f20a24c1b557d61458446257534c346ed3cfff2812cb29d5614b32e694483833fc4389914187ed3cd477577285af21d576c8fc4141c108dabbf6f87e97d8913138d0d585b0e4e32fae2201c96891730995188953e46befd04212b8ce7e8bc37e6ca97e1f5dcb039593f7c125b9ddaa4cb39a15b030329f649c80a4f3a5ba1ddb09996bb45a3d83ad03f09912099ca709bc0c396bbfcf424d7db5e0c88f56f86b53d3f3e3701be28d88cf1ffee911342b15b7c3018db383f75284a2881e01a3b44e152920dd467c37dc7ecc7d249851f87208bea9c7f0f8d95abf7a45efeb40afe666bbe752ffb8e066fb6efa7bf728d8217818f3e80266d89208028ebe73c1d6cfc540674863996a9ede62aa1ab91262bb3d3366bcb171d3b1649d683b59f4bb9babbc2639860416b8b5fe6087e7cc2c70522379e9c7953004215d3633683492d2051d8491f5c71dfa3688ec055319846b008af9a4201b15de88beba08ad56b2dfdeb21d7a475191d0129d3f0769a7977b28a25bc5548cd64c3d0a0898cfbf914f3e46096ee80b754be234d8fd8af717fc181b48b3cbdeba61bfad6ea5da96a9092868cb978e0ff85afcc8d8c0ebb04806c6c1b4309c97128bcbcd896bf80723c87be5a0a916ace539c42013fc4da17d34cb529b9f5a001886603f971cdba9f9231f250eecd6bc760f6423d178134567e82844a04a511352d721f3efc37be1ade00120c2739cde9492d79725b704c458bfdb94e7dd36c9c1df02f475ff1c931fe249bf18f12738770e2744282270acce72dc1fee18a1a9fa3f79421fca39022b56ba8bc6176a4d03a49d7a6a027398cbaefe8d00a329afda90647c18af686f5e6bf5e4da7e9754ebd0d25e0cb7a07113d6e3876756b1cedf879b312a45c6d55a302574236a038430aef7ae6068283d28fa1c1ae5fe0d87e471e8e082b97e69efbff0b0407a678548443a3609ca2a08f786f24a641fff78349293a8afcdc54cdda6db67af6f5cde0b1a94318f50bc2779eb9f58b88b21e46aa3c62ab275d43e84a97bf2677c35d99bdb2634c3ca86574b6f3338c236a8d9aa5609b80eb9257365cb841b63d59f661f2ce564026bc58a38706de819bb463d51a87e8b800b185865be57a6b8a7ef5ecaa16f7b22c400cbddc58b827755e7e1351d64f88f3a7b852aaedfa6883e84e3cb92046f6ce3e513a810a85b2aae5a4ef88f11a95b75fafd0e5d0c4aca4bf9cabdfb05d041edc33a9248f0cfd66290fe57c294955755c5a92f0221ee0d73aac624efa1c671f94606aaeece80ca0caf3173b243677a0ae285035d04265d1a596382b5822f12409b3edb8f657f4725a1521bd508a91eb7e90bf554f53b55984bc48daeb8e5d58d32876b14a93f070ecdd9cea06db8a9776534bf50fe0008047f3f3c1fdb329ecec5aa8c2d3d828995f7daa1204bb25ba48ce2f26bfb58e297154fd3ce97113d6dbbf51a3bec29eca5f27c4ffbe73ebb34c798b4162b73e90910345f480f77b2791d6edbc4c5cbfab44b5cd5991e8c8b660086b69d49f790e4848468a5611f777f67d07fe3128f577043bf26469edca6105bbcd2d9f34619a4333c32ad30b9b71c74ff5a629a90743f574c201b12f000e9d2ed50df27b993952af54acb867332a4d1b248aa9bf998a2176beb21ed0a1b49801388527d23aa18c2523d0e59f1ebe335c57126cebf1b588b043779f1ec83de6b4b07d0d76127d36bd2506d3acb7463a19a7cbf982acf517dce1b2f2399912437ada164791277805bb4c8c9c13f233d0a1701d40afc66d43be0e8091e9bb5aa67dee32445961719ab02877b3b6b1330311f1ccadea73a9e56117f51facebce84ef689d795ca27a257f9c253b4edad798f86f91bda4528333ff72cc329110a712a7190f2734cde173c64ae80dfbdb52015bd5753b4219231fdea14dad652101b3786630cdac7fd737f4472918f7da8b7f6679454cf6bed84724da86244c1bda32d82f16fce3b2e615374a80c8898d0002bf7edb96d0d8f2f531d21c0a3638680af35d6c7f2c4affbf6540008b16a36bb5807ed26a6219ae3d6d648dbc76cab8c4cbbd8fea62f8dafce7cd4afdc531b0b2ec1add93e7938bc360d9b6a3b623658de1cfe197449a123a4d6919a4c955192c71c18b3b99a04471bd4f0ef97a54f6f153fd2ce2be10edfe33b1f2b2c9ca84cd1b62138ceb74824e944504f014d0cc47b7c71610eb9998265b31e8906072f72ff9456ff31b313cfb08a4c7268941f87ae09b54a0c1db5a07d72fa4b9f4779ba0c3cbce7f74cda329c72396a3ecad359ab2df5eabe2c7f936fee5f05a6a8ee8f6682b006ac46cfbd51a269fc404622461bed444583e0ed1232f1921cd2a61a315b09b8a31bca0e15032418dedb263be9d8d4b6ad2e79db8c731314b66df08299d6820a37a51163cef333c67102aecf10ada778bac24154e7bbfd77a5fe60c041b8b82522f7a95b3b7dc2b1111c8e97472f50b1f1042dd6c3153f68bc77f949beef9c10517baf0ff6b7c276adadb9d387bb07e6aff2e7746389478dbb1666e1c2c10660d91a900fc49f4e607f28e1242a343ee7e24176e47ac3ecbc3e2c686df73e5742e7ead499946c6a35e250cd870cbd262b3c1dcc32539bf0f2aab52af576b3ace8a290fe713c0cdeea3ed989264b14383942f54441545374b33af0a6be7e61fdb47d26538c8296f473c8dd1c847793a75c6998b67b6af4b659ee879aa22472bc06ab290a974292d62c232f97422f1603997c12e9f8643fe4b68305aca6d811a76ebe91fbc7d11852932a23459f3d3a9c5287de9d9a208df7abd65e6b135dfabb95b49238aae8ebfcaff649b482480d9b983839526342bd3bed4b2e3d41d9463596b9bfdc79d108cb32b55a8e244f56147dee6f8477d70ab4b7601325</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-xray\">\n      <input class=\"hbe hbe-input-field hbe-input-field-xray\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-xray\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-xray\">您好, 这里需要输入密码。</span>\n      </label>\n      <svg class=\"hbe hbe-graphic hbe-graphic-xray\" width=\"300%\" height=\"100%\" viewBox=\"0 0 1200 60\" preserveAspectRatio=\"none\">\n        <path d=\"M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0\"></path>\n        <path d=\"M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0\"></path>\n      </svg>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/1888662579.html",
            "url": "http://ixuyong.cn/posts/1888662579.html",
            "title": "Containerd常用命令",
            "date_published": "2025-05-14T12:29:07.000Z",
            "content_html": "<h3 id=\"containerd常用命令\"><a class=\"anchor\" href=\"#containerd常用命令\">#</a> Containerd 常用命令</h3>\n<h4 id=\"1-安装containerd\"><a class=\"anchor\" href=\"#1-安装containerd\">#</a> 1. 安装 Containerd</h4>\n<p><strong>1.1 配置安装源</strong></p>\n<pre><code>yum install wget jq psmisc vim net-tools telnet yum-utils device-mapper-persistent-data lvm2 git -y\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n</code></pre>\n<p><strong>1.2 安装 docker-ce、containerd</strong></p>\n<pre><code>yum install docker-ce containerd -y\n</code></pre>\n<p><em>可以无需启动 Docker，只需要配置和启动 Containerd 即可。</em></p>\n<p><strong>1.3 配置 Containerd 所需的模块</strong></p>\n<pre><code># cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/containerd.conf\noverlay\nbr_netfilter\nEOF\n</code></pre>\n<p><strong>1.4 加载模块</strong></p>\n<pre><code># cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.ipv4.ip_forward                 = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nEOF\n</code></pre>\n<p><strong>1.5 配置 Containerd 所需的内核</strong></p>\n<pre><code># cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.ipv4.ip_forward                 = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nEOF\n</code></pre>\n<p><strong>1.6 加载内核</strong></p>\n<pre><code>sysctl --system\n</code></pre>\n<p><strong>1.7 生成 Containerd 的配置文件</strong></p>\n<pre><code>mkdir -p /etc/containerd\ncontainerd config default | tee /etc/containerd/config.toml\n</code></pre>\n<p><strong>1.8 更改 Containerd 的 Cgroup 和 Pause 镜像</strong></p>\n<pre><code>sed -i 's#SystemdCgroup = false#SystemdCgroup = true#g' /etc/containerd/config.toml\nsed -i 's#k8s.gcr.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\nsed -i 's#registry.gcr.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\nsed -i 's#registry.k8s.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\n</code></pre>\n<p><strong>1.9 启动 Containerd，并配置开机自启动</strong></p>\n<pre><code>systemctl daemon-reload\nsystemctl enable --now containerd\nsystemctl status  containerd \n</code></pre>\n<h4 id=\"2-containerd-配置镜像加速\"><a class=\"anchor\" href=\"#2-containerd-配置镜像加速\">#</a> 2. Containerd 配置镜像加速</h4>\n<p>打开 /etc/containerd/config.toml 文件，找到 [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors] 部分，添加所需的镜像源配置</p>\n<pre><code># vim /etc/containerd/config.toml\n#添加以下配置镜像加速服务\n[plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors]\n  [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;docker.io&quot;]\n    endpoint = [\n      &quot;https://docker.io&quot;,\n      &quot;https://6qxc6b6n.mirror.aliyuncs.com&quot;,\n      &quot;https://docker.m.daocloud.io&quot;,\n      &quot;https://dockerproxy.com/&quot;\n    ]\n  [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;gcr.io&quot;]\n    endpoint = [\n      &quot;https://gcr.m.daocloud.io&quot;,\n      &quot;https://gcr.nju.edu.cn&quot;,\n      &quot;https://gcr.dockerproxy.com&quot;\n    ]\n</code></pre>\n<p><strong>重新启动 Containerd</strong></p>\n<pre><code>systemctl daemon-reload\nsystemctl restart containerd\n</code></pre>\n<h4 id=\"3-containerd常用操作命令实践\"><a class=\"anchor\" href=\"#3-containerd常用操作命令实践\">#</a> 3. Containerd 常用操作命令实践</h4>\n<h5 id=\"31-查看containerd命名空间\"><a class=\"anchor\" href=\"#31-查看containerd命名空间\">#</a> <strong>3.1 查看 Containerd 命名空间</strong></h5>\n<p>namespace 来于指定类似于工作空间的隔离区域</p>\n<pre><code>[root@k8s-node02 ~]# ctr namespace ls \nNAME    LABELS \ndefault        \nk8s.io         \nmoby \n</code></pre>\n<h5 id=\"32-查看containerd镜像\"><a class=\"anchor\" href=\"#32-查看containerd镜像\">#</a> <strong>3.2 查看 Containerd 镜像</strong></h5>\n<p>因为没有指定 namespace，所以查看的是默认命名空间下的镜像</p>\n<pre><code>ctr images ls\n</code></pre>\n<p>查看指定命名空间 k8s.io 下的镜像</p>\n<pre><code>ctr -n k8s.io images ls\n</code></pre>\n<h5 id=\"33-拉取containerd镜像\"><a class=\"anchor\" href=\"#33-拉取containerd镜像\">#</a> <strong>3.3 拉取 Containerd 镜像</strong></h5>\n<p>拉取指定命名空间 k8s.io 镜像 pause-amd64:3.2</p>\n<pre><code> ctr -n k8s.io images pull registry.aliyuncs.com/google_containers/pause-amd64:3.2\n ctr -n k8s.io images pull docker.io/library/nginx:1.21\n</code></pre>\n<h5 id=\"34-删除containerd镜像\"><a class=\"anchor\" href=\"#34-删除containerd镜像\">#</a> <strong>3.4 删除 containerd 镜像</strong></h5>\n<pre><code>ctr -n k8s.io images rm registry.aliyuncs.com/google_containers/pause-amd64:3.2\n</code></pre>\n<h5 id=\"35-导出containerd镜像\"><a class=\"anchor\" href=\"#35-导出containerd镜像\">#</a> <strong>3.5 导出 Containerd 镜像</strong></h5>\n<pre><code>ctr -n k8s.io images export pause.tar.gz registry.aliyuncs.com/google_containers/pause-amd64:3.2\n</code></pre>\n<h5 id=\"36-导入containerd镜像\"><a class=\"anchor\" href=\"#36-导入containerd镜像\">#</a> <strong>3.6 导入 Containerd 镜像</strong></h5>\n<pre><code>ctr -n k8s.io image import pause.tar.gz\n</code></pre>\n<p><em>docker save -o 命令导出来的镜像可以用 ctr images import 导出，同理 ctr images export 导出来的镜像也可以有 docker load 还原。</em></p>\n<h5 id=\"37-标记containerd镜像\"><a class=\"anchor\" href=\"#37-标记containerd镜像\">#</a> <strong>3.7 标记 Containerd 镜像</strong></h5>\n<pre><code>ctr -n k8s.io images tag registry.aliyuncs.com/google_containers/pause-amd64:3.2 pause:3.2\n</code></pre>\n<h5 id=\"38-运行containerd容器\"><a class=\"anchor\" href=\"#38-运行containerd容器\">#</a> <strong>3.8 运行 Containerd 容器</strong></h5>\n<p>在后台运行一个 centos 镜像的容器，名称叫做 centos_k8s</p>\n<pre><code> ctr -n k8s.io  run -d  docker.io/library/nginx:1.21 web\n</code></pre>\n<h5 id=\"39-查看运行容器的task\"><a class=\"anchor\" href=\"#39-查看运行容器的task\">#</a> <strong>3.9 查看运行容器的 task</strong></h5>\n<pre><code>ctr -n k8s.io task ls\n</code></pre>\n<h5 id=\"310-启动指定容器task\"><a class=\"anchor\" href=\"#310-启动指定容器task\">#</a> 3.10 启动指定容器 task</h5>\n<pre><code>ctr -n k8s.io task start -d centos_k8s\n</code></pre>\n<h5 id=\"311-进入指定容器task\"><a class=\"anchor\" href=\"#311-进入指定容器task\">#</a> 3.11 进入指定容器 task</h5>\n<pre><code>ctr -n k8s.io task exec --exec-id 3118 -t web /bin/bash\n</code></pre>\n<h5 id=\"312-删除指定容器task\"><a class=\"anchor\" href=\"#312-删除指定容器task\">#</a> 3.12 删除指定容器 task</h5>\n<pre><code>ctr -n k8s.io task rm -f web\n</code></pre>\n<h5 id=\"313-停止指定容器task\"><a class=\"anchor\" href=\"#313-停止指定容器task\">#</a> 3.13 停止指定容器 task</h5>\n<pre><code>ctr -n k8s.io task kill --signal 9 centos_k8s\n</code></pre>\n<h5 id=\"314-查看容器\"><a class=\"anchor\" href=\"#314-查看容器\">#</a> 3.14 查看容器</h5>\n<pre><code>ctr -n k8s.io c list\n</code></pre>\n<h5 id=\"315-删除容器\"><a class=\"anchor\" href=\"#315-删除容器\">#</a> 3.15 删除容器</h5>\n<pre><code>ctr -n k8s.io c rm centos\n</code></pre>\n<p>删除容器以前需要将 task 删除，不然会报以下错误</p>\n<pre><code>[root@k8s-node02 ~]# ctr -n k8s.io c rm web \nERRO[0000] failed to delete container &quot;web&quot;              error=&quot;cannot delete a non stopped container: &#123;running 0 0001-01-01 00:00:00 +0000 UTC&#125;&quot;\nctr: cannot delete a non stopped container: &#123;running 0 0001-01-01 00:00:00 +0000 UTC&#125;\n</code></pre>\n<h4 id=\"4-docker与containerd常用命令对比\"><a class=\"anchor\" href=\"#4-docker与containerd常用命令对比\">#</a> 4. Docker 与 Containerd 常用命令对比</h4>\n<table>\n<thead>\n<tr>\n<th>说明</th>\n<th>docker 命令</th>\n<th>containerd 命令</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>查看本地镜像</td>\n<td>docker images</td>\n<td>ctr images ls</td>\n</tr>\n<tr>\n<td>拉取镜像</td>\n<td>docker pull imagename</td>\n<td>ctr images pull imagename</td>\n</tr>\n<tr>\n<td>推送镜像</td>\n<td>docker push imagename</td>\n<td>ctr images push imagename</td>\n</tr>\n<tr>\n<td>给镜像打标签</td>\n<td>docker tag imagename tagname</td>\n<td>ctr images tag imagename tagname</td>\n</tr>\n<tr>\n<td>导出镜像</td>\n<td>docker save filename imagename</td>\n<td>ctr images export filename imagename</td>\n</tr>\n<tr>\n<td>导入镜像</td>\n<td>docker load filename</td>\n<td>ctr image import filename</td>\n</tr>\n<tr>\n<td>运行并创建容器</td>\n<td>docker run [options] imagename commond</td>\n<td>ctr run [options]  imagenamecontainername</td>\n</tr>\n<tr>\n<td>进入容器</td>\n<td>docker exec [options] names commond</td>\n<td>ctr task exec [options]  names commond</td>\n</tr>\n<tr>\n<td>查看运行的容器</td>\n<td>docker ps</td>\n<td>ctr task list</td>\n</tr>\n<tr>\n<td>删除容器</td>\n<td>docker rm [options] names</td>\n<td>1.ctr task rm -f names 2. ctr c rm -f names</td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "Docker"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/1490514396.html",
            "url": "http://ixuyong.cn/posts/1490514396.html",
            "title": "Redis Cluster集群部署",
            "date_published": "2025-05-12T13:21:44.000Z",
            "content_html": "<h3 id=\"redis-cluster集群部署\"><a class=\"anchor\" href=\"#redis-cluster集群部署\">#</a> Redis Cluster 集群部署</h3>\n<h4 id=\"1-环境配置\"><a class=\"anchor\" href=\"#1-环境配置\">#</a> 1、环境配置</h4>\n<h5 id=\"11-关闭防火墙-selinux\"><a class=\"anchor\" href=\"#11-关闭防火墙-selinux\">#</a> 1.1 关闭防火墙、Selinux</h5>\n<pre><code>systemctl disable --now firewalld \nsetenforce 0\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/sysconfig/selinux\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/selinux/config\n</code></pre>\n<h5 id=\"11-配置yum源\"><a class=\"anchor\" href=\"#11-配置yum源\">#</a> 1.1 配置 yum 源</h5>\n<pre><code>#rocky linux配置\nsed -e 's|^mirrorlist=|#mirrorlist=|g' \\\n    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.aliyun.com/rockylinux|g' \\\n    -i.bak \\\n    /etc/yum.repos.d/rocky-*.repo\nyum clean all &amp;&amp; yum makecache\nmkdir /soft /data /scripts /backup\n</code></pre>\n<h5 id=\"13-配置文件描述符\"><a class=\"anchor\" href=\"#13-配置文件描述符\">#</a> 1.3 配置文件描述符</h5>\n<pre><code>ulimit -SHn 65535\nvim /etc/security/limits.conf\n# 末尾添加如下内容\n* soft nofile 65536\n* hard nofile 131072\n* soft nproc 65535\n* hard nproc 655350\n* soft memlock unlimited\n* hard memlock unlimited\n</code></pre>\n<h5 id=\"14-系统内核参数调优\"><a class=\"anchor\" href=\"#14-系统内核参数调优\">#</a> 1.4 系统内核参数调优</h5>\n<pre><code># 修改/etc/sysctl.conf文件\ncat &gt;&gt; /etc/sysctl.conf &lt;&lt;EOF\nvm.max_map_count = 262144\nvm.swappiness=1\n\nnet.ipv4.tcp_fin_timeout=2\nnet.ipv4.tcp_tw_reuse=1\n#net.ipv4.tcp_tw_recycle=1\nnet.ipv4.tcp_syncookies=1\nnet.ipv4.tcp_keepalive_time=600\nnet.ipv4.ip_local_port_range=4000 65000\nnet.ipv4.tcp_max_syn_backlog=16384\nnet.ipv4.route.gc_timeout=100\nnet.ipv4.tcp_max_tw_buckets= 5000\n\nnet.ipv4.tcp_syn_retries=1\nnet.ipv4.tcp_synack_retries=1\nnet.core.somaxconn=16384\nnet.core.netdev_max_backlog=16384\nnet.ipv4.tcp_max_orphans=16384\n\n# 设置最大内存共享段大小bytes\nkernel.shmmax=15461882265\nkernel.shmall=3774873\n# 修改消息队列长度\nkernel.msgmax=65535\nkernel.msgmnb=65535\nEOF\n</code></pre>\n<h5 id=\"15-修改默认限制内存\"><a class=\"anchor\" href=\"#15-修改默认限制内存\">#</a> 1.5 修改默认限制内存</h5>\n<pre><code>cat &gt;&gt;/etc/systemd/system.conf&lt;&lt; EOF\nDefaultLimitNOFILE=65536\nDefaultLimitNPROC=32000\nDefaultLimitMEMLOCK=infinity\nEOF\n</code></pre>\n<h5 id=\"16-执行命令生效状态\"><a class=\"anchor\" href=\"#16-执行命令生效状态\">#</a> 1.6 执行命令生效状态</h5>\n<pre><code>sysctl -p\n</code></pre>\n<h5 id=\"17-安装基础软件包\"><a class=\"anchor\" href=\"#17-安装基础软件包\">#</a> 1.7 安装基础软件包</h5>\n<pre><code>yum install wget jq psmisc vim unzip net-tools telnet tree yum-utils device-mapper-persistent-data \\\nlvm2 git ntpdate nfs-utils iotop httpd-tools dos2unix lrzsz -y\n</code></pre>\n<h5 id=\"18-升级系统\"><a class=\"anchor\" href=\"#18-升级系统\">#</a> 1.8 升级系统</h5>\n<pre><code>yum update -y --exclude=kernel* &amp;&amp; reboot\n</code></pre>\n<h4 id=\"2-redis-cluster部署\"><a class=\"anchor\" href=\"#2-redis-cluster部署\">#</a> 2、Redis cluster 部署</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">192.168.1.135</th>\n<th style=\"text-align:center\">192.168.1.136</th>\n<th style=\"text-align:center\">192.168.1.137</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">node1：7001</td>\n<td style=\"text-align:center\">node1：7001</td>\n<td style=\"text-align:center\">node1：7001</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">node2：7002</td>\n<td style=\"text-align:center\">node2：7002</td>\n<td style=\"text-align:center\">node2：7002</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">node3：7003</td>\n<td style=\"text-align:center\">node3：7003</td>\n<td style=\"text-align:center\">node3：7003</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"21-安装包下载\"><a class=\"anchor\" href=\"#21-安装包下载\">#</a> 2.1 安装包下载</h5>\n<pre><code>wget https://download.redis.io/releases/redis-7.2.1.tar.gz\n</code></pre>\n<h5 id=\"22-安装-redis\"><a class=\"anchor\" href=\"#22-安装-redis\">#</a> 2.2 安装 redis</h5>\n<pre><code>yum install gcc-c++ -y\nmkdir /soft\ntar -xzvf redis-7.2.1.tar.gz -C /soft\nln -s /soft/redis-7.2.1 /soft/redis\ncd /soft/redis\nmake\nmake install prefix=/soft/redis\n</code></pre>\n<h5 id=\"23-生成集群配置文件\"><a class=\"anchor\" href=\"#23-生成集群配置文件\">#</a> 2.3 生成集群配置文件</h5>\n<pre><code>mkdir -p /soft/redis/data/7001\nmkdir -p /soft/redis/data/7002\nmkdir -p /soft/redis/data/7003\nmkdir -p /soft/redis/log\ncd /soft/redis\n</code></pre>\n<p><strong>redis_7001.conf 配置文件</strong></p>\n<pre><code>cat &gt; /soft/redis/redis_7001.conf &lt;&lt;EOF\nprotected-mode yes\nport 7001\nrequirepass admin123\nmasterauth admin123\ncluster-enabled yes\ncluster-config-file nodes-7001.conf\ncluster-node-timeout 5000\nmaxmemory 2GB\nmaxmemory-policy volatile-lru\ntcp-backlog 511\ntimeout 0\ntcp-keepalive 300\ndaemonize yes\npidfile /soft/redis/data/redis7001.pid\nloglevel notice\nlogfile &quot;/soft/redis/log/redis7001.log&quot;\n#databases 16\nalways-show-logo no\nset-proc-title yes\nproc-title-template &quot;&#123;title&#125; &#123;listen-addr&#125; &#123;server-mode&#125;&quot;\nlocale-collate &quot;&quot;\nstop-writes-on-bgsave-error yes\nrdbcompression yes\nrdbchecksum yes\ndbfilename dump.rdb\nrdb-del-sync-files no\ndir /soft/redis/data/7001\nreplica-serve-stale-data yes\nreplica-read-only yes\nrepl-diskless-sync yes\nrepl-diskless-sync-delay 5\nrepl-diskless-sync-max-replicas 0\nrepl-diskless-load disabled\nrepl-disable-tcp-nodelay no\nreplica-priority 100\nacllog-max-len 128\nlazyfree-lazy-eviction no\nlazyfree-lazy-expire no\nlazyfree-lazy-server-del no\nreplica-lazy-flush no\nlazyfree-lazy-user-del no\nlazyfree-lazy-user-flush no\noom-score-adj no\noom-score-adj-values 0 200 800\ndisable-thp yes\nappendonly no\nappendfilename &quot;appendonly.aof&quot;\nappenddirname &quot;appendonlydir&quot;\nappendfsync everysec\nno-appendfsync-on-rewrite no\nauto-aof-rewrite-percentage 100\nauto-aof-rewrite-min-size 64mb\naof-load-truncated yes\naof-use-rdb-preamble yes\naof-timestamp-enabled no\nslowlog-log-slower-than 10000\nslowlog-max-len 128\nlatency-monitor-threshold 0\nnotify-keyspace-events &quot;&quot;\nhash-max-listpack-entries 512\nhash-max-listpack-value 64\nlist-max-listpack-size -2\nlist-compress-depth 0\nset-max-intset-entries 512\nset-max-listpack-entries 128\nset-max-listpack-value 64\nzset-max-listpack-entries 128\nzset-max-listpack-value 64\nhll-sparse-max-bytes 3000\nstream-node-max-bytes 4096\nstream-node-max-entries 100\nactiverehashing yes\nclient-output-buffer-limit normal 0 0 0\nclient-output-buffer-limit replica 256mb 64mb 60\nclient-output-buffer-limit pubsub 32mb 8mb 60\nhz 10\ndynamic-hz yes\naof-rewrite-incremental-fsync yes\nrdb-save-incremental-fsync yes\njemalloc-bg-thread yes\nEOF\n</code></pre>\n<p><strong>redis_7002.conf 配置文件</strong></p>\n<pre><code>cat &gt; /soft/redis/redis_7002.conf &lt;&lt;EOF\nprotected-mode yes\nport 7002\nrequirepass admin123\nmasterauth admin123\ncluster-enabled yes\ncluster-config-file nodes-7002.conf\ncluster-node-timeout 5000\nmaxmemory 2GB\nmaxmemory-policy  volatile-lru\ntcp-backlog 511\ntimeout 0\ntcp-keepalive 300\ndaemonize yes\npidfile /soft/redis/data/redis7002.pid\nloglevel notice\nlogfile &quot;/soft/redis/log/redis7002.log&quot;\n#databases 16\nalways-show-logo no\nset-proc-title yes\nproc-title-template &quot;&#123;title&#125; &#123;listen-addr&#125; &#123;server-mode&#125;&quot;\nlocale-collate &quot;&quot;\nstop-writes-on-bgsave-error yes\nrdbcompression yes\nrdbchecksum yes\ndbfilename dump.rdb\nrdb-del-sync-files no\ndir /soft/redis/data/7002\nreplica-serve-stale-data yes\nreplica-read-only yes\nrepl-diskless-sync yes\nrepl-diskless-sync-delay 5\nrepl-diskless-sync-max-replicas 0\nrepl-diskless-load disabled\nrepl-disable-tcp-nodelay no\nreplica-priority 100\nacllog-max-len 128\nlazyfree-lazy-eviction no\nlazyfree-lazy-expire no\nlazyfree-lazy-server-del no\nreplica-lazy-flush no\nlazyfree-lazy-user-del no\nlazyfree-lazy-user-flush no\noom-score-adj no\noom-score-adj-values 0 200 800\ndisable-thp yes\nappendonly no\nappendfilename &quot;appendonly.aof&quot;\nappenddirname &quot;appendonlydir&quot;\nappendfsync everysec\nno-appendfsync-on-rewrite no\nauto-aof-rewrite-percentage 100\nauto-aof-rewrite-min-size 64mb\naof-load-truncated yes\naof-use-rdb-preamble yes\naof-timestamp-enabled no\nslowlog-log-slower-than 10000\nslowlog-max-len 128\nlatency-monitor-threshold 0\nnotify-keyspace-events &quot;&quot;\nhash-max-listpack-entries 512\nhash-max-listpack-value 64\nlist-max-listpack-size -2\nlist-compress-depth 0\nset-max-intset-entries 512\nset-max-listpack-entries 128\nset-max-listpack-value 64\nzset-max-listpack-entries 128\nzset-max-listpack-value 64\nhll-sparse-max-bytes 3000\nstream-node-max-bytes 4096\nstream-node-max-entries 100\nactiverehashing yes\nclient-output-buffer-limit normal 0 0 0\nclient-output-buffer-limit replica 256mb 64mb 60\nclient-output-buffer-limit pubsub 32mb 8mb 60\nhz 10\ndynamic-hz yes\naof-rewrite-incremental-fsync yes\nrdb-save-incremental-fsync yes\njemalloc-bg-thread yes\nEOF\n</code></pre>\n<p><strong>redis_7003.conf 配置文件</strong></p>\n<pre><code>cat &gt; /soft/redis/redis_7003.conf &lt;&lt;EOF\nprotected-mode yes\nport 7003\nrequirepass admin123\nmasterauth admin123\ncluster-enabled yes\ncluster-config-file nodes-7003.conf\ncluster-node-timeout 5000\nmaxmemory 2GB\nmaxmemory-policy  volatile-lru\ntcp-backlog 511\ntimeout 0\ntcp-keepalive 300\ndaemonize yes\npidfile /soft/redis/data/redis7003.pid\nloglevel notice\nlogfile &quot;/soft/redis/log/redis7003.log&quot;\n#databases 16\nalways-show-logo no\nset-proc-title yes\nproc-title-template &quot;&#123;title&#125; &#123;listen-addr&#125; &#123;server-mode&#125;&quot;\nlocale-collate &quot;&quot;\nstop-writes-on-bgsave-error yes\nrdbcompression yes\nrdbchecksum yes\ndbfilename dump.rdb\nrdb-del-sync-files no\ndir /soft/redis/data/7003\nreplica-serve-stale-data yes\nreplica-read-only yes\nrepl-diskless-sync yes\nrepl-diskless-sync-delay 5\nrepl-diskless-sync-max-replicas 0\nrepl-diskless-load disabled\nrepl-disable-tcp-nodelay no\nreplica-priority 100\nacllog-max-len 128\nlazyfree-lazy-eviction no\nlazyfree-lazy-expire no\nlazyfree-lazy-server-del no\nreplica-lazy-flush no\nlazyfree-lazy-user-del no\nlazyfree-lazy-user-flush no\noom-score-adj no\noom-score-adj-values 0 200 800\ndisable-thp yes\nappendonly no\nappendfilename &quot;appendonly.aof&quot;\nappenddirname &quot;appendonlydir&quot;\nappendfsync everysec\nno-appendfsync-on-rewrite no\nauto-aof-rewrite-percentage 100\nauto-aof-rewrite-min-size 64mb\naof-load-truncated yes\naof-use-rdb-preamble yes\naof-timestamp-enabled no\nslowlog-log-slower-than 10000\nslowlog-max-len 128\nlatency-monitor-threshold 0\nnotify-keyspace-events &quot;&quot;\nhash-max-listpack-entries 512\nhash-max-listpack-value 64\nlist-max-listpack-size -2\nlist-compress-depth 0\nset-max-intset-entries 512\nset-max-listpack-entries 128\nset-max-listpack-value 64\nzset-max-listpack-entries 128\nzset-max-listpack-value 64\nhll-sparse-max-bytes 3000\nstream-node-max-bytes 4096\nstream-node-max-entries 100\nactiverehashing yes\nclient-output-buffer-limit normal 0 0 0\nclient-output-buffer-limit replica 256mb 64mb 60\nclient-output-buffer-limit pubsub 32mb 8mb 60\nhz 10\ndynamic-hz yes\naof-rewrite-incremental-fsync yes\nrdb-save-incremental-fsync yes\njemalloc-bg-thread yes\nEOF\n</code></pre>\n<h5 id=\"24-redis开机自启\"><a class=\"anchor\" href=\"#24-redis开机自启\">#</a> 2.4 Redis 开机自启</h5>\n<p><strong>redis_7001.service</strong></p>\n<pre><code>cat &lt;&lt; &quot;EOF&quot; &gt; /usr/lib/systemd/system/redis_7001.service\n[Unit]\nDescription=Redis 7001 service\nDocumentation=https://redis.io/documentation\nWants=network-online.target\nAfter=network-online.target\n[Service]\nType=forking\nLimitNOFILE=10032\nUser=root\nGroup=root\nExecStart=/soft/redis/src/redis-server /soft/redis/redis_7001.conf\nPrivateTmp=true\n[Install]\nWantedBy=multi-user.target\nEOF\n</code></pre>\n<p><strong>redis_7002.service</strong></p>\n<pre><code>cat &lt;&lt; &quot;EOF&quot; &gt; /usr/lib/systemd/system/redis_7002.service\n[Unit]\nDescription=Redis 7002 service\nDocumentation=https://redis.io/documentation\nWants=network-online.target\nAfter=network-online.target\n[Service]\nType=forking\nLimitNOFILE=10032\nUser=root\nGroup=root\nExecStart=/soft/redis/src/redis-server /soft/redis/redis_7002.conf\nPrivateTmp=true\n[Install]\nWantedBy=multi-user.target\nEOF\n</code></pre>\n<p><strong>redis_7003.service</strong></p>\n<pre><code>cat &lt;&lt; &quot;EOF&quot; &gt; /usr/lib/systemd/system/redis_7003.service\n[Unit]\nDescription=Redis 7003 service\nDocumentation=https://redis.io/documentation\nWants=network-online.target\nAfter=network-online.target\n[Service]\nType=forking\nLimitNOFILE=10032\nUser=root\nGroup=root\nExecStart=/soft/redis/src/redis-server /soft/redis/redis_7003.conf\nPrivateTmp=true\n[Install]\nWantedBy=multi-user.target\nEOF\n</code></pre>\n<p><strong>设置开机自启</strong></p>\n<pre><code>chown -R root.root /soft/redis\nsystemctl daemon-reload\nsystemctl enable redis_7001.service\nsystemctl enable redis_7002.service\nsystemctl enable redis_7003.service\nsystemctl start redis_7001.service\nsystemctl start redis_7002.service\nsystemctl start redis_7003.service\nsystemctl status redis_7001.service\nsystemctl status redis_7002.service\nsystemctl status redis_7003.service\n</code></pre>\n<h5 id=\"25-启动redis集群服务\"><a class=\"anchor\" href=\"#25-启动redis集群服务\">#</a> 2.5 启动 redis 集群服务</h5>\n<p>--cluster-replicas 2 表示为集群中的每个主节点创建 2 个从节点</p>\n<pre><code>cd /soft/redis/src\n./redis-cli --cluster create \\  \n192.168.1.135:7001 192.168.1.135:7002 192.168.1.135:7003 \\  \n192.168.1.136:7001 192.168.1.136:7002 192.168.1.136:7003 \\ \n192.168.1.137:7001 192.168.1.137:7002 192.168.1.137:7003 \\ \n--cluster-replicas 2 -a admin123 \n</code></pre>\n<p>输入创建集群的命令后会出现以下提示，注意 Can I set the above configuration? (type 'yes' to accept): yes，该处请输入 yes</p>\n<pre><code>[root@qnyp_node01 src]# ./redis-cli --cluster create \\\n&gt; 192.168.1.135:7001 192.168.1.135:7002 192.168.1.135:7003 \\\n&gt; 192.168.1.136:7001 192.168.1.136:7002 192.168.1.136:7003 \\\n&gt; 192.168.1.137:7001 192.168.1.137:7002 192.168.1.137:7003 \\\n&gt; --cluster-replicas 2 -a admin123\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\n&gt;&gt;&gt; Performing hash slots allocation on 9 nodes...\nMaster[0] -&gt; Slots 0 - 5460\nMaster[1] -&gt; Slots 5461 - 10922\nMaster[2] -&gt; Slots 10923 - 16383\nAdding replica 192.168.1.136:7002 to 192.168.1.135:7001\nAdding replica 192.168.1.137:7002 to 192.168.1.135:7001\nAdding replica 192.168.1.135:7003 to 192.168.1.136:7001\nAdding replica 192.168.1.137:7003 to 192.168.1.136:7001\nAdding replica 192.168.1.136:7003 to 192.168.1.137:7001\nAdding replica 192.168.1.135:7002 to 192.168.1.137:7001\nM: 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7 192.168.1.135:7001\n   slots:[0-5460] (5461 slots) master\nS: 4508bee0c33784e0d5be25b64e4c7e677cd9d396 192.168.1.135:7002\n   replicates f9133541e2175958117753ef4e206ea43a21f07c\nS: a0e13083fcc1d6e96398f3bb2ea5581b7a64e05e 192.168.1.135:7003\n   replicates 06ea827f8d328d9d776c9643109317b0100727a6\nM: 06ea827f8d328d9d776c9643109317b0100727a6 192.168.1.136:7001\n   slots:[5461-10922] (5462 slots) master\nS: 1d1b9817e39ee8987a3518f62a9b91c3ab666eff 192.168.1.136:7002\n   replicates 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7\nS: a73c099dcc63f5d46a11d0f61c91270ef61290ff 192.168.1.136:7003\n   replicates f9133541e2175958117753ef4e206ea43a21f07c\nM: f9133541e2175958117753ef4e206ea43a21f07c 192.168.1.137:7001\n   slots:[10923-16383] (5461 slots) master\nS: 626dc659bb1059ec40039869241f7de88a49cd87 192.168.1.137:7002\n   replicates 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7\nS: 622f73cd06c5658f8d02056925ac708750f12c1a 192.168.1.137:7003\n   replicates 06ea827f8d328d9d776c9643109317b0100727a6\nCan I set the above configuration? (type 'yes' to accept):\n</code></pre>\n<p>输完 yes 后，会出现如下提示，[OK] All 16384 slots covered. 说明成功啦</p>\n<pre><code>Can I set the above configuration? (type 'yes' to accept): yes\n&gt;&gt;&gt; Nodes configuration updated\n&gt;&gt;&gt; Assign a different config epoch to each node\n&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join\n..\n&gt;&gt;&gt; Performing Cluster Check (using node 192.168.1.135:7001)\nM: 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7 192.168.1.135:7001\n   slots:[0-5460] (5461 slots) master\n   2 additional replica(s)\nM: 06ea827f8d328d9d776c9643109317b0100727a6 192.168.1.136:7001\n   slots:[5461-10922] (5462 slots) master\n   2 additional replica(s)\nS: 622f73cd06c5658f8d02056925ac708750f12c1a 192.168.1.137:7003\n   slots: (0 slots) slave\n   replicates 06ea827f8d328d9d776c9643109317b0100727a6\nS: 1d1b9817e39ee8987a3518f62a9b91c3ab666eff 192.168.1.136:7002\n   slots: (0 slots) slave\n   replicates 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7\nS: a73c099dcc63f5d46a11d0f61c91270ef61290ff 192.168.1.136:7003\n   slots: (0 slots) slave\n   replicates f9133541e2175958117753ef4e206ea43a21f07c\nS: a0e13083fcc1d6e96398f3bb2ea5581b7a64e05e 192.168.1.135:7003\n   slots: (0 slots) slave\n   replicates 06ea827f8d328d9d776c9643109317b0100727a6\nM: f9133541e2175958117753ef4e206ea43a21f07c 192.168.1.137:7001\n   slots:[10923-16383] (5461 slots) master\n   2 additional replica(s)\nS: 626dc659bb1059ec40039869241f7de88a49cd87 192.168.1.137:7002\n   slots: (0 slots) slave\n   replicates 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7\nS: 4508bee0c33784e0d5be25b64e4c7e677cd9d396 192.168.1.135:7002\n   slots: (0 slots) slave\n   replicates f9133541e2175958117753ef4e206ea43a21f07c\n[OK] All nodes agree about slots configuration.\n&gt;&gt;&gt; Check for open slots...\n&gt;&gt;&gt; Check slots coverage...\n[OK] All 16384 slots covered.\n</code></pre>\n<h5 id=\"26-访问reids集群并验证\"><a class=\"anchor\" href=\"#26-访问reids集群并验证\">#</a> 2.6 访问 reids 集群并验证</h5>\n<pre><code>cd /data/redis/src\n./redis-cli -h 192.168.1.135 -p 7001 -c -a admin123\n#列出当前节点的信息：cluster info\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\n192.168.1.135:7001&gt; cluster info\ncluster_state:ok\ncluster_slots_assigned:16384\ncluster_slots_ok:16384\ncluster_slots_pfail:0\ncluster_slots_fail:0\ncluster_known_nodes:9\ncluster_size:3\ncluster_current_epoch:9\ncluster_my_epoch:1\ncluster_stats_messages_ping_sent:344\ncluster_stats_messages_pong_sent:354\ncluster_stats_messages_sent:698\ncluster_stats_messages_ping_received:346\ncluster_stats_messages_pong_received:344\ncluster_stats_messages_meet_received:8\ncluster_stats_messages_received:698\ntotal_cluster_links_buffer_limit_exceeded:0\n列出集群的节点的信息：cluster nodes\n192.168.1.135:7001&gt; cluster nodes\n06ea827f8d328d9d776c9643109317b0100727a6 192.168.1.136:7001@17001 master - 0 1747034145581 4 connected 5461-10922\n622f73cd06c5658f8d02056925ac708750f12c1a 192.168.1.137:7003@17003 slave 06ea827f8d328d9d776c9643109317b0100727a6 0 1747034145581 4 connected\n1d1b9817e39ee8987a3518f62a9b91c3ab666eff 192.168.1.136:7002@17002 slave 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7 0 1747034145581 1 connected\na73c099dcc63f5d46a11d0f61c91270ef61290ff 192.168.1.136:7003@17003 slave f9133541e2175958117753ef4e206ea43a21f07c 0 1747034145581 7 connected\na0e13083fcc1d6e96398f3bb2ea5581b7a64e05e 192.168.1.135:7003@17003 slave 06ea827f8d328d9d776c9643109317b0100727a6 0 1747034144077 4 connected\nf9133541e2175958117753ef4e206ea43a21f07c 192.168.1.137:7001@17001 master - 0 1747034145079 7 connected 10923-16383\n626dc659bb1059ec40039869241f7de88a49cd87 192.168.1.137:7002@17002 slave 928637d72deb6a2e7935f8a7bb5ebd9455cf64a7 0 1747034144000 1 connected\n928637d72deb6a2e7935f8a7bb5ebd9455cf64a7 192.168.1.135:7001@17001 myself,master - 0 1747034144000 1 connected 0-5460\n4508bee0c33784e0d5be25b64e4c7e677cd9d396 192.168.1.135:7002@17002 slave f9133541e2175958117753ef4e206ea43a21f07c 0 1747034144578 7 connected\n</code></pre>\n",
            "tags": [
                "Redis"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/170573601.html",
            "url": "http://ixuyong.cn/posts/170573601.html",
            "title": "K8s服务发布Ingress",
            "date_published": "2025-04-26T08:52:06.000Z",
            "content_html": "<h4 id=\"1-ingress-nginx-controller-安装\"><a class=\"anchor\" href=\"#1-ingress-nginx-controller-安装\">#</a> 1. Ingress Nginx Controller 安装</h4>\n<table>\n<thead>\n<tr>\n<th>Supported</th>\n<th>Ingress-NGINX version</th>\n<th>k8s supported version</th>\n<th>Alpine Version</th>\n<th>Nginx Version</th>\n<th>Helm Chart Version</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>🔄</td>\n<td><strong>v1.12.1</strong></td>\n<td>1.32, 1.31, 1.30, 1.29, 1.28</td>\n<td>3.21.3</td>\n<td>1.25.5</td>\n<td>4.12.1</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.12.0</strong></td>\n<td>1.32, 1.31, 1.30, 1.29, 1.28</td>\n<td>3.21.0</td>\n<td>1.25.5</td>\n<td>4.12.0</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.12.0-beta.0</strong></td>\n<td>1.32, 1.31, 1.30, 1.29, 1.28</td>\n<td>3.20.3</td>\n<td>1.25.5</td>\n<td>4.12.0-beta.0</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.11.5</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.21.3</td>\n<td>1.25.5</td>\n<td>4.11.5</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.11.4</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.21.0</td>\n<td>1.25.5</td>\n<td>4.11.4</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.11.3</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.3</td>\n<td>1.25.5</td>\n<td>4.11.3</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.11.2</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.0</td>\n<td>1.25.5</td>\n<td>4.11.2</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.11.1</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.0</td>\n<td>1.25.5</td>\n<td>4.11.1</td>\n</tr>\n<tr>\n<td>🔄</td>\n<td><strong>v1.11.0</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.0</td>\n<td>1.25.5</td>\n<td>4.11.0</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>v1.10.6</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.21.0</td>\n<td>1.25.5</td>\n<td>4.10.6</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>v1.10.5</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.3</td>\n<td>1.25.5</td>\n<td>4.10.5</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>v1.10.4</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.0</td>\n<td>1.25.5</td>\n<td>4.10.4</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>v1.10.3</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.0</td>\n<td>1.25.5</td>\n<td>4.10.3</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>v1.10.2</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.20.0</td>\n<td>1.25.5</td>\n<td>4.10.2</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>v1.10.1</strong></td>\n<td>1.30, 1.29, 1.28, 1.27, 1.26</td>\n<td>3.19.1</td>\n<td>1.25.3</td>\n<td>4.10.1</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>v1.10.0</strong></td>\n<td>1.29, 1.28, 1.27, 1.26</td>\n<td>3.19.1</td>\n<td>1.25.3</td>\n<td>4.10.0</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.9.6</td>\n<td>1.29, 1.28, 1.27, 1.26, 1.25</td>\n<td>3.19.0</td>\n<td>1.21.6</td>\n<td>4.9.1</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.9.5</td>\n<td>1.28, 1.27, 1.26, 1.25</td>\n<td>3.18.4</td>\n<td>1.21.6</td>\n<td>4.9.0</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.9.4</td>\n<td>1.28, 1.27, 1.26, 1.25</td>\n<td>3.18.4</td>\n<td>1.21.6</td>\n<td>4.8.3</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.9.3</td>\n<td>1.28, 1.27, 1.26, 1.25</td>\n<td>3.18.4</td>\n<td>1.21.6</td>\n<td>4.8.*</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.9.1</td>\n<td>1.28, 1.27, 1.26, 1.25</td>\n<td>3.18.4</td>\n<td>1.21.6</td>\n<td>4.8.*</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.9.0</td>\n<td>1.28, 1.27, 1.26, 1.25</td>\n<td>3.18.2</td>\n<td>1.21.6</td>\n<td>4.8.*</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.8.4</td>\n<td>1.27, 1.26, 1.25, 1.24</td>\n<td>3.18.2</td>\n<td>1.21.6</td>\n<td>4.7.*</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.7.1</td>\n<td>1.27, 1.26, 1.25, 1.24</td>\n<td>3.17.2</td>\n<td>1.21.6</td>\n<td>4.6.*</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.6.4</td>\n<td>1.26, 1.25, 1.24, 1.23</td>\n<td>3.17.0</td>\n<td>1.21.6</td>\n<td>4.5.*</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.5.1</td>\n<td>1.25, 1.24, 1.23</td>\n<td>3.16.2</td>\n<td>1.21.6</td>\n<td>4.4.*</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.4.0</td>\n<td>1.25, 1.24, 1.23, 1.22</td>\n<td>3.16.2</td>\n<td>1.19.10†</td>\n<td>4.3.0</td>\n</tr>\n<tr>\n<td></td>\n<td>v1.3.1</td>\n<td>1.24, 1.23, 1.22, 1.21, 1.20</td>\n<td>3.16.2</td>\n<td>1.19.10†</td>\n<td>4.2.5</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"11-helm安装ingress-nginx-controller\"><a class=\"anchor\" href=\"#11-helm安装ingress-nginx-controller\">#</a> 1.1 Helm 安装 Ingress Nginx Controller</h5>\n<ol>\n<li>安装 Helm</li>\n</ol>\n<pre><code># wget https://get.helm.sh/helm-v3.6.3-linux-amd64.tar.gz\n# tar xf helm-v3.6.3-linux-amd64.tar.gz\n# mv linux-amd64/helm /usr/local/bin/helm\n# helm version\n</code></pre>\n<ol start=\"2\">\n<li>下载 Ingress Nginx Controller 安装包</li>\n</ol>\n<pre><code>官方文档：https://github.com/kubernetes/ingress-nginx/tree/helm-chart-4.8.2         #根据自己k8s版本下载\n# helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\n# helm repo update\n# helm repo list\n# helm pull ingress-nginx/ingress-nginx --version 4.8.2\n</code></pre>\n<ol start=\"3\">\n<li>配置 Ingress Nginx Controller</li>\n</ol>\n<pre><code># tar xf ingress-nginx-4.8.2.tgz\n# cd ingress-nginx\n# vim values.yaml\n...\n 16 controller:\n 17   name: controller\n 18   enableAnnotationValidations: false\n 19   image:\n 20     ## Keep false as default for now!\n 21     chroot: false\n 22     registry: registry.cn-hangzhou.aliyuncs.com\n 23     image: kubernetes_public/ingress-nginx-controller\n 24     ## for backwards compatibility consider setting the full image url via the repository value below\n 25     ## use *either* current default registry/image or repository format or installing chart by providing the values.yaml wil    l fail\n 26     ## repository:\n 27     tag: &quot;v1.9.3&quot;\n 28     #digest: sha256:8fd21d59428507671ce0fb47f818b1d859c92d2ad07bb7c947268d433030ba98\n...\n 42   # -- Will add custom configuration options to Nginx https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configurat    ion/configmap/\n 43   config:\n 44     allow-snippet-annotations: true          #开启server snippet的配置\n...\n 67   dnsPolicy: ClusterFirstWithHostNet\n...\n 88   hostNetwork: true\n...\n107   ingressClassResource:\n108     # -- Name of the ingressClass\n109     name: nginx\n110     # -- Is this ingressClass enabled or not\n111     enabled: true\n112     # -- Is this the default ingressClass for the cluster\n113     default: true\n...\n184   kind: DaemonSet\n...\n287   nodeSelector:\n288     kubernetes.io/os: linux\n289     ingress: &quot;true&quot;\n...\n638       image:\n639         registry: registry.cn-hangzhou.aliyuncs.com\n640         image: kubernetes_public/kube-webhook-certgen\n641         ## for backwards compatibility consider setting the full image url via the repository value below\n642         ## use *either* current default registry/image or repository format or installing chart by providing the values.yaml     will fail\n643         ## repository:\n644         tag: v20231011-8b53cabe0\n645         #digest: sha256:a7943503b45d552785aa3b5e457f169a5661fb94d82b8a3373bcd9ebaf9aac80\n...\n</code></pre>\n<p>4. 给需要部署 ingress 的节点上打标签</p>\n<pre><code># kubectl label node k8s-node02 ingress=true\n# kubectl label node k8s-node01 ingress=true\n# kubectl create ns ingress-nginx\n# helm install ingress-nginx -n ingress-nginx .     #安装\n# helm upgrade ingress-nginx -n ingress-nginx .     #更新\n# kubectl get pods -n ingress-nginx \nNAME                             READY   STATUS    RESTARTS   AGE\ningress-nginx-controller-7nfqn   1/1     Running   0          27s\ningress-nginx-controller-k4p2n   1/1     Running   0          17m\ningress-nginx-controller-kw5jk   1/1     Running   0          24s\n</code></pre>\n<h5 id=\"12-bare-metal安装ingress-nginx-controller\"><a class=\"anchor\" href=\"#12-bare-metal安装ingress-nginx-controller\">#</a> 1.2 Bare metal 安装 Ingress Nginx Controller</h5>\n<ol>\n<li>下载 Ingress 部署文件，链接地址：<a href=\"https://kubernetes.github.io/ingress-nginx/deploy/#bare-metal-clusters\">https://kubernetes.github.io/ingress-nginx/deploy/#bare-metal-clusters</a></li>\n</ol>\n<pre><code>[root@k8s-master01 ~]# wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.12.1/deploy/static/provider/baremetal/deploy.yaml\n</code></pre>\n<ol start=\"2\">\n<li>配置 Ingress</li>\n</ol>\n<pre><code>[root@k8s-master01 ingress-master]# cat deploy.yaml \napiVersion: v1\nkind: Namespace\nmetadata:\n  labels:\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n  name: ingress-nginx\n---\napiVersion: v1\nautomountServiceAccountToken: true\nkind: ServiceAccount\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx\n  namespace: ingress-nginx\n---\napiVersion: v1\nautomountServiceAccountToken: true\nkind: ServiceAccount\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission\n  namespace: ingress-nginx\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx\n  namespace: ingress-nginx\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - namespaces\n  verbs:\n  - get\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - configmaps\n  - pods\n  - secrets\n  - endpoints\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - services\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - ingresses\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - ingresses/status\n  verbs:\n  - update\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - ingressclasses\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - coordination.k8s.io\n  resourceNames:\n  - ingress-nginx-leader\n  resources:\n  - leases\n  verbs:\n  - get\n  - update\n- apiGroups:\n  - coordination.k8s.io\n  resources:\n  - leases\n  verbs:\n  - create\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - events\n  verbs:\n  - create\n  - patch\n- apiGroups:\n  - discovery.k8s.io\n  resources:\n  - endpointslices\n  verbs:\n  - list\n  - watch\n  - get\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission\n  namespace: ingress-nginx\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - secrets\n  verbs:\n  - get\n  - create\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  labels:\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - configmaps\n  - endpoints\n  - nodes\n  - pods\n  - secrets\n  - namespaces\n  verbs:\n  - list\n  - watch\n- apiGroups:\n  - coordination.k8s.io\n  resources:\n  - leases\n  verbs:\n  - list\n  - watch\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - nodes\n  verbs:\n  - get\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - services\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - ingresses\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - events\n  verbs:\n  - create\n  - patch\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - ingresses/status\n  verbs:\n  - update\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - ingressclasses\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - discovery.k8s.io\n  resources:\n  - endpointslices\n  verbs:\n  - list\n  - watch\n  - get\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission\nrules:\n- apiGroups:\n  - admissionregistration.k8s.io\n  resources:\n  - validatingwebhookconfigurations\n  verbs:\n  - get\n  - update\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx\n  namespace: ingress-nginx\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: ingress-nginx\nsubjects:\n- kind: ServiceAccount\n  name: ingress-nginx\n  namespace: ingress-nginx\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission\n  namespace: ingress-nginx\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: ingress-nginx-admission\nsubjects:\n- kind: ServiceAccount\n  name: ingress-nginx-admission\n  namespace: ingress-nginx\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  labels:\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: ingress-nginx\nsubjects:\n- kind: ServiceAccount\n  name: ingress-nginx\n  namespace: ingress-nginx\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: ingress-nginx-admission\nsubjects:\n- kind: ServiceAccount\n  name: ingress-nginx-admission\n  namespace: ingress-nginx\n---\napiVersion: v1\ndata: null\nkind: ConfigMap\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-controller\n  namespace: ingress-nginx\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-controller\n  namespace: ingress-nginx\nspec:\n  ipFamilies:\n  - IPv4\n  ipFamilyPolicy: SingleStack\n  ports:\n  - appProtocol: http\n    name: http\n    port: 80\n    protocol: TCP\n    targetPort: http\n  - appProtocol: https\n    name: https\n    port: 443\n    protocol: TCP\n    targetPort: https\n  selector:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n  #type: NodePort\n  type: ClusterIP\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-controller-admission\n  namespace: ingress-nginx\nspec:\n  ports:\n  - appProtocol: https\n    name: https-webhook\n    port: 443\n    targetPort: webhook\n  selector:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n  type: ClusterIP\n---\napiVersion: apps/v1\n#kind: Deployment\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-controller\n  namespace: ingress-nginx\nspec:\n  minReadySeconds: 0\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: controller\n      app.kubernetes.io/instance: ingress-nginx\n      app.kubernetes.io/name: ingress-nginx\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: controller\n        app.kubernetes.io/instance: ingress-nginx\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/version: 1.12.1\n    spec:\n      containers:\n      - args:\n        - /nginx-ingress-controller\n        - --election-id=ingress-nginx-leader\n        - --controller-class=k8s.io/ingress-nginx\n        - --ingress-class=nginx\n        - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller\n        - --validating-webhook=:8443\n        - --validating-webhook-certificate=/usr/local/certificates/cert\n        - --validating-webhook-key=/usr/local/certificates/key\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: LD_PRELOAD\n          value: /usr/local/lib/libmimalloc.so\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/ingress-nginx-controller-v1.12.1:v1.12.1 \n        imagePullPolicy: IfNotPresent\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /wait-shutdown\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: controller\n        ports:\n        - containerPort: 80\n          name: http\n          protocol: TCP\n        - containerPort: 443\n          name: https\n          protocol: TCP\n        - containerPort: 8443\n          name: webhook\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 100m\n            memory: 90Mi\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            add:\n            - NET_BIND_SERVICE\n            drop:\n            - ALL\n          readOnlyRootFilesystem: false\n          runAsGroup: 82\n          runAsNonRoot: true\n          runAsUser: 101\n          seccompProfile:\n            type: RuntimeDefault\n        volumeMounts:\n        - mountPath: /usr/local/certificates/\n          name: webhook-cert\n          readOnly: true\n      hostNetwork: true                         # 与节点共享网络名称空间\n      #dnsPolicy: ClusterFirst\n      dnsPolicy: ClusterFirstWithHostNet        # dns 策略\n      nodeSelector:                             # 节点选择器\n        kubernetes.io/os: linux\n        ingress: &quot;true&quot;\n      serviceAccountName: ingress-nginx\n      terminationGracePeriodSeconds: 300\n      volumes:\n      - name: webhook-cert\n        secret:\n          secretName: ingress-nginx-admission\n---\napiVersion: batch/v1\nkind: Job\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission-create\n  namespace: ingress-nginx\nspec:\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: admission-webhook\n        app.kubernetes.io/instance: ingress-nginx\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/version: 1.12.1\n      name: ingress-nginx-admission-create\n    spec:\n      containers:\n      - args:\n        - create\n        - --host=ingress-nginx-controller-admission,ingress-nginx-controller-admission.$(POD_NAMESPACE).svc\n        - --namespace=$(POD_NAMESPACE)\n        - --secret-name=ingress-nginx-admission\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kube-webhook-certgen-v1.5.2:v1.5.2 \n        imagePullPolicy: IfNotPresent\n        name: create\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      nodeSelector:\n        kubernetes.io/os: linux\n      restartPolicy: OnFailure\n      serviceAccountName: ingress-nginx-admission\n---\napiVersion: batch/v1\nkind: Job\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission-patch\n  namespace: ingress-nginx\nspec:\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: admission-webhook\n        app.kubernetes.io/instance: ingress-nginx\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/version: 1.12.1\n      name: ingress-nginx-admission-patch\n    spec:\n      containers:\n      - args:\n        - patch\n        - --webhook-name=ingress-nginx-admission\n        - --namespace=$(POD_NAMESPACE)\n        - --patch-mutating=false\n        - --secret-name=ingress-nginx-admission\n        - --patch-failure-policy=Fail\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/kube-webhook-certgen-v1.5.2:v1.5.2 \n        imagePullPolicy: IfNotPresent\n        name: patch\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      nodeSelector:\n        kubernetes.io/os: linux\n      restartPolicy: OnFailure\n      serviceAccountName: ingress-nginx-admission\n---\napiVersion: networking.k8s.io/v1\nkind: IngressClass\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: nginx\nspec:\n  controller: k8s.io/ingress-nginx\n---\napiVersion: admissionregistration.k8s.io/v1\nkind: ValidatingWebhookConfiguration\nmetadata:\n  labels:\n    app.kubernetes.io/component: admission-webhook\n    app.kubernetes.io/instance: ingress-nginx\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/version: 1.12.1\n  name: ingress-nginx-admission\nwebhooks:\n- admissionReviewVersions:\n  - v1\n  clientConfig:\n    service:\n      name: ingress-nginx-controller-admission\n      namespace: ingress-nginx\n      path: /networking/v1/ingresses\n      port: 443\n  failurePolicy: Fail\n  matchPolicy: Equivalent\n  name: validate.nginx.ingress.kubernetes.io\n  rules:\n  - apiGroups:\n    - networking.k8s.io\n    apiVersions:\n    - v1\n    operations:\n    - CREATE\n    - UPDATE\n    resources:\n    - ingresses\n  sideEffects: None\n</code></pre>\n<ul>\n<li>type: ClusterIP                                              #service 类型改为 ClusterIP</li>\n<li>hostNetwork: true                                      # 与节点共享网络名称空间</li>\n<li>dnsPolicy: ClusterFirstWithHostNet        # dns 策略</li>\n<li>nodeSelector:                                             # 节点选择器</li>\n<li>kind: DaemonSet                                        # 资源类型 DaemonSet</li>\n</ul>\n<ol start=\"3\">\n<li>在指定节点部署 Ingress-Controller</li>\n</ol>\n<pre><code>[root@k8s-master01 ingress-master]# kubectl apply -f deploy.yaml -n ingress-nginx\n\n[root@k8s-master01 ingress-master]# kubectl label node k8s-node01 ingress=true\n[root@k8s-master01 ingress-master]# kubectl label node k8s-node02 ingress=true\n[root@k8s-master01 ingress-master]# kubectl label node k8s-master03 ingress-     #取消节点部署\n\n[root@k8s-master01 ingress-master]# kubectl get pods -n ingress-nginx \nNAME                                   READY   STATUS      RESTARTS   AGE\ningress-nginx-admission-create-zp6mh   0/1     Completed   0          12m\ningress-nginx-admission-patch-f2bpd    0/1     Completed   0          12m\ningress-nginx-controller-rgtkc         1/1     Running     0          3m59s\ningress-nginx-controller-trmn8         1/1     Running     0          3m59s\n</code></pre>\n<h4 id=\"2-ingress-nginx-入门使用\"><a class=\"anchor\" href=\"#2-ingress-nginx-入门使用\">#</a> 2. Ingress Nginx 入门使用</h4>\n<pre><code># cat web-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: web-ingress\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: test.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n</code></pre>\n<h4 id=\"3-ingress-nginx-域名重定向-redirect\"><a class=\"anchor\" href=\"#3-ingress-nginx-域名重定向-redirect\">#</a> 3. Ingress Nginx 域名重定向 Redirect</h4>\n<pre><code># cat redirect-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: redirect-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/permanent-redirect: https://www.baidu.com\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: redirect.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n</code></pre>\n<h4 id=\"4-ingress-nginx-前后端分离-rewrite\"><a class=\"anchor\" href=\"#4-ingress-nginx-前后端分离-rewrite\">#</a> 4. Ingress Nginx 前后端分离 Rewrite</h4>\n<pre><code># cat rewrite-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: rewrite-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /$2\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: rewrite.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /api(/|$)(.*)\n        pathType: ImplementationSpecif\n</code></pre>\n<h4 id=\"5-ingress-nginx-错误代码重定向\"><a class=\"anchor\" href=\"#5-ingress-nginx-错误代码重定向\">#</a> 5. Ingress Nginx 错误代码重定向</h4>\n<pre><code>\n</code></pre>\n<h4 id=\"6-ingress-nginx-ssl\"><a class=\"anchor\" href=\"#6-ingress-nginx-ssl\">#</a> 6. Ingress Nginx SSL</h4>\n<pre><code>1.生成证书\n# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout tls.key -out tls.cert -subj &quot;/CN=s.hmallleasing.com/O=tls.hmallleasing.com&quot;\n\n2.创建证书\n# kubectl create secret tls tls.hmallleasig.com --key tls.key --cert tls.cert\n\n3.ingress配置\n# kubectl create secret tls tls.hmallleasig.com --cert=tls.crt --key=tls.key\n# cat tls-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: tls-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/ssl-redirect: &quot;false&quot;    #禁用https强制跳转\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: tls.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n  tls:                  #https\n  - hosts:\n    - tls.hmallleasing.com\n    secretName: &quot;tls.hmallleasig.com&quot;\t\n</code></pre>\n<h4 id=\"7-ingress-nginx-匹配请求头\"><a class=\"anchor\" href=\"#7-ingress-nginx-匹配请求头\">#</a> 7. Ingress Nginx 匹配请求头</h4>\n<pre><code>1.部署移动端应用\n# kubectl create deploy phone --image=registry.cn-beijing.aliyuncs.com/dotbalo/nginx:phone\n# kubectl expose deploy phone --port 80\n# vim m-ingress.yaml\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: m-ingress\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: m.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: phone\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n\n2.部署PC端应用\t\t\n# kubectl create deploy laptop --image=registry.cn-beijing.aliyuncs.com/dotbalo/nginx:laptop\t\n# kubectl expose deploy laptop --port 80\n# vim laptop-ingress.yaml\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  annotations:\n    kubernetes.io/ingress.class: nginx\n    nginx.ingress.kubernetes.io/server-snippet: |\n      set $agentflag 0;\n          if ($http_user_agent ~* &quot;(Android|iPhone|Windows Phone|UC|Kindle)&quot; )&#123;\n              set $agentflag 1;\n          &#125;\n          if ( $agentflag = 1 ) &#123;\n              return 301 http://m.hmallleaing.com;\n          &#125;\n  name: laptop-ingress\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: laptop\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\t\n</code></pre>\n<h4 id=\"8ingress-nginx-基本认证\"><a class=\"anchor\" href=\"#8ingress-nginx-基本认证\">#</a> 8.Ingress Nginx 基本认证</h4>\n<pre><code># yum install httpd -y\n# htpasswd -c auth superman\n# cat auth \nsuperman:$apr1$AC1pc3dK$RJyWnyDJFNKY6twneGVrA1\t\t\n\n# kubectl create secret generic basic-auth --from-file=auth\n# cat basic-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: basic-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/auth-type: basic  # 认证类型\n    nginx.ingress.kubernetes.io/auth-secret: basic-auth  # 包含用户和密码的 secret 资源名称\n    nginx.ingress.kubernetes.io/auth-realm: 'Please User password'  # 要显示的信息\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: basic.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n</code></pre>\n<h4 id=\"9-ingress-nginx-黑白名单\"><a class=\"anchor\" href=\"#9-ingress-nginx-黑白名单\">#</a> 9. Ingress Nginx 黑 / 白名单</h4>\n<pre><code>写法一：\n# cat white-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: white-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/whitelist-source-range: &quot;192.168.40.101&quot;\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: white.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\t\n\n写法二：\t\t\n[root@k8s-master01 ingress]# cat white-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: white-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/whitelist-source-range: &quot;192.168.40.0/24&quot;\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: white.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n\n\n写法三：\n# cat white-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: white-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/server-snippet: |\n      allow 192.168.40.0/24;\n      deny all;\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: white.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n\t\t\n\n#Master01测试\t\t\n# curl -H &quot;Host:white.hmallleasing.com&quot; http://192.168.40.103 -I\nHTTP/1.1 200 OK\nDate: Sat, 14 Oct 2023 13:12:03 GMT\nContent-Type: text/html\nContent-Length: 612\nConnection: keep-alive\nLast-Modified: Tue, 16 Apr 2019 13:08:19 GMT\nETag: &quot;5cb5d3c3-264&quot;\nAccept-Ranges: bytes\t\t\n\n#Master02测试\n# curl -H &quot;Host:white.hmallleasing.com&quot; http://192.168.40.103 -I\nHTTP/1.1 403 Forbidden\nDate: Sat, 14 Oct 2023 13:13:34 GMT\nContent-Type: text/html\nContent-Length: 146\nConnection: keep-alive\n</code></pre>\n<h4 id=\"10-ingress-nginx-速率限制\"><a class=\"anchor\" href=\"#10-ingress-nginx-速率限制\">#</a> 10. Ingress Nginx 速率限制</h4>\n<pre><code>[root@k8s-master01 ingress]# cat limit-rate-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: rate-limit-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/limit-rps: &quot;50&quot;\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: rate-limit.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: nginx\n            port:\n              number: 80\n        path: /\n        pathType: ImplementationSpecific\n\n# ab -c 20 -n 1000 http://rate-limit.hmallleasing.com/ |grep request\nComplete requests:      1000\nFailed requests:        724\nTime per request:       10.301 [ms] (mean)\nTime per request:       0.515 [ms] (mean, across all concurrent requests)\nPercentage of the requests served within a certain time (ms)\n</code></pre>\n<h4 id=\"11使用-nginx-实现灰度金丝雀发布\"><a class=\"anchor\" href=\"#11使用-nginx-实现灰度金丝雀发布\">#</a> 11. 使用 Nginx 实现灰度 / 金丝雀发布</h4>\n<pre><code>1.创建 v1 版本\n# kubectl create deploy canary-v1 --image=registry.cn-beijing.aliyuncs.com/dotbalo/canary:v1\t\n# kubectl expose deploy canary-v1 --port 8080\n# cat canary-v1-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: canary-v1-ingress\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: canary.hmallleasing.com\n    http:\n      paths:\n      - backend:\n          service:\n            name: canary-v1\n            port:\n              number: 8080\n        path: /\n        pathType: ImplementationSpecific\n\t\t\n# curl -H &quot;Host:canary.hmallleasing.com&quot; http://192.168.40.103 \t\n\n2.创建 v2 版本\n# kubectl create deploy canary-v2 --image=registry.cn-beijing.aliyuncs.com/dotbalo/canary:v2\n# kubectl expose deploy canary-v2 --port 8080\n# cat canary-v2-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: canary-v2-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/canary: &quot;true&quot;    #启动灰度发布\n    nginx.ingress.kubernetes.io/canary-weight: &quot;20&quot;  #基于权重,50%流量调度到这个灰度的版本上\nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: canary.hmallleasing.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: canary-v2\n            port:\n              number: 8080\n\n#测试灰度发布\n[root@k8s-master01 ingress]# cat canary.sh \n#!/bin/bash\n\nwhile true\ndo\n\tcurl -H &quot;Host:canary.hmallleasing.com&quot; http://192.168.40.103\n\tsleep 0.5\ndone\n</code></pre>\n<h4 id=\"12-kubernetes-dashboard配置证书\"><a class=\"anchor\" href=\"#12-kubernetes-dashboard配置证书\">#</a> 12. kubernetes-dashboard 配置证书</h4>\n<pre><code>1.创建证书\nkubectl create secret tls kubernetes-dashboard-certs --key *.hmallleasing.com_key.key --cert *.hmallleasing.com_chain.crt -n kubernetes-dashboard\n\n2.修改kubernetes-dashboard资源清单\nkubectl edit deployment -n kubernetes-dashboard kubernetes-dashboard\n...\n      - args:\n        - --auto-generate-certificates=false\n        - --tls-key-file=_.hmallleasing.com_key.key\n        - --tls-cert-file=_.hmallleasing.com_chain.crt\n        - --token-ttl=21600\n        - --authentication-mode=basic,token\n        - --namespace=kubernetes-dashboard\n...\n\n3.创建ingress\n#cat dashboard-ingress.yaml \napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: dashboard-ingress\n  namespace: kubernetes-dashboard\n  annotations:\n    nginx.ingress.kubernetes.io/ssl-passthrough: &quot;true&quot;    \n    nginx.ingress.kubernetes.io/backend-protocol: &quot;HTTPS&quot;    \nspec:\n  ingressClassName: &quot;nginx&quot;\n  rules:\n  - host: dashboard.hmallleasing.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: kubernetes-dashboard\n            port:\n              number: 443\n\n# kubectl apply -f dashboard-ingress.yaml \n</code></pre>\n<h4 id=\"13-入口lb配置\"><a class=\"anchor\" href=\"#13-入口lb配置\">#</a> 13. 入口 LB 配置</h4>\n<pre><code>[root@lb nginx]# cat /etc/nginx/conf.d/ingress.conf \nupstream ingress &#123;\n\tserver 192.168.40.103:80 max_conns=2000 max_fails=2 fail_timeout=5s;\n\tserver 192.168.40.104:80 max_conns=2000 max_fails=2 fail_timeout=5s;\n\tserver 192.168.40.105:80 max_conns=2000 max_fails=2 fail_timeout=5s;\n&#125;\n\nserver &#123;\n    listen 443 ssl;\n    server_name test.hmallleasing.com;\n    client_max_body_size 1G; \n    ssl_prefer_server_ciphers on;\n    ssl_certificate  /etc/nginx/sslkey/*.hmallleasing.com_chain.crt;\n    ssl_certificate_key  /etc/nginx/sslkey/*.hmallleasing.com_key.key;\n\n    location / &#123;\n        proxy_pass http://ingress;\n        include proxy_params;\n\t    proxy_next_upstream error timeout http_500 http_502 http_503 http_504;\n\t    proxy_next_upstream_tries 2;\n\t    proxy_next_upstream_timeout 3s;\n    &#125;\n&#125;\n\nserver &#123;\n    listen 80;\n    server_name test.hmallleasing.com;\n    return 302 https://$server_name$request_uri;\n&#125;\n\n[root@lb ~]# mkdir /etc/nginx/sslkey -p\n\n\n[root@lb ~]# cat proxy_params \nproxy_http_version 1.1;\nproxy_set_header Connectin &quot;&quot;;\n\nproxy_set_header Host $http_host;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\nproxy_connect_timeout 60;\nproxy_send_timeout 120;\nproxy_read_timeout 120;\n\nproxy_buffering on;\nproxy_buffer_size 32k;\nproxy_buffers 4 128k;\nproxy_temp_file_write_size 10240k;\nproxy_max_temp_file_size 10240k;\n</code></pre>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3364424907.html",
            "url": "http://ixuyong.cn/posts/3364424907.html",
            "title": "阿里云+Github构建镜像仓库",
            "date_published": "2025-04-26T08:20:14.000Z",
            "content_html": "<h3 id=\"阿里云github构建镜像仓库解决-k8sgcrio访问\"><a class=\"anchor\" href=\"#阿里云github构建镜像仓库解决-k8sgcrio访问\">#</a> 阿里云 + github 构建镜像仓库解决 k8s.gcr.io 访问</h3>\n<p><a href=\"http://xn--k8s-xi9d897o.gcr.io/\">由于 k8s.gcr.io/</a> 镜像仓库位于国外，国内使用 kubeadm 构建 docker 集群时无法访问相应的 docker 镜像。</p>\n<h4 id=\"1-登录github创建仓库\"><a class=\"anchor\" href=\"#1-登录github创建仓库\">#</a> <strong>1.</strong> 登录 Github 创建仓库</h4>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/vgZkKBC.png\" alt=\"1.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/VnJlhBE.png\" alt=\"2.png\" /></p>\n<h4 id=\"2-创建dockerfile\"><a class=\"anchor\" href=\"#2-创建dockerfile\">#</a> <strong>2.</strong> 创建 Dockerfile</h4>\n<p>仓库下面创建一个 Dockerfile，以 ingress-nginx-controller 为例下的 dockerfile 内容如下：</p>\n<pre><code>[root@manager ~]# mkdir ingress-nginx-controller\n[root@manager ~]# cd ingress-nginx-controller/\n[root@manager ingress-nginx-controller]# cat Dockerfile \nFROM registry.k8s.io/ingress-nginx/controller:v1.12.1 \n</code></pre>\n<h4 id=\"3-ssh免密登录github\"><a class=\"anchor\" href=\"#3-ssh免密登录github\">#</a> 3. SSH 免密登录 GitHub</h4>\n<pre><code>[root@manager ingress-nginx-controller]# ssh-keygen\n[root@manager ingress-nginx-controller]# cat ~/.ssh/id_rsa.pub\n</code></pre>\n<p>进入<em> GitHub</em> 的个人设置，找到【<em>SSH and GPG keys</em>】，然后点击新增 SSH Key，进入如下界面，<em>title</em> 输入你对于当前<em> SSH key</em> 的备注，下面的<em> key</em> 就粘贴上一步生成的<em> id_rsa.pub</em> 内的内容</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/3djSHRS.png\" alt=\"3.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/8gVcVu4.png\" alt=\"5.png\" /></p>\n<h4 id=\"4-推送dockerfile至github\"><a class=\"anchor\" href=\"#4-推送dockerfile至github\">#</a> 4. 推送 Dockerfile 至 Github</h4>\n<pre><code>[root@manager ingress-nginx-controller]# yum install git -y\n[root@manager ingress-nginx-controller]# git --version\n[root@manager ingress-nginx-controller]# git config --global user.email &quot;373370405@qq.com&quot;\n[root@manager ingress-nginx-controller]# git config --global color.ui true\n[root@manager ingress-nginx-controller]# git init\n[root@manager ingress-nginx-controller]# git add .\n[root@manager ingress-nginx-controller]# git commit -m &quot;first commit&quot;\n[root@manager ingress-nginx-controller]# git branch -M main\n[root@manager ingress-nginx-controller]# git remote add origin git@github.com:xyapples/ingress-nginx-controller.git   #添加远程仓库\n[root@manager ingress-nginx-controller]# git remote -v\n[root@manager ingress-nginx-controller]# git push -u origin main\n[root@manager ingress-nginx-controller]# git remote remove origin  #移除远程仓库\n</code></pre>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/N3t49eX.png\" alt=\"6.png\" /></p>\n<h4 id=\"5-登录阿里云创建镜像仓库\"><a class=\"anchor\" href=\"#5-登录阿里云创建镜像仓库\">#</a> <strong>5.</strong> 登录阿里云创建镜像仓库</h4>\n<p>登录阿里云镜像：<a href=\"https://cr.console.aliyun.com/%EF%BC%8C%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%EF%BC%9A\">https://cr.console.aliyun.com/，创建镜像仓库：</a></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/1zFqa35.png\" alt=\"7.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/PhzoeeT.png\" alt=\"1.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/iYAbB0x.png\" alt=\"2.png\" /></p>\n<h4 id=\"6-构建镜像\"><a class=\"anchor\" href=\"#6-构建镜像\">#</a> 6. 构建镜像</h4>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/KD3DI7J.png\" alt=\"3.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/WiwNBRK.png\" alt=\"4.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/155pUrE.png\" alt=\"7.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/155pUrE.png\" alt=\"7.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/AU1371X.png\" alt=\"8.png\" /></p>\n",
            "tags": [
                "Docker"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3030097036.html",
            "url": "http://ixuyong.cn/posts/3030097036.html",
            "title": "K8S云原生存储Rook-Ceph",
            "date_published": "2025-04-24T13:43:19.000Z",
            "content_html": "<h3 id=\"k8s云原生存储rook-ceph\"><a class=\"anchor\" href=\"#k8s云原生存储rook-ceph\">#</a> K8S 云原生存储 Rook-Ceph</h3>\n<h4 id=\"1-storageclass动态存储\"><a class=\"anchor\" href=\"#1-storageclass动态存储\">#</a> 1. StorageClass 动态存储</h4>\n<p>StorageClass：存储类，由 K8s 管理员创建，用于动态 PV 的管理，可以链接至不同的后端存储，比如 Ceph、GlusterFS 等。之后对存储的请求可以指向 StorageClass，然后 StorageClass 会自动的创建、删除 PV。</p>\n<p>实现方式：</p>\n<ul>\n<li>in-tree: 内置于 K8s 核心代码，对于存储的管理，都需要编写相应的代码。</li>\n<li>out-of-tree：由存储厂商提供一个驱动（CSI 或 Flex Volume），安装到 K8s 集群，然后 StorageClass 只需要配置该驱动即可，驱动器会代替 StorageClass 管理存储。</li>\n</ul>\n<p>StorageClass 官网介绍：<a href=\"https://kubernetes.io/docs/concepts/storage/storage-classes/\">https://kubernetes.io/docs/concepts/storage/storage-classes/</a></p>\n<h4 id=\"2-云原生存储rook\"><a class=\"anchor\" href=\"#2-云原生存储rook\">#</a> 2. 云原生存储 Rook</h4>\n<p>Rook 是一个自我管理的分布式存储编排系统，它本身并不是存储系统，在存储和 k8s 之前搭建了一个桥梁，使存储系统的搭建或者维护变得特别简单，Rook 将分布式存储系统转变为自我管理、自我扩展、自我修复的存储服务。它让一些存储的操作，比如部署、配置、扩容、升级、迁移、灾难恢复、监视和资源管理变得自动化，无需人工处理。并且 Rook 支持 CSI，可以利用 CSI 做一些 PVC 的快照、扩容、克隆等操作。</p>\n<p>Rook 官网介绍：<a href=\"https://rook.io/\">https://rook.io/</a></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/CK4Gn1u.jpeg\" alt=\"Snipaste_2025-05-07_20-15-59.jpg\" /></p>\n<h4 id=\"3-rook-安装\"><a class=\"anchor\" href=\"#3-rook-安装\">#</a> 3. Rook 安装</h4>\n<p>环境准备</p>\n<ul>\n<li>K8s 集群至少五个节点，每个节点的内存不低于 5G，CPU 不低于 2 核</li>\n<li>所有节点时间同步</li>\n<li>至少有三个存储节点，并且每个节点至少有一个裸盘，k8s-master03、k8s-node01、k8s-node02 增加裸盘</li>\n</ul>\n<h5 id=\"31-下载-rook-安装文件\"><a class=\"anchor\" href=\"#31-下载-rook-安装文件\">#</a> 3.1 下载 Rook 安装文件</h5>\n<pre><code>[root@k8s-master01 ~]# git clone --single-branch --branch v1.17.2 https://github.com/rook/rook.git\n</code></pre>\n<h5 id=\"32-配置更改\"><a class=\"anchor\" href=\"#32-配置更改\">#</a> 3.2 配置更改</h5>\n<pre><code>[root@k8s-master01 ~]# cd rook/deploy/examples\n[root@k8s-master01 ~]# vim operator.yaml\n  ROOK_CSI_CEPH_IMAGE: &quot;registry.cn-hangzhou.aliyuncs.com/kubernetes_public/cephcsi:v3.14.0&quot;\n  ROOK_CSI_REGISTRAR_IMAGE: &quot;registry.cn-hangzhou.aliyuncs.com/kubernetes_public/csi-node-driver-registrar:v2.13.0&quot;\n  ROOK_CSI_RESIZER_IMAGE: &quot;registry.cn-hangzhou.aliyuncs.com/kubernetes_public/csi-resizer:v1.13.1&quot;\n  ROOK_CSI_PROVISIONER_IMAGE: &quot;registry.cn-hangzhou.aliyuncs.com/kubernetes_public/csi-provisioner:v5.1.0&quot;\n  ROOK_CSI_SNAPSHOTTER_IMAGE: &quot;registry.cn-hangzhou.aliyuncs.com/kubernetes_public/csi-snapshotter:v8.2.0&quot;\n  ROOK_CSI_ATTACHER_IMAGE: &quot;registry.cn-hangzhou.aliyuncs.com/kubernetes_public/csi-attacher:v4.8.0&quot;\n\n#ROOK_ENABLE_DISCOVERY_DAEMON 改成 true 即可\nROOK_ENABLE_DISCOVERY_DAEMON: &quot;true&quot;\n</code></pre>\n<h5 id=\"33-部署-rook\"><a class=\"anchor\" href=\"#33-部署-rook\">#</a> 3.3 部署 rook</h5>\n<pre><code>[root@k8s-master01 ceph]# kubectl create -f crds.yaml -f common.yaml -f operator.yaml\n[root@k8s-master01 examples]# kubectl get pods -n rook-ceph\nNAME                                  READY   STATUS    RESTARTS   AGE\nrook-ceph-operator-84ff77778b-7ww2w   1/1     Running   0          91m\nrook-discover-6j68f                   1/1     Running   0          82m\nrook-discover-9w4kt                   1/1     Running   0          82m\nrook-discover-h2zfm                   1/1     Running   0          82m\nrook-discover-hsz8b                   1/1     Running   0          19m\nrook-discover-rj4t7                   1/1     Running   0          82m\n</code></pre>\n<h4 id=\"4创建-ceph-集群\"><a class=\"anchor\" href=\"#4创建-ceph-集群\">#</a> 4. 创建 Ceph 集群</h4>\n<h5 id=\"41-配置更改\"><a class=\"anchor\" href=\"#41-配置更改\">#</a> 4.1 配置更改</h5>\n<pre><code>[root@k8s-master01 examples]# vim cluster.yaml\n...\n    image: registry.cn-hangzhou.aliyuncs.com/kubernetes_public/cephv19.2.2:v19.2.2\n...\n  skipUpgradeChecks: true     #改为true，跳过升级\n....\n  dashboard:\n    enabled: true\n    # serve the dashboard under a subpath (useful when you are accessing the dashboard via a reverse proxy)\n    # urlPrefix: /ceph-dashboard\n    # serve the dashboard at the given port.\n    # port: 8443\n    # serve the dashboard using SSL\n    ssl: false          #改为false\n...\n  storage: # cluster level storage configuration and selection\n    useAllNodes: false      #改为false,不使用所有的节点当osd\n    useAllDevices: false    #改为false,不使用所有的磁盘当osd\n...\n    #     deviceFilter: &quot;^sd.&quot;\n    nodes:\n    - name: &quot;k8s-master03&quot;\n      devices:\n      - name: &quot;sdb&quot;\n    - name: &quot;k8s-node01&quot;\n      devices:\n      - name: &quot;sdb&quot;\n    - name: &quot;k8s-node02&quot;\n      devices:\n      - name: &quot;sdb&quot;\n...\n</code></pre>\n<p>注意：新版必须采用裸盘，即未格式化的磁盘。其中 k8s-master03、 k8s-node01、  k8s-node02 有新加的一个磁盘，可以通过 lsblk -f 查看新添加的磁盘名称。建议最少三个节点，否则后面的试验可能会出现问题</p>\n<h5 id=\"42-创建-ceph-集群\"><a class=\"anchor\" href=\"#42-创建-ceph-集群\">#</a> 4.2 创建 Ceph 集群</h5>\n<pre><code>[root@k8s-master01 examples]# kubectl create -f cluster.yaml\n[root@k8s-master01 examples]# kubectl get pods -n rook-ceph\nNAME                                                     READY   STATUS      RESTARTS        AGE\ncsi-cephfsplugin-5nmnl                                   3/3     Running     1 (60m ago)     62m\ncsi-cephfsplugin-6b6ct                                   3/3     Running     1 (60m ago)     62m\ncsi-cephfsplugin-8xlnl                                   3/3     Running     1 (60m ago)     62m\ncsi-cephfsplugin-fh9w5                                   3/3     Running     1 (60m ago)     62m\ncsi-cephfsplugin-mslst                                   3/3     Running     1 (60m ago)     62m\ncsi-cephfsplugin-provisioner-59bd447c6d-5zwj2            6/6     Running     0               61s\ncsi-cephfsplugin-provisioner-59bd447c6d-7t2kg            6/6     Running     2 (20s ago)     61s\ncsi-rbdplugin-5gvmp                                      3/3     Running     1 (60m ago)     62m\ncsi-rbdplugin-dzcs4                                      3/3     Running     1 (60m ago)     62m\ncsi-rbdplugin-n82b5                                      3/3     Running     1 (60m ago)     62m\ncsi-rbdplugin-provisioner-6856fb8b86-86hw8               6/6     Running     0               19s\ncsi-rbdplugin-provisioner-6856fb8b86-lj9s4               6/6     Running     0               19s\ncsi-rbdplugin-vh8j2                                      3/3     Running     1 (60m ago)     62m\ncsi-rbdplugin-xfgwr                                      3/3     Running     1 (60m ago)     62m\nrook-ceph-crashcollector-k8s-master01-bbc78d496-bzjk8    1/1     Running     0               8m26s\nrook-ceph-crashcollector-k8s-master03-765ff964bb-95wmt   1/1     Running     0               28m\nrook-ceph-crashcollector-k8s-node01-7cf4c4b6b6-r4n84     1/1     Running     0               20m\nrook-ceph-crashcollector-k8s-node02-f887f8cf9-jz2l8      1/1     Running     0               28m\nrook-ceph-detect-version-nsrwj                           0/1     Init:0/1    0               3s\nrook-ceph-exporter-k8s-master01-5cd4577b79-ckd4m         1/1     Running     0               8m26s\nrook-ceph-exporter-k8s-master03-75f4cf6f7-hc9zb          1/1     Running     0               28m\nrook-ceph-exporter-k8s-node01-96fc7cf49-d2r24            1/1     Running     0               20m\nrook-ceph-exporter-k8s-node02-777b9f555b-7j6cz           1/1     Running     0               27m\nrook-ceph-mgr-a-6f46b4b945-q6cjb                         3/3     Running     3 (14m ago)     35m\nrook-ceph-mgr-b-5d4cc5465b-8dfh6                         3/3     Running     0               35m\nrook-ceph-mon-a-7c7b7555c7-nlhwg                         2/2     Running     2 (6m14s ago)   51m\nrook-ceph-mon-c-559bcf95fd-cl62w                         2/2     Running     0               8m27s\nrook-ceph-mon-d-7dbc6b8f5c-8264t                         2/2     Running     0               28m\nrook-ceph-operator-645478ff5b-jdcrp                      1/1     Running     0               102m\nrook-ceph-osd-0-6d9cf78f76-4zhx8                         2/2     Running     0               12m\nrook-ceph-osd-1-88c78bbcb-cn48c                          2/2     Running     0               5m15s\nrook-ceph-osd-2-b464c9fc6-458hv                          2/2     Running     0               4m29s\nrook-ceph-osd-prepare-k8s-master03-pwnrc                 0/1     Completed   0               86s\nrook-ceph-osd-prepare-k8s-node01-xxp2j                   0/1     Completed   0               83s\nrook-ceph-osd-prepare-k8s-node02-8nz7x                   0/1     Completed   0               78s\nrook-discover-jzmkr                                      1/1     Running     0               91m\nrook-discover-k7pxt                                      1/1     Running     0               91m\nrook-discover-vqjh5                                      1/1     Running     0               91m\nrook-discover-wk8jq                                      1/1     Running     0               91m\nrook-discover-x8rsn                                      1/1     Running     0               91m\n\n[root@k8s-master01 examples]# kubectl get cephcluster -n rook-ceph\nNAME        DATADIRHOSTPATH   MONCOUNT   AGE   PHASE   MESSAGE                        HEALTH        EXTERNAL   FSID\nrook-ceph   /var/lib/rook     3          63m   Ready   Cluster created successfully   HEALTH_WARN              ca429602-66f4-4a1e-9d5c-a5773a0f594f\n</code></pre>\n<h5 id=\"43-安装-ceph-snapshot-控制器\"><a class=\"anchor\" href=\"#43-安装-ceph-snapshot-控制器\">#</a> 4.3 安装 ceph snapshot 控制器</h5>\n<pre><code>[root@k8s-master01 ~]# cd /root/k8s-ha-install/\n[root@k8s-master01 k8s-ha-install]# git checkout manual-installation-v1.32.x\n[root@k8s-master01 k8s-ha-install]# kubectl create -f snapshotter/ -n kube-system\n[root@k8s-master01 k8s-ha-install]# kubectl get po -n kube-system -l app=snapshot-controller\nNAME                    READY   STATUS    RESTARTS   AGE\nsnapshot-controller-0   1/1     Running   0          67s\n</code></pre>\n<h4 id=\"5-安装-ceph-客户端工具\"><a class=\"anchor\" href=\"#5-安装-ceph-客户端工具\">#</a> 5. 安装 ceph 客户端工具</h4>\n<pre><code>[root@k8s-master01 k8s-ha-install]# cd /root/rook/deploy/examples/\n[root@k8s-master01 examples]# kubectl create -f toolbox.yaml -n rook-ceph\n[root@k8s-master01 examples]# kubectl get po -n rook-ceph -l app=rook-ceph-tools\nNAME                               READY   STATUS    RESTARTS   AGE\nrook-ceph-tools-7b75b967db-sqddk   1/1     Running   0          8s\n[root@k8s-master01 examples]# kubectl exec -it rook-ceph-tools-7b75b967db-sqddk -n rook-ceph -- bash\nbash-5.1$ ceph status\n  cluster:\n    id:     87b85368-9487-4967-a4e4-5970d2e0ec94\n    health: HEALTH_WARN\n            1 mgr modules have recently crashed\n \n  services:\n    mon: 3 daemons, quorum b,c (age 12s), out of quorum: a\n    mgr: a(active, since 7m), standbys: b\n    osd: 3 osds: 3 up (since 8m), 3 in (since 3h)\n \n  data:\n    pools:   0 pools, 0 pgs\n    objects: 0 objects, 0 B\n    usage:   82 MiB used, 60 GiB / 60 GiB avail\n    pgs: \n\t\nbash-4.4$  ceph osd status\nID  HOST           USED  AVAIL  WR OPS  WR DATA  RD OPS  RD DATA  STATE      \n 0  k8s-master03  20.6M  19.9G      0        0       0        0   exists,up  \n 1  k8s-node01    20.6M  19.9G      0        0       0        0   exists,up  \n 2  k8s-node02    20.6M  19.9G      0        0       0        0   exists,up \n\nbash-4.4$ ceph df\n--- RAW STORAGE ---\nCLASS    SIZE   AVAIL    USED  RAW USED  %RAW USED\nhdd    60 GiB  60 GiB  62 MiB    62 MiB       0.10\nTOTAL  60 GiB  60 GiB  62 MiB    62 MiB       0.10\n\n--- POOLS ---\nPOOL  ID  PGS   STORED  OBJECTS     USED  %USED  MAX AVAIL\n.mgr   1    1  449 KiB        2  1.3 MiB      0     19 GiB\n</code></pre>\n<h4 id=\"6-ceph-dashboard\"><a class=\"anchor\" href=\"#6-ceph-dashboard\">#</a> 6. Ceph dashboard</h4>\n<h5 id=\"61-暴露服务\"><a class=\"anchor\" href=\"#61-暴露服务\">#</a> 6.1 暴露服务</h5>\n<pre><code>[root@k8s-master01 ~]# kubectl get svc -n rook-ceph\nNAME                      TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)             AGE\nrook-ceph-mgr             ClusterIP   10.96.54.15     &lt;none&gt;        9283/TCP            133m\nrook-ceph-mgr-dashboard   ClusterIP   10.96.97.117    &lt;none&gt;        7000/TCP            133m        #暴露ingresss也可\nrook-ceph-mon-a           ClusterIP   10.96.125.216   &lt;none&gt;        6789/TCP,3300/TCP   170m\nrook-ceph-mon-b           ClusterIP   10.96.34.183    &lt;none&gt;        6789/TCP,3300/TCP   133m\nrook-ceph-mon-c           ClusterIP   10.96.232.252   &lt;none&gt;        6789/TCP,3300/TCP   133m\n\n\n[root@k8s-master01 examples]# kubectl create -f dashboard-external-http.yaml           #暴露nodeport\n[root@k8s-master01 examples]# kubectl get svc -n rook-ceph rook-ceph-mgr-dashboard-external-http\nNAME                                     TYPE       CLUSTER-IP     EXTERNAL-IP   PORT(S)          AGE\nrook-ceph-mgr-dashboard-external-https   NodePort   10.96.11.120   &lt;none&gt;        8443:32611/TCP   45s\n</code></pre>\n<h5 id=\"62-配置ingress访问ceph\"><a class=\"anchor\" href=\"#62-配置ingress访问ceph\">#</a> 6.2 配置 ingress 访问 ceph</h5>\n<pre><code>[root@k8s-master01 examples]# cat dashboard-ingress-https.yaml \n#\n# This example is for Kubernetes running an nginx-ingress\n# and an ACME (e.g. Let's Encrypt) certificate service\n#\n# The nginx-ingress annotations support the dashboard\n# running using HTTPS with a self-signed certificate\n#\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: rook-ceph-mgr-dashboard\n  namespace: rook-ceph # namespace:cluster\n#  annotations:\n#    kubernetes.io/ingress.class: &quot;nginx&quot;\n#    kubernetes.io/tls-acme: &quot;true&quot;\n#    nginx.ingress.kubernetes.io/backend-protocol: &quot;HTTPS&quot;\n#    nginx.ingress.kubernetes.io/server-snippet: |\n#      proxy_ssl_verify off;\n\nspec:\n  ingressClassName: &quot;nginx&quot;\n#  tls:\n#    - hosts:\n#        - rook-ceph.hmallleasing.com\n#      secretName: rook-ceph.example.com\n  rules:\n    - host: rook-ceph.hmallleasing.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: rook-ceph-mgr-dashboard\n                port:\n                  name: http-dashboard\n</code></pre>\n<h5 id=\"63-登录\"><a class=\"anchor\" href=\"#63-登录\">#</a> 6.3 登录</h5>\n<pre><code>http://192.168.40.100:32611\n用户名：admin\n密码：kubectl -n rook-ceph get secret rook-ceph-dashboard-password -o jsonpath=&quot;&#123;['data']['password']&#125;&quot; | base64 --decode &amp;&amp; echo\n</code></pre>\n<h4 id=\"7-ceph-块存储的使用\"><a class=\"anchor\" href=\"#7-ceph-块存储的使用\">#</a> 7. Ceph 块存储的使用</h4>\n<p>块存储一般用于一个 Pod 挂载一块存储使用，相当于一个服务器新挂了一个盘，只给一个应用使用。</p>\n<h5 id=\"71-创建-storageclass-和-ceph-的存储池\"><a class=\"anchor\" href=\"#71-创建-storageclass-和-ceph-的存储池\">#</a> 7.1 创建 StorageClass 和 ceph 的存储池</h5>\n<pre><code>[root@k8s-master01 examples]# kubectl get csidriver\nNAME                            ATTACHREQUIRED   PODINFOONMOUNT   STORAGECAPACITY   TOKENREQUESTS   REQUIRESREPUBLISH   MODES        AGE\nrook-ceph.cephfs.csi.ceph.com   true             false            false             &lt;unset&gt;         false               Persistent   15h       #文件存储csi\nrook-ceph.rbd.csi.ceph.com      true             false            false             &lt;unset&gt;         false               Persistent   15h       #块存储csi\n\n[root@k8s-master01 ~]# cd /root/rook/deploy/examples/\n[root@k8s-master01 examples]# vim csi/rbd/storageclass.yaml\n...\napiVersion: ceph.rook.io/v1\nkind: CephBlockPool\nmetadata:\n  name: replicapool\n  namespace: rook-ceph # namespace:cluster\nspec:\n  failureDomain: host\n  replicated:\n    size: 3                #数据保存几份，测试环境可以将副本数设置成了 2（不能设置为 1），生产环境最少为 3，且要小于等于 osd 的数量\n...\nallowVolumeExpansion: true     #是否可以扩容\nreclaimPolicy: Delete          #pv回收策略\n\n[root@k8s-master01 examples]# kubectl create -f csi/rbd/storageclass.yaml -n rook-ceph\n\n[root@k8s-master01 examples]# kubectl get cephblockpool -n rook-ceph\nNAME          PHASE\nreplicapool   Ready\n[root@k8s-master01 examples]# kubectl get sc\nNAME              PROVISIONER                  RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\nnfs-storage       nfzl.com/nfs                 Delete          Immediate           false                  16h\nrook-ceph-block   rook-ceph.rbd.csi.ceph.com   Delete          Immediate           true                   37s\n</code></pre>\n<h5 id=\"72-挂载测试\"><a class=\"anchor\" href=\"#72-挂载测试\">#</a> 7.2 挂载测试</h5>\n<pre><code>[root@k8s-master01 ~]# cat ceph-block-pvc.yaml        #创建PVC\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: ceph-block-pvc\nspec:\n  storageClassName: &quot;rook-ceph-block&quot;     # 明确指定使用哪个sc的供应商来创建pv\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 1Gi                      # 根据业务实际大小进行资源申请\n\n[root@k8s-master01 ~]# kubectl apply -f ceph-block-pvc.yaml \n\n[root@k8s-master01 ~]# kubectl get pvc\nNAME             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE\nceph-block-pvc   Bound    pvc-86c94d8d-c359-47b8-b5d3-31dcdaf86551   1Gi        RWO            rook-ceph-block   3s\n\n[root@k8s-master01 ~]# kubectl get pv\nNAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                    STORAGECLASS      REASON   AGE\npvc-86c94d8d-c359-47b8-b5d3-31dcdaf86551   1Gi        RWO            Delete           Bound    default/ceph-block-pvc   rook-ceph-block\n\t  \n[root@k8s-master01 ~]# cat ceph-block-pvc-pod.yaml    #挂载PVC测试 \napiVersion: v1\nkind: Pod\nmetadata:\n  name: ceph-block-pvc-pod\nspec:\n  containers:\n  - name: ceph-block-pvc-pod\n    image: nginx\n    volumeMounts:\n    - name: nginx-page\n      mountPath: /usr/share/nginx/html\n  volumes:\n  - name: nginx-page\n    persistentVolumeClaim:      \n      claimName: ceph-block-pv\n\n[root@k8s-master01 ~]# kubectl apply -f ceph-block-pvc-pod.yaml\n</code></pre>\n<h5 id=\"73-statefulset-volumeclaimtemplates\"><a class=\"anchor\" href=\"#73-statefulset-volumeclaimtemplates\">#</a> 7.3 StatefulSet volumeClaimTemplates</h5>\n<pre><code>[root@k8s-master01 ~]# cat ceph-block-pvc-sts.yaml \napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  ports:\n\n  - port: 80\n    name: web\n      clusterIP: None\n      selector:\n    app: nginx\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx # 必须匹配 .spec.template.metadata.labels\n  serviceName: &quot;nginx&quot;\n  replicas: 3 # 默认值是 1\n  template:\n    metadata:\n      labels:\n        app: nginx # 必须匹配 .spec.selector.matchLabels\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.20\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n  volumeClaimTemplates:\n  - metadata:\n    name: www\n    spec:\n      accessModes: [ &quot;ReadWriteOnce&quot; ]\n      storageClassName: &quot;rook-ceph-block&quot;\n      resources:\n        requests:\n          storage: 1Gi\n    \t  \n[root@k8s-master01 ~]# kubectl apply -f ceph-block-pvc-sts.yaml \n\n[root@k8s-master01 ~]# kubectl get pods\nNAME                                      READY   STATUS    RESTARTS       AGE\nweb-0                                     1/1     Running   0              4m19s\nweb-1                                     1/1     Running   0              4m10s\nweb-2                                     1/1     Running   0              2m21s\n\n[root@k8s-master01 ~]# kubectl get pvc\nNAME        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE\nwww-web-0   Bound    pvc-27cab5bf-f989-4050-aa84-1b2dac9fa745   1Gi        RWO            rook-ceph-block   4m23s\nwww-web-1   Bound    pvc-76fb08f4-2195-4678-b6b8-286c2f722cc9   1Gi        RWO            rook-ceph-block   4m14s\nwww-web-2   Bound    pvc-6b858cd9-288f-48bc-bc96-33e6eb519613   1Gi        RWO            rook-ceph-block   2m25s\n\n[root@k8s-master01 ~]# kubectl get pv\nNAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM               STORAGECLASS      REASON   AGE\npvc-27cab5bf-f989-4050-aa84-1b2dac9fa745   1Gi        RWO            Delete           Bound    default/www-web-0   rook-ceph-block            4m25s\npvc-6b858cd9-288f-48bc-bc96-33e6eb519613   1Gi        RWO            Delete           Bound    default/www-web-2   rook-ceph-block            2m27s\npvc-76fb08f4-2195-4678-b6b8-286c2f722cc9   1Gi        RWO            Delete           Bound    default/www-web-1   rook-ceph-block            4m16s\n</code></pre>\n<h4 id=\"8-共享文件系统的使用\"><a class=\"anchor\" href=\"#8-共享文件系统的使用\">#</a> 8. 共享文件系统的使用</h4>\n<p>共享文件系统一般用于多个 Pod 共享一个存储</p>\n<h5 id=\"81-创建共享类型的文件系统\"><a class=\"anchor\" href=\"#81-创建共享类型的文件系统\">#</a> 8.1 创建共享类型的文件系统</h5>\n<pre><code>[root@k8s-master01 ~]# cd /root/rook/deploy/examples/\n[root@k8s-master01 examples]# kubectl apply -f filesystem.yaml\n[root@k8s-master01 examples]# kubectl get pod -l app=rook-ceph-mds -n rook-ceph\nNAME                                    READY   STATUS    RESTARTS   AGE\nrook-ceph-mds-myfs-a-7d76cb5988-9nz9p   2/2     Running   0          36s\nrook-ceph-mds-myfs-b-76ff7c784c-vs8nm   2/2     Running   0          33s\n</code></pre>\n<h5 id=\"82-创建共享类型文件系统的-storageclass\"><a class=\"anchor\" href=\"#82-创建共享类型文件系统的-storageclass\">#</a> 8.2 创建共享类型文件系统的 StorageClass</h5>\n<pre><code>[root@k8s-master01 examples]# cd csi/cephfs\n[root@k8s-master01 cephfs]# kubectl create -f storageclass.yaml\n[root@k8s-master01 cephfs]# kubectl get sc\nNAME              PROVISIONER                     RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\nnfs-storage       nfzl.com/nfs                    Delete          Immediate           false                  17h\nrook-ceph-block   rook-ceph.rbd.csi.ceph.com      Delete          Immediate           true                   82m\nrook-cephfs       rook-ceph.cephfs.csi.ceph.com   Delete          Immediate           true                   13s\n</code></pre>\n<h5 id=\"83-挂载测试\"><a class=\"anchor\" href=\"#83-挂载测试\">#</a> 8.3 挂载测试</h5>\n<pre><code>[root@k8s-master01 ~]# cat cephfs-pvc-deploy.yaml \napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  ports:\n  - port: 80\n    name: web\n  selector:\n    app: nginx\n  type: ClusterIP\n---\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: nginx-share-pvc\nspec:\n  storageClassName: rook-cephfs \n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 2Gi\n---\napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx # has to match .spec.template.metadata.labels\n  replicas: 3 # by default is 1\n  template:\n    metadata:\n      labels:\n        app: nginx # has to match .spec.selector.matchLabels\n    spec:\n      containers:\n      - name: nginx\n        image: nginx \n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n      volumes:\n        - name: www\n          persistentVolumeClaim:\n            claimName: nginx-share-pvc\n\t\t\t\n[root@k8s-master01 ~]# kubectl apply -f cephfs-pvc-deploy.yaml\n[root@k8s-master01 ~]# kubectl get pods\nNAME                                      READY   STATUS    RESTARTS        AGE\ncluster-test-84dfc9c68b-5q4ng             1/1     Running   84 (4m2s ago)   16d\nnfs-client-provisioner-5dbbd8d796-lhdgw   1/1     Running   5 (123m ago)    18h\nweb-6c59f8559-g5xzb                       1/1     Running   0               46s\nweb-6c59f8559-ns77q                       1/1     Running   0               46s\nweb-6c59f8559-qxb5f                       1/1     Running   0               46s\n\n[root@k8s-master01 ~]# kubectl get pvc\nNAME              STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nnginx-share-pvc   Bound    pvc-4de733fe-c2fb-437b-baff-aaeba0235d54   2Gi        RWX            rook-cephfs    52s\n\n[root@k8s-master01 ~]# kubectl get pv\nNAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                     STORAGECLASS   REASON   AGE\npvc-4de733fe-c2fb-437b-baff-aaeba0235d54   2Gi        RWX            Delete           Bound    default/nginx-share-pvc   rook-cephfs             53s\n\n[root@k8s-master01 ~]# kubectl exec -it web-6c59f8559-g5xzb -- bash\nroot@web-6c59f8559-g5xzb:/# cd /usr/share/nginx/html/\nroot@web-6c59f8559-g5xzb:/usr/share/nginx/html# echo &quot;hello cephfs&quot; &gt;&gt; index.html\n\n[root@k8s-master01 ~]# kubectl get svc\nNAME                 TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)    AGE\nkubernetes           ClusterIP   10.96.0.1     &lt;none&gt;        443/TCP    16d\nmysql-svc-external   ClusterIP   None          &lt;none&gt;        3306/TCP   9d\nnginx                ClusterIP   10.96.58.17   &lt;none&gt;        80/TCP     4m34s\n[root@k8s-master01 ~]# curl 10.96.58.17\nhello cephfs\n</code></pre>\n<h4 id=\"9pvc-扩容\"><a class=\"anchor\" href=\"#9pvc-扩容\">#</a> 9.PVC 扩容</h4>\n<pre><code>[root@k8s-master01 ~]# kubectl get sc\nNAME              PROVISIONER                     RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\nnfs-storage       nfzl.com/nfs                    Delete          Immediate           false                  18h\nrook-ceph-block   rook-ceph.rbd.csi.ceph.com      Delete          Immediate           true                   104m     #true允许扩容\nrook-cephfs       rook-ceph.cephfs.csi.ceph.com   Delete          Immediate           true                   22m      #true允许扩容\n\n[root@k8s-master01 ~]# kubectl get pvc\nNAME              STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nnginx-share-pvc   Bound    pvc-4de733fe-c2fb-437b-baff-aaeba0235d54   2Gi        RWX            rook-cephfs    13m\n[root@k8s-master01 ~]# kubectl edit pvc nginx-share-pvc\n...\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 5Gi         #更改pvc大小\n  storageClassName: rook-cephfs\n...\n\n[root@k8s-master01 ~]# kubectl get pvc       #查看PVC是否扩容\nNAME              STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nnginx-share-pvc   Bound    pvc-4de733fe-c2fb-437b-baff-aaeba0235d54   5Gi        RWX            rook-cephfs    15m\n\n[root@k8s-master01 ~]# kubectl get pv         #查看PV是否扩容\nNAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                     STORAGECLASS   REASON   AGE\npvc-4de733fe-c2fb-437b-baff-aaeba0235d54   5Gi        RWX            Delete           Bound    default/nginx-share-pvc   rook-cephfs             15m\n\n[root@k8s-master01 ~]# kubectl exec -it web-6c59f8559-g5xzb -- bash       #进入容器，查看pod是否扩容  \nroot@web-6c59f8559-g5xzb:/# df -h \nFilesystem                                                                                                                                             Size  Used Avail Use% Mounted on\noverlay                                                                                                                                                 17G   13G  4.1G  76% /\ntmpfs                                                                                                                                                   64M     0   64M   0% /dev\ntmpfs                                                                                                                                                  2.0G     0  2.0G   0% /sys/fs/cgroup\n/dev/sda3                                                                                                                                               17G   13G  4.1G  76% /etc/hosts\nshm                                                                                                                                                     64M     0   64M   0% /dev/shm\n10.96.121.140:6789,10.96.131.130:6789,10.96.62.64:6789:/volumes/csi/csi-vol-3b645a11-58f4-475a-9404-5d84964f5291/e4bdf743-eb18-42c8-b04f-41964f76de4f  5.0G     0  5.0G   0% /usr/share/nginx/html\ntmpfs                                                                                                                                                  3.8G   12K  3.8G   1% /run/secrets/kubernetes.io/serviceaccount\ntmpfs                                                                                                                                                  2.0G     0  2.0G   0% /proc/asound\ntmpfs                                                                                                                                                  2.0G     0  2.0G   0% /proc/acpi\ntmpfs                                                                                                                                                  2.0G     0  2.0G   0% /proc/scsi\ntmpfs                                                                                                                                                  2.0G     0  2.0G   0% /sys/firmware\n</code></pre>\n<h4 id=\"10-pvc-快照\"><a class=\"anchor\" href=\"#10-pvc-快照\">#</a> 10. PVC 快照</h4>\n<h5 id=\"101-文件共享类型快照\"><a class=\"anchor\" href=\"#101-文件共享类型快照\">#</a> 10.1 文件共享类型快照</h5>\n<pre><code>[root@k8s-master01 ~]# cd rook/deploy/examples\n[root@k8s-master01 examples]# kubectl create -f csi/cephfs/snapshotclass.yaml \n\n[root@k8s-master01 examples]# kubectl get volumesnapshotclass\nNAME                         DRIVER                          DELETIONPOLICY   AGE\ncsi-cephfsplugin-snapclass   rook-ceph.cephfs.csi.ceph.com   Delete           25s\n\n\n#拍摄快照\t\n[root@k8s-master01 examples]# kubectl exec -it web-6c59f8559-g5xzb -- bash         #pvc新增数据\nroot@web-6c59f8559-g5xzb:/# cd /usr/share/nginx/html/\nroot@web-6c59f8559-g5xzb:/usr/share/nginx/html# touch &#123;1..10&#125;\nroot@web-6c59f8559-g5xzb:/usr/share/nginx/html# ls\n1  10  2  3  4\t5  6  7  8  9  index.html\n\n[root@k8s-master01 examples]# kubectl get pvc       #查看pvs并对nginx-share-pvc拍摄快照\nNAME              STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nnginx-share-pvc   Bound    pvc-4de733fe-c2fb-437b-baff-aaeba0235d54   5Gi        RWX            rook-cephfs    4h23m\n\n[root@k8s-master01 examples]# cat csi/cephfs/snapshot.yaml         #拍摄快照\n---\n# 1.17 &lt;= K8s &lt;= v1.19\n# apiVersion: snapshot.storage.k8s.io/v1beta1\n# K8s &gt;= v1.20\napiVersion: snapshot.storage.k8s.io/v1\nkind: VolumeSnapshot\nmetadata:\n  name: cephfs-pvc-snapshot\nspec:\n  volumeSnapshotClassName: csi-cephfsplugin-snapclass\n  source:\n    persistentVolumeClaimName: nginx-share-pvc         #基于那个PVC拍摄快照\n\t\n[root@k8s-master01 examples]# kubectl apply -f csi/cephfs/snapshot.yaml\n[root@k8s-master01 examples]# kubectl get volumesnapshot\nNAME                  READYTOUSE   SOURCEPVC         SOURCESNAPSHOTCONTENT   RESTORESIZE   SNAPSHOTCLASS                SNAPSHOTCONTENT                                    CREATIONTIME   AGE\ncephfs-pvc-snapshot   true         nginx-share-pvc                           5Gi           csi-cephfsplugin-snapclass   snapcontent-bdaddb97-debe-4f42-9423-13bf1c5b5402   4m6s           4m8s\n\n#删除pvc数据\n[root@k8s-master01 examples]# kubectl exec -it web-6c59f8559-g5xzb -- bash\nroot@web-6c59f8559-g5xzb:/# cd /usr/share/nginx/html/\nroot@web-6c59f8559-g5xzb:/usr/share/nginx/html# ls\n1  10  2  3  4\t5  6  7  8  9  index.html\nroot@web-6c59f8559-g5xzb:/usr/share/nginx/html# rm -rf &#123;1..10&#125;\nroot@web-6c59f8559-g5xzb:/usr/share/nginx/html# ls\nindex.html\n\n#pvc回滚数据\n[root@k8s-master01 examples]# kubectl get volumesnapshot\nNAME                  READYTOUSE   SOURCEPVC         SOURCESNAPSHOTCONTENT   RESTORESIZE   SNAPSHOTCLASS                SNAPSHOTCONTENT                                    CREATIONTIME   AGE\ncephfs-pvc-snapshot   true         nginx-share-pvc                           5Gi           csi-cephfsplugin-snapclass   snapcontent-bdaddb97-debe-4f42-9423-13bf1c5b5402   7m39s          7m41s\n\t\n[root@k8s-master01 examples]# cat csi/cephfs/pvc-restore.yaml \n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: cephfs-pvc-restore\nspec:\n  storageClassName: rook-cephfs       #创建pv的storageclass名称相同\n  dataSource:\n    name: cephfs-pvc-snapshot         #volumesnapshot数据源\n    kind: VolumeSnapshot\n    apiGroup: snapshot.storage.k8s.io\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 5Gi      #大小等于snapshot大小\n\n[root@k8s-master01 examples]# kubectl apply -f csi/cephfs/pvc-restore.yaml\n\n[root@k8s-master01 examples]# kubectl get pvc\nNAME                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\ncephfs-pvc-restore   Bound    pvc-9e845f2b-df1f-450d-8aa2-f9a46db6adb6   5Gi        RWX            rook-cephfs    54s          \nnginx-share-pvc      Bound    pvc-4de733fe-c2fb-437b-baff-aaeba0235d54   5Gi        RWX            rook-cephfs    4h50m\n\n#挂载PVC测试数据是否恢复\n[root@k8s-master01 examples]# cat csi/cephfs/pod.yaml \n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: csicephfs-demo-pod\nspec:\n  containers:\n    - name: web-server\n      image: nginx\n      volumeMounts:\n        - name: mypvc\n          mountPath: /var/lib/www/html\n  volumes:\n    - name: mypvc\n      persistentVolumeClaim:\n        claimName: cephfs-pvc-restore        #挂载恢复pvc\n        readOnly: false\n\n[root@k8s-master01 examples]# kubectl apply -f csi/cephfs/pod.yaml\n[root@k8s-master01 examples]# kubectl get pods\nNAME                                      READY   STATUS    RESTARTS        AGE\ncluster-test-84dfc9c68b-5q4ng             1/1     Running   88 (57m ago)    16d\ncsicephfs-demo-pod                        1/1     Running   0               24s\nnfs-client-provisioner-5dbbd8d796-lhdgw   1/1     Running   5 (6h57m ago)   23h\nweb-6c59f8559-g5xzb                       1/1     Running   0               4h54m\nweb-6c59f8559-ns77q                       1/1     Running   0               4h54m\nweb-6c59f8559-qxb5f                       1/1     Running   0               4h54m\n[root@k8s-master01 examples]# kubectl exec -it csicephfs-demo-pod -- bash\nroot@csicephfs-demo-pod:/# ls /var/lib/www/html/               #s删除数据已经恢复\n1  10  2  3  4\t5  6  7  8  9  index.html\n</code></pre>\n<h5 id=\"102-pvc-克隆\"><a class=\"anchor\" href=\"#102-pvc-克隆\">#</a> 10.2 PVC 克隆</h5>\n<pre><code>[root@k8s-master01 examples]# kubectl get pvc\nNAME                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\ncephfs-pvc-restore   Bound    pvc-9e845f2b-df1f-450d-8aa2-f9a46db6adb6   5Gi        RWX            rook-cephfs    11m\nnginx-share-pvc      Bound    pvc-4de733fe-c2fb-437b-baff-aaeba0235d54   5Gi        RWX            rook-cephfs    5h1m\n\n\n[root@k8s-master01 examples]# cat csi/cephfs/pvc-clone.yaml \n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: cephfs-pvc-clone\nspec:\n  storageClassName: rook-cephfs      # pvc 的 storageClass 名称\n  dataSource:\n    name: nginx-share-pvc          #克隆的PVC名称\n    kind: PersistentVolumeClaim\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 5Gi                 #大小等于所克隆的PVC大小\n\n[root@k8s-master01 examples]# kubectl apply -f csi/cephfs/pvc-clone.yaml\n\n[root@k8s-master01 examples]# kubectl get pvc\nNAME                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\ncephfs-pvc-clone     Bound    pvc-0a19b65e-cb5e-4379-a7f7-e0783fcf8ddf   5Gi        RWX            rook-cephfs    22s\ncephfs-pvc-restore   Bound    pvc-9e845f2b-df1f-450d-8aa2-f9a46db6adb6   5Gi        RWX            rook-cephfs    15m\nnginx-share-pvc      Bound    pvc-4de733fe-c2fb-437b-baff-aaeba0235d54   5Gi        RWX            rook-cephfs    5h4m\n\n#挂载克隆PVC测试\n[root@k8s-master01 examples]# cat csi/cephfs/pod.yaml \n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: csicephfs-demo-pod\nspec:\n  containers:\n    - name: web-server\n      image: nginx\n      volumeMounts:\n        - name: mypvc\n          mountPath: /var/lib/www/html\n  volumes:\n    - name: mypvc\n      persistentVolumeClaim:\n        claimName: cephfs-pvc-clone      #挂载克隆的pvc\n        readOnly: false\n\n[root@k8s-master01 examples]# kubectl apply -f csi/cephfs/pod.yaml          \n[root@k8s-master01 examples]# kubectl get pods\nNAME                                      READY   STATUS    RESTARTS         AGE\ncluster-test-84dfc9c68b-5q4ng             1/1     Running   89 (9m54s ago)   16d\ncsicephfs-demo-pod                        1/1     Running   0                17s\nnfs-client-provisioner-5dbbd8d796-lhdgw   1/1     Running   5 (7h9m ago)     23h\nweb-6c59f8559-g5xzb                       1/1     Running   0                5h6m\nweb-6c59f8559-ns77q                       1/1     Running   0                5h6m\nweb-6c59f8559-qxb5f                       1/1     Running   0                5h6m\n\n[root@k8s-master01 examples]# kubectl exec -it csicephfs-demo-pod -- bash\nroot@csicephfs-demo-pod:/# cat /var/lib/www/html/index.html \nhello cephfs\n</code></pre>\n<h4 id=\"11-测试数据清理\"><a class=\"anchor\" href=\"#11-测试数据清理\">#</a> 11. 测试数据清理</h4>\n<pre><code>参考文档：https://rook.io/docs/rook/v1.11/Getting-Started/ceph-teardown/#delete-the-cephcluster-crd\n[root@k8s-master01 ~]# kubectl delete deploy web\n\n[root@k8s-master01 ~]# kubectl delete pods csicephfs-demo-pod\n\n[root@k8s-master01 ~]# kubectl delete pvc --all\n[root@k8s-master01 ~]# kubectl get pvc\nNo resources found in default namespace.\n[root@k8s-master01 ~]# kubectl get pv\nNo resources found\n\n\n[root@k8s-master01 ~]# kubectl get volumesnapshot\nNAME                  READYTOUSE   SOURCEPVC         SOURCESNAPSHOTCONTENT   RESTORESIZE   SNAPSHOTCLASS                SNAPSHOTCONTENT                                    CREATIONTIME   AGE\ncephfs-pvc-snapshot   true         nginx-share-pvc                           5Gi           csi-cephfsplugin-snapclass   snapcontent-bdaddb97-debe-4f42-9423-13bf1c5b5402   61m            61m\n[root@k8s-master01 ~]# kubectl delete volumesnapshot cephfs-pvc-snapshot\nvolumesnapshot.snapshot.storage.k8s.io &quot;cephfs-pvc-snapshot&quot; deleted\n\nkubectl delete -n rook-ceph cephblockpool replicapool\nkubectl delete -n rook-ceph cephfilesystem myfs\n\nkubectl delete storageclass rook-ceph-block\nkubectl delete storageclass rook-cephfs\nkubectl delete -f csi/cephfs/kube-registry.yaml\nkubectl delete storageclass csi-cephfs\n\nkubectl -n rook-ceph delete cephcluster rook-ceph\n\nkubectl delete -f operator.yaml\nkubectl delete -f common.yaml\nkubectl delete -f crds.yaml\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3890389502.html",
            "url": "http://ixuyong.cn/posts/3890389502.html",
            "title": "K8S持久化存储NFS+StorageClass",
            "date_published": "2025-04-23T12:08:26.000Z",
            "content_html": "<h3 id=\"k8s持久化存储nfsstorageclass\"><a class=\"anchor\" href=\"#k8s持久化存储nfsstorageclass\">#</a> K8S 持久化存储 NFS+StorageClass</h3>\n<h4 id=\"1-搭建nfs服务器\"><a class=\"anchor\" href=\"#1-搭建nfs服务器\">#</a> 1. 搭建 NFS 服务器</h4>\n<pre><code>#所有K8S节点安装nfs-utils\n[root@k8s-node02 ~]# yum install nfs-utils -y    \n\n#K8S-node02节点配置nfs服务\n[root@k8s-node02 ~]# mkdir /data/nfs -p\n[root@k8s-node02 ~]# cat /etc/exports\n/data/nfs 192.168.1.0/24(rw,no_root_squash)\n[root@k8s-node02 ~]# exportfs -arv   #NFS配置生效 \n[root@k8s-node02 ~]# systemctl start nfs-server &amp;&amp; systemctl enable nfs-server &amp;&amp; systemctl status nfs-server\n</code></pre>\n<h4 id=\"2-创建rbac\"><a class=\"anchor\" href=\"#2-创建rbac\">#</a> 2.  创建 RBAC</h4>\n<pre><code>[root@k8s-node02 ~]# cat 01-rbac.yaml \napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: nfs-client-provisioner\n  # replace with namespace where provisioner is deployed\n  namespace: default\n---\nkind: ClusterRole\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: nfs-client-provisioner-runner\nrules:\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;nodes&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;persistentvolumes&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;delete&quot;]\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;persistentvolumeclaims&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;update&quot;]\n  - apiGroups: [&quot;storage.k8s.io&quot;]\n    resources: [&quot;storageclasses&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;events&quot;]\n    verbs: [&quot;create&quot;, &quot;update&quot;, &quot;patch&quot;]\n---\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: run-nfs-client-provisioner\nsubjects:\n  - kind: ServiceAccount\n    name: nfs-client-provisioner\n    # replace with namespace where provisioner is deployed\n    namespace: default\nroleRef:\n  kind: ClusterRole\n  name: nfs-client-provisioner-runner\n  apiGroup: rbac.authorization.k8s.io\n---\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: leader-locking-nfs-client-provisioner\n  # replace with namespace where provisioner is deployed\n  namespace: default\nrules:\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;endpoints&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;update&quot;, &quot;patch&quot;]\n---\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: leader-locking-nfs-client-provisioner\n  # replace with namespace where provisioner is deployed\n  namespace: default\nsubjects:\n  - kind: ServiceAccount\n    name: nfs-client-provisioner\n    # replace with namespace where provisioner is deployed\n    namespace: default\nroleRef:\n  kind: Role\n  name: leader-locking-nfs-client-provisioner\n  apiGroup: rbac.authorization.k8s.io\n  \n  \n[root@k8s-master01 ~]# kubectl apply -f 01-rbac.yaml \nserviceaccount/nfs-client-provisioner created\nclusterrole.rbac.authorization.k8s.io/nfs-client-provisioner-runner created\nclusterrolebinding.rbac.authorization.k8s.io/run-nfs-client-provisioner created\nrole.rbac.authorization.k8s.io/leader-locking-nfs-client-provisioner created\nrolebinding.rbac.authorization.k8s.io/leader-locking-nfs-client-provisioner created\n</code></pre>\n<h4 id=\"3-创建nfs-provisioner\"><a class=\"anchor\" href=\"#3-创建nfs-provisioner\">#</a> 3. 创建 nfs-provisioner</h4>\n<pre><code>[root@k8s-master01 ~]# cat 02-nfs-provisioner.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nfs-client-provisioner\n  labels:\n    app: nfs-client-provisioner\n  # replace with namespace where provisioner is deployed\n  namespace: default\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: nfs-client-provisioner\n  template:\n    metadata:\n      labels:\n        app: nfs-client-provisioner\n    spec:\n      serviceAccountName: nfs-client-provisioner\n      containers:\n        - name: nfs-client-provisioner\n          image: registry.cn-hangzhou.aliyuncs.com/old_xu/nfs-subdir-external-provisioner:v4.0.2\n          volumeMounts:\n            - name: nfs-client-root\n              mountPath: /persistentvolumes\n          env:\n            - name: PROVISIONER_NAME\t# nfs-provisioner的名称，后续storageClass要与该名称一致\n              value: nfzl.com/nfs\n            - name: NFS_SERVER\t\t# NFS服务的IP地址\n              value: 192.168.1.75\n            - name: NFS_PATH\t\t# NFS服务共享的路径\n              value: /data/nfs\n      volumes:\n        - name: nfs-client-root\n          nfs:\n            server: 192.168.1.75\n            path: /data/nfs\n\n[root@k8s-master01 ~]# kubectl apply -f 02-nfs-provisioner.yaml \n[root@k8s-master01 ~]# kubectl get pods\nNAME                                      READY   STATUS    RESTARTS   AGE\nnfs-client-provisioner-6bcc4587f8-zp8qc   1/1     Running   0          17s\n</code></pre>\n<h4 id=\"4-创建storageclass\"><a class=\"anchor\" href=\"#4-创建storageclass\">#</a> 4. 创建 StorageClass</h4>\n<pre><code>[root@k8s-master01 ~]# cat 03-storageClass.yaml \napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: nfs-storage \t# pvc申请时需明确指定的storageClass名称\nprovisioner: nfzl.com/nfs        # 供应商名称，必须和上面创建的&quot;PROVISIONER_NAME&quot;变量值致\nparameters:\n  archiveOnDelete: &quot;false&quot;     # 如果值为false，删除PVC后也会删除目录内容, &quot;true&quot;则会对数据进行保留\n</code></pre>\n<h4 id=\"5-创建pvc\"><a class=\"anchor\" href=\"#5-创建pvc\">#</a> 5. 创建 PVC</h4>\n<pre><code>[root@k8s-master01 ~]# cat 04-nginx-pvc.yaml \napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: sc-pvc-001\nspec:\n  storageClassName: &quot;nfs-storage&quot;     # 明确指定使用哪个sc的供应商来创建pv\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 1Gi                      # 根据业务实际大小进行资源申请\n      \n[root@k8s-master01 ~]# kubectl apply -f 04-nginx-pvc.yaml \n</code></pre>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/fgpaP15.png\" alt=\"1.png\" /></p>\n<h4 id=\"6-挂载pvc测试\"><a class=\"anchor\" href=\"#6-挂载pvc测试\">#</a> 6. 挂载 PVC 测试</h4>\n<pre><code>[root@k8s-master01 ~]# cat 05-nginx-pod.yaml \napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-sc-001\nspec:\n  containers:\n  - name: nginx-sc-001\n    image: nginx\n    volumeMounts:\n    - name: nginx-page\n      mountPath: /usr/share/nginx/html\n  volumes:\n  - name: nginx-page\n    persistentVolumeClaim:      \n      claimName: sc-pvc-001\n\n[root@k8s-master01 ~]# kubectl apply -f 05-nginx-pod.yaml\n[root@k8s-master01 ~]# kubectl get pods -o wide\nNAME                                      READY   STATUS    RESTARTS   AGE   IP              NODE         NOMINATED NODE   READINESS GATES\nnginx-sc-001                              1/1     Running   0          15s   172.16.85.244   k8s-node01   &lt;none&gt;           &lt;none&gt;\n\n[root@k8s-master01 ~]# curl 172.16.85.244\nhello world\n</code></pre>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/722512536.html",
            "url": "http://ixuyong.cn/posts/722512536.html",
            "title": "K8s细粒度权限控制RBAC",
            "date_published": "2025-04-23T12:04:03.000Z",
            "content_html": "<h3 id=\"k8s细粒度权限控制rbac\"><a class=\"anchor\" href=\"#k8s细粒度权限控制rbac\">#</a> K8s 细粒度权限控制 RBAC</h3>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/KCZPPkv.jpeg\" alt=\"rbac.jpg\" /></p>\n<h4 id=\"1-创建不同权限的clusterrole\"><a class=\"anchor\" href=\"#1-创建不同权限的clusterrole\">#</a> 1. 创建不同权限的 clusterrole</h4>\n<h5 id=\"11-命令空间只读namespace-readonly\"><a class=\"anchor\" href=\"#11-命令空间只读namespace-readonly\">#</a> 1.1 命令空间只读 namespace-readonly</h5>\n<pre><code># cat namespace-readonly.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: namespace-readonly\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - namespaces\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - metrics.k8s.io\n  resources:\n  - pods\n  verbs:\n  - get\n  - list\n  - watch\n</code></pre>\n<h5 id=\"12-资源查看resource-readonly\"><a class=\"anchor\" href=\"#12-资源查看resource-readonly\">#</a> 1.2 资源查看 resource-readonly</h5>\n<pre><code># cat resource-readonly.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: resource-readonly\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - configmaps\n  - endpoints\n  - persistentvolumeclaims\n  - pods\n  - replicationcontrollers\n  - replicationcontrollers/scale\n  - serviceaccounts\n  - services\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - bindings\n  - events\n  - limitranges\n  - namespaces/status\n  - pods/log\n  - pods/status\n  - replicationcontrollers/status\n  - resourcequotas\n  - resourcequotas/status\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - namespaces\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - apps\n  resources:\n  - controllerrevisions\n  - daemonsets\n  - deployments\n  - deployments/scale\n  - replicasets\n  - replicasets/scale\n  - statefulsets\n  - statefulsets/scale\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - autoscaling\n  resources:\n  - horizontalpodautoscalers\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - batch\n  resources:\n  - cronjobs\n  - jobs\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - extensions\n  resources:\n  - daemonsets\n  - deployments\n  - deployments/scale\n  - ingresses\n  - networkpolicies\n  - replicasets\n  - replicasets/scale\n  - replicationcontrollers/scale\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - policy\n  resources:\n  - poddisruptionbudgets\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - networkpolicies\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - metrics.k8s.io\n  resources:\n  - pods\n  verbs:\n  - get\n  - list\n  - watch\n</code></pre>\n<h5 id=\"13-pod日志查看\"><a class=\"anchor\" href=\"#13-pod日志查看\">#</a> 1.3 pod 日志查看</h5>\n<pre><code># cat pod-log.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: pod-log\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - pods\n  - pods/log\n  verbs:\n  - get\n  - list\n  - watch\n</code></pre>\n<h5 id=\"14-pod删除\"><a class=\"anchor\" href=\"#14-pod删除\">#</a> 1.4 Pod 删除</h5>\n<pre><code># cat pod-delete.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: pod-delete\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - pods\n  verbs:\n  - get\n  - list\n  - delete\n</code></pre>\n<h5 id=\"15-pod执行\"><a class=\"anchor\" href=\"#15-pod执行\">#</a> 1.5 Pod 执行</h5>\n<pre><code># cat pod-exec.yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: pod-exec\nrules:\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - pods\n  verbs:\n  - get\n  - list\n- apiGroups:\n  - &quot;&quot;\n  resources:\n  - pods/exec\n  verbs:\n  - create\n</code></pre>\n<h5 id=\"16-创建不同权限的clusterrole\"><a class=\"anchor\" href=\"#16-创建不同权限的clusterrole\">#</a> 1.6 创建不同权限的 clusterrole</h5>\n<pre><code>[root@k8s-master01 rbac]# kubectl apply -f .\n</code></pre>\n<h4 id=\"2-创建serviceaccount\"><a class=\"anchor\" href=\"#2-创建serviceaccount\">#</a> 2. 创建 serviceaccount</h4>\n<pre><code># kubectl create ns kube-users\n\n# kubectl create sa test -n kube-users   \n# kubectl create sa dev -n kube-users    \n# kubectl create sa ops -n kube-users    \n\n# kubectl create token test -n kube-users\n# kubectl create token dev -n kube-users\n# kubectl create token ops -n kube-users\n</code></pre>\n<h4 id=\"3-创建clusterrolebinding\"><a class=\"anchor\" href=\"#3-创建clusterrolebinding\">#</a> 3. 创建 ClusterRoleBinding</h4>\n<h5 id=\"31-绑定全局命名空间查看权限\"><a class=\"anchor\" href=\"#31-绑定全局命名空间查看权限\">#</a> 3.1 绑定全局命名空间查看权限</h5>\n<pre><code># cat clusterrolebinding-namespace-readonly.yaml \napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: clusterrolebinding-namespace-readonly \nsubjects:\n- kind: Group\n  name: system:serviceaccounts:kube-users\n  apiGroup: rbac.authorization.k8s.io\nroleRef:\n  kind: ClusterRole\n  name: namespace-readonly\n  apiGroup: rbac.authorization.k8s.io\n  \n# kubectl apply -f clusterrolebinding-namespace-readonly.yaml\n</code></pre>\n<h5 id=\"32-绑定日志查看权限\"><a class=\"anchor\" href=\"#32-绑定日志查看权限\">#</a> 3.2 绑定日志查看权限</h5>\n<pre><code># kubectl create rolebinding ops-pod-log --clusterrole=pod-log --serviceaccount=kube-users:ops --namespace=projectA\n# kubectl create rolebinding ops-pod-log --clusterrole=pod-log --serviceaccount=kube-users:ops --namespace=projectB\n</code></pre>\n<h5 id=\"33-绑定资源查看权限\"><a class=\"anchor\" href=\"#33-绑定资源查看权限\">#</a> 3.3 绑定资源查看权限</h5>\n<pre><code># kubectl create rolebinding ops-resource-readonly --clusterrole=resource-readonly --serviceaccount=kube-users:ops --namespace=projectA\n# kubectl create rolebinding ops-resource-readonly --clusterrole=resource-readonly --serviceaccount=kube-users:ops --namespace=projectB\n</code></pre>\n<h5 id=\"34-绑定pod执行权限\"><a class=\"anchor\" href=\"#34-绑定pod执行权限\">#</a> 3.4 绑定 Pod 执行权限</h5>\n<pre><code># kubectl create rolebinding ops-pod-exec --clusterrole=pod-exec --serviceaccount=kube-users:ops --namespace=projectA\n# kubectl create rolebinding ops-pod-exec --clusterrole=pod-exec --serviceaccount=kube-users:ops --namespace=projectB\n</code></pre>\n<h5 id=\"35-绑定pod删除权限\"><a class=\"anchor\" href=\"#35-绑定pod删除权限\">#</a> 3.5 绑定 Pod 删除权限</h5>\n<pre><code># kubectl create rolebinding ops-pod-delete --clusterrole=pod-delete --serviceaccount=kube-users:ops --namespace=projectA\n# kubectl create rolebinding ops-pod-delete --clusterrole=pod-delete --serviceaccount=kube-users:ops --namespace=projectB\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/176412055.html",
            "url": "http://ixuyong.cn/posts/176412055.html",
            "title": "K8s准入控制ResourceQuota、LimitRange、QoS服务质量",
            "date_published": "2025-04-23T11:55:19.000Z",
            "content_html": "<h3 id=\"k8s准入控制resourcequota-limitrange-qos服务质量\"><a class=\"anchor\" href=\"#k8s准入控制resourcequota-limitrange-qos服务质量\">#</a> K8s 准入控制 ResourceQuota、LimitRange、QoS 服务质量</h3>\n<h4 id=\"1-resourcequota配置解析\"><a class=\"anchor\" href=\"#1-resourcequota配置解析\">#</a> 1. ResourceQuota 配置解析</h4>\n<p>ResourceQuotas 实现资源配额，避免过度创建资源，针对 namespace 进行限制。cpu 内存则是根据 pod 配置的 resources 总额进行限制，如果没有配置 resources 参数则无法限制。</p>\n<pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: resourcequota-test\n  namespace: test\n  labels:\n    app: resourcequota\nspec:\n  hard:\n    pods: 3\n    requests.cpu: 3\n    requests.memory: 512Mi\n    limits.cpu: 8\n    limits.memory: 16Gi\n    configmaps: 201\n    requests.storage: 40Gi\n    persistentvolumeclaims: 20\n    replicationcontrollers: 20\n    secrets: 20\n    services: 50\n    services.loadbalancers: &quot;2&quot;\n    services.nodeports: &quot;10&quot;\n</code></pre>\n<ul>\n<li>pods：限制最多启动 Pod 的个数</li>\n<li>requests.cpu：限制最高 CPU 请求数</li>\n<li>requests.memory：限制最高内存的请求数</li>\n<li>limits.cpu：限制最高 CPU 的 limit 上限</li>\n<li>limits.memory：限制最高内存的 limit 上限</li>\n<li>services：限制 services 数量</li>\n<li>services.nodeports：限制 services 中 nodeport 类型 service 数量</li>\n<li>services.loadbalancers：限制 services 中 loadbalancers 类型 service 数量</li>\n</ul>\n<h5 id=\"11-resourcequota配置示例\"><a class=\"anchor\" href=\"#11-resourcequota配置示例\">#</a> 1.1 ResourceQuota 配置示例</h5>\n<pre><code>#1.限制test命名空间pods数量量为3、configmap数量为2\n[root@k8s-master01 resourcequota]# cat rq-test.yaml\napiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: resourcequota-test\n  namespace: test\n  labels:\n    app: resourcequota\nspec:\n  hard:\n    pods: 3\n#    requests.cpu: 3\n#    requests.memory: 512Mi\n#    limits.cpu: 8\n#    limits.memory: 16Gi\n    configmaps: 2\n#    requests.storage: 40Gi\n#    persistentvolumeclaims: 20\n#    replicationcontrollers: 20\n#    secrets: 20\n#    services: 50\n#    services.loadbalancers: &quot;2&quot;\n#    services.nodeports: &quot;10&quot;\n\n#2.test命名空间已创建configmap数量为1,限制数量为2\n[root@k8s-master01 resourcequota]# kubectl get resourcequota -n test\nNAME                 AGE   REQUEST                      LIMIT\nresourcequota-test   61s   configmaps: 1/2, pods: 0/3  \n\n#3.test命名空间创建第2个configmap时正常，创建第3个configmap时报错\n[root@k8s-master01 resourcequota]# kubectl create cm rq-cm1 -n test --from-literal=key1=value1\n[root@k8s-master01 resourcequota]# kubectl create cm rq-cm2 -n test --from-literal=key2=value2\nerror: failed to create configmap: configmaps &quot;rq-cm2&quot; is forbidden: exceeded quota: resourcequota-test, requested: configmaps=1, used: configmaps=2, limited: configmaps=2\n</code></pre>\n<h4 id=\"2-limitrange配置解析\"><a class=\"anchor\" href=\"#2-limitrange配置解析\">#</a> 2. LimitRange 配置解析</h4>\n<p>虽然 ResourceQuota 可以实现资源配额，可以限制某个命名空间内存和 CPU，但是如果创建的 Pod 都没有配置 resources 参数则无法限制。如果配置 LimitRange，Pod 没有配置 resources 情况下，创建的 Pod 会根据 LimitRange 配置自动添加 CPU 内存配置，并且可以限制 resources 参数最大配置和最小配置，LimitRange 针对 Pod 进行限制。</p>\n<pre><code>apiVersion: v1\nkind: LimitRange\nmetadata:\n  name: cpu-mem-limit-range\n  namespace: test\nspec:\n  limits:\n  - default:         #限制CPU内存默认limits配置\n      cpu: 1\n      memory: 512Mi\n    defaultRequest:  #限制CPU内存默认request配置\n      cpu: 0.5\n      memory: 256Mi\n    max:                #限制CPU内存最大配置 \n      cpu: &quot;4000m&quot;\n      memory: 4Gi\n    min:                #限制CPU内存最小配置\n      cpu: &quot;100m&quot;\n      memory: 100Mi\n    type: Container\n  - type: PersistentVolumeClaim    #限制pvc大小\n    max:\n      storage: 2Gi\n    min:\n      storage: 1Gi\n</code></pre>\n<ul>\n<li>default：默认 limits 配置</li>\n<li>defaultRequest：默认 requests 配置</li>\n</ul>\n<h5 id=\"21-配置默认的requests和limits\"><a class=\"anchor\" href=\"#21-配置默认的requests和limits\">#</a> 2.1 配置默认的 requests 和 limits</h5>\n<p>Pod 没有配置 resources 情况下，创建的 Pod 会根据 LimitRange 配置自动添加 CPU 内存配置。</p>\n<pre><code>#1.创建LimitRange\n[root@k8s-master01 resourcequota]# cat limitrange.yaml \napiVersion: v1\nkind: LimitRange\nmetadata:\n  name: cpu-mem-limit-range\n  namespace: test\nspec:\n  limits:\n  - default:         #限制CPU内存默认limits配置\n      cpu: 1\n      memory: 512Mi\n    defaultRequest:  #限制CPU内存默认request配置\n      cpu: 0.5\n      memory: 256Mi\n    max:                #限制CPU内存最大配置 \n      cpu: &quot;4000m&quot;\n      memory: 4Gi\n    min:                #限制CPU内存最小配置\n      cpu: &quot;100m&quot;\n      memory: 100Mi\n    type: Container\n  - type: PersistentVolumeClaim    #限制pvc大小\n    max:\n      storage: 2Gi\n    min:\n      storage: 1Gi  \n      \n[root@k8s-master01 resourcequota]# kubectl apply -f limitrange.yaml\n[root@k8s-master01 resourcequota]# kubectl get limitrange -n test\nNAME                  CREATED AT\ncpu-mem-limit-range   2025-04-23T07:55:03Z\n\n#2.创建deployment, 查看是否会根据LimitRange自动添加CPU内存配置\n[root@k8s-master01 resourcequota]# cat deploy-limitrange.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: deploy-limirange\n  labels:\n    app: deploy-limirange\n  namespace: test\nspec:\n  selector:\n    matchLabels:\n      app: deploy-limirange\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: deploy-limirange\n    spec:\n      restartPolicy: Always\n      containers:\n        - name: deploy-limirange\n          image: nginx\n          imagePullPolicy: IfNotPresent\n\n[root@k8s-master01 resourcequota]# kubectl get pod -n test\nNAME                                READY   STATUS    RESTARTS   AGE\ndeploy-limirange-854c9545ff-grpxr   1/1     Running   0          39s\n[root@k8s-master01 resourcequota]# kubectl get pod -n test -oyaml\n...\n  spec:\n    containers:\n    - image: nginx\n      imagePullPolicy: IfNotPresent\n      name: deploy-limirange\n      resources:\n        limits:\n          cpu: &quot;1&quot;\n          memory: 512Mi\n        requests:\n          cpu: 500m\n          memory: 256Mi\n...\n</code></pre>\n<h5 id=\"22-限制requests和limits范围\"><a class=\"anchor\" href=\"#22-限制requests和limits范围\">#</a> 2.2 限制 requests 和 limits 范围</h5>\n<pre><code>#1.创建LimitRange\n[root@k8s-master01 resourcequota]# cat limitrange.yaml \napiVersion: v1\nkind: LimitRange\nmetadata:\n  name: cpu-mem-limit-range\n  namespace: test\nspec:\n  limits:\n  - default:         #限制CPU内存默认limits配置\n      cpu: 1\n      memory: 512Mi\n    defaultRequest:  #限制CPU内存默认request配置\n      cpu: 0.5\n      memory: 256Mi\n    max:                #限制CPU内存最大配置 \n      cpu: &quot;4000m&quot;\n      memory: 4Gi\n    min:                #限制CPU内存最小配置\n      cpu: &quot;100m&quot;\n      memory: 100Mi\n    type: Container\n  - type: PersistentVolumeClaim    #限制pvc大小\n    max:\n      storage: 2Gi\n    min:\n      storage: 1Gi  \n\n#2.创建deployment, CPU内存limits和requests高于/低于LimitRangeCPU内存max、min配置\n[root@k8s-master01 resourcequota]# cat deploy-limitrange.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: deploy-limirange\n  labels:\n    app: deploy-limirange\n  namespace: test\nspec:\n  selector:\n    matchLabels:\n      app: deploy-limirange\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: deploy-limirange\n    spec:\n      restartPolicy: Always\n      containers:\n        - name: deploy-limirange\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 8096Mi\n              cpu: 5\n            requests:\n              memory: 64Mi\n              cpu: 10m\n\n#3.由于创建deployment, CPU内存limits和requests高于/低于LimitRangeCPU内存max、min配置，pod没有创建\n[root@k8s-master01 resourcequota]# kubectl create -f deploy-limitrange.yaml \n\n[root@k8s-master01 resourcequota]# kubectl get deploy deploy-limirange -n test\nNAME               READY   UP-TO-DATE   AVAILABLE   AGE\ndeploy-limirange   0/1     0            0           2m7s\n[root@k8s-master01 resourcequota]# kubectl get pods -n test\n\n[root@k8s-master01 resourcequota]# kubectl describe rs deploy-limirange-54c5d69b4b -n test\nName:           deploy-limirange-54c5d69b4b\nNamespace:      test\nSelector:       app=deploy-limirange,pod-template-hash=54c5d69b4b\nLabels:         app=deploy-limirange\n                pod-template-hash=54c5d69b4b\nAnnotations:    deployment.kubernetes.io/desired-replicas: 1\n                deployment.kubernetes.io/max-replicas: 2\n                deployment.kubernetes.io/revision: 1\nControlled By:  Deployment/deploy-limirange\nReplicas:       0 current / 1 desired\nPods Status:    0 Running / 0 Waiting / 0 Succeeded / 0 Failed\nPod Template:\n  Labels:  app=deploy-limirange\n           pod-template-hash=54c5d69b4b\n  Containers:\n   deploy-limirange:\n    Image:      nginx\n    Port:       &lt;none&gt;\n    Host Port:  &lt;none&gt;\n    Limits:\n      cpu:     5\n      memory:  8096Mi\n    Requests:\n      cpu:         10m\n      memory:      64Mi\n    Environment:   &lt;none&gt;\n    Mounts:        &lt;none&gt;\n  Volumes:         &lt;none&gt;\n  Node-Selectors:  &lt;none&gt;\n  Tolerations:     &lt;none&gt;\nConditions:\n  Type             Status  Reason\n  ----             ------  ------\n  ReplicaFailure   True    FailedCreate\nEvents:\n  Type     Reason        Age                 From                   Message\n  ----     ------        ----                ----                   -------\n  Warning  FailedCreate  3m8s                replicaset-controller  Error creating: pods &quot;deploy-limirange-54c5d69b4b-zxhzk&quot; is forbidden: [minimum cpu usage per Container is 100m, but request is 10m, minimum memory usage per Container is 100Mi, but request is 64Mi, maximum cpu usage per Container is 4, but limit is 5, maximum memory usage per Container is 4Gi, but limit is 8096Mi]\n</code></pre>\n<h5 id=\"23-限制存储空间大小\"><a class=\"anchor\" href=\"#23-限制存储空间大小\">#</a> 2.3 限制存储空间大小</h5>\n<pre><code>#1.创建LimitRange\n[root@k8s-master01 resourcequota]# cat limitrange.yaml \napiVersion: v1\nkind: LimitRange\nmetadata:\n  name: cpu-mem-limit-range\n  namespace: test\nspec:\n  limits:\n  - default:         #限制CPU内存默认limits配置\n      cpu: 1\n      memory: 512Mi\n    defaultRequest:  #限制CPU内存默认request配置\n      cpu: 0.5\n      memory: 256Mi\n    max:                #限制CPU内存最大配置 \n      cpu: &quot;4000m&quot;\n      memory: 4Gi\n    min:                #限制CPU内存最小配置\n      cpu: &quot;100m&quot;\n      memory: 100Mi\n    type: Container\n  - type: PersistentVolumeClaim    #限制pvc大小\n    max:\n      storage: 2Gi\n    min:\n      storage: 1Gi  \n  \n#2.由于创建的pvc大于2G，所以报错  \n[root@k8s-master01 ~]# cat pvc.yaml \napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: sc-pvc-001\nspec:\n  storageClassName: &quot;nfs-storage&quot;     # 明确指定使用哪个sc的供应商来创建pv\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 3Gi                      # 根据业务实际大小进行资源申请  \n[root@k8s-master01 ~]# kubectl create -f pvc.yaml -n test\nError from server (Forbidden): error when creating &quot;pvc.yaml&quot;: persistentvolumeclaims &quot;sc-pvc-001&quot; is forbidden: maximum storage usage per PersistentVolumeClaim is 2Gi, but request is 3Gi\n</code></pre>\n<h4 id=\"3-服务质量-qos\"><a class=\"anchor\" href=\"#3-服务质量-qos\">#</a> 3. 服务质量 QoS</h4>\n<ul>\n<li>Guaranteed：最高服务质量，当宿主机内存不够时，会先 kill 掉 QoS 为 BestEffort 和 Burstable 的 Pod，如果内存还是不够，才会 kill 掉 QoS 为 Guaranteed，该级别 Pod 的资源占用量一般比较明确，即 requests 的 cpu 和 memory 和 limits 的 cpu 和 memory 配置的一致。</li>\n<li>Burstable： 服务质量低于 Guaranteed，当宿主机内存不够时，会先 kill 掉 QoS 为 BestEffort 的 Pod，如果内存还是不够之后就会 kill 掉 QoS 级别为 Burstable 的 Pod，用来保证 QoS 质量为 Guaranteed 的 Pod，该级别 Pod 一般知道最小资源使用量，但是当机器资源充足时，还是想尽可能的使用更多的资源，即 limits 字段的 cpu 和 memory 大于 requests 的 cpu 和 memory 的配置。</li>\n<li>BestEffort：尽力而为，当宿主机内存不够时，首先 kill 的就是该 QoS 的 Pod，用以保证 Burstable 和 Guaranteed 级别的 Pod 正常运行。</li>\n</ul>\n<h5 id=\"31-实现qos为guaranteed的pod\"><a class=\"anchor\" href=\"#31-实现qos为guaranteed的pod\">#</a> 3.1 实现 QoS 为 Guaranteed 的 Pod</h5>\n<ol>\n<li>\n<p>Pod 中的每个容器必须指定 limits.memory 和 requests.memory，并且两者需要相等；</p>\n</li>\n<li>\n<p>Pod 中的每个容器必须指定 limits.cpu 和 limits.memory，并且两者需要相等。</p>\n</li>\n</ol>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 1024Mi\n              cpu: 1\n</code></pre>\n<h5 id=\"32-实现qos为burstable的pod\"><a class=\"anchor\" href=\"#32-实现qos为burstable的pod\">#</a> 3.2 实现 QoS 为 Burstable 的 Pod</h5>\n<ol>\n<li>\n<p>Pod 不符合 Guaranteed 的配置要求；</p>\n</li>\n<li>\n<p>Pod 中至少有一个容器配置了 requests.cpu 或 requests.memory。</p>\n</li>\n</ol>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n</code></pre>\n<h5 id=\"33-实现qos为besteffort的pod\"><a class=\"anchor\" href=\"#33-实现qos为besteffort的pod\">#</a> 3.3 实现 QoS 为 BestEffort 的 Pod</h5>\n<ol>\n<li>不设置 resources 参数</li>\n</ol>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/312010518.html",
            "url": "http://ixuyong.cn/posts/312010518.html",
            "title": "K8s亲和力Affinity",
            "date_published": "2025-04-20T09:59:58.000Z",
            "content_html": "<h3 id=\"k8s亲和力affinity\"><a class=\"anchor\" href=\"#k8s亲和力affinity\">#</a> K8s 亲和力 Affinity</h3>\n<p>Pod 和节点之间的关系：</p>\n<ul>\n<li>某些 Pod 优先选择有 ssd=true 标签的节点，如果没有在考虑部署到其它节点；</li>\n<li>某些 Pod 需要部署在 ssd=true 和 type=physical 的节点上，但是优先部署在 ssd=true 的节点上。</li>\n</ul>\n<p>Pod 和 Pod 之间的关系：</p>\n<ul>\n<li>同一个应用的 Pod 不同的副本或者同一个项目的应用尽量或必须不部署在同一个节点或者符合某个标签的一类节点上或者不同的区域；</li>\n<li>相互依赖的两个 Pod 尽量或必须部署在同一个节点上或者同一个域内。</li>\n</ul>\n<h4 id=\"1-affinity分类\"><a class=\"anchor\" href=\"#1-affinity分类\">#</a> 1. Affinity 分类</h4>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/hTd0wmD.png\" alt=\"1.png\" /></p>\n<h4 id=\"2-节点亲和力配置详解\"><a class=\"anchor\" href=\"#2-节点亲和力配置详解\">#</a> 2. 节点亲和力配置详解</h4>\n<h5 id=\"21-硬亲和力required\"><a class=\"anchor\" href=\"#21-硬亲和力required\">#</a> 2.1 硬亲和力 required</h5>\n<pre><code># cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 5\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n              - matchExpressions:\n                  - key: kubernetes.io/hostname\n                    operator: In\n                    values:\n                      - k8s-node01\n                      - k8s-node02\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n</code></pre>\n<ul>\n<li>requiredDuringSchedulingIgnoredDuringExecution：硬亲和力配置</li>\n<li>nodeSelectorTerms：节点选择器配置，可以配置多个 matchExpressions（满足其一即可）</li>\n<li>matchExpressions：matchExpressions 下可以配置多个 key、values（都需要满足），其中 values 可以配置多个（满足其一即可）</li>\n<li>operator：\n<ul>\n<li>IN 相当于 key = value 的形式，<strong>NotIn 相当于 key!=value 的形式 (反亲和力)</strong></li>\n<li>Exists: 节点存在 label 的 key 为指定的值即可，不能配置 values 字段</li>\n<li>DoesNotExist: 节点不存在 label 的 key 为指定的值即可，不能配置 values 字段</li>\n<li>Gt：大于 value 指定的值</li>\n<li>Lt：小于 value 指定的值</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"22-软亲和力preferred\"><a class=\"anchor\" href=\"#22-软亲和力preferred\">#</a> 2.2 软亲和力 preferred</h5>\n<pre><code># cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 6\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n            - weight: 100\n              preference:\n                matchExpressions:\n                  - key: ssd\n                    operator: In\n                    values:\n                      - 'true'\n            - weight: 50\n              preference:\n                matchExpressions:\n                  - key: kubernetes.io/hostname\n                    operator: In\n                    values:\n                      - k8s-master01\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n</code></pre>\n<ul>\n<li>preferredDuringSchedulingIgnoredDuringExecution：软亲和力配置</li>\n<li>weight：软亲和力的权重，权重越高优先级越大，范围 1-100</li>\n<li>matchExpressions：matchExpressions 下可以配置多个 key、values（都需要满足），其中 values 可以配置多个（满足其一即可）</li>\n<li>operator：\n<ul>\n<li>IN 相当于 key = value 的形式，<strong>NotIn 相当于 key!=value 的形式 (反亲和力)</strong></li>\n<li>Exists: 节点存在 label 的 key 为指定的值即可，不能配置 values 字段</li>\n<li>DoesNotExist: 节点不存在 label 的 key 为指定的值即可，不能配置 values 字段</li>\n<li>Gt：大于 value 指定的值</li>\n<li>Lt：小于 value 指定的值</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"3-pod亲和力详解\"><a class=\"anchor\" href=\"#3-pod亲和力详解\">#</a> 3. Pod 亲和力详解</h4>\n<pre><code>[root@k8s-master01 ~]# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      affinity:              \n        podAntiAffinity:   #pod硬反亲和力\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - nginx-deploy\n            topologyKey: kubernetes.io/hostname\n        podAntiAffinity:       #pod软反亲和力\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: app\n                  operator: In\n                  values:\n                  - nginx-deploy\n              namespaces:     #和哪个命名空间的Pod进行匹配，为空为当前命名空间\n              - default\n              topologyKey: kubernetes.io/hostname\n</code></pre>\n<ul>\n<li>\n<p>labelSelector：Pod 选择器配置，可以配置多个</p>\n</li>\n<li>\n<p>matchExpressions：matchExpressions 下可以配置多个 key、values（都需要满足），其中 values 可以配置多个（满足其一即可）</p>\n</li>\n<li>\n<p>topologyKey：匹配的拓扑域的 key，也就是节点上 label 的 key，key 和 value 相同的为同一个域，可以用于标注不同的机房和地区</p>\n</li>\n<li>\n<p>Namespaces: 和哪个命名空间的 Pod 进行匹配，为空为当前命名空间</p>\n</li>\n<li>\n<p>operator：配置和节点亲和力一致，但是没有 Gt 和 Lt</p>\n<ul>\n<li>\n<p>IN 相当于 key = value 的形式；</p>\n</li>\n<li>\n<p>Exists: 节点存在 label 的 key 为指定的值即可，不能配置 values 字段；</p>\n</li>\n<li>\n<p>DoesNotExist: 节点不存在 label 的 key 为指定的值即可，不能配置 values 字段</p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"4-节点亲和力配置示例\"><a class=\"anchor\" href=\"#4-节点亲和力配置示例\">#</a> 4. 节点亲和力配置示例</h4>\n<p>Pod 尽量部署在 ssd=true 和 type=physical 的节点上，但是优先部署在 ssd=true 的节点上，不能部署 label 为 gpu=true 的节点。</p>\n<pre><code>[root@k8s-master01 ~]# kubectl label nodes k8s-node01 ssd=true\n[root@k8s-master01 ~]# kubectl label nodes k8s-master01 ssd=true\n[root@k8s-master01 ~]# kubectl label nodes k8s-master01 gpu=true\n[root@k8s-master01 ~]# kubectl label nodes k8s-node02 type=physical\n\n[root@k8s-master01 ~]# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 5\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n      annotations:\n        app: nginx-deploy\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n            - weight: 100\n              preference:\n                matchExpressions:\n                  - key: ssd\n                    operator: In\n                    values:\n                      - 'true'\n                  - key: gpu\n                    operator: NotIn\n                    values:\n                      - 'true'\n            - weight: 50\n              preference:\n                matchExpressions:\n                  - key: type\n                    operator: In\n                    values:\n                      - physical\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          volumeMounts:\n          - name: tz-config\n            mountPath: /usr/share/zoneinfo/Asia/Shanghai\n          - name: tz-config\n            mountPath: /etc/localtime\n          - name: timezone\n            mountPath: /etc/timezone\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n\n\n[root@k8s-master01 ~]# kubectl apply -f nginx-deploy.yaml \n[root@k8s-master01 ~]# kubectl get pods -o wide\nNAME                          READY   STATUS    RESTARTS   AGE   IP              NODE         NOMINATED NODE   READINESS GATES\nnginx-deploy-7d65fbdf-2b4jr   1/1     Running   0          5s    172.16.85.236   k8s-node01   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7d65fbdf-jjzwr   1/1     Running   0          5s    172.16.58.251   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7d65fbdf-kx5lm   1/1     Running   0          5s    172.16.85.237   k8s-node01   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7d65fbdf-lrmcg   1/1     Running   0          5s    172.16.85.238   k8s-node01   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7d65fbdf-n6mlp   1/1     Running   0          5s    172.16.58.250   k8s-node02   &lt;none&gt;           &lt;none&gt;\n</code></pre>\n<h4 id=\"5-pod亲和力-反亲和力配置示例\"><a class=\"anchor\" href=\"#5-pod亲和力-反亲和力配置示例\">#</a> 5. Pod 亲和力、反亲和力配置示例</h4>\n<h5 id=\"51-pod反亲和力required\"><a class=\"anchor\" href=\"#51-pod反亲和力required\">#</a> 5.1 Pod 反亲和力 required</h5>\n<p>同一个应用部署在不同的宿主机</p>\n<pre><code>#1.节点存在污点pod无法调度至该节点\n# kubectl describe nodes|grep -i taint\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\n\n#2.pod反亲和力required\n# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 5\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            - labelSelector:\n                matchExpressions:\n                  - key: app\n                    operator: In\n                    values:\n                      - nginx-deploy\n              topologyKey: kubernetes.io/hostname\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          volumeMounts:\n          - name: tz-config\n            mountPath: /usr/share/zoneinfo/Asia/Shanghai\n          - name: tz-config\n            mountPath: /etc/localtime\n          - name: timezone\n            mountPath: /etc/timezone\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n\n#3.部署deployment\n[root@k8s-master01 ~]# kubectl apply -f nginx-deploy.yaml \n[root@k8s-master01 ~]# kubectl get pods -o wide\nNAME                            READY   STATUS    RESTARTS   AGE   IP               NODE           NOMINATED NODE   READINESS GATES\nnginx-deploy-5787887b6f-4654b   1/1     Running   0          4s    172.16.85.234    k8s-node01     &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-8mq7s   1/1     Running   0          4s    172.16.122.152   k8s-master02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-fdkft   1/1     Running   0          4s    172.16.58.247    k8s-node02     &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-jzcmd   1/1     Running   0          4s    172.16.32.152    k8s-master01   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-qdq9g   1/1     Running   0          4s    172.16.195.14    k8s-master03   &lt;none&gt;           &lt;none&gt;\n\n#4.将副本扩成6个，由于K8s集群只有5个节点，即5个topologyKey（拓扑域），每个域只能有一个副本，所以有一个pod会pending\n[root@k8s-master01 ~]# kubectl scale deploy nginx-deploy --replicas=6 \n[root@k8s-master01 ~]# kubectl get pods -o wide\nNAME                            READY   STATUS    RESTARTS   AGE     IP               NODE           NOMINATED NODE   READINESS GATES\nnginx-deploy-5787887b6f-4654b   1/1     Running   0          4m44s   172.16.85.234    k8s-node01     &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-8mq7s   1/1     Running   0          4m44s   172.16.122.152   k8s-master02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-fdkft   1/1     Running   0          4m44s   172.16.58.247    k8s-node02     &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-jzcmd   1/1     Running   0          4m44s   172.16.32.152    k8s-master01   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-qdq9g   1/1     Running   0          4m44s   172.16.195.14    k8s-master03   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-5787887b6f-sztm7   0/1     Pending   0          9s      &lt;none&gt;           &lt;none&gt;         &lt;none&gt;           &lt;none&gt;\n\n[root@k8s-master01 ~]# kubectl describe pods nginx-deploy-5787887b6f-sztm7\n...\nEvents:\n  Type     Reason            Age   From               Message\n  ----     ------            ----  ----               -------\n  Warning  FailedScheduling  102s  default-scheduler  0/5 nodes are available: 5 node(s) didn't match pod anti-affinity rules. preemption: 0/5 nodes are available: 5 No preemption victims found for incoming pod.\n</code></pre>\n<p><strong>将副本扩成 6 个，有一个会 pending 状态，原因 K8s 集群只有 5 个节点，即 5 个 topologyKey（拓扑域），每个拓扑域只能有一个副本，所以有一个 pod 会 pending。</strong></p>\n<p><strong>topologyKey：匹配的拓扑域的 key，也就是节点上 label 的 key，key 和 value 相同的为同一个域，可以用于标注不同的机房和地区</strong>。</p>\n<h5 id=\"52-pod反亲和力preferred\"><a class=\"anchor\" href=\"#52-pod反亲和力preferred\">#</a> 5.2 Pod 反亲和力 preferred</h5>\n<p>同一个应用尽量部署在不同的宿主机</p>\n<pre><code>#1.节点存在污点pod无法调度至该节点\n# kubectl describe nodes|grep -i taint\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\nTaints:             &lt;none&gt;\n\n#2.pod反亲和力preferred\n# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 6\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n            - podAffinityTerm:\n                labelSelector:\n                  matchExpressions:\n                    - key: app\n                      operator: In\n                      values:\n                        - nginx-deploy\n                topologyKey: kubernetes.io/hostname\n              weight: 100\n      restartPolicy: Always\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          volumeMounts:\n          - name: tz-config\n            mountPath: /usr/share/zoneinfo/Asia/Shanghai\n          - name: tz-config\n            mountPath: /etc/localtime\n          - name: timezone\n            mountPath: /etc/timezone\n      volumes:\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n\n#3.部署deployment\n[root@k8s-master01 ~]# kubectl apply -f nginx-deploy.yaml \n[root@k8s-master01 ~]# kubectl get pods -o wide\nNAME                            READY   STATUS    RESTARTS   AGE   IP               NODE           NOMINATED NODE   READINESS GATES\nnginx-deploy-7c47567b79-97qs5   1/1     Running   0          6s    172.16.122.153   k8s-master02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7c47567b79-g49h4   1/1     Running   0          6s    172.16.85.235    k8s-node01     &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7c47567b79-g5n2s   1/1     Running   0          6s    172.16.58.248    k8s-node02     &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7c47567b79-g5v5b   1/1     Running   0          6s    172.16.195.15    k8s-master03   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7c47567b79-pjwws   1/1     Running   0          6s    172.16.58.249    k8s-node02     &lt;none&gt;           &lt;none&gt;\nnginx-deploy-7c47567b79-q2hn5   1/1     Running   0          6s    172.16.32.153    k8s-master01   &lt;none&gt;           &lt;none&gt;\n</code></pre>\n<h5 id=\"53-pod亲和力required\"><a class=\"anchor\" href=\"#53-pod亲和力required\">#</a> 5.3 Pod 亲和力 required</h5>\n<p>同一个应用必须部署在同一个宿主机</p>\n<pre><code>[root@k8s-master01 ~]# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 8\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      affinity:              \n        podAffinity:   #pod硬亲和力\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - nginx-deploy\n            topologyKey: kubernetes.io/hostname\n      containers:\n      - image: nginx\n        name: nginx\n        volumeMounts:\n        - name: timezone\n          mountPath: /etc/timezone\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n      volumes:\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: File\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: File\n\n[root@k8s-master01 ~]# kubectl apply -f nginx-deploy.yaml \n[root@k8s-master01 ~]# kubectl get pods -o wide\nNAME                           READY   STATUS    RESTARTS   AGE   IP              NODE         NOMINATED NODE   READINESS GATES\nnginx-deploy-dbcc4d65c-2sthn   1/1     Running   0          12s   172.16.58.255   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-dbcc4d65c-78nxf   1/1     Running   0          12s   172.16.58.197   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-dbcc4d65c-82ssq   1/1     Running   0          12s   172.16.58.194   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-dbcc4d65c-986cb   1/1     Running   0          12s   172.16.58.254   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-dbcc4d65c-9rnt7   1/1     Running   0          12s   172.16.58.252   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-dbcc4d65c-knm8q   1/1     Running   0          12s   172.16.58.195   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-dbcc4d65c-kx56f   1/1     Running   0          12s   172.16.58.253   k8s-node02   &lt;none&gt;           &lt;none&gt;\nnginx-deploy-dbcc4d65c-sqlhf   1/1     Running   0          12s   172.16.58.198   k8s-node02   &lt;none&gt;           &lt;none&gt;\n</code></pre>\n<h5 id=\"54-pod亲和力preferre\"><a class=\"anchor\" href=\"#54-pod亲和力preferre\">#</a> 5.4 Pod 亲和力 preferre</h5>\n<p>同一个应用尽量部署在同一个宿主机</p>\n<pre><code># cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 20\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      affinity:              \n        podAffinity:       #pod软亲和力\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: app\n                  operator: In\n                  values:\n                  - nginx-deploy\n              namespaces:     #和哪个命名空间的Pod进行匹配，为空为当前命名空间\n              - default\n              topologyKey: kubernetes.io/hostname\n      containers:\n      - image: nginx\n        name: nginx\n        volumeMounts:\n        - name: timezone\n          mountPath: /etc/timezone\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n      volumes:\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: File\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: File\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3254599477.html",
            "url": "http://ixuyong.cn/posts/3254599477.html",
            "title": "K8s容忍和污点",
            "date_published": "2025-04-20T07:51:58.000Z",
            "content_html": "<h3 id=\"k8s容忍和污点\"><a class=\"anchor\" href=\"#k8s容忍和污点\">#</a> K8s 容忍和污点</h3>\n<p>Taint 指定服务器上打上污点，让不能容忍这个污点的 Pod 不能部署在打了污点的服务器上。Toleration 是让 Pod 容忍节点上配置的污点，可以让一些需要特殊配置的 Pod 能够调用到具有污点和特殊配置的节点上。</p>\n<h4 id=\"1-taint配置解析\"><a class=\"anchor\" href=\"#1-taint配置解析\">#</a> 1. Taint 配置解析</h4>\n<pre><code>#1.Taint语法\n# kubectl taint nodes NODE_NAME TAINT_KEY=TAINT_VALUE:EFFECT\n\n#2.创建Taint示例\n# kubectl taint nodes k8s-node01 ssd=true:PreferNoSchedule\n\n#3.查看污点\n# kubectl describe node k8s-node01 | grep Taints -A 10\n\n#4.删除污点\n# kubectl taint nodes k8s-node01 ssd-                   #基于Key删除\n# kubectl taint nodes k8s-node01 ssd:PreferNoSchedule-  #基于Key+Effect删除\n\n#5.修改污点（Key和Effect相同）\n# kubectl taint nodes k8s-node01 ssd=true:PreferNoSchedule --overwrite\n</code></pre>\n<p>EFFECT 排斥等级：</p>\n<ul>\n<li>NoSchedule：禁止调度到该节点，已经在该节点上的 Pod 不受影响</li>\n<li>NoExecute：禁止调度到该节点，如果不符合这个污点，会立马被驱逐（或在一段时间后）</li>\n<li>PreferNoSchedule：尽量避免将 Pod 调度到指定的节点上，如果没有更合适的节点，可以部署到该节点</li>\n</ul>\n<h4 id=\"2toleration配置解析\"><a class=\"anchor\" href=\"#2toleration配置解析\">#</a> 2.Toleration 配置解析</h4>\n<pre><code>#1.完全匹配\ntolerations:\n- key: &quot;taintKey&quot;\n  operator: &quot;Equal&quot;\n  value: &quot;taintValue&quot;\n  effect: &quot;NoSchedule\n \n#2.不完全匹配 \ntolerations:\n- key: &quot;taintKey&quot;\n  operator: &quot;Exists&quot;\n  effect: &quot;NoSchedule&quot;\n  \n#3.大范围匹配（不推荐key为内置Taint，会导致节点故障pod无法漂移）\ntolerations:\n- key: &quot;taintKey&quot;\n  operator: &quot;Exists\n  \n#4.容忍时间配置\ntolerations:\n- key: &quot;key1&quot;\n  operator: &quot;Equal&quot;\n  value: &quot;value1&quot;\n  effect: &quot;NoExecute&quot;\n  tolerationSeconds: 3600\n</code></pre>\n<h4 id=\"3-taint-toleration配置示例\"><a class=\"anchor\" href=\"#3-taint-toleration配置示例\">#</a> 3. Taint、Toleration 配置示例</h4>\n<p>有一个 K8s 节点是纯 SSD 硬盘的节点，现需要只有一些需要高性能存储的 Pod 才能调度到该节点上。</p>\n<pre><code>#1.给节点打上污点和标签\n# kubectl taint nodes k8s-node01 ssd=true:PreferNoSchedule\n# kubectl label node k8s-node01 ssd=true\n\n#2.配置Toleration：\n# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 5\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n      nodeSelector:\n        ssd: 'true'\n      tolerations:\n        - key: ssd\n          operator: Exists\n          effect: NoSchedule\n</code></pre>\n<h4 id=\"4-k8s内置污点\"><a class=\"anchor\" href=\"#4-k8s内置污点\">#</a> 4. K8s 内置污点</h4>\n<ul>\n<li><a href=\"http://node.kubernetes.io/not-ready%EF%BC%9A%E8%8A%82%E7%82%B9%E6%9C%AA%E5%87%86%E5%A4%87%E5%A5%BD%EF%BC%8C%E7%9B%B8%E5%BD%93%E4%BA%8E%E8%8A%82%E7%82%B9%E7%8A%B6%E6%80%81Ready%E7%9A%84%E5%80%BC%E4%B8%BAFalse%E3%80%82\">node.kubernetes.io/not-ready：节点未准备好，相当于节点状态 Ready 的值为 False。</a></li>\n<li><a href=\"http://node.kubernetes.io/unreachable%EF%BC%9ANode\">node.kubernetes.io/unreachable：Node</a> Controller 访问不到节点，相当于节点状态 Ready 的值为 Unknown。</li>\n<li><a href=\"http://node.kubernetes.io/out-of-disk%EF%BC%9A%E8%8A%82%E7%82%B9%E7%A3%81%E7%9B%98%E8%80%97%E5%B0%BD%E3%80%82\">node.kubernetes.io/out-of-disk：节点磁盘耗尽。</a></li>\n<li><a href=\"http://node.kubernetes.io/memory-pressure%EF%BC%9A%E8%8A%82%E7%82%B9%E5%AD%98%E5%9C%A8%E5%86%85%E5%AD%98%E5%8E%8B%E5%8A%9B%E3%80%82\">node.kubernetes.io/memory-pressure：节点存在内存压力。</a></li>\n<li><a href=\"http://node.kubernetes.io/disk-pressure%EF%BC%9A%E8%8A%82%E7%82%B9%E5%AD%98%E5%9C%A8%E7%A3%81%E7%9B%98%E5%8E%8B%E5%8A%9B%E3%80%82\">node.kubernetes.io/disk-pressure：节点存在磁盘压力。</a></li>\n<li><a href=\"http://node.kubernetes.io/network-unavailable%EF%BC%9A%E8%8A%82%E7%82%B9%E7%BD%91%E7%BB%9C%E4%B8%8D%E5%8F%AF%E8%BE%BE%E3%80%82\">node.kubernetes.io/network-unavailable：节点网络不可达。</a></li>\n<li><a href=\"http://node.kubernetes.io/unschedulable%EF%BC%9A%E8%8A%82%E7%82%B9%E4%B8%8D%E5%8F%AF%E8%B0%83%E5%BA%A6%E3%80%82\">node.kubernetes.io/unschedulable：节点不可调度。</a></li>\n<li><a href=\"http://node.cloudprovider.kubernetes.io/uninitialized%EF%BC%9A%E5%A6%82%E6%9E%9CKubelet%E5%90%AF%E5%8A%A8%E6%97%B6%E6%8C%87%E5%AE%9A%E4%BA%86%E4%B8%80%E4%B8%AA%E5%A4%96%E9%83%A8%E7%9A%84cloudprovider%EF%BC%8C%E5%AE%83%E5%B0%86%E7%BB%99%E5%BD%93%E5%89%8D%E8%8A%82%E7%82%B9%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AATaint%E5%B0%86%E5%85%B6%E6%A0%87%E8%AE%B0%E4%B8%BA%E4%B8%8D%E5%8F%AF%E7%94%A8%E3%80%82%E5%9C%A8cloud-controller-manager%E7%9A%84%E4%B8%80%E4%B8%AAcontroller%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%99%E4%B8%AA%E8%8A%82%E7%82%B9%E5%90%8E%EF%BC%8CKubelet%E5%B0%86%E5%88%A0%E9%99%A4%E8%BF%99%E4%B8%AATaint%E3%80%82\">node.cloudprovider.kubernetes.io/uninitialized：如果 Kubelet 启动时指定了一个外部的 cloudprovider，它将给当前节点添加一个 Taint 将其标记为不可用。在 cloud-controller-manager 的一个 controller 初始化这个节点后，Kubelet 将删除这个 Taint。</a></li>\n</ul>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/vO7kURL.png\" alt=\"1.png\" /></p>\n<p>Deployment 创建后 K8s 默认为 Pod 添加容忍，当 Pod 所在的节点宕机，300 秒后 pod 会漂移，默认容忍时间 300 秒。</p>\n<h4 id=\"5节点宕机快速恢复业务应用\"><a class=\"anchor\" href=\"#5节点宕机快速恢复业务应用\">#</a> 5. 节点宕机快速恢复业务应用</h4>\n<p>节点不健康，180 秒后再驱逐（默认是 300 秒）</p>\n<pre><code># cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 5\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n      tolerations:\n        - key: node.kubernetes.io/unreachable\n          operator: Exists\n          effect: NoExecute\n          tolerationSeconds: 180\n        - key: node.kubernetes.io/not-ready\n          operator: Exists\n          effect: NoExecute\n          tolerationSeconds: 180\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3142072607.html",
            "url": "http://ixuyong.cn/posts/3142072607.html",
            "title": "K8s初始化容器、临时容器",
            "date_published": "2025-04-19T13:07:20.000Z",
            "content_html": "<h3 id=\"k8s初始化容器-临时容器\"><a class=\"anchor\" href=\"#k8s初始化容器-临时容器\">#</a> K8s 初始化容器、临时容器</h3>\n<h4 id=\"1-初始化容器\"><a class=\"anchor\" href=\"#1-初始化容器\">#</a> 1. 初始化容器</h4>\n<h5 id=\"1-1-初始化容器的用途\"><a class=\"anchor\" href=\"#1-1-初始化容器的用途\">#</a> 1. 1 初始化容器的用途</h5>\n<p>初始化容器主要是在主应用启动之前，做一些初始化的操作，比如创建文件、修改内核参数、等待依赖程序启动或其他需要在主程序启动之前需要做的工作。</p>\n<ul>\n<li>Init 容器可以包含一些安装过程中应用容器中不存在的实用工具或个性化代码；</li>\n<li>Init 容器可以安全地运行这些工具，避免这些工具导致应用镜像的安全性降低；</li>\n<li>Init 容器可以以 root 身份运行，执行一些高权限命令；</li>\n<li>Init 容器相关操作执行完成以后即退出，不会给业务容器带来安全隐患。</li>\n</ul>\n<h5 id=\"12-初始化容器和poststart区别\"><a class=\"anchor\" href=\"#12-初始化容器和poststart区别\">#</a> 1.2 初始化容器和 PostStart 区别</h5>\n<p>PostStart：依赖主应用的环境，而且并不一定先于 Command 运行。</p>\n<p>InitContainer：不依赖主应用的环境，可以有更高的权限和更多的工具，一定会在主应用启动之前完成</p>\n<h5 id=\"13-初始化容器和普通容器的区别\"><a class=\"anchor\" href=\"#13-初始化容器和普通容器的区别\">#</a> 1.3 初始化容器和普通容器的区别</h5>\n<p>Init 容器与普通的容器非常像，除了如下几点：</p>\n<ul>\n<li>\n<p>第一个 Init 容器运行成功后才会运行下一个 Init 容器；</p>\n</li>\n<li>\n<p>所有的 Init 容器运行成功后才会运行主容器；</p>\n</li>\n<li>\n<p>如果 Pod 的 Init 容器失败，Kubernetes 会不断地重启该 Pod，直到 Init 容器成功为止，但是 Pod 对应的 restartPolicy 值为 Never，Kubernetes 不会重新启动 Pod。</p>\n</li>\n<li>\n<p>Init 容器不支持 lifecycle、livenessProbe、readinessProbe 和 startupProbe</p>\n</li>\n</ul>\n<h5 id=\"14-初始化容器示例\"><a class=\"anchor\" href=\"#14-初始化容器示例\">#</a> 1.4 初始化容器示例</h5>\n<pre><code>[root@k8s-master01 ~]# cat init.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      initContainers:           # 初始化容器设定\n      - name: fix-permissions\n        image: busybox\n        command: [&quot;sh&quot;,&quot;-c&quot;,&quot;echo hello kubernetes&gt;/usr/share/nginx/html/index.html&quot;]\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: share-volume\n          mountPath: /usr/share/nginx/html\n      containers:\n      - image: nginx\n        name: nginx\n        volumeMounts:\n        - name: timezone\n          mountPath: /etc/timezone\n        - name: tz-config\n          mountPath: /usr/share/zoneinfo/Asia/Shanghai\n        - name: tz-config\n          mountPath: /etc/localtime\n        - name: share-volume\n          mountPath: /usr/share/nginx/html\n      volumes:\n      - name: share-volume\n        emptyDir: &#123;&#125;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: File\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: File\n\n[root@k8s-master01 ~]# kubectl create -f init.yaml\n\n[root@k8s-master01 ~]# curl 172.16.32.145\nhello kubernetes\n</code></pre>\n<h4 id=\"2-临时容器\"><a class=\"anchor\" href=\"#2-临时容器\">#</a> 2. 临时容器</h4>\n<h5 id=\"21-注入临时容器到pod\"><a class=\"anchor\" href=\"#21-注入临时容器到pod\">#</a> 2.1 注入临时容器到 Pod</h5>\n<pre><code>[root@k8s-master01 ~]# kubectl get pods\nNAME                            READY   STATUS    RESTARTS      AGE\nnginx-deploy-7dd6cd4b44-ktw5k   1/1     Running   1             16h\nnginx-deploy-7dd6cd4b44-mjcgq   1/1     Running   1 (28m ago)   16h\nnginx-deploy-7dd6cd4b44-wdm6p   1/1     Running   1 (28m ago)   16h\n\n#1.进入容器发现pod没有ps和netstat命令\n[root@k8s-master01 ~]# kubectl exec -it nginx-deploy-7dd6cd4b44-ktw5k  -- bash\nroot@nginx-deploy-7dd6cd4b44-ktw5k:/# ps aux\nroot@nginx-deploy-7dd6cd4b44-ktw5k:/# netstat -lntp\n\n#2.注入临时容器至该Pod\n[root@k8s-master01 ~]# kubectl debug nginx-deploy-7dd6cd4b44-wdm6p -ti --image=registry.cn-hangzhou.aliyuncs.com/old_xu/debug-tools\n</code></pre>\n<h5 id=\"21-注入临时容器到节点\"><a class=\"anchor\" href=\"#21-注入临时容器到节点\">#</a> 2.1 注入临时容器到节点</h5>\n<pre><code>kubectl debug node k8s-node01 -it --image=registry.cn-hangzhou.aliyuncs.com/old_xu/debug-tools\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3833778957.html",
            "url": "http://ixuyong.cn/posts/3833778957.html",
            "title": "K8s计划任务Job、Cronjob",
            "date_published": "2025-04-19T13:00:21.000Z",
            "content_html": "<h3 id=\"k8s计划任务job-cronjob\"><a class=\"anchor\" href=\"#k8s计划任务job-cronjob\">#</a> K8s 计划任务 Job、Cronjob</h3>\n<h4 id=\"1-job配置参数详解\"><a class=\"anchor\" href=\"#1-job配置参数详解\">#</a> 1. Job 配置参数详解</h4>\n<pre><code># cat job.yaml \napiVersion: batch/v1\nkind: Job\nmetadata:\n  labels:\n    job-name: echo\n  name: echo\n  namespace: default\nspec:\n  #suspend: true # 1.21+\n  #ttlSecondsAfterFinished: 100\n  backoffLimit: 4\n  completions: 1\n  parallelism: 1\n  template:\n    spec:\n      containers:\n      - name: echo\n        image: busybox\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - echo &quot;Hello Job&quot;\n      restartPolicy: Never\n      \n[root@k8s-master01 ~]# kubectl get jobs\nNAME   STATUS     COMPLETIONS   DURATION   AGE\necho   Complete   1/1           70s        2m5s\n\n[root@k8s-master01 ~]# kubectl get pods\nNAME          READY   STATUS      RESTARTS      AGE\necho-564c8    0/1     Completed   0             2m10s\n\n[root@k8s-master01 ~]# kubectl logs echo-564c8\nHello Job\n</code></pre>\n<ul>\n<li>backoffLimit:：如果任务执行失败，失败多少次后不再执行</li>\n<li>completions：有多少个 Pod 执行成功，认为任务是成功的，默认为空和 parallelism 数值一样</li>\n<li>parallelism：并行执行任务的数量，如果 parallelism 数值大于 completions 数值，只会创建 completions 的数量；如果 completions 是 4，并发是 3，第一次会创建 3 个 Pod 执行任务，第二次只会创建一个 Pod 执行任务</li>\n<li>ttlSecondsAfterFinished：Job 在执行结束之后（状态为 completed 或 Failed）自动清理。设置为 0 表示执行结束立即删除，不设置则不会清除，需要开启 TTLAfterFinished 特性</li>\n</ul>\n<h4 id=\"2-cronjob配置参数详解\"><a class=\"anchor\" href=\"#2-cronjob配置参数详解\">#</a> 2. CronJob 配置参数详解</h4>\n<pre><code># cat cronjob.yaml \napiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: hello\nspec:\n  schedule: &quot;*/1 * * * *&quot;\n  concurrencyPolicy: Allow   #允许同时运行多个任务\n  failedJobsHistoryLimit: 10  #保留多少失败的任务\n  successfulJobsHistoryLimit: 10  #保留多少已完成的任务\n  #suspend: true             #如果true则取消周期性执行任务\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: hello\n            image: busybox\n            command:\n            - sh\n            - -c\n            - date; echo Hello from the Kubernetes cluster\n          restartPolicy: OnFailure \n          \n[root@k8s-master01 ~]# kubectl get  cj\nNAME    SCHEDULE      TIMEZONE   SUSPEND   ACTIVE   LAST SCHEDULE   AGE\nhello   */1 * * * *   &lt;none&gt;     False     0        6s              81s\n\n[root@k8s-master01 ~]# kubectl get  jobs\nNAME             STATUS     COMPLETIONS   DURATION   AGE\nhello-29084454   Complete   1/1           4s         72s\nhello-29084455   Complete   1/1           5s         12s\n\n[root@k8s-master01 ~]# kubectl get  pods\nNAME                   READY   STATUS      RESTARTS   AGE\nhello-29084454-hwv7p   0/1     Completed   0          78s\nhello-29084455-vf99w   0/1     Completed   0          18s\n\n[root@k8s-master01 ~]# kubectl logs -f hello-29084455-vf99w\nSat Apr 19 12:55:02 UTC 2025\nHello from the Kubernetes cluster\n</code></pre>\n<ul>\n<li>apiVersion: batch/v1beta1   #1.21+ batch/v1</li>\n<li>schedule：调度周期，和 Linux 一致，分别是分时日月周。</li>\n<li>restartPolicy：重启策略，和 Pod 一致。</li>\n<li>concurrencyPolicy：并发调度策略。可选参数如下：\n<ul>\n<li>Allow：允许同时运行多个任务。</li>\n<li>Forbid：不允许并发运行，如果之前的任务尚未完成，新的任务不会被创建。</li>\n<li>Replace：如果之前的任务尚未完成，新的任务会替换的之前的任务。</li>\n</ul>\n</li>\n<li>suspend：如果设置为 true，则暂停后续的任务，默认为 false。</li>\n<li>successfulJobsHistoryLimit：保留多少已完成的任务，按需配置。</li>\n<li>failedJobsHistoryLimit：保留多少失败的任务。</li>\n</ul>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/169153047.html",
            "url": "http://ixuyong.cn/posts/169153047.html",
            "title": "K8s持久化存储",
            "date_published": "2025-04-18T14:25:17.000Z",
            "content_html": "<h3 id=\"k8s持久化存储\"><a class=\"anchor\" href=\"#k8s持久化存储\">#</a> K8s 持久化存储</h3>\n<h4 id=\"1-volume\"><a class=\"anchor\" href=\"#1-volume\">#</a> 1. Volume</h4>\n<p>Container（容器）中的磁盘文件是短暂的，当容器崩溃时，kubelet 会重新启动容器，Container 会以最干净的状态启动，最初的文件将丢失。另外，当一个 Pod 运行多个 Container 时，各个容器可能需要共享一些文件。Kubernetes Volume 可以解决这两个问题。</p>\n<ul>\n<li>一些需要持久化数据的程序才会用到 Volumes，或者一些需要共享数据的容器需要 volumes。</li>\n<li>日志收集的需求需要在应用程序的容器里面加一个 sidecar，这个容器是一个收集日志的容器，比如 filebeat，它通过 volumes 共享应用程序的日志文件目录。</li>\n</ul>\n<h5 id=\"11-emptydir实现数据共享\"><a class=\"anchor\" href=\"#11-emptydir实现数据共享\">#</a> 1.1 EmptyDir 实现数据共享</h5>\n<p>和上述 volume 不同的是，如果删除 Pod，emptyDir 卷中的数据也将被删除，一般 emptyDir 卷用于 Pod 中的不同 Container 共享数据。</p>\n<pre><code># cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      restartPolicy: Always\n      volumes:\n        - name: share-volume\n          emptyDir: &#123;&#125;\n      containers:\n        - name: nginx\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          volumeMounts:\n            - name: share-volume\n              mountPath: /opt\n        - name: nginx2\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          command:\n            - sh\n            - '-c'\n            - sleep 3600\n          volumeMounts:\n            - name: share-volume\n              mountPath: /mnt\n</code></pre>\n<h5 id=\"12-volumes-hostpath挂载宿主机路径\"><a class=\"anchor\" href=\"#12-volumes-hostpath挂载宿主机路径\">#</a> 1.2 Volumes HostPath 挂载宿主机路径</h5>\n<p>hostPath 卷可将节点上的文件或目录挂载到 Pod 上，用于 Pod 自定义日志输出或访问 Docker 内部的容器等。</p>\n<pre><code>[root@k8s-master01 ~]# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      restartPolicy: Always\n      volumes:\n      - name: share-volume\n        emptyDir: &#123;&#125;\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n      containers:\n        - name: nginx\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          volumeMounts:\n          - name: share-volume\n            mountPath: /opt\n          - name: tz-config\n            mountPath: /usr/share/zoneinfo/Asia/Shanghai\n          - name: tz-config\n            mountPath: /etc/localtime\n          - name: timezone\n            mountPath: /etc/timezone\n        - name: nginx2\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          command:\n            - sh\n            - '-c'\n            - sleep 3600\n          volumeMounts:\n          - name: share-volume\n            mountPath: /mnt\n</code></pre>\n<p>hostPath 卷常用的 type（类型）如下：</p>\n<ul>\n<li>type 为空字符串：默认选项，意味着挂载 hostPath 卷之前不会执行任何检查。</li>\n<li>DirectoryOrCreate：如果给定的 path 不存在任何东西，那么将根据需要创建一个权限为 0755 的空目录，和 Kubelet 具有相同的组和权限。</li>\n<li>Directory：目录必须存在于给定的路径下。</li>\n<li>FileOrCreate：如果给定的路径不存储任何内容，则会根据需要创建一个空文件，权限设置为 0644，和 Kubelet 具有相同的组和所有权。</li>\n<li>File：文件，必须存在于给定路径中。</li>\n<li>Socket：UNIX 套接字，必须存在于给定路径中。</li>\n<li>CharDevice：字符设备，必须存在于给定路径中。</li>\n<li>BlockDevice：块设备，必须存在于给定路径中。</li>\n</ul>\n<h5 id=\"13-挂载nfs至容器\"><a class=\"anchor\" href=\"#13-挂载nfs至容器\">#</a> 1.3 挂载 NFS 至容器</h5>\n<pre><code>#1.安装nfs\n# yum install nfs-utils -y       \n# mkdir /data/nfs -p\n# vim /etc/exports \n/data 192.168.1.0/24(rw,no_root_squash)\n# exportfs -arv   \n# systemctl start nfs-server &amp;&amp; systemctl enable nfs-server &amp;&amp; systemctl status nfs-server \n\n#2.测试客户端挂载\n# showmount -e 192.168.1.75\n# mount -t nfs 192.168.1.75:/data/nfs /mnt\n\n#3.Deploy挂载NFS\n[root@k8s-master01 ~]# cat nginx-deploy-nfs.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n      annotations:\n        app: nginx-deploy\n    spec:\n      restartPolicy: Always\n      volumes:\n      - name: nfs-volume\n        nfs:\n          server: 192.168.1.75\n          path: /data/nfs\n      - name: tz-config\n        hostPath:\n          path: /usr/share/zoneinfo/Asia/Shanghai\n          type: &quot;&quot;\n      - name: timezone\n        hostPath:\n          path: /etc/timezone\n          type: &quot;&quot;\n      containers:\n        - name: nginx-deploy\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n          volumeMounts:\n          - name: nfs-volume\n            mountPath: /usr/share/nginx/html\n          - name: tz-config\n            mountPath: /usr/share/zoneinfo/Asia/Shanghai\n          - name: tz-config\n            mountPath: /etc/localtime\n          - name: timezone\n            mountPath: /etc/timezone\n</code></pre>\n<h4 id=\"2-pv-pvc\"><a class=\"anchor\" href=\"#2-pv-pvc\">#</a> 2. PV、PVC</h4>\n<p>PersistentVolume：简称 PV，是由 Kubernetes 管理员设置的存储，可以配置 Ceph、NFS、GlusterFS 等常用存储配置，相对于 Volume 配置，提供了更多的功能，比如生命周期的管理、大小的限制。PV 分为静态和动态。</p>\n<p>PersistentVolumeClaim：简称 PVC，是对存储 PV 的请求，表示需要什么类型的 PV，需要存储的技术人员只需要配置 PVC 即可使用存储，或者 Volume 配置 PVC 的名称即可。</p>\n<h5 id=\"21-pv回收策略\"><a class=\"anchor\" href=\"#21-pv回收策略\">#</a> 2.1 PV 回收策略</h5>\n<ul>\n<li>Retain：保留，该策略允许手动回收资源，当删除 PVC 时，PV 仍然存在，PV 被视为已释放，管理员可以手动回收卷。</li>\n<li>Recycle：回收，如果 Volume 插件支持，Recycle 策略会对卷执行 rm -rf 清理该 PV，并使其可用于下一个新的 PVC，但是本策略将来会被弃用，目前只有 NFS 和 HostPath 支持该策略。</li>\n<li>Delete：删除，如果 Volume 插件支持，删除 PVC 时会同时删除 PV，动态卷默认为 Delete，目前支持 Delete 的存储后端包括 AWS EBS, GCE PD, Azure Disk, or OpenStack Cinder 等。</li>\n<li>可以通过 persistentVolumeReclaimPolicy: Recycle 字段配置</li>\n</ul>\n<h5 id=\"22-pv访问策略\"><a class=\"anchor\" href=\"#22-pv访问策略\">#</a> 2.2 PV 访问策略</h5>\n<ul>\n<li>ReadWriteOnce：可以被单节点以读写模式挂载，命令行中可以被缩写为 RWO。</li>\n<li>ReadOnlyMany：可以被多个节点以只读模式挂载，命令行中可以被缩写为 ROX。</li>\n<li>ReadWriteMany：可以被多个节点以读写模式挂载，命令行中可以被缩写为 RWX。</li>\n<li>ReadWriteOncePod ：只允许被单个 Pod 访问，需要 K8s 1.22 + 以上版本，并且是 CSI 创建的 PV 才可使用，缩写为 RWOP</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Volume Plugin</th>\n<th style=\"text-align:center\">ReadWriteOnce</th>\n<th style=\"text-align:center\">ReadOnlyMany</th>\n<th style=\"text-align:center\">ReadWriteMany</th>\n<th style=\"text-align:center\">ReadWriteOncePod</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">AzureFile</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CephFS</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CSI</td>\n<td style=\"text-align:center\">depends on the driver</td>\n<td style=\"text-align:center\">depends on the driver</td>\n<td style=\"text-align:center\">depends on the driver</td>\n<td style=\"text-align:center\">depends on the driver</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">FC</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">FlexVolume</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">depends on the driver</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">HostPath</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">iSCSI</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">NFS</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">RBD</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">VsphereVolume</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">- (works when Pods are collocated)</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PortworxVolume</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">✓</td>\n<td style=\"text-align:center\">-</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"23-存储分类\"><a class=\"anchor\" href=\"#23-存储分类\">#</a> 2.3 存储分类</h5>\n<ul>\n<li>文件存储：一些数据可能需要被多个节点使用，比如用户的头像、用户上传的文件等，实现方式：NFS、NAS、FTP、CephFS 等。</li>\n<li>块存储：一些数据只能被一个节点使用，或者是需要将一块裸盘整个挂载使用，比如数据库、Redis 等，实现方式：Ceph、GlusterFS、公有云。</li>\n<li>对象存储：由程序代码直接实现的一种存储方式，云原生应用无状态化常用的实现方式，实现方式：一般是符合 S3 协议的云存储，比如 AWS 的 S3 存储、Minio、七牛云等。</li>\n</ul>\n<h5 id=\"24-pv配置示例nfs\"><a class=\"anchor\" href=\"#24-pv配置示例nfs\">#</a> 2.4 PV 配置示例 NFS</h5>\n<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: nfs-pv1\nspec:\n  capacity:\n    storage: 5Gi\n  volumeMode: Filesystem\n  accessModes:\n    - ReadWriteOnce\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: nfs-slow\n  nfs:\n    path: /data/pv1\n    server: 192.168.1.75\n</code></pre>\n<p>capacity：容量配置</p>\n<p>volumeMode：卷的模式，目前支持 Filesystem（文件系统） 和 Block（块），其中 Block 类型需要后端存储支持，默认为文件系统</p>\n<p>accessModes：该 PV 的访问模式</p>\n<p>storageClassName：PV 的类，一个特定类型的 PV 只能绑定到特定类别的 PVC；</p>\n<p>persistentVolumeReclaimPolicy：回收策略</p>\n<p>mountOptions：非必须，新版本中已弃用</p>\n<p>nfs：NFS 服务配置，包括以下两个选项</p>\n<ul>\n<li>path：NFS 上的共享目录</li>\n<li>server：NFS 的 IP 地址</li>\n</ul>\n<h5 id=\"25-pv配置示例hostpath\"><a class=\"anchor\" href=\"#25-pv配置示例hostpath\">#</a> 2.5 PV 配置示例 HostPath</h5>\n<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: hostpath\nspec:\n  capacity:\n    storage: 5Gi\n  volumeMode: Filesystem\n  accessModes:\n    - ReadWriteOnce\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: hostpath\n  hostPath:\n    path: &quot;/mnt/data&quot;\n</code></pre>\n<p>hostPath：hostPath 服务配置</p>\n<ul>\n<li>path：宿主机路径</li>\n</ul>\n<h5 id=\"26-pv的状态\"><a class=\"anchor\" href=\"#26-pv的状态\">#</a> 2.6 PV 的状态</h5>\n<ul>\n<li>Available：可用，没有被 PVC 绑定的空闲资源。</li>\n<li>Bound：已绑定，已经被 PVC 绑定。</li>\n<li>Released：已释放，PVC 被删除，但是资源还未被重新使用。</li>\n<li>Failed：失败，自动回收失败。</li>\n</ul>\n<h5 id=\"27-pvc绑定pv\"><a class=\"anchor\" href=\"#27-pvc绑定pv\">#</a> 2.7 PVC 绑定 PV</h5>\n<pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: nfs-pvc\nspec:\n  storageClassName: nfs-slow\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 5Gi      \n</code></pre>\n<ul>\n<li>PVC 的空间申请大小≤PV 的大小</li>\n<li>PVC 的 StorageClassName 和 PV 的一致</li>\n<li>PVC 的 accessModes 和 PV 的一致</li>\n</ul>\n<h5 id=\"28-depoyment挂载pvc\"><a class=\"anchor\" href=\"#28-depoyment挂载pvc\">#</a> 2.8 Depoyment 挂载 PVC</h5>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      volumes:\n      - name: nfs-pvc-storage  #volume名称\n        persistentVolumeClaim:\n          claimName: nfs-pvc   #PVC名称\n      containers:\n      - image: nginx\n        name: nginx\n        volumeMounts:\n         - name: nfs-pvc-storage\n          mountPath: /usr/share/nginx/html\n</code></pre>\n<p>挂载 PVC 的 Pod 一直处于 Pending：</p>\n<ul>\n<li>PVC 没有创建成功或 PVC 不存在</li>\n<li>PVC 和 Pod 不在同一个 Namespace</li>\n</ul>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3992668367.html",
            "url": "http://ixuyong.cn/posts/3992668367.html",
            "title": "K8s配置管理Configmap",
            "date_published": "2025-04-14T13:47:47.000Z",
            "content_html": "<h3 id=\"k8s配置管理configmap\"><a class=\"anchor\" href=\"#k8s配置管理configmap\">#</a> K8s 配置管理 Configmap</h3>\n<h4 id=\"1-configmap\"><a class=\"anchor\" href=\"#1-configmap\">#</a> 1. Configmap</h4>\n<h5 id=\"1-1-基于from-env-file创建configmap\"><a class=\"anchor\" href=\"#1-1-基于from-env-file创建configmap\">#</a> 1. 1 基于 from-env-file 创建 Configmap</h5>\n<pre><code># cat cm_env.conf \npodname=nf-flms-system\npodip=192.168.1.100\nenv=prod\nnacosaddr=nacos.svc.cluster.local\n\n#kubectl create cm cmenv --from-env-file=./cm_env.conf \n</code></pre>\n<h5 id=\"12-基于from-literal创建configmap\"><a class=\"anchor\" href=\"#12-基于from-literal创建configmap\">#</a> 1.2 基于 from-literal 创建 Configmap</h5>\n<pre><code># kubectl create cm cmliteral --from-literal=level=INFO --from-literal=passwd=Superman*2023\n</code></pre>\n<h5 id=\"13-基于from-file创建configmap\"><a class=\"anchor\" href=\"#13-基于from-file创建configmap\">#</a> 1.3 基于 from-file 创建 Configmap</h5>\n<pre><code># cat s.hmallleasing.com.conf \nserver &#123;\n    listen 80;\n    server_name s.hmallleasing.com;\n    client_max_body_size 1G; \n    location / &#123;\n        proxy_pass http://192.168.1.134;\n        proxy_set_header Host $http_host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        \n        proxy_connect_timeout 30;\n        proxy_send_timeout 60;\n        proxy_read_timeout 60;\n        \n        proxy_buffering on;\n        proxy_buffer_size 32k;\n        proxy_buffers 4 128k;\n        proxy_temp_file_write_size 10240k;\t\t\n        proxy_max_temp_file_size 10240k;\n    &#125;\n&#125;\n\nserver &#123;\n    listen 80;\n    server_name s.hmallleasing.com;\n    return 302 https://$server_name$request_uri;\n&#125;\n\n# kubectl create cm nginxconfig --from-file=./s.hmallleasing.com.conf\n</code></pre>\n<h5 id=\"14-deployment挂载configmap示例\"><a class=\"anchor\" href=\"#14-deployment挂载configmap示例\">#</a> 1.4 Deployment 挂载 configmap 示例</h5>\n<pre><code>[root@k8s-master01 cm]# cat deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      imagePullSecrets:        \n      - name: harboradmin\n      containers:\n      - image: nginx\n        name: nginx\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        envFrom:         # 1.批量挂载ConfigMap生成环境变量\n        - configMapRef:\n            name: cmenv\n        env:\n        - name: MYSQL_ADDR     # 2.自定义环境变量\n          value: &quot;192.168.40.150&quot;\n        - name: MYSQL_PASSWD\n          value: Superman*2022\n        - name: LOG_LEVEL           # 3.挂载单个ConfigMap生成环境变量，这里和ConfigMap中的键名是不一样的     \n          valueFrom:\n            configMapKeyRef:\n              name: cmliteral       # 这个值来自ConfigMap\n              key: level            # 来自ConfigMap的key\n        volumeMounts:              \n        - name: nginx-config\n          mountPath: &quot;/etc/nginx/conf.d&quot;\n          readOnly: true\n      volumes:\n      - name: nginx-config\n        configMap:\n          name: nginxconfig      # 提供你想要挂载的 ConfigMap 的名字\n</code></pre>\n<h5 id=\"15-重命名挂载的configmaq-key的名称\"><a class=\"anchor\" href=\"#15-重命名挂载的configmaq-key的名称\">#</a> 1.5 重命名挂载的 configmaq key 的名称</h5>\n<pre><code>[root@k8s-master01 cm]# cat deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      imagePullSecrets:        \n      - name: harboradmin\n      containers:\n      - image: nginx\n        name: nginx\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        envFrom:         # 1.批量挂载ConfigMap生成环境变量\n        - configMapRef:\n            name: cmenv\n        env:\n        - name: MYSQL_ADDR     # 2.自定义环境变量\n          value: &quot;192.168.40.150&quot;\n        - name: MYSQL_PASSWD\n          value: Superman*2022\n        - name: LOG_LEVEL           # 3.挂载单个ConfigMap生成环境变量，这里和ConfigMap中的键名是不一样的     \n          valueFrom:\n            configMapKeyRef:\n              name: cmliteral       # 这个值来自ConfigMap\n              key: level            # 来自ConfigMap的key\n        volumeMounts:              \n        - name: nginx-config\n          mountPath: &quot;/etc/nginx/conf.d&quot;\n          readOnly: true\n      volumes:\n      - name: nginx-config\n        configMap:\n          name: nginxconfig      # 提供你想要挂载的 ConfigMap 的名字\n          items:                # 重命名挂载的configmaq key的名称为nginx.conf\n          - key: s.hmallleasing.com.conf  \n            path: nginx.conf\n \n#查看挂载的configmaq key的名称重命名为nginx.conf\n[root@k8s-master01 cm]# kubectl get pods\nNAME                           READY   STATUS    RESTARTS   AGE\nnginx-deploy-bc476bc56-flln4   1/1     Running   0          10h\nnginx-deploy-bc476bc56-jhsh6   1/1     Running   0          10h\nnginx-deploy-bc476bc56-splv9   1/1     Running   0          10h\n[root@k8s-master01 cm]# kubectl exec -it nginx-deploy-bc476bc56-flln4 -- bash\nroot@nginx-deploy-bc476bc56-flln4:/# ls /etc/nginx/conf.d/\nnginx.conf\n</code></pre>\n<h5 id=\"16-修改挂载的configmaq-权限\"><a class=\"anchor\" href=\"#16-修改挂载的configmaq-权限\">#</a> 1.6 修改挂载的 configmaq 权限</h5>\n<pre><code>[root@k8s-master01 cm]# cat deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      imagePullSecrets:        \n      - name: harboradmin\n      containers:\n      - image: nginx\n        name: nginx\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        envFrom:         # 1.批量挂载ConfigMap生成环境变量\n        - configMapRef:\n            name: cmenv\n        env:\n        - name: MYSQL_ADDR     # 2.自定义环境变量\n          value: &quot;192.168.40.150&quot;\n        - name: MYSQL_PASSWD\n          value: Superman*2022\n        - name: LOG_LEVEL           # 3.挂载单个ConfigMap生成环境变量，这里和ConfigMap中的键名是不一样的     \n          valueFrom:\n            configMapKeyRef:\n              name: cmliteral       # 这个值来自ConfigMap\n              key: level            # 来自ConfigMap的key\n        volumeMounts:              \n        - name: nginx-config\n          mountPath: &quot;/etc/nginx/conf.d&quot;\n          readOnly: true\n      volumes:\n      - name: nginx-config\n        configMap:\n          name: nginxconfig      # 提供你想要挂载的 ConfigMap 的名字\n          items:                # 重命名挂载的configmaq key的名称为nginx.conf\n          - key: s.hmallleasing.com.conf  \n            path: nginx.conf\n            mode: 0644        # 配置挂载权限，针对单个key生效\n          defaultMode: 0666   # 配置挂载权限，针对整个key生效\n    \n#查看挂载权限\nroot@nginx-deploy-7657fbffc7-k75l5:/# ls -l /etc/nginx/conf.d/nginx.conf \nlrwxrwxrwx 1 root root 17 Apr 16 13:37 /etc/nginx/conf.d/nginx.conf -&gt; ..data/nginx.conf\nroot@nginx-deploy-7657fbffc7-k75l5:/# ls -l /etc/nginx/conf.d/..data/nginx.conf \n-rw-rw-rw- 1 root root 722 Apr 16 13:37 /etc/nginx/conf.d/..data/nginx.conf\n</code></pre>\n<h5 id=\"17-subpath解决挂载覆盖问题\"><a class=\"anchor\" href=\"#17-subpath解决挂载覆盖问题\">#</a> 1.7 subpath 解决挂载覆盖问题</h5>\n<pre><code>#1.创建configmap\n[root@k8s-master01 cm]# cat nginx.conf \n\nuser  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\n\nevents &#123;\n    worker_connections  512;\n&#125;\n\n\nhttp &#123;\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n\n    log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '\n                      '$status $body_bytes_sent &quot;$http_referer&quot; '\n                      '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    include /etc/nginx/conf.d/*.conf;\n&#125;\n\n[root@k8s-master01 cm]# kubectl create cm nginx-config --from-file=./nginx.conf\n\n#subpath解决挂载覆盖问题\n[root@k8s-master01 study]# cat cm-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      imagePullSecrets:        \n      - name: harboradmin\n      containers:\n      - image: nginx\n        name: nginx\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        envFrom:         # ①批量挂载ConfigMap生成环境变量\n        - configMapRef:\n            name: cmenv\n        env:\n        - name: MYSQL_ADDR     # ②自定义环境变量\n          value: &quot;192.168.40.150&quot;\n        - name: MYSQL_PASSWD\n          value: Superman*2022\n        - name: LOG_LEVEL           # ③挂载单个ConfigMap生成环境变量，这里和ConfigMap中的键名是不一样的     \n          valueFrom:\n            configMapKeyRef:\n              name: cmliteral       # 这个值来自ConfigMap\n              key: level            # 来自ConfigMap的key\n        volumeMounts:\n        - name: config\n          mountPath: &quot;/etc/nginx/nginx.conf&quot;   #只挂在nginx.conf一个文件,不覆盖目录\n          subPath: nginx.conf      \n      volumes:\n      - name: config\n        configMap:\n          name: nginx-config      # 提供你想要挂载的ConfigMap的名字\n</code></pre>\n<h4 id=\"2-secret\"><a class=\"anchor\" href=\"#2-secret\">#</a> 2. Secret</h4>\n<h5 id=\"21-secret拉取私有仓库镜像\"><a class=\"anchor\" href=\"#21-secret拉取私有仓库镜像\">#</a> 2.1 Secret 拉取私有仓库镜像</h5>\n<pre><code># kubectl create secret docker-registry harboradmin \\\n--docker-server=s.hmallleasing.com \\\n--docker-username=admin \\\n--docker-password=Superman*2023 \n</code></pre>\n<h5 id=\"22-创建ssl-secret\"><a class=\"anchor\" href=\"#22-创建ssl-secret\">#</a> 2.2 创建 ssl Secret</h5>\n<pre><code># kubectl create secret tls dev.hmallleasig.com --key *.hmallleasing.com_key.key --cert *.hmallleasing.com_chain.crt -n dev\n</code></pre>\n<h5 id=\"23-基于命令创建generic-secret\"><a class=\"anchor\" href=\"#23-基于命令创建generic-secret\">#</a> 2.3 基于命令创建 generic Secret</h5>\n<pre><code>#1.通过from-env-file创建\n# cat db.conf \nusername=xuyong\npasswd=Superman*2023\n\n# kubectl create secret generic dbconf --from-env-file=./db.conf\n\n#2.通过from-literal创建\nkubectl create secret generic db-user-pass \\\n    --from-literal=username=admin \\\n    --from-literal=password='S!B\\*d$zDsb='\n</code></pre>\n<h5 id=\"24-secret加密-解密\"><a class=\"anchor\" href=\"#24-secret加密-解密\">#</a> 2.4 Secret 加密、解密</h5>\n<pre><code>1.加密\n# echo -n &quot;Superman*2023&quot; | base64\nU3VwZXJtYW4qMjAyMw==\n\n2.解密\n# echo &quot;U3VwZXJtYW4qMjAyMw==&quot; | base64 --decode\n</code></pre>\n<h5 id=\"25-基于文件创建非加密generic-secret\"><a class=\"anchor\" href=\"#25-基于文件创建非加密generic-secret\">#</a> 2.5 基于文件创建非加密 generic Secret</h5>\n<pre><code># kubectl get secret dbconf -oyaml\napiVersion: v1\ndata:\n  passwd: U3VwZXJtYW4qMjAyMw==\n  username: eHV5b25n\nkind: Secret\nmetadata:\n  name: dbconf\n  namespace: default\ntype: Opaque\n</code></pre>\n<h5 id=\"2-6-基于yaml创建加密generic-secret\"><a class=\"anchor\" href=\"#2-6-基于yaml创建加密generic-secret\">#</a> 2. 6 基于 yaml 创建加密 generic Secret</h5>\n<pre><code># cat mysql-secret.yaml \napiVersion: v1\nkind: Secret\nmetadata:\n  name: mysql-secret\n  namespace: dev\nstringData:\n  MYSQL_ROOT_PASSWORD: Superman*2023\ntype: Opaque\n</code></pre>\n<h5 id=\"27-deployment挂载secret示例\"><a class=\"anchor\" href=\"#27-deployment挂载secret示例\">#</a> 2.7 Deployment 挂载 Secret 示例</h5>\n<pre><code>[root@k8s-master01 study]# cat cm-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: nginx-deploy\n  name: nginx-deploy\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      imagePullSecrets:        \n      - name: harboradmin\n      containers:\n      - image: nginx\n        name: nginx\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        - name: MYSQL_ROOT_PASSWORD  \n          valueFrom:\n            secretKeyRef:\n              name: mysql-secret\n              key: MYSQL_ROOT_PASSWORD\n</code></pre>\n<h4 id=\"3-configmapsecret热更新\"><a class=\"anchor\" href=\"#3-configmapsecret热更新\">#</a> 3. ConfigMap&amp;Secret 热更新</h4>\n<pre><code># kubectl create cm nginxconfig --from-file=nginx.conf --dry-run=client -oyaml | kubectl replace -f -\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/858611107.html",
            "url": "http://ixuyong.cn/posts/858611107.html",
            "title": "K8s服务发布Service",
            "date_published": "2025-04-14T11:25:51.000Z",
            "content_html": "<h3 id=\"k8s服务发布service\"><a class=\"anchor\" href=\"#k8s服务发布service\">#</a> K8s 服务发布 Service</h3>\n<h4 id=\"1-service类型\"><a class=\"anchor\" href=\"#1-service类型\">#</a> 1. Service 类型</h4>\n<p>Kubernetes Service Type（服务类型）主要包括以下几种：</p>\n<ul>\n<li>ClusterIP：在集群内部使用，默认值，只能从集群中访问。</li>\n<li>NodePort：在所有安装了 Kube-Proxy 的节点上打开一个端口，此端口可以代理至后端 Pod，可以通过 NodePort 从集群外部访问集群内的服务，格式为 NodeIP:NodePort。</li>\n<li>LoadBalancer：使用云提供商的负载均衡器公开服务，成本较高。</li>\n<li>ExternalName：通过返回定义的 CNAME 别名，没有设置任何类型的代理，需要 1.7 或更高版本 kube-dns 支持。</li>\n</ul>\n<h5 id=\"11-nodeport类型\"><a class=\"anchor\" href=\"#11-nodeport类型\">#</a> 1.1 NodePort 类型</h5>\n<p>如果将 Service 的 type 字段设置为 NodePort，则 Kubernetes 将从 --service-node-port-range 参数指定的范围（默认为 30000-32767）中自动分配端口，也可以手动指定 NodePort，创建该 Service 后，集群每个节点都将暴露一个端口，通过某个宿主机的 IP + 端口即可访问到后端的应用。</p>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-svc\n  namespace: default\n  labels:\n    app: nginx-svc\nspec:\n  ports:\n    - port: 80\n      targetPort: 80\n      protocol: TCP\n      name: http\n  selector:\n    app: nginx\n  type: NodePort\n</code></pre>\n<h5 id=\"12-clusterip类型\"><a class=\"anchor\" href=\"#12-clusterip类型\">#</a> 1.2 ClusterIP 类型</h5>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-svc\n  namespace: default\n  labels:\n    app: nginx-svc\nspec:\n  ports:\n    - port: 80\n      targetPort: 80\n      protocol: TCP\n      name: http\n  selector:\n    app: nginx\n  type: ClusterIP\n</code></pre>\n<h5 id=\"13-使用service代理k8s外部服务\"><a class=\"anchor\" href=\"#13-使用service代理k8s外部服务\">#</a> 1.3 使用 Service 代理 K8s 外部服务</h5>\n<p>使用场景：</p>\n<ul>\n<li>希望在生产环境中使用某个固定的名称而非 IP 地址访问外部的中间件服务；</li>\n<li>希望 Service 指向另一个 Namespace 中或其他集群中的服务；</li>\n<li>正在将工作负载转移到 Kubernetes 集群，但是一部分服务仍运行在 Kubernetes 集群之外的 backend。</li>\n</ul>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: mysql-svc-external\n  name: mysql-svc-external\nspec:\n  clusterIP: None\n  ports:\n  - name: mysql\n    port: 3306 \n    protocol: TCP\n    targetPort: 3306\n  type: ClusterIP\n---\napiVersion: v1\nkind: Endpoints\nmetadata:\n  labels:\n    app: mysql-svc-external\n  name: mysql-svc-external\nsubsets:\n- addresses:\n  - ip: 192.168.40.150\n  ports:\n  - name: mysql\n    port: 3306\n    protocol: TCP\n</code></pre>\n<h5 id=\"14-externalname-service\"><a class=\"anchor\" href=\"#14-externalname-service\">#</a> 1.4 ExternalName Service</h5>\n<p>ExternalName Service 是 Service 的特例，它没有 Selector，也没有定义任何端口和 Endpoint，它通过返回该外部服务的别名来提供服务。</p>\n<p>比如可以定义一个 Service，后端设置为一个外部域名，这样通过 Service 的名称即可访问到该域名。使用 nslookup 解析以下文件定义的 Service，集群的 DNS <a href=\"http://xn--my-uu2cmg2cx7mswf9rko5lsx1a5n3h.database.example.com\">服务将返回一个值为 my.database.example.com</a> 的 CNAME 记录：</p>\n<pre><code>kind: Service\napiVersion: v1\nmetadata:\n  name: my-service\n  namespace: prod\nspec:\n  type: ExternalName\n  externalName: my.database.example.com\n</code></pre>\n<h5 id=\"15-多端口-service\"><a class=\"anchor\" href=\"#15-多端口-service\">#</a> 1.5 多端口 Service</h5>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-svc\n  namespace: default\n  labels:\n    app: nginx-svc\nspec:\n  ports:\n    - port: 80\n      targetPort: 80\n      protocol: TCP\n      name: http\n    - port: 443\n      targetPort: 443\n      protocol: TCP\n      name: https\n  selector:\n    app: nginx\n  type: ClusterIP\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/108692210.html",
            "url": "http://ixuyong.cn/posts/108692210.html",
            "title": "K8s资源调度deployment、statefulset、daemonset",
            "date_published": "2025-04-14T11:25:00.000Z",
            "content_html": "<h3 id=\"k8s资源调度deployment-statefulset-daemonset\"><a class=\"anchor\" href=\"#k8s资源调度deployment-statefulset-daemonset\">#</a> K8s 资源调度 deployment、statefulset、daemonset</h3>\n<h4 id=\"1-无状态应用管理-deployment\"><a class=\"anchor\" href=\"#1-无状态应用管理-deployment\">#</a> 1. 无状态应用管理 Deployment</h4>\n<pre><code>[root@k8s-master01 ~]# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx:1.21.0\n          imagePullPolicy: IfNotPresent\n      restartPolicy: Always\n</code></pre>\n<p>示例解析：</p>\n<ol>\n<li>\n<p>nginx-deploy：Deployment 的名称；</p>\n</li>\n<li>\n<p>replicas： 创建 Pod 的副本数；</p>\n</li>\n<li>\n<p>selector：定义 Deployment 如何找到要管理的 Pod，与 template 的 label（标签）对应，apiVersion 为 apps/v1 必须指定该字段；</p>\n</li>\n<li>\n<p>template 字段包含以下字段：</p>\n<ul>\n<li>\n<p>app: nginx-deploy 使用 label（标签）标记 Pod；</p>\n</li>\n<li>\n<p>spec：表示 Pod 运行一个名字为 nginx 的容器；</p>\n</li>\n<li>\n<p>image：运行此 Pod 使用的镜像；</p>\n</li>\n<li>\n<p>Port：容器用于发送和接收流量的端口。</p>\n</li>\n</ul>\n</li>\n</ol>\n<h5 id=\"11-更新-deployment\"><a class=\"anchor\" href=\"#11-更新-deployment\">#</a> 1.1 更新 Deployment</h5>\n<p>假如更新 Nginx Pod 的 image 使用 nginx:latest，并使用 --record 记录当前更改的参数，后期回滚时可以查看到对应的信息：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl set image deployment nginx-deploy nginx-deploy=nginx:latest --record\n</code></pre>\n<p>更新过程为新旧交替更新，首先新建一个 Pod，当 Pod 状态为 Running 时，删除一个旧的 Pod，同时再创建一个新的 Pod。当触发一个更新后，会有新的 ReplicaSet 产生，旧的 ReplicaSet 会被保存，查看此时 ReplicaSet，可以从 AGE 或 READY 看出来新旧 ReplicaSet：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get rs\nNAME                      DESIRED   CURRENT   READY   AGE\nnginx-deploy-65bfb77869   0         0         0       50s\nnginx-deploy-85b94dddb4   3         3         3       8s\n</code></pre>\n<p>通过 describe 查看 Deployment 的详细信息：</p>\n<pre><code>[root@k8s-master01 ~]#  kubectl describe deploy nginx-deploy\nName:                   nginx-deploy\nNamespace:              default\nCreationTimestamp:      Mon, 14 Apr 2025 11:28:03 +0800\nLabels:                 app=nginx-deploy\nAnnotations:            app: nginx-deploy\n                        deployment.kubernetes.io/revision: 2\n                        kubernetes.io/change-cause: kubectl set image deployment nginx-deploy nginx-deploy=nginx:latest --record=true\nSelector:               app=nginx-deploy\nReplicas:               3 desired | 3 updated | 3 total | 3 available | 0 unavailable\nStrategyType:           RollingUpdate\nMinReadySeconds:        0\nRollingUpdateStrategy:  25% max unavailable, 25% max surge\nPod Template:\n  Labels:  app=nginx-deploy\n  Containers:\n   nginx-deploy:\n    Image:         nginx:latest\n    Port:          &lt;none&gt;\n    Host Port:     &lt;none&gt;\n    Environment:   &lt;none&gt;\n    Mounts:        &lt;none&gt;\n  Volumes:         &lt;none&gt;\n  Node-Selectors:  &lt;none&gt;\n  Tolerations:     &lt;none&gt;\nConditions:\n  Type           Status  Reason\n  ----           ------  ------\n  Available      True    MinimumReplicasAvailable\n  Progressing    True    NewReplicaSetAvailable\nOldReplicaSets:  nginx-deploy-65bfb77869 (0/0 replicas created)\nNewReplicaSet:   nginx-deploy-85b94dddb4 (3/3 replicas created)\nEvents:\n  Type    Reason             Age   From                   Message\n  ----    ------             ----  ----                   -------\n  Normal  ScalingReplicaSet  71s   deployment-controller  Scaled up replica set nginx-deploy-65bfb77869 from 0 to 3\n  Normal  ScalingReplicaSet  29s   deployment-controller  Scaled up replica set nginx-deploy-85b94dddb4 from 0 to 1\n  Normal  ScalingReplicaSet  28s   deployment-controller  Scaled down replica set nginx-deploy-65bfb77869 from 3 to 2\n  Normal  ScalingReplicaSet  28s   deployment-controller  Scaled up replica set nginx-deploy-85b94dddb4 from 1 to 2\n  Normal  ScalingReplicaSet  27s   deployment-controller  Scaled down replica set nginx-deploy-65bfb77869 from 2 to 1\n  Normal  ScalingReplicaSet  27s   deployment-controller  Scaled up replica set nginx-deploy-85b94dddb4 from 2 to 3\n  Normal  ScalingReplicaSet  26s   deployment-controller  Scaled down replica set nginx-deploy-65bfb77869 from 1 to 0\n</code></pre>\n<p>在 describe 中可以看出，第一次创建时，它创建了一个名为 nginx-deploy-65bfb77869 的 ReplicaSet，并直接将其扩展为 3 个副本。更新部署时，它创建了一个新的 ReplicaSet，命名为 nginx-deploy-85b94dddb4，并将其副本数扩展为 1，然后将旧的 ReplicaSet 缩小为 2，这样至少可以有 2 个 Pod 可用，最多创建了 4 个 Pod。以此类推，使用相同的滚动更新策略向上和向下扩展新旧 ReplicaSet，最终新的 ReplicaSet 可以拥有 3 个副本，并将旧的 ReplicaSet 缩小为 0。</p>\n<h5 id=\"12-回滚-deployment\"><a class=\"anchor\" href=\"#12-回滚-deployment\">#</a> 1.2 回滚 Deployment</h5>\n<p>当更新了版本不稳定或配置不合理时，可以对其进行回滚操作，假设我们又进行了几次更新（此处以更新镜像版本触发更新，更改配置效果类似）：</p>\n<pre><code># kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.1 --record\n# kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.2 --record\n</code></pre>\n<p>使用 kubectl rollout history 查看更新历史：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl rollout history deployment nginx-deploy\ndeployment.apps/nginx-deploy \nREVISION  CHANGE-CAUSE\n1         &lt;none&gt;\n2         kubectl set image deployment nginx-deploy nginx-deploy=nginx:latest --record=true\n3         kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.1 --record=true\n4         kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.2 --record=true\n</code></pre>\n<p>查看 Deployment 某次更新的详细信息，使用 --revision 指定某次更新版本号：</p>\n<pre><code># kubectl rollout history deployment nginx-deploy --revision=4\ndeployment.apps/nginx-deploy with revision #4\nPod Template:\n  Labels:\tapp=nginx-deploy\n\tpod-template-hash=65b576b795\n  Annotations:\tkubernetes.io/change-cause: kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.2 --record=true\n  Containers:\n   nginx-deploy:\n    Image:\tnginx:1.21.2\n    Port:\t&lt;none&gt;\n    Host Port:\t&lt;none&gt;\n    Environment:\t&lt;none&gt;\n    Mounts:\t&lt;none&gt;\n  Volumes:\t&lt;none&gt;\n  Node-Selectors:\t&lt;none&gt;\n  Tolerations:\t&lt;none&gt;\n</code></pre>\n<p>如果只需要回滚到上一个稳定版本，使用 kubectl rollout undo 即可：</p>\n<pre><code># kubectl rollout undo deployment nginx-deploy\n</code></pre>\n<p>再次查看更新历史，发现 REVISION3 回到了 nginx:1.21.1：</p>\n<pre><code># kubectl rollout history deployment nginx-deploy\ndeployment.apps/nginx-deploy \nREVISION  CHANGE-CAUSE\n1         &lt;none&gt;\n2         kubectl set image deployment nginx-deploy nginx-deploy=nginx:latest --record=true\n4         kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.2 --record=true\n5         kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.1 --record=true\n</code></pre>\n<p>如果要回滚到指定版本，使用 --to-revision 参数：</p>\n<pre><code># kubectl rollout undo deployment nginx-deploy --to-revision=2\n</code></pre>\n<h5 id=\"13-扩容-deployment\"><a class=\"anchor\" href=\"#13-扩容-deployment\">#</a> 1.3 扩容 Deployment</h5>\n<p>当公司访问量变大，或者有预期内的活动时，三个 Pod 可能已无法支撑业务时，可以提前对其进行扩展。</p>\n<p>使用 kubectl scale 动态调整 Pod 的副本数，比如增加 Pod 为 5 个：</p>\n<pre><code># kubectl scale deployment nginx-deploy --replicas=5\n</code></pre>\n<p>查看 Pod，此时 Pod 已经变成了 5 个：</p>\n<pre><code># kubectl get pods\nNAME                            READY   STATUS    RESTARTS   AGE\nnginx-deploy-85b94dddb4-2qrh6   1/1     Running   0          2m9s\nnginx-deploy-85b94dddb4-gvkqj   1/1     Running   0          2m10s\nnginx-deploy-85b94dddb4-mdfjs   1/1     Running   0          22s\nnginx-deploy-85b94dddb4-rhgpr   1/1     Running   0          2m8s\nnginx-deploy-85b94dddb4-vwjhl   1/1     Running   0          22s\n</code></pre>\n<h5 id=\"14-暂停和恢复-deployment-更新\"><a class=\"anchor\" href=\"#14-暂停和恢复-deployment-更新\">#</a> 1.4 暂停和恢复 Deployment 更新</h5>\n<p>上述演示的均为更改某一处的配置，更改后立即触发更新，大多数情况下可能需要针对一个资源文件更改多处地方，而并不需要多次触发更新，此时可以使用 Deployment 暂停功能，临时禁用更新操作，对 Deployment 进行多次修改后在进行更新。</p>\n<p>使用 kubectl rollout pause 命令即可暂停 Deployment 更新：</p>\n<pre><code># kubectl rollout pause deployment nginx-deploy\n</code></pre>\n<p>然后对 Deployment 进行相关更新操作，比如先更新镜像，然后对其资源进行限制（如果使用的是 kubectl edit 命令，可以直接进行多次修改，无需暂停更新，kubectlset 命令一般会集成在 CICD 流水线中）：</p>\n<pre><code># kubectl set image deployment nginx-deploy nginx-deploy=nginx:1.21.3\n# kubectl set resources deployment nginx-deploy -c=nginx-deploy --limits=cpu=200m,memory=512Mi\n</code></pre>\n<p>通过 rollout history 可以看到没有新的更新：</p>\n<pre><code>#  kubectl rollout history deployment nginx-deploy\n</code></pre>\n<p>进行完最后一处配置更改后，使用 kubectl rollout resume 恢复 Deployment 更新：</p>\n<pre><code># kubectl rollout resume deployment nginx-deploy\n</code></pre>\n<p>可以查看到恢复更新的 Deployment 创建了一个新的 RS（ReplicaSet 缩写）：</p>\n<pre><code># kubectl get rs\n</code></pre>\n<p>可以查看 Deployment 的 image（镜像）已经变为 nginx:1.21.3</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get pods -oyaml|grep image\n    - image: nginx:1.21.3\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.3\n      imageID: docker.io/library/nginx@sha256:644a70516a26004c97d0d85c7fe1d0c3a67ea8ab7ddf4aff193d9f301670cf36\n    - image: nginx:1.21.3\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.3\n      imageID: docker.io/library/nginx@sha256:644a70516a26004c97d0d85c7fe1d0c3a67ea8ab7ddf4aff193d9f301670cf36\n    - image: nginx:1.21.3\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.3\n      imageID: docker.io/library/nginx@sha256:644a70516a26004c97d0d85c7fe1d0c3a67ea8ab7ddf4aff193d9f301670cf36\n    - image: nginx:1.21.3\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.3\n      imageID: docker.io/library/nginx@sha256:644a70516a26004c97d0d85c7fe1d0c3a67ea8ab7ddf4aff193d9f301670cf36\n    - image: nginx:1.21.3\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.3\n      imageID: docker.io/library/nginx@sha256:644a70516a26004c97d0d85c7fe1d0c3a67ea8ab7ddf4aff193d9f301670cf36\n</code></pre>\n<h5 id=\"15-更新-deployment-的注意事项\"><a class=\"anchor\" href=\"#15-更新-deployment-的注意事项\">#</a> 1.5 更新 Deployment 的注意事项</h5>\n<p>在默认情况下，revision 保留 10 个旧的 ReplicaSet，其余的将在后台进行垃圾回收，可以在.spec.revisionHistoryLimit 设置保留 ReplicaSet 的个数。当设置为 0 时，不保留历史记录。</p>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  namespace: default\n  labels:\n    app: nginx-deploy\nspec:\n  replicas: 5\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx:1.21.3\n          resources:\n            limits:\n              cpu: 200m\n              memory: 512Mi\n          imagePullPolicy: IfNotPresent\n      restartPolicy: Always\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 25%\n      maxSurge: 25%\n  revisionHistoryLimit: 10\n</code></pre>\n<p>更新策略：</p>\n<ul>\n<li>spec.strategy.type==Recreate，表示重建，先删掉旧的 Pod 再创建新的 Pod；</li>\n</ul>\n<pre><code>  strategy:\n    type: Recreate\n</code></pre>\n<ul>\n<li>\n<p>spec.strategy.type==RollingUpdate，表示滚动更新，可以指定 maxUnavailable 和 maxSurge 来控制滚动更新过程；</p>\n<ul>\n<li>\n<p>spec.strategy.rollingUpdate.maxUnavailable，指定在回滚更新时最大不可用的 Pod 数量，可选字段，默认为 25%，可以设置为数字或百分比，如果 maxSurge 为 0，则该值不能为 0；</p>\n</li>\n<li>\n<p>spec.strategy.rollingUpdate.maxSurge 可以超过期望值的最大 Pod 数，可选字段，默认为 25%，可以设置成数字或百分比，如果 maxUnavailable 为 0，则该值不能为 0。</p>\n</li>\n</ul>\n</li>\n</ul>\n<pre><code>  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 25%\n      maxSurge: 25%\n</code></pre>\n<h4 id=\"2-有状态应用管理-statefulset\"><a class=\"anchor\" href=\"#2-有状态应用管理-statefulset\">#</a> 2. 有状态应用管理 StatefulSet</h4>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: web\n  namespace: default\nspec:\n  ports:\n    - port: 80\n      targetPort: 80\n      protocol: TCP\n      name: http\n  selector:\n    app: nginx\n  type: ClusterIP\n  clusterIP: None\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: nginx\n  namespace: default\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n        - name: nginx\n          image: nginx:latest\n          resources:\n            limits:\n              cpu: '1'\n              memory: 1Gi\n            requests:\n              cpu: 100m\n              memory: 128Mi\n      restartPolicy: Always\n  serviceName: web\n</code></pre>\n<ul>\n<li>kind: Service 定义了一个名字为 web 的 Headless Service，创建的 Service 格式为 nginx-0.web.default.svc.cluster.local，其他的类似，因为没有指定 Namespace（命名空间），所以默认部署在 default；</li>\n<li>kind: StatefulSet 定义了一个名字为 nginx 的 StatefulSet，replicas 表示部署 Pod 的副本数，本实例为 3。</li>\n</ul>\n<h5 id=\"21-创建-statefulset\"><a class=\"anchor\" href=\"#21-创建-statefulset\">#</a> 2.1 创建 StatefulSet</h5>\n<pre><code>[root@k8s-master01 ~]# kubectl get pods\nNAME      READY   STATUS    RESTARTS   AGE\nnginx-0   1/1     Running   0          8m51s\nnginx-1   1/1     Running   0          8m50s\nnginx-2   1/1     Running   0          8m48s\n[root@k8s-master01 ~]# kubectl get svc\nNAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE\nkubernetes   ClusterIP   10.96.0.1    &lt;none&gt;        443/TCP   6d1h\nweb          ClusterIP   None         &lt;none&gt;        80/TCP    9m28s\n[root@k8s-master01 ~]# kubectl get sts\nNAME    READY   AGE\nnginx   3/3     8m58s\n</code></pre>\n<h5 id=\"22-statefulset创建pod流程\"><a class=\"anchor\" href=\"#22-statefulset创建pod流程\">#</a> 2.2 StatefulSet 创建 Pod 流程</h5>\n<p>StatefulSet 管理的 Pod 部署和扩展规则如下：</p>\n<ul>\n<li>对于具有 N 个副本的 StatefulSet，将按顺序从 0 到 N-1 开始创建 Pod；</li>\n<li>当删除 Pod 时，将按照 N-1 到 0 的反顺序终止；</li>\n<li>在缩放 Pod 之前，必须保证当前的 Pod 是 Running（运行中）或者 Ready（就绪）；</li>\n<li>在终止 Pod 之前，它所有的继任者必须是完全关闭状态。</li>\n</ul>\n<p>StatefulSet 的 pod.Spec.TerminationGracePeriodSeconds（终止 Pod 的等待时间）不应该指定为 0，设置为 0 对 StatefulSet 的 Pod 是极其不安全的做法，优雅地删除 StatefulSet 的 Pod 是非常有必要的，而且是安全的，因为它可以确保在 Kubelet 从 APIServer 删除之前，让 Pod 正常关闭。</p>\n<p>当创建上面的 Nginx 实例时，Pod 将按 nginx-0、nginx-1、nginx-2 的顺序部署 3 个 Pod。在 nginx-0 处于 Running 或者 Ready 之前，nginx-1 不会被部署，相同的，nginx-2 在 web-1 未处于 Running 和 Ready 之前也不会被部署。如果在 nginx-1 处于 Running 和 Ready 状态时，nginx-0 变成 Failed 失败）状态，那么 nginx-2 将不会被启动，直到 nginx-0 恢复为 Running 和 Ready 状态。</p>\n<p>如果用户将 StatefulSet 的 replicas 设置为 1，那么 nginx-2 将首先被终止，在完全关闭并删除 nginx-2 之前，不会删除 nginx-1。如果 nginx-2 终止并且完全关闭后，nginx-0 突然失败，那么在 nginx-0 未恢复成 Running 或者 Ready 时，nginx-1 不会被删除。</p>\n<h5 id=\"23-tatefulset-扩容和缩容\"><a class=\"anchor\" href=\"#23-tatefulset-扩容和缩容\">#</a> 2.3 tatefulSet 扩容和缩容</h5>\n<p>和 Deployment 类似，可以通过更新 replicas 字段扩容 / 缩容 StatefulSet，也可以使用 kubectlscale、kubectl edit 和 kubectl patch 来扩容 / 缩容一个 StatefulSet。</p>\n<pre><code># kubectl scale sts nginx --replicas=5\n</code></pre>\n<h5 id=\"24-statefulset-更新策略\"><a class=\"anchor\" href=\"#24-statefulset-更新策略\">#</a> 2.4 StatefulSet 更新策略</h5>\n<p><strong>On Delete 策略</strong></p>\n<p>OnDelete 更新策略实现了传统（1.7 版本之前）的行为，它也是默认的更新策略。当我们选择这个更新策略并修改 StatefulSet 的.spec.template 字段时，StatefulSet 控制器不会自动更新 Pod，必须手动删除 Pod 才能使控制器创建新的 Pod。</p>\n<pre><code>  updateStrategy:\n    type: OnDelete\n</code></pre>\n<p><strong>RollingUpdate 策略</strong></p>\n<p>RollingUpdate（滚动更新）更新策略会自动更新一个 StatefulSet 中所有的 Pod，采用与序号索引相反的顺序进行滚动更新。</p>\n<pre><code>  updateStrategy:\n    type: RollingUpdate\n    rollingUpdate:\n      partition: 0\n</code></pre>\n<h5 id=\"25-分段更新\"><a class=\"anchor\" href=\"#25-分段更新\">#</a> 2.5 分段更新</h5>\n<p>将分区改为 2，此时会自动更新 nginx-2、nginx-3、nginx-4（因为之前更改了更新策略），但是不会更新 nginx-0 和 nginx-1：</p>\n<pre><code>  updateStrategy:\n    type: RollingUpdate\n    rollingUpdate:\n      partition: 2\n</code></pre>\n<p>将 sts 镜像为 nginx:1.21.1</p>\n<pre><code># kubectl set image sts nginx nginx=nginx:1.21.1\n</code></pre>\n<p>按照上述方式，可以实现分阶段更新，类似于灰度 / 金丝雀发布。查看最终的结果如下：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get pods -oyaml|grep image\n    - image: nginx:latest\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:latest\n      imageID: docker.io/library/nginx@sha256:fad8e1cd52e24bce7b72cd7cb674a2efad671647b917055f5bd8a1f7ac9b1af8\n    - image: nginx:latest\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:latest\n      imageID: docker.io/library/nginx@sha256:fad8e1cd52e24bce7b72cd7cb674a2efad671647b917055f5bd8a1f7ac9b1af8\n    - image: nginx:1.21.1\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.1\n      imageID: docker.io/library/nginx@sha256:a05b0cdd4fc1be3b224ba9662ebdf98fe44c09c0c9215b45f84344c12867002e\n    - image: nginx:1.21.1\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.1\n      imageID: docker.io/library/nginx@sha256:a05b0cdd4fc1be3b224ba9662ebdf98fe44c09c0c9215b45f84344c12867002e\n    - image: nginx:1.21.1\n      imagePullPolicy: IfNotPresent\n      image: docker.io/library/nginx:1.21.1\n      imageID: docker.io/library/nginx@sha256:a05b0cdd4fc1be3b224ba9662ebdf98fe44c09c0c9215b45f84344c12867002e\n</code></pre>\n<h5 id=\"26-statefulset-挂载动态存储\"><a class=\"anchor\" href=\"#26-statefulset-挂载动态存储\">#</a> 2.6 StatefulSet 挂载动态存储</h5>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  ports:\n  - port: 80\n    name: web\n  clusterIP: None\n  selector:\n    app: nginx\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx \n  serviceName: &quot;nginx&quot;\n  replicas: 3 1\n  template:\n    metadata:\n      labels:\n        app: nginx \n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.20\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n  volumeClaimTemplates:\n  - metadata:\n      name: www\n    spec:\n      accessModes: [ &quot;ReadWriteOnce&quot; ]\n      storageClassName: &quot;rook-ceph-block&quot;\n      resources:\n        requests:\n          storage: 10Gi\n</code></pre>\n<h4 id=\"3守护进程集-daemonset\"><a class=\"anchor\" href=\"#3守护进程集-daemonset\">#</a> 3. 守护进程集 DaemonSet</h4>\n<pre><code>apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nginx-ds\n  labels:\n    app: nginx-ds\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-ds\n  template:\n    metadata:\n      labels:\n        app: nginx-ds\n    spec:\n      containers:\n        - name: nginx-ds\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n</code></pre>\n<p>此时会在每个节点创建一个 Pod：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get pods -o wide\nNAME             READY   STATUS    RESTARTS   AGE   IP               NODE           NOMINATED NODE   READINESS GATES\nnginx-ds-47dxc   1/1     Running   0          56s   172.16.85.213    k8s-node01     &lt;none&gt;           &lt;none&gt;\nnginx-ds-4m89f   1/1     Running   0          56s   172.16.32.143    k8s-master01   &lt;none&gt;           &lt;none&gt;\nnginx-ds-mtpc2   1/1     Running   0          56s   172.16.195.12    k8s-master03   &lt;none&gt;           &lt;none&gt;\nnginx-ds-t5rxc   1/1     Running   0          56s   172.16.122.142   k8s-master02   &lt;none&gt;           &lt;none&gt;\nnginx-ds-x86kc   1/1     Running   0          56s   172.16.58.222    k8s-node02     &lt;none&gt;           &lt;none&gt;\n</code></pre>\n<p>指定节点部署 Pod</p>\n<pre><code>      nodeSelector:\n        ingress: 'true'\n</code></pre>\n<p>更新和回滚 DaemonSet</p>\n<pre><code># kubectl set image ds nginx-ds nginx-ds=1.21.0 --record=true\n# kubectl rollout undo daemonset &lt;daemonset-name&gt; --to-revision=&lt;revision&gt;\n</code></pre>\n<p>DaemonSet 的更新和回滚与 Deployment 类似，此处不再演示。</p>\n<h4 id=\"4-hpa\"><a class=\"anchor\" href=\"#4-hpa\">#</a> 4. HPA</h4>\n<p>创建 deployment、service</p>\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-hpa-svc\n  namespace: default\nspec:\n  ports:\n    - port: 80\n      targetPort: 80\n      protocol: TCP\n      name: http\n  selector:\n    app: nginx-hpa\n  type: ClusterIP\n\n---\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-hpa\n  labels:\n    app: nginx-hpa\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-hpa\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx-hpa\n    spec:\n      restartPolicy: Always\n      containers:\n        - name: nginx-hpa\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          resources:\n            limits:\n              memory: 1024Mi\n              cpu: 1\n            requests:\n              memory: 128Mi\n              cpu: 100m\n</code></pre>\n<p>创建 HPA</p>\n<pre><code># kubectl autoscale deployment nginx-hpa --cpu-percent=10 --min=1 --max=10\n# kubectl get hpa\nNAME        REFERENCE              TARGETS       MINPODS   MAXPODS   REPLICAS   AGE\nnginx-hpa   Deployment/nginx-hpa   cpu: 0%/10%   1         10        1          16s\n\n</code></pre>\n<p>测试自动扩缩容</p>\n<pre><code>while true; do wget -q -O- http://10.96.18.221 &gt; /dev/null; done\n[root@k8s-master01 ~]# kubectl get pods\nNAME                        READY   STATUS    RESTARTS   AGE\nnginx-hpa-d8bcbdf7d-4mkxp   1/1     Running   0          66s\nnginx-hpa-d8bcbdf7d-974q5   1/1     Running   0          6m36s\nnginx-hpa-d8bcbdf7d-g6p2h   1/1     Running   0          66s\nnginx-hpa-d8bcbdf7d-lvvsq   1/1     Running   0          111s\nnginx-hpa-d8bcbdf7d-tgqmr   1/1     Running   0          111s\nnginx-hpa-d8bcbdf7d-tzfbs   1/1     Running   0          21s\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/1771242682.html",
            "url": "http://ixuyong.cn/posts/1771242682.html",
            "title": "K8s零宕机服务发布-探针",
            "date_published": "2025-04-14T11:23:48.000Z",
            "content_html": "<h3 id=\"k8s零宕机服务发布-探针\"><a class=\"anchor\" href=\"#k8s零宕机服务发布-探针\">#</a> K8s 零宕机服务发布 - 探针</h3>\n<h4 id=\"1-pod状态及-pod-故障排查命令\"><a class=\"anchor\" href=\"#1-pod状态及-pod-故障排查命令\">#</a> 1. Pod 状态及 Pod 故障排查命令</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">状态</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Pending（挂起）</td>\n<td style=\"text-align:left\">Pod 已被 Kubernetes 系统接收，但仍有一个或多个容器未被创建，可以通过 kubectl describe 查看处于 Pending 状态的原因</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Running（运行中）</td>\n<td style=\"text-align:left\">Pod 已经被绑定到一个节点上，并且所有的容器都已经被创建，而且至少有一个是运行状态，或者是正在启动或者重启，可以通过 kubectl logs 查看 Pod 的日志</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Succeeded（成功）</td>\n<td style=\"text-align:left\">所有容器执行成功并终止，并且不会再次重启，可以通过 kubectl logs 查看 Pod 日志</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Failed（失败）</td>\n<td style=\"text-align:left\">所有容器都已终止，并且至少有一个容器以失败的方式终止，也就是说这个容器要么以非零状态退出，要么被系统终止，可以通过 logs 和 describe 查看 Pod 日志和状态</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Unknown（未知）</td>\n<td style=\"text-align:left\">通常是由于通信问题造成的无法获得 Pod 的状态</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ImagePullBackOff ErrImagePull</td>\n<td style=\"text-align:left\">镜像拉取失败，一般是由于镜像不存在、网络不通或者需要登录认证引起的，可以使用 describe 命令查看具体原因</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CrashLoopBackOff</td>\n<td style=\"text-align:left\">容器启动失败，可以通过 logs 命令查看具体原因，一般为启动命令不正确，健康检查不通过等</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">OOMKilled</td>\n<td style=\"text-align:left\">容器内存溢出，一般是容器的内存 Limit 设置的过小，或者程序本身有内存溢出，可以通过 logs 查看程序启动日志</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Terminating</td>\n<td style=\"text-align:left\">Pod 正在被删除，可以通过 describe 查看状态</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SysctlForbidden</td>\n<td style=\"text-align:left\">Pod 自定义了内核配置，但 kubelet 没有添加内核配置或配置的内核参数不支持，可以通过 describe 查看具体原因</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Completed</td>\n<td style=\"text-align:left\">容器内部主进程退出，一般计划任务执行结束会显示该状态，此时可以通过 logs 查看容器日志</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ContainerCreating</td>\n<td style=\"text-align:left\">Pod 正在创建，一般为正在下载镜像，或者有配置不当的地方，可以通过 describe 查看具体原因</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"2-pod镜像拉取策略\"><a class=\"anchor\" href=\"#2-pod镜像拉取策略\">#</a> 2. Pod 镜像拉取策略</h4>\n<p>通过 spec.containers [].imagePullPolicy 参数可以指定镜像的拉取策略，目前支持的策略如下：</p>\n<table>\n<thead>\n<tr>\n<th>操作方式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Always</td>\n<td>总是拉取，当镜像 tag 为 latest 时，且 imagePullPolicy 未配置，默认为 Always</td>\n</tr>\n<tr>\n<td>Never</td>\n<td>不管是否存在都不会拉取</td>\n</tr>\n<tr>\n<td>IfNotPresent</td>\n<td>镜像不存在时拉取镜像，如果 tag 为非 latest，且 imagePullPolicy 未配置，默认为 IfNotPresent</td>\n</tr>\n</tbody>\n</table>\n<p>更改镜像拉取策略为 IfNotPresent：</p>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n</code></pre>\n<h4 id=\"3-pod-重启策略\"><a class=\"anchor\" href=\"#3-pod-重启策略\">#</a> 3. <strong>Pod</strong> 重启策略</h4>\n<table>\n<thead>\n<tr>\n<th>操作方式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Always</td>\n<td>默认策略。容器失效时，自动重启该容器</td>\n</tr>\n<tr>\n<td>OnFailure</td>\n<td>容器以不为 0 的状态码终止，自动重启该容器</td>\n</tr>\n<tr>\n<td>Never</td>\n<td>无论何种状态，都不会重启</td>\n</tr>\n</tbody>\n</table>\n<p>指定重启策略为 Always ：</p>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n      restartPolicy: Always\n</code></pre>\n<h4 id=\"4-pod的三种探针\"><a class=\"anchor\" href=\"#4-pod的三种探针\">#</a> 4. Pod 的三种探针</h4>\n<table>\n<thead>\n<tr>\n<th>种类</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>startupProbe</td>\n<td>Kubernetes1.16 新加的探测方式，用于判断容器内的应用程序是否已经启动。如果配置了 startupProbe，就会先禁用其他探测，直到它成功为止。如果探测失败，Kubelet 会杀死容器，之后根据重启策略进行处理，如果探测成功，或没有配置 startupProbe，则状态为成功，之后就不再探测。</td>\n</tr>\n<tr>\n<td>livenessProbe</td>\n<td>用于探测容器是否在运行，如果探测失败，kubelet 会 “杀死” 容器并根据重启策略进行相应的处理。如果未指定该探针，将默认为 Success</td>\n</tr>\n<tr>\n<td>readinessProbe</td>\n<td>一般用于探测容器内的程序是否健康，即判断容器是否为就绪（Ready）状态。如果是，则可以处理请求，反之 Endpoints Controller 将从所有的 Service 的 Endpoints 中删除此容器所在 Pod 的 IP 地址。如果未指定，将默认为 Success</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"5-pod探针的实现方式\"><a class=\"anchor\" href=\"#5-pod探针的实现方式\">#</a> 5. Pod 探针的实现方式</h4>\n<table>\n<thead>\n<tr>\n<th>实现方式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ExecAction</td>\n<td>在容器内执行一个指定的命令，如果命令返回值为 0，则认为容器健康</td>\n</tr>\n<tr>\n<td>TCPSocketAction</td>\n<td>通过 TCP 连接检查容器指定的端口，如果端口开放，则认为容器健康</td>\n</tr>\n<tr>\n<td>HTTPGetAction</td>\n<td>对指定的 URL 进行 Get 请求，如果状态码在 200~400 之间，则认为容器健康</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"6-健康检查配置\"><a class=\"anchor\" href=\"#6-健康检查配置\">#</a> 6. 健康检查配置</h4>\n<p>配置健康检查：</p>\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          startupProbe:\n            initialDelaySeconds: 30\n            timeoutSeconds: 2\n            periodSeconds: 30\n            successThreshold: 1\n            failureThreshold: 2\n            tcpSocket:\n              port: 80\n          livenessProbe:\n            initialDelaySeconds: 30\n            timeoutSeconds: 2\n            periodSeconds: 30\n            successThreshold: 1\n            failureThreshold: 2\n            tcpSocket:\n              port: 80\n          readinessProbe:\n            initialDelaySeconds: 30\n            timeoutSeconds: 2\n            periodSeconds: 30\n            successThreshold: 1\n            failureThreshold: 2\n            httpGet:\n              path: /index.html\n              port: 80\n              scheme: HTTP\n      restartPolicy: Always\n</code></pre>\n<h4 id=\"7-prestop和-poststart配置\"><a class=\"anchor\" href=\"#7-prestop和-poststart配置\">#</a> 7. PreStop 和 PostStart 配置</h4>\n<pre><code>[root@k8s-master01 ~]# cat nginx-deploy.yaml \napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deploy\n  labels:\n    app: nginx-deploy\n  annotations:\n    app: nginx-deploy\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app: nginx-deploy\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: nginx-deploy\n    spec:\n      containers:\n        - name: nginx-deploy\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          startupProbe:\n            initialDelaySeconds: 30\n            timeoutSeconds: 2\n            periodSeconds: 30\n            successThreshold: 1\n            failureThreshold: 2\n            tcpSocket:\n              port: 80\n          livenessProbe:\n            initialDelaySeconds: 30\n            timeoutSeconds: 2\n            periodSeconds: 30\n            successThreshold: 1\n            failureThreshold: 2\n            tcpSocket:\n              port: 80\n          readinessProbe:\n            initialDelaySeconds: 30\n            timeoutSeconds: 2\n            periodSeconds: 30\n            successThreshold: 1\n            failureThreshold: 2\n            httpGet:\n              path: /index.html\n              port: 80\n              scheme: HTTP\n          lifecycle:\n            postStart:\n              exec:\n                command:\n                  - sh\n                  - '-c'\n                  - mkdir /data\n            preStop:\n              exec:\n                command:\n                  - sh\n                  - '-c'\n                  - sleep 30\n      restartPolicy: Always\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3071070979.html",
            "url": "http://ixuyong.cn/posts/3071070979.html",
            "title": "一键永久激活Window、office教程",
            "date_published": "2025-04-10T13:32:09.000Z",
            "content_html": "<h3 id=\"一键永久激活window-office教程\"><a class=\"anchor\" href=\"#一键永久激活window-office教程\">#</a> 一键永久激活 Window、office 教程</h3>\n<p>1、按下 Win 键 + R，调出运行对话框，输入 powershell 并回车，启动命令提示符窗口。接着输入以下指令执行激活：</p>\n<pre><code>irm https://get.activated.win | iex\n</code></pre>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/ilMT403.png\" alt=\"1.png\" /></p>\n<p>该脚本包含四个功能：首个命令用于 Windows 系统永久激活，第二个用于 Office 永久激活，第三个将系统有效期延长至 2038 年，第四个则实现每 180 天自动循环激活。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/taJbKQr.png\" alt=\"2.png\" /></p>\n<p>2. 我们再次使用 Windows 徽标 + R 快捷键打开运行框，输入 slmgr.vbs/xpr 就可以看到系统已经永久激活了。</p>\n<pre><code>slmgr.vbs /xpr\n</code></pre>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/JMWlUpc.png\" alt=\"3.png\" /></p>\n<p>以上，既然看到这里了，如果觉得不错，随手点个赞、打赏一下吧，⭐～谢谢你看我的文章，我们下次再见。</p>\n",
            "tags": [
                "Windows"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/985149017.html",
            "url": "http://ixuyong.cn/posts/985149017.html",
            "title": "二进制高可用安装K8S集群",
            "date_published": "2025-04-10T12:58:40.000Z",
            "content_html": "<h2 id=\"二进制高可用安装k8s集群\"><a class=\"anchor\" href=\"#二进制高可用安装k8s集群\">#</a> 二进制高可用安装 K8s 集群</h2>\n<h4 id=\"1-基本配置\"><a class=\"anchor\" href=\"#1-基本配置\">#</a> 1. 基本配置</h4>\n<h5 id=\"11-基本环境配置\"><a class=\"anchor\" href=\"#11-基本环境配置\">#</a> 1.1 基本环境配置</h5>\n<table>\n<thead>\n<tr>\n<th>主机名</th>\n<th>IP 地址</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>k8s-master01 ~ 03</td>\n<td>192.168.1.71 ~ 73</td>\n<td>master 节点 * 3</td>\n</tr>\n<tr>\n<td>/</td>\n<td>192.168.1.70</td>\n<td>keepalived 虚拟 IP（不占用机器）</td>\n</tr>\n<tr>\n<td>k8s-node01 ~ 02</td>\n<td>192.168.1.74/75</td>\n<td>worker 节点 * 2</td>\n</tr>\n</tbody>\n</table>\n<p><em>请统一替换这些网段，Pod 网段和 service 和宿主机网段不要重复！！！</em></p>\n<table>\n<thead>\n<tr>\n<th><em><strong>* 配置信息 *</strong></em></th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>系统版本</td>\n<td>Rocky Linux 8/9</td>\n</tr>\n<tr>\n<td>Containerd</td>\n<td>latest</td>\n</tr>\n<tr>\n<td>Pod 网段</td>\n<td>172.16.0.0/16</td>\n</tr>\n<tr>\n<td>Service 网段</td>\n<td>10.96.0.0/16</td>\n</tr>\n</tbody>\n</table>\n<p><mark>所有节点</mark>更改主机名（其它节点按需修改）：</p>\n<pre><code>hostnamectl set-hostname k8s-master01 \n</code></pre>\n<p><mark>所有节点</mark>配置 hosts，修改 /etc/hosts 如下：</p>\n<pre><code>[root@k8s-master01 ~]# cat /etc/hosts\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n192.168.1.71 k8s-master01\n192.168.1.72 k8s-master02\n192.168.1.73 k8s-master03\n192.168.1.74 k8s-node01\n192.168.1.75 k8s-node02\n</code></pre>\n<p><mark>所有节点</mark>配置 yum 源：</p>\n<pre><code># 配置基础源\nsed -e 's|^mirrorlist=|#mirrorlist=|g' \\\n    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.aliyun.com/rockylinux|g' \\\n    -i.bak \\\n    /etc/yum.repos.d/*.repo\n\nyum makecache\n</code></pre>\n<p><mark>所有节点</mark>必备工具安装：</p>\n<pre><code>yum install wget jq psmisc vim net-tools telnet yum-utils device-mapper-persistent-data lvm2 git rsyslog -y\n</code></pre>\n<p><mark>所有节点</mark>关闭防火墙、selinux、dnsmasq、swap、开启 rsyslog。服务器配置如下：</p>\n<pre><code>systemctl disable --now firewalld \nsystemctl disable --now dnsmasq\nsetenforce 0\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/sysconfig/selinux\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/selinux/config\nsystemctl enable --now rsyslog\n</code></pre>\n<p><mark>所有节点</mark>关闭 swap 分区：</p>\n<pre><code>swapoff -a &amp;&amp; sysctl -w vm.swappiness=0\nsed -ri '/^[^#]*swap/s@^@#@' /etc/fstab\n</code></pre>\n<p><mark>所有节点</mark>安装 ntpdate：</p>\n<pre><code>sudo dnf install epel-release -y\nsudo dnf config-manager --set-enabled epel\nsudo dnf install ntpsec\n</code></pre>\n<p><mark>所有节点</mark>同步时间并配置上海时区：</p>\n<pre><code>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\necho 'Asia/Shanghai' &gt;/etc/timezone\nntpdate time2.aliyun.com\n# 加入到crontab\ncrontab -e\n*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com\n</code></pre>\n<p><mark>所有节点</mark>配置 limit：</p>\n<pre><code>ulimit -SHn 65535\nvim /etc/security/limits.conf\n# 末尾添加如下内容\n* soft nofile 65536\n* hard nofile 131072\n* soft nproc 65535\n* hard nproc 655350\n* soft memlock unlimited\n* hard memlock unlimited\n</code></pre>\n<p><mark>所有节点</mark>升级系统：</p>\n<pre><code>yum update -y\n</code></pre>\n<p><mark>Master01 节点</mark>免密钥登录其他节点，安装过程中生成配置文件和证书均在 Master01 上操作，集群管理也在 Master01 上操作：</p>\n<pre><code>ssh-keygen -t rsa\nfor i in k8s-master01 k8s-master02 k8s-master03 k8s-node01 k8s-node02;do ssh-copy-id -i .ssh/id_rsa.pub $i;done\n</code></pre>\n<p><em>注意：公有云环境，可能需要把 kubectl 放在一个非 Master 节点上</em></p>\n<p><mark>Master01 节点</mark>下载安装所有的源码文件：</p>\n<pre><code>cd /root/ ; git clone https://gitee.com/chinagei/k8s-ha-install\n</code></pre>\n<h5 id=\"12-内核配置\"><a class=\"anchor\" href=\"#12-内核配置\">#</a> 1.2 内核配置</h5>\n<p><mark>所有节点</mark>安装 ipvsadm：</p>\n<pre><code>yum install ipvsadm ipset sysstat conntrack libseccomp -y\n</code></pre>\n<p><mark>所有节点</mark>配置 ipvs 模块：</p>\n<pre><code>modprobe -- ip_vs\nmodprobe -- ip_vs_rr\nmodprobe -- ip_vs_wrr\nmodprobe -- ip_vs_sh\nmodprobe -- nf_conntrack\n</code></pre>\n<p><mark>所有节点</mark>创建 ipvs.conf，并配置开机自动加载：</p>\n<pre><code>vim /etc/modules-load.d/ipvs.conf \n# 加入以下内容\nip_vs\nip_vs_lc\nip_vs_wlc\nip_vs_rr\nip_vs_wrr\nip_vs_lblc\nip_vs_lblcr\nip_vs_dh\nip_vs_sh\nip_vs_fo\nip_vs_nq\nip_vs_sed\nip_vs_ftp\nip_vs_sh\nnf_conntrack\nip_tables\nip_set\nxt_set\nipt_set\nipt_rpfilter\nipt_REJECT\nipip\n</code></pre>\n<p><mark>所有节点</mark>然后执行 systemctl enable --now systemd-modules-load.service 即可（报错不用管）</p>\n<pre><code>systemctl enable --now systemd-modules-load.service\n</code></pre>\n<p><mark>所有节点</mark>内核优化配置：</p>\n<pre><code>cat &lt;&lt;EOF &gt; /etc/sysctl.d/k8s.conf\nnet.ipv4.ip_forward = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nfs.may_detach_mounts = 1\nnet.ipv4.conf.all.route_localnet = 1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\nfs.inotify.max_user_watches=89100\nfs.file-max=52706963\nfs.nr_open=52706963\nnet.netfilter.nf_conntrack_max=2310720\n\nnet.ipv4.tcp_keepalive_time = 600\nnet.ipv4.tcp_keepalive_probes = 3\nnet.ipv4.tcp_keepalive_intvl =15\nnet.ipv4.tcp_max_tw_buckets = 36000\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_max_orphans = 327680\nnet.ipv4.tcp_orphan_retries = 3\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_max_syn_backlog = 16384\nnet.ipv4.ip_conntrack_max = 65536\nnet.ipv4.tcp_max_syn_backlog = 16384\nnet.ipv4.tcp_timestamps = 0\nnet.core.somaxconn = 16384\nEOF\n</code></pre>\n<p><mark>所有节点</mark>应用配置：</p>\n<pre><code>sysctl --system\n</code></pre>\n<p><mark>所有节点</mark>配置完内核后，重启机器，之后查看内核模块是否已自动加载：</p>\n<pre><code>reboot\nlsmod | grep --color=auto -e ip_vs -e nf_conntrack\n</code></pre>\n<h4 id=\"2-高可用组件安装\"><a class=\"anchor\" href=\"#2-高可用组件安装\">#</a> 2. 高可用组件安装</h4>\n<p><em>注意：如果安装的不是高可用集群，haproxy 和 keepalived 无需安装</em></p>\n<p><em>注意：公有云要用公有云自带的负载均衡，比如阿里云的 SLB、NLB，腾讯云的 ELB，用来替代 haproxy 和 keepalived，因为公有云大部分都是不支持 keepalived 的。</em></p>\n<p><mark>所有 Master 节点</mark>通过 yum 安装 HAProxy 和 KeepAlived：</p>\n<pre><code>yum install keepalived haproxy -y\n</code></pre>\n<p><mark>所有 Master 节点</mark>配置 HAProxy，需要注意黄色部分的 IP：</p>\n<pre><code>[root@k8s-master01 etc]# mkdir /etc/haproxy\n[root@k8s-master01 etc]# vim /etc/haproxy/haproxy.cfg \nglobal\n  maxconn  2000\n  ulimit-n  16384\n  log  127.0.0.1 local0 err\n  stats timeout 30s\n\ndefaults\n  log global\n  mode  http\n  option  httplog\n  timeout connect 5000\n  timeout client  50000\n  timeout server  50000\n  timeout http-request 15s\n  timeout http-keep-alive 15s\n\nfrontend monitor-in\n  bind *:33305\n  mode http\n  option httplog\n  monitor-uri /monitor\n\nfrontend k8s-master\n  bind 0.0.0.0:8443       #HAProxy监听端口\n  bind 127.0.0.1:8443     #HAProxy监听端口\n  mode tcp\n  option tcplog\n  tcp-request inspect-delay 5s\n  default_backend k8s-master\n\nbackend k8s-master\n  mode tcp\n  option tcplog\n  option tcp-check\n  balance roundrobin\n  default-server inter 10s downinter 5s rise 2 fall 2 slowstart 60s maxconn 250 maxqueue 256 weight 100\n  server k8s-master01\t192.168.1.71:6443  check       #API Server IP地址\n  server k8s-master02\t192.168.1.72:6443  check       #API Server IP地址\n  server k8s-master03\t192.168.1.73:6443  check       #API Server IP地址\n</code></pre>\n<p><mark>所有 Master 节点</mark>配置 KeepAlived，需要注意黄色部分的配置。</p>\n<p><mark>Master01 节点</mark>的配置：</p>\n<pre><code>[root@k8s-master01 etc]# mkdir /etc/keepalived\n\n[root@k8s-master01 ~]# vim /etc/keepalived/keepalived.conf \n! Configuration File for keepalived\nglobal_defs &#123;\n    router_id LVS_DEVEL\nscript_user root\n    enable_script_security\n&#125;\nvrrp_script chk_apiserver &#123;\n    script &quot;/etc/keepalived/check_apiserver.sh&quot;\n    interval 5\n    weight -5\n    fall 2  \nrise 1\n&#125;\nvrrp_instance VI_1 &#123;\n    state MASTER\n    interface ens160               #网卡名称\n    mcast_src_ip 192.168.1.71      #K8s-master01 IP地址\n    virtual_router_id 51\n    priority 101\n    advert_int 2\n    authentication &#123;\n        auth_type PASS\n        auth_pass K8SHA_KA_AUTH\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.70        #VIP地址\n    &#125;\n    track_script &#123;\n       chk_apiserver\n    &#125;\n&#125;\t\n</code></pre>\n<p><mark>Master02 节点</mark>的配置：</p>\n<pre><code># vim /etc/keepalived/keepalived.conf \n\n! Configuration File for keepalived\nglobal_defs &#123;\n    router_id LVS_DEVEL\nscript_user root\n    enable_script_security\n&#125;\nvrrp_script chk_apiserver &#123;\n    script &quot;/etc/keepalived/check_apiserver.sh&quot;\n   interval 5\n    weight -5\n    fall 2  \nrise 1\n&#125;\nvrrp_instance VI_1 &#123;\n    state BACKUP\n    interface ens160                #网卡名称\n    mcast_src_ip 192.168.1.72       #K8s-master02 IP地址\n    virtual_router_id 51\n    priority 100\n    advert_int 2\n    authentication &#123;\n        auth_type PASS\n        auth_pass K8SHA_KA_AUTH\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.70              #VIP地址\n    &#125;\n    track_script &#123;\n       chk_apiserver\n    &#125;\n&#125;\n</code></pre>\n<p><mark>Master03 节点</mark>的配置：</p>\n<pre><code># vim /etc/keepalived/keepalived.conf \n\n! Configuration File for keepalived\nglobal_defs &#123;\n    router_id LVS_DEVEL\nscript_user root\n    enable_script_security\n&#125;\nvrrp_script chk_apiserver &#123;\n    script &quot;/etc/keepalived/check_apiserver.sh&quot;\n interval 5\n    weight -5\n    fall 2  \nrise 1\n&#125;\nvrrp_instance VI_1 &#123;\n    state BACKUP\n    interface ens160                 #网卡名称\n    mcast_src_ip 192.168.1.73        #K8s-master03 IP地址\n    virtual_router_id 51\n    priority 100\n    advert_int 2\n    authentication &#123;\n        auth_type PASS\n        auth_pass K8SHA_KA_AUTH\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.70          #VIP地址\n    &#125;\n    track_script &#123;\n       chk_apiserver\n    &#125;\n&#125;\n</code></pre>\n<p><mark>所有 master 节点</mark>配置 KeepAlived 健康检查文件：</p>\n<pre><code>[root@k8s-master01 keepalived]# vim /etc/keepalived/check_apiserver.sh \n#!/bin/bash\n\nerr=0\nfor k in $(seq 1 3)\ndo\n    check_code=$(pgrep haproxy)\n    if [[ $check_code == &quot;&quot; ]]; then\n        err=$(expr $err + 1)\n        sleep 1\n        continue\n    else\n        err=0\n        break\n    fi\ndone\n\nif [[ $err != &quot;0&quot; ]]; then\n    echo &quot;systemctl stop keepalived&quot;\n    /usr/bin/systemctl stop keepalived\n    exit 1\nelse\n    exit 0\nfi\n</code></pre>\n<p><mark>所有 master 节点</mark>配置健康检查文件添加执行权限：</p>\n<pre><code>chmod +x /etc/keepalived/check_apiserver.sh\n</code></pre>\n<p><mark>所有 master 节点</mark>启动 haproxy 和 keepalived：</p>\n<pre><code>[root@k8s-master01 keepalived]# systemctl daemon-reload\n[root@k8s-master01 keepalived]# systemctl enable --now haproxy\n[root@k8s-master01 keepalived]# systemctl enable --now keepalived\n</code></pre>\n<p>重要：如果安装了 keepalived 和 haproxy，需要测试 keepalived 是否是正常的</p>\n<pre><code>所有节点测试VIP\n[root@k8s-master01 ~]# ping 192.168.1.70 -c 4\nPING 192.168.1.70 (192.168.1.70) 56(84) bytes of data.\n64 bytes from 192.168.1.70: icmp_seq=1 ttl=64 time=0.464 ms\n64 bytes from 192.168.1.70: icmp_seq=2 ttl=64 time=0.063 ms\n64 bytes from 192.168.1.70: icmp_seq=3 ttl=64 time=0.062 ms\n64 bytes from 192.168.1.70: icmp_seq=4 ttl=64 time=0.063 ms\n\n[root@k8s-master01 ~]# telnet 192.168.1.70 16443\nTrying 192.168.1.70...\nConnected to 192.168.1.70.\nEscape character is '^]'.\nConnection closed by foreign host.\n</code></pre>\n<p>如果 ping 不通且 telnet 没有出现 ] ，则认为 VIP 不可以，不可在继续往下执行，需要排查 keepalived 的问题，比如防火墙和 selinux，haproxy 和 keepalived 的状态，监听端口等</p>\n<ul>\n<li>所有节点查看防火墙状态必须为 disable 和 inactive：systemctl status firewalld</li>\n<li>所有节点查看 selinux 状态，必须为 disable：getenforce</li>\n<li>master 节点查看 haproxy 和 keepalived 状态：systemctl status keepalived haproxy</li>\n<li>master 节点查看监听端口：netstat -lntp</li>\n</ul>\n<p>如果以上都没有问题，需要确认：</p>\n<ol>\n<li>\n<p>是否是公有云机器</p>\n</li>\n<li>\n<p>是否是私有云机器（类似 OpenStack）</p>\n</li>\n</ol>\n<p>上述公有云一般都是不支持 keepalived，私有云可能也有限制，需要和自己的私有云管理员咨询</p>\n<h4 id=\"3-runtime安装\"><a class=\"anchor\" href=\"#3-runtime安装\">#</a> 3. Runtime 安装</h4>\n<p>如果安装的版本低于 1.24，选择 Docker 和 Containerd 均可，高于 1.24 建议选择 Containerd 作为 Runtime，不再推荐使用 Docker 作为 Runtime。</p>\n<h5 id=\"31-安装containerd\"><a class=\"anchor\" href=\"#31-安装containerd\">#</a> 3.1 安装 Containerd</h5>\n<p><mark>所有节点</mark>配置安装源：</p>\n<pre><code>yum install wget jq psmisc vim net-tools telnet yum-utils device-mapper-persistent-data lvm2 git -y\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n</code></pre>\n<p><mark>所有节点</mark>安装 docker-ce（如果在以前已经安装过，需要重新安装更新一下）：</p>\n<pre><code># yum install docker-ce containerd -y\n</code></pre>\n<p><em>可以无需启动 Docker，只需要配置和启动 Containerd 即可。</em></p>\n<p>首先配置 Containerd 所需的模块（<mark>所有节点</mark>）：</p>\n<pre><code># cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/containerd.conf\noverlay\nbr_netfilter\nEOF\n</code></pre>\n<p><mark>所有节点</mark>加载模块：</p>\n<pre><code># modprobe -- overlay\n# modprobe -- br_netfilter\n</code></pre>\n<p><mark>所有节点</mark>，配置 Containerd 所需的内核：</p>\n<pre><code># cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.ipv4.ip_forward                 = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nEOF\n</code></pre>\n<p><mark>所有节点</mark>加载内核：</p>\n<pre><code># sysctl --system\n</code></pre>\n<p><mark>所有节点</mark>生成 Containerd 的配置文件：</p>\n<pre><code># mkdir -p /etc/containerd\n# containerd config default | tee /etc/containerd/config.toml\n</code></pre>\n<p><mark>所有节点</mark>更改 Containerd 的 Cgroup 和 Pause 镜像配置：</p>\n<pre><code>sed -i 's#SystemdCgroup = false#SystemdCgroup = true#g' /etc/containerd/config.toml\nsed -i 's#k8s.gcr.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\nsed -i 's#registry.gcr.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\nsed -i 's#registry.k8s.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\n</code></pre>\n<p><mark>所有节点</mark>启动 Containerd，并配置开机自启动：</p>\n<pre><code># systemctl daemon-reload\n# systemctl enable --now containerd\n</code></pre>\n<p><mark>所有节点</mark>配置 crictl 客户端连接的运行时位置（可选）：</p>\n<pre><code># cat &gt; /etc/crictl.yaml &lt;&lt;EOF\nruntime-endpoint: unix:///run/containerd/containerd.sock\nimage-endpoint: unix:///run/containerd/containerd.sock\ntimeout: 10\ndebug: false\nEOF\n</code></pre>\n<h4 id=\"4-k8s及etcd安装\"><a class=\"anchor\" href=\"#4-k8s及etcd安装\">#</a> 4 . K8S 及 etcd 安装</h4>\n<p><mark>Master01</mark> 下载 kubernetes 安装包（1.32.3 需要更改为你看到的最新版本）：</p>\n<pre><code>[root@k8s-master01 ~]# wget https://dl.k8s.io/v1.32.0/kubernetes-server-linux-amd64.tar.gz\n</code></pre>\n<p>最新版获取地址：<a href=\"https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.31.md\">https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/</a></p>\n<p><mark>以下操作都在 master01 执行</mark></p>\n<p>下载 etcd 安装包：<a href=\"https://github.com/etcd-io/etcd/releases/\">https://github.com/etcd-io/etcd/releases/</a></p>\n<pre><code>[root@k8s-master01 ~]# wget https://github.com/etcd-io/etcd/releases/download/v3.5.16/etcd-v3.5.16-linux-amd64.tar.gz\n</code></pre>\n<p>解压 kubernetes 安装文件：</p>\n<pre><code>[root@k8s-master01 ~]# tar -xf kubernetes-server-linux-amd64.tar.gz  --strip-components=3 -C /usr/local/bin kubernetes/server/bin/kube&#123;let,ctl,-apiserver,-controller-manager,-scheduler,-proxy&#125;\n</code></pre>\n<p>解压 etcd 安装文件：</p>\n<pre><code>[root@k8s-master01 ~]#  tar -zxvf etcd-v3.5.16-linux-amd64.tar.gz --strip-components=1 -C /usr/local/bin etcd-v3.5.16-linux-amd64/etcd&#123;,ctl&#125;\n</code></pre>\n<p>版本查看：</p>\n<pre><code>[root@k8s-master01 ~]# kubelet --version\nKubernetes v1.32.3\n[root@k8s-master01 ~]# etcdctl version\netcdctl version: 3.5.16\nAPI version: 3.5\n</code></pre>\n<p>将组件发送到其他节点</p>\n<pre><code>MasterNodes='k8s-master02 k8s-master03'\nWorkNodes='k8s-node01 k8s-node02'\nfor NODE in $MasterNodes; do echo $NODE; scp /usr/local/bin/kube&#123;let,ctl,-apiserver,-controller-manager,-scheduler,-proxy&#125; $NODE:/usr/local/bin/; scp /usr/local/bin/etcd* $NODE:/usr/local/bin/; done\nfor NODE in $WorkNodes; do     scp /usr/local/bin/kube&#123;let,-proxy&#125; $NODE:/usr/local/bin/ ; done\n</code></pre>\n<p><mark>Master01 节点</mark>切换到 1.32.x 分支（其他版本可以切换到其他分支，.x 即可，不需要更改为具体的小版本）：</p>\n<pre><code>cd /root/k8s-ha-install &amp;&amp; git checkout manual-installation-v1.32.x\n</code></pre>\n<h4 id=\"5-生成证书\"><a class=\"anchor\" href=\"#5-生成证书\">#</a> 5 . 生成证书</h4>\n<p><em><mark>二进制安装最关键步骤，一步错误全盘皆输，一定要注意每个步骤都要是正确的</mark></em></p>\n<p><mark>Master01</mark> 下载生成证书工具（下载不成功可以去百度网盘）</p>\n<pre><code>wget &quot;https://pkg.cfssl.org/R1.2/cfssl_linux-amd64&quot; -O /usr/local/bin/cfssl\nwget &quot;https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64&quot; -O /usr/local/bin/cfssljson\nchmod +x /usr/local/bin/cfssl /usr/local/bin/cfssljson\n</code></pre>\n<h5 id=\"51-etcd证书\"><a class=\"anchor\" href=\"#51-etcd证书\">#</a> 5.1 Etcd 证书</h5>\n<p><mark>所有 Master 节点</mark>创建 etcd 证书目录：</p>\n<pre><code>mkdir /etc/etcd/ssl -p\n</code></pre>\n<p><mark>所有节点</mark>创建 kubernetes 相关目录：</p>\n<pre><code>mkdir -p /etc/kubernetes/pki\n</code></pre>\n<p><mark>Master01 节点</mark>生成 etcd 证书</p>\n<p>生成证书的 CSR（证书签名请求文件，配置了一些域名、公司、单位）文件：</p>\n<pre><code>[root@k8s-master01 pki]# cd /root/k8s-ha-install/pki\n\n# 生成etcd CA证书和CA证书的key\ncfssl gencert -initca etcd-ca-csr.json | cfssljson -bare /etc/etcd/ssl/etcd-ca\n\n\ncfssl gencert \\\n   -ca=/etc/etcd/ssl/etcd-ca.pem \\\n   -ca-key=/etc/etcd/ssl/etcd-ca-key.pem \\\n   -config=ca-config.json \\\n   -hostname=127.0.0.1,k8s-master01,k8s-master02,k8s-master03,192.168.1.71,192.168.1.72,192.168.1.73 \\\n   -profile=kubernetes \\\n   etcd-csr.json | cfssljson -bare /etc/etcd/ssl/etcd\n\n执行结果\n[INFO] generate received request\n \t[INFO] received CSR\n     [INFO] generating key: rsa-2048\n     [INFO] encoded CSR\n     [INFO] signed certificate with serial number     250230878926052708909595617022917808304837732033\n</code></pre>\n<p>将证书复制到其他 master 节点</p>\n<pre><code>MasterNodes='k8s-master02 k8s-master03'\n\nfor NODE in $MasterNodes; do\n     ssh $NODE &quot;mkdir -p /etc/etcd/ssl&quot;\n     for FILE in etcd-ca-key.pem  etcd-ca.pem  etcd-key.pem  etcd.pem; do\n       scp /etc/etcd/ssl/$&#123;FILE&#125; $NODE:/etc/etcd/ssl/$&#123;FILE&#125;\n     done\n done\n</code></pre>\n<h5 id=\"52-k8s组件证书\"><a class=\"anchor\" href=\"#52-k8s组件证书\">#</a> 5.2 K8s 组件证书</h5>\n<p><mark>Master01</mark> 生成 kubernetes CA 证书：</p>\n<pre><code>[root@k8s-master01 pki]# cd /root/k8s-ha-install/pki\n\ncfssl gencert -initca ca-csr.json | cfssljson -bare /etc/kubernetes/pki/ca\n</code></pre>\n<h6 id=\"521-apiserver证书\"><a class=\"anchor\" href=\"#521-apiserver证书\">#</a> 5.2.1 APIServer 证书</h6>\n<p>注意：10.96.0. 是 k8s service 的网段，如果说需要更改 k8s service 网段，那就需要更改 10.96.0.1</p>\n<pre><code>cfssl gencert   -ca=/etc/kubernetes/pki/ca.pem   -ca-key=/etc/kubernetes/pki/ca-key.pem   -config=ca-config.json   -hostname=10.96.0.1,192.168.1.70,127.0.0.1,kubernetes,kubernetes.default,kubernetes.default.svc,kubernetes.default.svc.cluster,kubernetes.default.svc.cluster.local,192.168.1.71,192.168.1.72,192.168.1.73   -profile=kubernetes   apiserver-csr.json | cfssljson -bare /etc/kubernetes/pki/apiserver\n</code></pre>\n<p>生成 apiserver 的聚合证书：：</p>\n<pre><code>cfssl gencert   -initca front-proxy-ca-csr.json | cfssljson -bare /etc/kubernetes/pki/front-proxy-ca \n\ncfssl gencert   -ca=/etc/kubernetes/pki/front-proxy-ca.pem   -ca-key=/etc/kubernetes/pki/front-proxy-ca-key.pem   -config=ca-config.json   -profile=kubernetes   front-proxy-client-csr.json | cfssljson -bare /etc/kubernetes/pki/front-proxy-client\n</code></pre>\n<p>返回结果（忽略警告）：</p>\n<pre><code>2020/12/11 18:15:28 [INFO] generate received request\n2020/12/11 18:15:28 [INFO] received CSR\n2020/12/11 18:15:28 [INFO] generating key: rsa-2048\n\n2020/12/11 18:15:28 [INFO] encoded CSR\n2020/12/11 18:15:28 [INFO] signed certificate with serial number 597484897564859295955894546063479154194995827845\n2020/12/11 18:15:28 [WARNING] This certificate lacks a &quot;hosts&quot; field. This makes it unsuitable for\nwebsites. For more information see the Baseline Requirements for the Issuance and Management\nof Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum (https://cabforum.org);\nspecifically, section 10.2.3 (&quot;Information Requirements&quot;).\n</code></pre>\n<h6 id=\"522-controllermanager\"><a class=\"anchor\" href=\"#522-controllermanager\">#</a> 5.2.2 ControllerManager</h6>\n<p>生成 controller-manage 的证书：</p>\n<pre><code class=\"language-\\\">cfssl gencert \\\n   -ca=/etc/kubernetes/pki/ca.pem \\\n   -ca-key=/etc/kubernetes/pki/ca-key.pem \\\n   -config=ca-config.json \\\n   -profile=kubernetes \\\n   manager-csr.json | cfssljson -bare /etc/kubernetes/pki/controller-manager\n\n注意：修改黄色部分的IP地址\n# set-cluster：设置一个集群项，\n\nkubectl config set-cluster kubernetes \\\n     --certificate-authority=/etc/kubernetes/pki/ca.pem \\\n     --embed-certs=true \\\n     --server=https://192.168.1.70:8443 \\\n     --kubeconfig=/etc/kubernetes/controller-manager.kubeconfig\n\n# 设置一个环境项，一个上下文\nkubectl config set-context system:kube-controller-manager@kubernetes \\\n    --cluster=kubernetes \\\n    --user=system:kube-controller-manager \\\n    --kubeconfig=/etc/kubernetes/controller-manager.kubeconfig\n\n# set-credentials 设置一个用户项\n\nkubectl config set-credentials system:kube-controller-manager \\\n     --client-certificate=/etc/kubernetes/pki/controller-manager.pem \\\n     --client-key=/etc/kubernetes/pki/controller-manager-key.pem \\\n     --embed-certs=true \\\n     --kubeconfig=/etc/kubernetes/controller-manager.kubeconfig\n\n\n# 使用某个环境当做默认环境\n\nkubectl config use-context system:kube-controller-manager@kubernetes \\\n     --kubeconfig=/etc/kubernetes/controller-manager.kubeconfig\n</code></pre>\n<h6 id=\"523-scheduler证书\"><a class=\"anchor\" href=\"#523-scheduler证书\">#</a> 5.2.3 Scheduler 证书</h6>\n<pre><code>cfssl gencert \\\n   -ca=/etc/kubernetes/pki/ca.pem \\\n   -ca-key=/etc/kubernetes/pki/ca-key.pem \\\n   -config=ca-config.json \\\n   -profile=kubernetes \\\n   scheduler-csr.json | cfssljson -bare /etc/kubernetes/pki/scheduler\n\n注意：修改黄色部分的IP地址\n\nkubectl config set-cluster kubernetes \\\n     --certificate-authority=/etc/kubernetes/pki/ca.pem \\\n     --embed-certs=true \\\n     --server=https://192.168.1.70:8443 \\\n     --kubeconfig=/etc/kubernetes/scheduler.kubeconfig\n\n\nkubectl config set-credentials system:kube-scheduler \\\n     --client-certificate=/etc/kubernetes/pki/scheduler.pem \\\n     --client-key=/etc/kubernetes/pki/scheduler-key.pem \\\n     --embed-certs=true \\\n     --kubeconfig=/etc/kubernetes/scheduler.kubeconfig\n\nkubectl config set-context system:kube-scheduler@kubernetes \\\n     --cluster=kubernetes \\\n     --user=system:kube-scheduler \\\n     --kubeconfig=/etc/kubernetes/scheduler.kubeconfig\n\nkubectl config use-context system:kube-scheduler@kubernetes \\\n     --kubeconfig=/etc/kubernetes/scheduler.kubeconfig\n</code></pre>\n<h6 id=\"524-生成管理员证书\"><a class=\"anchor\" href=\"#524-生成管理员证书\">#</a> 5.2.4 生成管理员证书</h6>\n<p>Kubectl /etc/Kubernetes/admin.conf ~/.kube/config</p>\n<pre><code>cfssl gencert \\\n   -ca=/etc/kubernetes/pki/ca.pem \\\n   -ca-key=/etc/kubernetes/pki/ca-key.pem \\\n   -config=ca-config.json \\\n   -profile=kubernetes \\\n   admin-csr.json | cfssljson -bare /etc/kubernetes/pki/admin\n\n注意：修改黄色部分的IP\n\nkubectl config set-cluster kubernetes     --certificate-authority=/etc/kubernetes/pki/ca.pem     --embed-certs=true     --server=https://192.168.1.70:8443     --kubeconfig=/etc/kubernetes/admin.kubeconfig\nkubectl config set-credentials kubernetes-admin     --client-certificate=/etc/kubernetes/pki/admin.pem     --client-key=/etc/kubernetes/pki/admin-key.pem     --embed-certs=true     --kubeconfig=/etc/kubernetes/admin.kubeconfig\n\nkubectl config set-context kubernetes-admin@kubernetes     --cluster=kubernetes     --user=kubernetes-admin     --kubeconfig=/etc/kubernetes/admin.kubeconfig\n\nkubectl config use-context kubernetes-admin@kubernetes     --kubeconfig=/etc/kubernetes/admin.kubeconfig\n</code></pre>\n<h6 id=\"525-创建serviceaccount证书\"><a class=\"anchor\" href=\"#525-创建serviceaccount证书\">#</a> 5.2.5 创建 ServiceAccount 证书</h6>\n<p>创建一对公钥，用来签发 ServiceAccount 的 Token：</p>\n<pre><code>openssl genrsa -out /etc/kubernetes/pki/sa.key 2048\n</code></pre>\n<p>返回结果：</p>\n<pre><code>Generating RSA private key, 2048 bit long modulus (2 primes)\n...................................................................................+++++\n...............+++++\ne is 65537 (0x010001)\n</code></pre>\n<pre><code> openssl rsa -in /etc/kubernetes/pki/sa.key -pubout -out /etc/kubernetes/pki/sa.pub\n</code></pre>\n<p>发送证书至其他节点：</p>\n<pre><code>for NODE in k8s-master02 k8s-master03; do \n  for FILE in $(ls /etc/kubernetes/pki | grep -v etcd); do \n    scp /etc/kubernetes/pki/$&#123;FILE&#125; $NODE:/etc/kubernetes/pki/$&#123;FILE&#125;;\n  done; \n  for FILE in admin.kubeconfig controller-manager.kubeconfig scheduler.kubeconfig; do \n    scp /etc/kubernetes/$&#123;FILE&#125; $NODE:/etc/kubernetes/$&#123;FILE&#125;;\n  done;\ndone\n</code></pre>\n<p>查看证书文件：</p>\n<pre><code>[root@k8s-master01 pki]# ls /etc/kubernetes/pki/\nadmin.csr      apiserver.csr      ca.csr      controller-manager.csr      front-proxy-ca.csr      front-proxy-client.csr      sa.key         scheduler-key.pem\nadmin-key.pem  apiserver-key.pem  ca-key.pem  controller-manager-key.pem  front-proxy-ca-key.pem  front-proxy-client-key.pem  sa.pub         scheduler.pem\nadmin.pem      apiserver.pem      ca.pem      controller-manager.pem      front-proxy-ca.pem      front-proxy-client.pem      scheduler.csr\n[root@k8s-master01 pki]# ls /etc/kubernetes/pki/ |wc -l\n23\n</code></pre>\n<h4 id=\"6-kubernetes组件配置\"><a class=\"anchor\" href=\"#6-kubernetes组件配置\">#</a> 6. Kubernetes 组件配置</h4>\n<h5 id=\"61-ecd配置\"><a class=\"anchor\" href=\"#61-ecd配置\">#</a> 6.1 Ecd 配置</h5>\n<p>Etcd 配置大致相同，注意修改每个 Master 节点的 etcd 配置的主机名和 IP 地址</p>\n<h6 id=\"611-master01\"><a class=\"anchor\" href=\"#611-master01\">#</a> 6.1.1 Master01</h6>\n<pre><code># vim /etc/etcd/etcd.config.yml\nname: 'k8s-master01'     # k8s-master01名称\ndata-dir: /var/lib/etcd\nwal-dir: /var/lib/etcd/wal\nsnapshot-count: 5000\nheartbeat-interval: 100\nelection-timeout: 1000\nquota-backend-bytes: 0\nlisten-peer-urls: 'https://192.168.1.71:2380'            # k8s-master01 IP\nlisten-client-urls: 'https://192.168.1.71:2379,http://127.0.0.1:2379'   # k8s-master01 IP\nmax-snapshots: 3\nmax-wals: 5\ncors:\ninitial-advertise-peer-urls: 'https://192.168.1.71:2380'  # k8s-master01 IP\nadvertise-client-urls: 'https://192.168.1.71:2379'        # k8s-master01 IP\ndiscovery:\ndiscovery-fallback: 'proxy'\ndiscovery-proxy:\ndiscovery-srv:\ninitial-cluster: 'k8s-master01=https://192.168.1.71:2380,k8s-master02=https://192.168.1.72:2380,k8s-master03=https://192.168.1.73:2380'     # k8s-master01、k8s-master02、k8s-master03 IP \ninitial-cluster-token: 'etcd-k8s-cluster'\ninitial-cluster-state: 'new'\nstrict-reconfig-check: false\nenable-v2: true\nenable-pprof: true\nproxy: 'off'\nproxy-failure-wait: 5000\nproxy-refresh-interval: 30000\nproxy-dial-timeout: 1000\nproxy-write-timeout: 5000\nproxy-read-timeout: 0\nclient-transport-security:\n  cert-file: '/etc/kubernetes/pki/etcd/etcd.pem'\n  key-file: '/etc/kubernetes/pki/etcd/etcd-key.pem'\n  client-cert-auth: true\n  trusted-ca-file: '/etc/kubernetes/pki/etcd/etcd-ca.pem'\n  auto-tls: true\npeer-transport-security:\n  cert-file: '/etc/kubernetes/pki/etcd/etcd.pem'\n  key-file: '/etc/kubernetes/pki/etcd/etcd-key.pem'\n  peer-client-cert-auth: true\n  trusted-ca-file: '/etc/kubernetes/pki/etcd/etcd-ca.pem'\n  auto-tls: true\ndebug: false\nlog-package-levels:\nlog-outputs: [default]\nforce-new-cluster: false\n</code></pre>\n<h6 id=\"612-master02\"><a class=\"anchor\" href=\"#612-master02\">#</a> 6.1.2 Master02</h6>\n<pre><code># vim /etc/etcd/etcd.config.yml\t\nname: 'k8s-master02'   # k8s-master02名称\ndata-dir: /var/lib/etcd\nwal-dir: /var/lib/etcd/wal\nsnapshot-count: 5000\nheartbeat-interval: 100\nelection-timeout: 1000\nquota-backend-bytes: 0\nlisten-peer-urls: 'https://192.168.1.72:2380'      # k8s-master02 IP\nlisten-client-urls: 'https://192.168.1.72:2379,http://127.0.0.1:2379'    # k8s-master02 IP\nmax-snapshots: 3\nmax-wals: 5\ncors:\ninitial-advertise-peer-urls: 'https://192.168.1.72:2380'    # k8s-master02 IP\nadvertise-client-urls: 'https://192.168.1.72:2379'     # k8s-master02 IP\ndiscovery:\ndiscovery-fallback: 'proxy'\ndiscovery-proxy:\ndiscovery-srv:\ninitial-cluster: 'k8s-master01=https://192.168.1.71:2380,k8s-master02=https://192.168.1.72:2380,k8s-master03=https://192.168.1.73:2380'             # k8s-master01、k8s-master02、k8s-master03 IP \ninitial-cluster-token: 'etcd-k8s-cluster'\ninitial-cluster-state: 'new'\nstrict-reconfig-check: false\nenable-v2: true\nenable-pprof: true\nproxy: 'off'\nproxy-failure-wait: 5000\nproxy-refresh-interval: 30000\nproxy-dial-timeout: 1000\nproxy-write-timeout: 5000\nproxy-read-timeout: 0\nclient-transport-security:\n  cert-file: '/etc/kubernetes/pki/etcd/etcd.pem'\n  key-file: '/etc/kubernetes/pki/etcd/etcd-key.pem'\n  client-cert-auth: true\n  trusted-ca-file: '/etc/kubernetes/pki/etcd/etcd-ca.pem'\n  auto-tls: true\npeer-transport-security:\n  cert-file: '/etc/kubernetes/pki/etcd/etcd.pem'\n  key-file: '/etc/kubernetes/pki/etcd/etcd-key.pem'\n  peer-client-cert-auth: true\n  trusted-ca-file: '/etc/kubernetes/pki/etcd/etcd-ca.pem'\n  auto-tls: true\ndebug: false\nlog-package-levels:\nlog-outputs: [default]\nforce-new-cluster: false\n</code></pre>\n<h6 id=\"613-master03\"><a class=\"anchor\" href=\"#613-master03\">#</a> 6.1.3 Master03</h6>\n<pre><code># vim /etc/etcd/etcd.config.yml\nname: 'k8s-master03'           # k8s-master03名称\ndata-dir: /var/lib/etcd\nwal-dir: /var/lib/etcd/wal\nsnapshot-count: 5000\nheartbeat-interval: 100\nelection-timeout: 1000\nquota-backend-bytes: 0\nlisten-peer-urls: 'https://192.168.1.73:2380'           # k8s-master03 IP\nlisten-client-urls: 'https://192.168.1.73:2379,http://127.0.0.1:2379'       # k8s-master03 IP\nmax-snapshots: 3\nmax-wals: 5\ncors:\ninitial-advertise-peer-urls: 'https://192.168.1.73:2380'      # k8s-master03 IP\nadvertise-client-urls: 'https://192.168.1.73:2379'            # k8s-master03 IP\ndiscovery:\ndiscovery-fallback: 'proxy'\ndiscovery-proxy:\ndiscovery-srv:\ninitial-cluster: 'k8s-master01=https://192.168.1.71:2380,k8s-master02=https://192.168.1.72:2380,k8s-master03=https://192.168.1.73:2380'                # k8s-master01、k8s-master02、k8s-master03 IP\ninitial-cluster-token: 'etcd-k8s-cluster'\ninitial-cluster-state: 'new'\nstrict-reconfig-check: false\nenable-v2: true\nenable-pprof: true\nproxy: 'off'\nproxy-failure-wait: 5000\nproxy-refresh-interval: 30000\nproxy-dial-timeout: 1000\nproxy-write-timeout: 5000\nproxy-read-timeout: 0\nclient-transport-security:\n  cert-file: '/etc/kubernetes/pki/etcd/etcd.pem'\n  key-file: '/etc/kubernetes/pki/etcd/etcd-key.pem'\n  client-cert-auth: true\n  trusted-ca-file: '/etc/kubernetes/pki/etcd/etcd-ca.pem'\n  auto-tls: true\npeer-transport-security:\n  cert-file: '/etc/kubernetes/pki/etcd/etcd.pem'\n  key-file: '/etc/kubernetes/pki/etcd/etcd-key.pem'\n  peer-client-cert-auth: true\n  trusted-ca-file: '/etc/kubernetes/pki/etcd/etcd-ca.pem'\n  auto-tls: true\ndebug: false\nlog-package-levels:\nlog-outputs: [default]\nforce-new-cluster: false\n</code></pre>\n<h6 id=\"614-启动etcd\"><a class=\"anchor\" href=\"#614-启动etcd\">#</a> 6.1.4 启动 Etcd</h6>\n<p><mark>所有 Master 节点</mark>创建 etcd service 并启动</p>\n<pre><code># vim /usr/lib/systemd/system/etcd.service\n[Unit]\nDescription=Etcd Service\nDocumentation=https://coreos.com/etcd/docs/latest/\nAfter=network.target\n\n[Service]\nType=notify\nExecStart=/usr/local/bin/etcd --config-file=/etc/etcd/etcd.config.yml\nRestart=on-failure\nRestartSec=10\nLimitNOFILE=65536\n\n[Install]\nWantedBy=multi-user.target\nAlias=etcd3.service\n</code></pre>\n<p><mark>所有 Master 节点</mark>创建 etcd 的证书目录：</p>\n<pre><code>mkdir /etc/kubernetes/pki/etcd\nln -s /etc/etcd/ssl/* /etc/kubernetes/pki/etcd/\nsystemctl daemon-reload\nsystemctl enable --now etcd\n</code></pre>\n<p>查看 etcd 状态：</p>\n<pre><code>export ETCDCTL_API=3\netcdctl --endpoints=&quot;192.168.1.73:2379,192.168.1.72:2379,192.168.1.71:2379&quot; --cacert=/etc/kubernetes/pki/etcd/etcd-ca.pem --cert=/etc/kubernetes/pki/etcd/etcd.pem --key=/etc/kubernetes/pki/etcd/etcd-key.pem  endpoint status --write-out=table\n</code></pre>\n<h5 id=\"62-apiserver配置\"><a class=\"anchor\" href=\"#62-apiserver配置\">#</a> 6.2 APIServer 配置</h5>\n<h6 id=\"621-master01\"><a class=\"anchor\" href=\"#621-master01\">#</a> 6.2.1 Master01</h6>\n<p>注意：本文档使用的 k8s service 网段为 10.96.0.0/16，该网段不能和宿主机的网段、Pod 网段的重复，请按需修改：</p>\n<pre><code>[root@k8s-master01 pki]# vim /usr/lib/systemd/system/kube-apiserver.service \n\n[Unit]\nDescription=Kubernetes API Server\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/kube-apiserver \\\n      --v=2  \\\n      --allow-privileged=true  \\\n      --bind-address=0.0.0.0  \\\n      --secure-port=6443  \\\n      --advertise-address=192.168.1.71 \\\n      --service-cluster-ip-range=10.96.0.0/16  \\\n      --service-node-port-range=30000-32767  \\\n      --etcd-servers=https://192.168.1.71:2379,https://192.168.1.72:2379,https://192.168.1.73:2379 \\\n      --etcd-cafile=/etc/etcd/ssl/etcd-ca.pem  \\\n      --etcd-certfile=/etc/etcd/ssl/etcd.pem  \\\n      --etcd-keyfile=/etc/etcd/ssl/etcd-key.pem  \\\n      --client-ca-file=/etc/kubernetes/pki/ca.pem  \\\n      --tls-cert-file=/etc/kubernetes/pki/apiserver.pem  \\\n      --tls-private-key-file=/etc/kubernetes/pki/apiserver-key.pem  \\\n      --kubelet-client-certificate=/etc/kubernetes/pki/apiserver.pem  \\\n      --kubelet-client-key=/etc/kubernetes/pki/apiserver-key.pem  \\\n      --service-account-key-file=/etc/kubernetes/pki/sa.pub  \\\n      --service-account-signing-key-file=/etc/kubernetes/pki/sa.key  \\\n      --service-account-issuer=https://kubernetes.default.svc.cluster.local \\\n      --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname  \\\n      --enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,ResourceQuota  \\\n      --authorization-mode=Node,RBAC  \\\n      --enable-bootstrap-token-auth=true  \\\n      --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.pem  \\\n      --proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.pem  \\\n      --proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client-key.pem  \\\n      --requestheader-allowed-names=aggregator  \\\n      --requestheader-group-headers=X-Remote-Group  \\\n      --requestheader-extra-headers-prefix=X-Remote-Extra-  \\\n      --requestheader-username-headers=X-Remote-User\n      # --token-auth-file=/etc/kubernetes/token.csv\n\nRestart=on-failure\nRestartSec=10s\nLimitNOFILE=65535\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<h6 id=\"622-master02\"><a class=\"anchor\" href=\"#622-master02\">#</a> 6.2.2 Master02</h6>\n<p>注意：本文档使用的 k8s service 网段为 10.96.0.0/16，该网段不能和宿主机的网段、Pod 网段的重复，请按需修改：</p>\n<pre><code>[root@k8s-master01 pki]# vim  /usr/lib/systemd/system/kube-apiserver.service \n\n[Unit]\nDescription=Kubernetes API Server\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/kube-apiserver \\\n      --v=2  \\\n      --allow-privileged=true  \\\n      --bind-address=0.0.0.0  \\\n      --secure-port=6443  \\\n      --advertise-address=192.168.1.72 \\\n      --service-cluster-ip-range=10.96.0.0/16  \\\n      --service-node-port-range=30000-32767  \\\n      --etcd-servers=https://192.168.1.71:2379,https://192.168.1.72:2379,https://192.168.1.73:2379 \\\n      --etcd-cafile=/etc/etcd/ssl/etcd-ca.pem  \\\n      --etcd-certfile=/etc/etcd/ssl/etcd.pem  \\\n      --etcd-keyfile=/etc/etcd/ssl/etcd-key.pem  \\\n      --client-ca-file=/etc/kubernetes/pki/ca.pem  \\\n      --tls-cert-file=/etc/kubernetes/pki/apiserver.pem  \\\n      --tls-private-key-file=/etc/kubernetes/pki/apiserver-key.pem  \\\n      --kubelet-client-certificate=/etc/kubernetes/pki/apiserver.pem  \\\n      --kubelet-client-key=/etc/kubernetes/pki/apiserver-key.pem  \\\n      --service-account-key-file=/etc/kubernetes/pki/sa.pub  \\\n      --service-account-signing-key-file=/etc/kubernetes/pki/sa.key  \\\n      --service-account-issuer=https://kubernetes.default.svc.cluster.local \\\n      --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname  \\\n      --enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,ResourceQuota  \\\n      --authorization-mode=Node,RBAC  \\\n      --enable-bootstrap-token-auth=true  \\\n      --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.pem  \\\n      --proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.pem  \\\n      --proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client-key.pem  \\\n      --requestheader-allowed-names=aggregator  \\\n      --requestheader-group-headers=X-Remote-Group  \\\n      --requestheader-extra-headers-prefix=X-Remote-Extra-  \\\n      --requestheader-username-headers=X-Remote-User\n\nRestart=on-failure\nRestartSec=10s\nLimitNOFILE=65535\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<h6 id=\"623-master03\"><a class=\"anchor\" href=\"#623-master03\">#</a> 6.2.3 Master03</h6>\n<p>注意：本文档使用的 k8s service 网段为 10.96.0.0/16，该网段不能和宿主机的网段、Pod 网段的重复，请按需修改：</p>\n<pre><code>[root@k8s-master01 pki]# vim  /usr/lib/systemd/system/kube-apiserver.service \n\n[Unit]\nDescription=Kubernetes API Server\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/kube-apiserver \\\n      --v=2  \\\n      --allow-privileged=true  \\\n      --bind-address=0.0.0.0  \\\n      --secure-port=6443  \\\n      --advertise-address=192.168.1.73 \\\n      --service-cluster-ip-range=10.96.0.0/16  \\\n      --service-node-port-range=30000-32767  \\\n      --etcd-servers=https://192.168.1.71:2379,https://192.168.1.72:2379,https://192.168.1.73:2379 \\\n      --etcd-cafile=/etc/etcd/ssl/etcd-ca.pem  \\\n      --etcd-certfile=/etc/etcd/ssl/etcd.pem  \\\n      --etcd-keyfile=/etc/etcd/ssl/etcd-key.pem  \\\n      --client-ca-file=/etc/kubernetes/pki/ca.pem  \\\n      --tls-cert-file=/etc/kubernetes/pki/apiserver.pem  \\\n      --tls-private-key-file=/etc/kubernetes/pki/apiserver-key.pem  \\\n      --kubelet-client-certificate=/etc/kubernetes/pki/apiserver.pem  \\\n      --kubelet-client-key=/etc/kubernetes/pki/apiserver-key.pem  \\\n      --service-account-key-file=/etc/kubernetes/pki/sa.pub  \\\n      --service-account-signing-key-file=/etc/kubernetes/pki/sa.key  \\\n      --service-account-issuer=https://kubernetes.default.svc.cluster.local \\\n      --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname  \\\n      --enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,ResourceQuota  \\\n      --authorization-mode=Node,RBAC  \\\n      --enable-bootstrap-token-auth=true  \\\n      --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.pem  \\\n      --proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.pem  \\\n      --proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client-key.pem  \\\n      --requestheader-allowed-names=aggregator  \\\n      --requestheader-group-headers=X-Remote-Group  \\\n      --requestheader-extra-headers-prefix=X-Remote-Extra-  \\\n      --requestheader-username-headers=X-Remote-User\n      # --token-auth-file=/etc/kubernetes/token.csv\n\nRestart=on-failure\nRestartSec=10s\nLimitNOFILE=65535\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<h6 id=\"624-启动apiserver\"><a class=\"anchor\" href=\"#624-启动apiserver\">#</a> 6.2.4 启动 apiserver</h6>\n<p><mark>所有 Master 节点</mark>开启 kube-apiserver：</p>\n<pre><code>systemctl daemon-reload &amp;&amp; systemctl enable --now kube-apiserver\n</code></pre>\n<p>检测 kube-server 状态：</p>\n<pre><code># systemctl status kube-apiserver\n\n● kube-apiserver.service – Kubernetes API Server\n   Loaded: loaded (/usr/lib/systemd/system/kube-apiserver.service; enabled; vendor preset: disabled)\n   Active: active (running) since Sat 2020-08-22 21:26:49 CST; 26s ago \n</code></pre>\n<p>如果系统日志有这些提示可以忽略:</p>\n<pre><code>Dec 11 20:51:15 k8s-master01 kube-apiserver: I1211 20:51:15.004739    7450 clientconn.go:948] ClientConn switching balancer to “pick_first”\nDec 11 20:51:15 k8s-master01 kube-apiserver: I1211 20:51:15.004843    7450 balancer_conn_wrappers.go:78] pickfirstBalancer: HandleSubConnStateChange: 0xc011bd4c80, &#123;CONNECTING &lt;nil&gt;&#125;\nDec 11 20:51:15 k8s-master01 kube-apiserver: I1211 20:51:15.010725    7450 balancer_conn_wrappers.go:78] pickfirstBalancer: HandleSubConnStateChange: 0xc011bd4c80, &#123;READY &lt;nil&gt;&#125;\nDec 11 20:51:15 k8s-master01 kube-apiserver: I1211 20:51:15.011370    7450 controlbuf.go:508] transport: loopyWriter.run returning. Connection error: desc = “transport is closing”\n</code></pre>\n<h5 id=\"63-controllermanage\"><a class=\"anchor\" href=\"#63-controllermanage\">#</a> 6.3 ControllerManage</h5>\n<p><mark>所有 Master 节点</mark>配置 kube-controller-manager service（所有 master 节点配置一样）</p>\n<p>注意：本文档使用的 k8s Pod 网段为 172.16.0.0/16，该网段不能和宿主机的网段、k8s Service 网段的重复，请按需修改：</p>\n<pre><code>[root@k8s-master01 pki]# vim /usr/lib/systemd/system/kube-controller-manager.service\n[Unit]\nDescription=Kubernetes Controller Manager\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/kube-controller-manager \\\n      --v=2 \\\n      --root-ca-file=/etc/kubernetes/pki/ca.pem \\\n      --cluster-signing-cert-file=/etc/kubernetes/pki/ca.pem \\\n      --cluster-signing-key-file=/etc/kubernetes/pki/ca-key.pem \\\n      --service-account-private-key-file=/etc/kubernetes/pki/sa.key \\\n      --kubeconfig=/etc/kubernetes/controller-manager.kubeconfig \\\n      --authentication-kubeconfig=/etc/kubernetes/controller-manager.kubeconfig \\\n      --authorization-kubeconfig=/etc/kubernetes/controller-manager.kubeconfig \\\n      --leader-elect=true \\\n      --use-service-account-credentials=true \\\n      --node-monitor-grace-period=40s \\\n      --node-monitor-period=5s \\\n      --controllers=*,bootstrapsigner,tokencleaner \\\n      --allocate-node-cidrs=true \\\n      --cluster-cidr=172.16.0.0/16 \\\n      --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.pem \\\n      --node-cidr-mask-size=24\n      \nRestart=always\nRestartSec=10s\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<p><mark>所有 Master 节点</mark>启动 kube-controller-manager</p>\n<pre><code>[root@k8s-master01 pki]# systemctl daemon-reload\n\n[root@k8s-master01 pki]# systemctl enable --now kube-controller-manager\nCreated symlink /etc/systemd/system/multi-user.target.wants/kube-controller-manager.service → /usr/lib/systemd/system/kube-controller-manager.service.\n</code></pre>\n<p>查看启动状态</p>\n<pre><code>[root@k8s-master01 pki]# systemctl  status kube-controller-manager\n● kube-controller-manager.service – Kubernetes Controller Manager\n   Loaded: loaded (/usr/lib/ ubern/system/kube-controller-manager.service; enabled; vendor preset: disabled)\n Active: active (running) since Fri 2020-12-11 20:53:05 CST; 8s ago\n     Docs: https://github.com/  ubernetes/  ubernetes\n Main PID: 7518 (kube-controller)\n</code></pre>\n<h5 id=\"64-scheduler\"><a class=\"anchor\" href=\"#64-scheduler\">#</a> 6.4 Scheduler</h5>\n<p>所有 Master 节点配置 kube-scheduler service（所有 master 节点配置一样）</p>\n<pre><code>[root@k8s-master01 pki]# vim /usr/lib/systemd/system/kube-scheduler.service \n[Unit]\nDescription=Kubernetes Scheduler\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/kube-scheduler \\\n      --v=2 \\\n      --leader-elect=true \\\n      --authentication-kubeconfig=/etc/kubernetes/scheduler.kubeconfig \\\n      --authorization-kubeconfig=/etc/kubernetes/scheduler.kubeconfig \\\n      --kubeconfig=/etc/kubernetes/scheduler.kubeconfig\n\nRestart=always\nRestartSec=10s\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<p>启动 scheduler：</p>\n<pre><code>[root@k8s-master01 pki]# systemctl daemon-reload\n\n[root@k8s-master01 pki]# systemctl enable --now kube-scheduler\nCreated symlink /etc/systemd/system/multi-user.target.wants/kube-scheduler.service → /usr/lib/systemd/system/kube-scheduler.service.\n[root@k8s-master01 pki]# systemctl status kube-scheduler\n● kube-scheduler.service - Kubernetes Scheduler\n   Loaded: loaded (/usr/lib/systemd/system/kube-scheduler.service; enabled; vendor preset: disabled)\n   Active: active (running) since Wed 2022-05-04 17:31:13 CST; 6s ago\n     Docs: https://github.com/kubernetes/kubernetes\n Main PID: 5815 (kube-scheduler)\n    Tasks: 9\n   Memory: 19.8M\n</code></pre>\n<h4 id=\"7-tls-bootstrapping配置\"><a class=\"anchor\" href=\"#7-tls-bootstrapping配置\">#</a> 7. TLS Bootstrapping 配置</h4>\n<p>只需要在<mark> Master01</mark> 创建 bootstrap</p>\n<p>注意： 修改黄色部分的 IP 地址</p>\n<pre><code>cd /root/k8s-ha-install/bootstrap\nkubectl config set-cluster kubernetes     --certificate-authority=/etc/kubernetes/pki/ca.pem     --embed-certs=true     --server=https://192.168.1.70:8443     --kubeconfig=/etc/kubernetes/bootstrap-kubelet.kubeconfig\nkubectl config set-credentials tls-bootstrap-token-user     --token=c8ad9c.2e4d610cf3e7426e --kubeconfig=/etc/kubernetes/bootstrap-kubelet.kubeconfig\nkubectl config set-context tls-bootstrap-token-user@kubernetes     --cluster=kubernetes     --user=tls-bootstrap-token-user     --kubeconfig=/etc/kubernetes/bootstrap-kubelet.kubeconfig\nkubectl config use-context tls-bootstrap-token-user@kubernetes     --kubeconfig=/etc/kubernetes/bootstrap-kubelet.kubeconfig\n\n[root@k8s-master01 bootstrap]# mkdir -p /root/.kube ; cp /etc/kubernetes/admin.kubeconfig /root/.kube/config\n</code></pre>\n<p>可以正常查询集群状态，才可以继续往下，否则不行，需要排查 k8s 组件是否有故障（只要有结果即可，如果返回不一样不影响）</p>\n<pre><code># kubectl get cs\nWarning: v1 ComponentStatus is deprecated in v1.19+\nNAME                 STATUS    MESSAGE   ERROR\ncontroller-manager   Healthy   ok        \nscheduler            Healthy   ok        \netcd-0               Healthy   ok\n</code></pre>\n<p>创建 bootstrap 相关资源：</p>\n<pre><code>[root@k8s-master01 bootstrap]# kubectl create -f bootstrap.secret.yaml \nsecret/bootstrap-token-c8ad9c created\nclusterrolebinding.rbac.authorization.k8s.io/kubelet-bootstrap created\nclusterrolebinding.rbac.authorization.k8s.io/node-autoapprove-bootstrap created\nclusterrolebinding.rbac.authorization.k8s.io/node-autoapprove-certificate-rotation created\nclusterrole.rbac.authorization.k8s.io/system:kube-apiserver-to-kubelet created\nclusterrolebinding.rbac.authorization.k8s.io/system:kube-apiserver created\n</code></pre>\n<h4 id=\"8-node节点配置\"><a class=\"anchor\" href=\"#8-node节点配置\">#</a> 8. Node 节点配置</h4>\n<h5 id=\"81-复制证书\"><a class=\"anchor\" href=\"#81-复制证书\">#</a> 8.1 复制证书</h5>\n<p><mark>Master01 节点</mark>复制证书至其他节点：</p>\n<pre><code>cd /etc/kubernetes/\n\nfor NODE in k8s-master02 k8s-master03 k8s-node01 k8s-node02; do\n     ssh $NODE mkdir -p /etc/kubernetes/pki\n     for FILE in pki/ca.pem pki/ca-key.pem pki/front-proxy-ca.pem bootstrap-kubelet.kubeconfig; do\n       scp /etc/kubernetes/$FILE $NODE:/etc/kubernetes/$&#123;FILE&#125;\n done\n done\n</code></pre>\n<p>执行结果：</p>\n<pre><code>ca.pem                                                                                                                                                                         100% 1407   459.5KB/s   00:00    \n…\nbootstrap-kubelet.kubeconfig                                                                                                                                                   100% 2291   685.4KB/s   00:00\n</code></pre>\n<h5 id=\"82-kubelet配置\"><a class=\"anchor\" href=\"#82-kubelet配置\">#</a> 8.2 Kubelet 配置</h5>\n<p><mark>所有节点</mark>创建 Kubelet 配置目录</p>\n<pre><code>mkdir -p /var/lib/kubelet /var/log/kubernetes /etc/systemd/system/kubelet.service.d /etc/kubernetes/manifests/\n</code></pre>\n<p><mark>所有节点</mark>配置 kubelet service</p>\n<pre><code>[root@k8s-master01 bootstrap]# vim  /usr/lib/systemd/system/kubelet.service\n\n[Unit]\nDescription=Kubernetes Kubelet\nDocumentation=https://github.com/kubernetes/kubernetes\n\n[Service]\nExecStart=/usr/local/bin/kubelet\n\nRestart=always\nStartLimitInterval=0\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<p><mark>所有节点</mark>配置 kubelet service 的配置文件（也可以写到 kubelet.service）：</p>\n<pre><code># Runtime为Containerd\n# vim /etc/systemd/system/kubelet.service.d/10-kubelet.conf\n\n[Service]\nEnvironment=&quot;KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.kubeconfig --kubeconfig=/etc/kubernetes/kubelet.kubeconfig&quot;\nEnvironment=&quot;KUBELET_SYSTEM_ARGS=--container-runtime-endpoint=unix:///run/containerd/containerd.sock&quot;\nEnvironment=&quot;KUBELET_CONFIG_ARGS=--config=/etc/kubernetes/kubelet-conf.yml&quot;\nEnvironment=&quot;KUBELET_EXTRA_ARGS=--node-labels=node.kubernetes.io/node='' &quot;\nExecStart=\nExecStart=/usr/local/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_SYSTEM_ARGS $KUBELET_EXTRA_ARGS\n</code></pre>\n<p><mark>所有节点</mark>创建 kubelet 的配置文件</p>\n<p><em>注意：如果更改了 k8s 的 service 网段，需要更改 kubelet-conf.yml 的 clusterDNS: 配置，改成 k8s Service 网段的第十个地址，比如 10.96.0.10</em></p>\n<pre><code>[root@k8s-master01 bootstrap]# vim /etc/kubernetes/kubelet-conf.yml\n\napiVersion: kubelet.config.k8s.io/v1beta1\nkind: KubeletConfiguration\naddress: 0.0.0.0\nport: 10250\nreadOnlyPort: 10255\nauthentication:\n  anonymous:\n    enabled: false\n  webhook:\n    cacheTTL: 2m0s\n    enabled: true\n  x509:\n    clientCAFile: /etc/kubernetes/pki/ca.pem\nauthorization:\n  mode: Webhook\n  webhook:\n    cacheAuthorizedTTL: 5m0s\n    cacheUnauthorizedTTL: 30s\ncgroupDriver: systemd\ncgroupsPerQOS: true\nclusterDNS:\n- 10.96.0.10\nclusterDomain: cluster.local\ncontainerLogMaxFiles: 5\ncontainerLogMaxSize: 10Mi\ncontentType: application/vnd.kubernetes.protobuf\ncpuCFSQuota: true\ncpuManagerPolicy: none\ncpuManagerReconcilePeriod: 10s\nenableControllerAttachDetach: true\nenableDebuggingHandlers: true\nenforceNodeAllocatable:\n- pods\neventBurst: 10\neventRecordQPS: 5\nevictionHard:\n  imagefs.available: 15%\n  memory.available: 100Mi\n  nodefs.available: 10%\n  nodefs.inodesFree: 5%\nevictionPressureTransitionPeriod: 5m0s\nfailSwapOn: true\nfileCheckFrequency: 20s\nhairpinMode: promiscuous-bridge\nhealthzBindAddress: 127.0.0.1\nhealthzPort: 10248\nhttpCheckFrequency: 20s\nimageGCHighThresholdPercent: 85\nimageGCLowThresholdPercent: 80\nimageMinimumGCAge: 2m0s\niptablesDropBit: 15\niptablesMasqueradeBit: 14\nkubeAPIBurst: 10\nkubeAPIQPS: 5\nmakeIPTablesUtilChains: true\nmaxOpenFiles: 1000000\nmaxPods: 110\nnodeStatusUpdateFrequency: 10s\noomScoreAdj: -999\npodPidsLimit: -1\nregistryBurst: 10\nregistryPullQPS: 5\nresolvConf: /etc/resolv.conf\nrotateCertificates: true\nruntimeRequestTimeout: 2m0s\nserializeImagePulls: true\nstaticPodPath: /etc/kubernetes/manifests\nstreamingConnectionIdleTimeout: 4h0m0s\nsyncFrequency: 1m0s\nvolumeStatsAggPeriod: 1m0s\n</code></pre>\n<p>启动<mark>所有节点</mark> kubelet</p>\n<pre><code>systemctl daemon-reload\nsystemctl enable --now kubelet\n</code></pre>\n<p>此时系统日志 /var/log/messages**** 显示只有如下两种信息为正常 ****，安装 calico 后即可恢复</p>\n<pre><code>Unable to update cni config: no networks found in /etc/cni/net.d\n</code></pre>\n<p><a href=\"https://imgse.com/i/pE2ZkVK\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/10/pE2ZkVK.png\" alt=\"pE2ZkVK.png\" /></a></p>\n<p><em>如果有很多报错日志，或者有大量看不懂的报错，说明 kubelet 的配置有误，需要检查 kubelet 配置</em></p>\n<p>Master01 查看集群状态 (Ready 或 NotReady 都正常)</p>\n<pre><code>[root@k8s-master01 bootstrap]# kubectl get node\n</code></pre>\n<h5 id=\"83-kube-proxy配置\"><a class=\"anchor\" href=\"#83-kube-proxy配置\">#</a> 8.3 kube-proxy 配置</h5>\n<p><em>注意，如果不是高可用集群，192.168.1.70:8443 改为 master01 的地址，8443 改为 apiserver 的端口，默认是 6443</em></p>\n<p>生成 kube-proxy 的证书，以下操作只在<mark> Master01</mark> 执行</p>\n<pre><code>cd /root/k8s-ha-install/pki\ncfssl gencert \\\n   -ca=/etc/kubernetes/pki/ca.pem \\\n   -ca-key=/etc/kubernetes/pki/ca-key.pem \\\n   -config=ca-config.json \\\n   -profile=kubernetes \\\n   kube-proxy-csr.json | cfssljson -bare /etc/kubernetes/pki/kube-proxy\n\nkubectl config set-cluster kubernetes \\\n     --certificate-authority=/etc/kubernetes/pki/ca.pem \\\n     --embed-certs=true \\\n     --server=https://192.168.1.70:8443 \\\n     --kubeconfig=/etc/kubernetes/kube-proxy.kubeconfig\n\n\nkubectl config set-credentials system:kube-proxy \\\n     --client-certificate=/etc/kubernetes/pki/kube-proxy.pem \\\n     --client-key=/etc/kubernetes/pki/kube-proxy-key.pem \\\n     --embed-certs=true \\\n     --kubeconfig=/etc/kubernetes/kube-proxy.kubeconfig\n\nkubectl config set-context system:kube-proxy@kubernetes \\\n     --cluster=kubernetes \\\n     --user=system:kube-proxy \\\n     --kubeconfig=/etc/kubernetes/kube-proxy.kubeconfig\n\n\nkubectl config use-context system:kube-proxy@kubernetes \\\n     --kubeconfig=/etc/kubernetes/kube-proxy.kubeconfig\n</code></pre>\n<p>将 kubeconfig 发送至其他节点</p>\n<pre><code>for NODE in k8s-master02 k8s-master03; do\n     scp /etc/kubernetes/kube-proxy.kubeconfig  $NODE:/etc/kubernetes/kube-proxy.kubeconfig\n done\n\nfor NODE in k8s-node01 k8s-node02; do\n     scp /etc/kubernetes/kube-proxy.kubeconfig $NODE:/etc/kubernetes/kube-proxy.kubeconfig\n done\n</code></pre>\n<p><mark>所有节点</mark>添加 kube-proxy 的配置和 service 文件：</p>\n<pre><code>vim /usr/lib/systemd/system/kube-proxy.service\n\n[Unit]\nDescription=Kubernetes Kube Proxy\nDocumentation=https://github.com/kubernetes/kubernetes\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/kube-proxy \\\n  --config=/etc/kubernetes/kube-proxy.yaml \\\n  --v=2\n\nRestart=always\nRestartSec=10s\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<p>如果更改了集群 Pod 的网段，需要更改 kube-proxy.yaml 的 clusterCIDR 为自己的 Pod 网段：</p>\n<pre><code>vim /etc/kubernetes/kube-proxy.yaml\n\napiVersion: kubeproxy.config.k8s.io/v1alpha1\nbindAddress: 0.0.0.0\nclientConnection:\n  acceptContentTypes: &quot;&quot;\n  burst: 10\n  contentType: application/vnd.kubernetes.protobuf\n  kubeconfig: /etc/kubernetes/kube-proxy.kubeconfig\n  qps: 5\nclusterCIDR: 172.16.0.0/16 \nconfigSyncPeriod: 15m0s\nconntrack:\n  max: null\n  maxPerCore: 32768\n  min: 131072\n  tcpCloseWaitTimeout: 1h0m0s\n  tcpEstablishedTimeout: 24h0m0s\nenableProfiling: false\nhealthzBindAddress: 0.0.0.0:10256\nhostnameOverride: &quot;&quot;\niptables:\n  masqueradeAll: false\n  masqueradeBit: 14\n  minSyncPeriod: 0s\n  syncPeriod: 30s\nipvs:\n  masqueradeAll: true\n  minSyncPeriod: 5s\n  scheduler: &quot;rr&quot;\n  syncPeriod: 30s\nkind: KubeProxyConfiguration\nmetricsBindAddress: 127.0.0.1:10249\nmode: &quot;ipvs&quot;\nnodePortAddresses: null\noomScoreAdj: -999\nportRange: &quot;&quot;\nudpIdleTimeout: 250ms\n</code></pre>\n<p><mark>所有节点</mark>启动 kube-proxy</p>\n<pre><code>[root@k8s-master01 k8s-ha-install]# systemctl daemon-reload\n[root@k8s-master01 k8s-ha-install]# systemctl enable --now kube-proxy\nCreated symlink /etc/systemd/system/multi-user.target.wants/kube-proxy.service → /usr/lib/systemd/system/kube-proxy.service.\n</code></pre>\n<p>此时系统日志 /var/log/messages**** 显示只有如下两种信息为正常 ****，安装 calico 后即可恢复</p>\n<pre><code>Unable to update cni config: no networks found in /etc/cni/net.d\n</code></pre>\n<p><a href=\"https://imgse.com/i/pE2ZkVK\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/10/pE2ZkVK.png\" alt=\"pE2ZkVK.png\" /></a></p>\n<h4 id=\"9-calico组件的安装\"><a class=\"anchor\" href=\"#9-calico组件的安装\">#</a> 9. Calico 组件的安装</h4>\n<p>以下步骤只在 master01 执行：</p>\n<pre><code>cd /root/k8s-ha-install/calico/\n</code></pre>\n<p>更改 calico 的网段，主要需要将红色部分的网段，改为自己的 Pod 网段</p>\n<pre><code>sed -i &quot;s#POD_CIDR#172.16.0.0/16#g&quot; calico.yaml\n</code></pre>\n<p><em>检查网段是自己的 Pod 网段， grep &quot;IPV4POOL_CIDR&quot; calico.yaml  -A 1</em></p>\n<p>查看容器和节点状态：</p>\n<pre><code>[root@k8s-master01 calico]# kubectl get po -n kube-system\nNAME                                       READY   STATUS    RESTARTS      AGE\ncalico-kube-controllers-66686fdb54-mk2g6   1/1     Running   1 (20s ago)   85s\ncalico-node-8fxqp                          1/1     Running   0             85s\ncalico-node-8nkfl                          1/1     Running   0             86s\ncalico-node-pmpf4                          1/1     Running   0             86s\ncalico-node-vnlk7                          1/1     Running   0             86s\ncalico-node-xpchb                          1/1     Running   0             85s\ncalico-typha-67c6dc57d6-259t8              1/1     Running   0             86s\n</code></pre>\n<p><em>如果容器状态异常可以使用 kubectl describe 或者 kubectl logs 查看容器的日志</em></p>\n<ol>\n<li>Kubectl logs -f POD_NAME -n kube-system</li>\n<li>Kubectl logs -f POD_NAME -c upgrade-ipam -n kube-system</li>\n</ol>\n<h4 id=\"10-安装coredns\"><a class=\"anchor\" href=\"#10-安装coredns\">#</a> 10. 安装 CoreDNS</h4>\n<pre><code>cd /root/k8s-ha-install/\n</code></pre>\n<p>如果更改了 k8s service 的网段需要将 coredns 的 serviceIP 改成 k8s service 网段的第十个 IP</p>\n<pre><code>COREDNS_SERVICE_IP=`kubectl get svc | grep kubernetes | awk '&#123;print $3&#125;'`0\nsed -i &quot;s#KUBEDNS_SERVICE_IP#$&#123;COREDNS_SERVICE_IP&#125;#g&quot; CoreDNS/coredns.yaml\n</code></pre>\n<p>安装 coredns</p>\n<pre><code>[root@k8s-master01 k8s-ha-install]# kubectl  create -f CoreDNS/coredns.yaml \nserviceaccount/coredns created\nclusterrole.rbac.authorization.k8s.io/system:coredns created\nclusterrolebinding.rbac.authorization.k8s.io/system:coredns created\nconfigmap/coredns created\ndeployment.apps/coredns created\nservice/kube-dns created\n</code></pre>\n<h4 id=\"11-metrics部署\"><a class=\"anchor\" href=\"#11-metrics部署\">#</a> 11. Metrics 部署</h4>\n<p>在新版的 Kubernetes 中系统资源的采集均使用 Metrics-server，可以通过 Metrics 采集节点和 Pod 的内存、磁盘、CPU 和网络的使用率。</p>\n<p>以下操作均在<mark> master01 节点</mark>执行，安装 metrics server:</p>\n<pre><code>cd /root/k8s-ha-install/metrics-server\nkubectl  create -f . \n\nserviceaccount/metrics-server created\nclusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created\nclusterrole.rbac.authorization.k8s.io/system:metrics-server created\nrolebinding.rbac.authorization.k8s.io/metrics-server-auth-reader created\nclusterrolebinding.rbac.authorization.k8s.io/metrics-server:system:auth-delegator created\nclusterrolebinding.rbac.authorization.k8s.io/system:metrics-server created\nservice/metrics-server created\ndeployment.apps/metrics-server created\napiservice.apiregistration.k8s.io/v1beta1.metrics.k8s.io created\n</code></pre>\n<p>等待 metrics server 启动然后查看状态：</p>\n<pre><code># kubectl  top node\nNAME           CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   \nk8s-master01   231m         5%     1620Mi          42%       \nk8s-master02   274m         6%     1203Mi          31%       \nk8s-master03   202m         5%     1251Mi          32%       \nk8s-node01     69m          1%     667Mi           17%       \nk8s-node02     73m          1%     650Mi           16%\n</code></pre>\n<p>如果有如下报错，可以等待 10 分钟后，再次查看：</p>\n<pre><code>Error from server (ServiceUnavailable): the server is currently unable to handle the request (get nodes.metrics.k8s.io)\n</code></pre>\n<h4 id=\"12-dashboard部署\"><a class=\"anchor\" href=\"#12-dashboard部署\">#</a> 12. Dashboard 部署</h4>\n<h5 id=\"121-安装dashboard\"><a class=\"anchor\" href=\"#121-安装dashboard\">#</a> 12.1 安装 Dashboard</h5>\n<p>Dashboard 用于展示集群中的各类资源，同时也可以通过 Dashboard 实时查看 Pod 的日志和在容器中执行一些命令等。</p>\n<pre><code>cd /root/k8s-ha-install/dashboard/\n\n[root@k8s-master01 dashboard]# kubectl  create -f .\nserviceaccount/admin-user created\nclusterrolebinding.rbac.authorization.k8s.io/admin-user created\nnamespace/kubernetes-dashboard created\nserviceaccount/kubernetes-dashboard created\nservice/kubernetes-dashboard created\nsecret/kubernetes-dashboard-certs created\nsecret/kubernetes-dashboard-csrf created\nsecret/kubernetes-dashboard-key-holder created\nconfigmap/kubernetes-dashboard-settings created\nrole.rbac.authorization.k8s.io/kubernetes-dashboard created\nclusterrole.rbac.authorization.k8s.io/kubernetes-dashboard created\nrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created\nclusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created\ndeployment.apps/kubernetes-dashboard created\nservice/dashboard-metrics-scraper created\ndeployment.apps/dashboard-metrics-scraper created\n</code></pre>\n<h5 id=\"122-登录dashboard\"><a class=\"anchor\" href=\"#122-登录dashboard\">#</a> 12.2 登录 dashboard</h5>\n<p>在谷歌浏览器（Chrome）启动文件中加入启动参数，用于解决无法访问 Dashboard 的问题，参考下图：</p>\n<pre><code>--test-type --ignore-certificate-errors\n</code></pre>\n<p><a href=\"https://imgse.com/i/pEgWfHJ\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgWfHJ.png\" alt=\"pEgWfHJ.png\" /></a></p>\n<p>更改 dashboard 的 svc 为 NodePort:</p>\n<pre><code>kubectl edit svc kubernetes-dashboard -n kubernetes-dashboard\n</code></pre>\n<p><a href=\"https://imgse.com/i/pEgW5NR\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgW5NR.png\" alt=\"pEgW5NR.png\" /></a></p>\n<p><em>将 ClusterIP 更改为 NodePort（如果已经为 NodePort 忽略此步骤）</em></p>\n<p>查看端口号：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get svc kubernetes-dashboard -n kubernetes-dashboard\nNAME                   TYPE       CLUSTER-IP     EXTERNAL-IP   PORT(S)         AGE\nkubernetes-dashboard   NodePort   10.96.139.11   &lt;none&gt;        443:32409/TCP   24h\n</code></pre>\n<p>根据自己的实例端口号，通过任意安装了 kube-proxy 的宿主机的 IP + 端口即可访问到 dashboard：</p>\n<p>访问 Dashboard：<a href=\"https://192.168.181.129:31106\">https://192.168.1.71:32409</a> （把 IP 地址和端口改成你自己的）选择登录方式为令牌（即 token 方式），参考下图：</p>\n<p><a href=\"https://imgse.com/i/pEgW736\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgW736.png\" alt=\"pEgW736.png\" /></a></p>\n<p>创建登录 Token：</p>\n<pre><code>kubectl create token admin-user -n kube-system\n</code></pre>\n<p>将 token 值输入到令牌后，单击登录即可访问 Dashboard，参考下图：</p>\n<p><a href=\"https://imgse.com/i/pEgfPv8\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgfPv8.png\" alt=\"pEgfPv8.png\" /></a></p>\n<h4 id=\"14-containerd配置镜像加速\"><a class=\"anchor\" href=\"#14-containerd配置镜像加速\">#</a> 14. Containerd 配置镜像加速</h4>\n<pre><code># vim /etc/containerd/config.toml\n#添加以下配置镜像加速服务\n       [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;docker.io&quot;]\n        endpoint=[&quot;https://dockerproxy.com&quot;, &quot;https://mirror.baidubce.com&quot;,&quot;https://ccr.ccs.tencentyun.com&quot;,&quot;https://docker.m.daocloud.io&quot;,&quot;https://docker.nju.edu.cn&quot;,&quot;https://docker.mirrors.ustc.edu.cn&quot;,&quot;https://registry-1.docker.io&quot;, &quot;https://hbv0b596.mirror.aliyuncs.com&quot;]\n       [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;registry.k8s.io&quot;]\n        endpoint=[&quot;https://dockerproxy.com&quot;, &quot;https://mirror.baidubce.com&quot;,&quot;https://ccr.ccs.tencentyun.com&quot;,&quot;https://docker.m.daocloud.io&quot;,&quot;https://docker.nju.edu.cn&quot;,&quot;https://docker.mirrors.ustc.edu.cn&quot;,&quot;https://hbv0b596.mirror.aliyuncs.com&quot;, &quot;https://k8s.m.daocloud.io&quot;, &quot;https://docker.mirrors.ustc.edu.cn&quot;,&quot;https://hub-mirror.c.163.com&quot;]\n</code></pre>\n<p>所有节点重新启动 Containerd：</p>\n<pre><code># systemctl daemon-reload\n# systemctl restart containerd\n</code></pre>\n<h4 id=\"15-docker配置镜像加速\"><a class=\"anchor\" href=\"#15-docker配置镜像加速\">#</a> 15. Docker 配置镜像加速</h4>\n<pre><code># sudo mkdir -p /etc/docker\n# sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'\n&#123;\n  &quot;registry-mirrors&quot;: [\n\t  &quot;https://docker.credclouds.com&quot;,\n\t  &quot;https://k8s.credclouds.com&quot;,\n\t  &quot;https://quay.credclouds.com&quot;,\n\t  &quot;https://gcr.credclouds.com&quot;,\n\t  &quot;https://k8s-gcr.credclouds.com&quot;,\n\t  &quot;https://ghcr.credclouds.com&quot;,\n\t  &quot;https://do.nark.eu.org&quot;,\n\t  &quot;https://docker.m.daocloud.io&quot;,\n\t  &quot;https://docker.nju.edu.cn&quot;,\n\t  &quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;,\n\t  &quot;https://docker.1panel.live&quot;,\n\t  &quot;https://docker.rainbond.cc&quot;\n  ], \n  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;] \n&#125;\nEOF\n</code></pre>\n<p>所有节点重新启动 Docker：</p>\n<pre><code># systemctl daemon-reload\n# systemctl enable --now docker\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/2628187572.html",
            "url": "http://ixuyong.cn/posts/2628187572.html",
            "title": "MySQL运维DBA应用与实践",
            "date_published": "2025-04-09T14:02:40.000Z",
            "content_html": "<h3 id=\"mysql运维dba应用与实践\"><a class=\"anchor\" href=\"#mysql运维dba应用与实践\">#</a> MySQL 运维 DBA 应用与实践</h3>\n<h4 id=\"1日志\"><a class=\"anchor\" href=\"#1日志\">#</a> 1. 日志</h4>\n<p>在任何一种数据库中，都会有各种各样的日志，这些日志记录了数据库运行的各个方面。可以帮助数据库管理员追踪数据库曾经发生的一些事情。</p>\n<p>对于 MySQL 数据库，提供了四种不同的日志帮助我们追踪。</p>\n<ul>\n<li>\n<p>错误日志</p>\n</li>\n<li>\n<p>二进制日志</p>\n</li>\n<li>\n<p>查询日志</p>\n</li>\n<li>\n<p>慢查询日志</p>\n</li>\n</ul>\n<h5 id=\"11-错误日志\"><a class=\"anchor\" href=\"#11-错误日志\">#</a> 1.1 错误日志</h5>\n<p>错误日志是 MySQL 中最重要的日志之一，它记录了当 mysqld (MySQL 服务) 启动和停止时，以及服务器在运行过程中发生任何严重错误时的相关信息。当数据库出现任何故障导致无法正常使用时，建议首先查看此日志。</p>\n<p>该日志是默认开启的，默认存放目录 /var/log/，默认的日志文件名为 mysqld.log。查看日志位置；</p>\n<pre><code>mysql&gt; show variables like '%log_error%';\n+---------------------+---------------------+\n| Variable_name       | Value               |\n+---------------------+---------------------+\n| binlog_error_action | ABORT_SERVER        |\n| log_error           | /var/log/mysqld.log |\n| log_error_verbosity | 3                   |\n+---------------------+---------------------+\n</code></pre>\n<h5 id=\"12-二进制日志\"><a class=\"anchor\" href=\"#12-二进制日志\">#</a> 1.2 二进制日志</h5>\n<p>二进制日志 (BINLOG) 记录了所有的 DDL (数据定义语言) 语句和 DML (数据操纵语言) 语句，但不包括数据查询（SELECT、 SHOW）语句。</p>\n<p>作用:</p>\n<p>①. 灾难时的数据恢复；</p>\n<p>②. MySQL 的主从复制。</p>\n<p>在 MySQL5.7 版本中，默认二进制日志是关闭着的，涉及到的参数如下:</p>\n<h6 id=\"121-开启-bin-log记录\"><a class=\"anchor\" href=\"#121-开启-bin-log记录\">#</a> 1.2.1 开启 bin-log 记录</h6>\n<pre><code>1.1改修配置文件\n[root@db01 ~]# vim /etc/my.cnf\nserver-id=1\nlog-bin=mysql-bin\nmax_binlog_size=500M\nexpire_logs_days=15\n\n1.2查看是否开启binlog.\nmysql&gt; show variables like 'log_%';\n+----------------------------------------+--------------------------------+\n| Variable_name                          | Value                          |\n+----------------------------------------+--------------------------------+\n| log_bin                                | ON                             |\n| log_bin_basename                       | /var/lib/mysql/mysql-bin       |\n| log_bin_index                          | /var/lib/mysql/mysql-bin.index |\n| log_bin_trust_function_creators        | OFF                            |\n| log_bin_use_v1_row_events              | OFF                            |\n| log_builtin_as_identified_by_password  | OFF                            |\n| log_error                              | /var/log/mysqld.log            |\n| log_error_verbosity                    | 3                              |\n| log_output                             | FILE                           |\n| log_queries_not_using_indexes          | OFF                            |\n| log_slave_updates                      | OFF                            |\n| log_slow_admin_statements              | OFF                            |\n| log_slow_slave_statements              | OFF                            |\n| log_statements_unsafe_for_binlog       | ON                             |\n| log_syslog                             | OFF                            |\n| log_syslog_facility                    | daemon                         |\n| log_syslog_include_pid                 | ON                             |\n| log_syslog_tag                         |                                |\n| log_throttle_queries_not_using_indexes | 0                              |\n| log_timestamps                         | UTC                            |\n| log_warnings                           | 2                              |\n+----------------------------------------+--------------------------------+\n\n1.3查看binlog\nmysql&gt; show binary logs;\n+------------------+-----------+\n| Log_name         | File_size |\n+------------------+-----------+\n| mysql-bin.000001 |     36825 |\n| mysql-bin.000002 |    200464 |\n| mysql-bin.000003 |    419809 |\n+------------------+-----------+\n\n1.4查看binlog日志保存天数 \n# 0表示永久保留，expire_logs_days：保留指定日期范围内的binlog历史日志，上示例设置的15天内\nmysql&gt; show variables like 'expire_logs_days';\n+------------------+-------+\n| Variable_name    | Value |\n+------------------+-------+\n| expire_logs_days | 15    |\n+------------------+-------+\n1 row in set (0.00 sec)\n\n1.5查看binlog日志保存大小\n#max_binlog_size：bin log日志每达到设定大小后，会使用新的bin log日志。如mysql-bin.000002达到500M后，创建并使用mysql-bin.000003文件作为日志记录。\nmysql&gt; show variables like 'max_binlog_size';\n+-----------------+-----------+\n| Variable_name   | Value     |\n+-----------------+-----------+\n| max_binlog_size | 524288000 |\n+-----------------+-----------+\n\n1.6手动执行flush logs\n#将会new一个新文件用于记录binlog\nmysql&gt; flush logs;\n\n1.7手动清理binlog\n#将mysql-bin.000010之前的日志清理掉\nmysql&gt; purge binary logs to 'mysql-bin.000010';\nQuery OK, 0 rows affected (0.01 sec)\n\n#删除2022-04-21 18:08:00之前的binlog日志\nmysql&gt; purge binary logs before '2022-04-21 18:08:00';\n\n#清除全部binlog\nmysql&gt; reset master;\n</code></pre>\n<h6 id=\"122-日志格式\"><a class=\"anchor\" href=\"#122-日志格式\">#</a> <strong>1.2.2 日志格式</strong></h6>\n<p>MySQL 服务器中提供了多种格式来记录二进制日志，具体格式及特点如下：</p>\n<table>\n<thead>\n<tr>\n<th><strong>日志格式</strong></th>\n<th><strong>含义</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>STATEMENT</td>\n<td>基于 SQL 语句的日志记录，记录的是 SQL 语句，对数据进行修改的 SQL 都会记录在日志文件中。</td>\n</tr>\n<tr>\n<td>ROW</td>\n<td>基于行的日志记录，记录的是每一行的数据变更。(默认)</td>\n</tr>\n<tr>\n<td>MIXED</td>\n<td>混合了 STATEMENT 和 ROW 两种格式，默认采用 STATEMENT, 在某些特殊情况下会自动切换为 ROW 进行记录。</td>\n</tr>\n</tbody>\n</table>\n<pre><code>mysql&gt; show variables like 'binlog_format';\n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| binlog_format | ROW   |\n+---------------+-------+\n</code></pre>\n<p>由于日志是以二进制方式存储的，不能直接读取，需要通过二进制日志查询工具 <code>mysqlbinlog</code>  来查看，具体语法:</p>\n<pre><code>mysqlbinlog [ 参数选项] logfilename\n参数选项:\n\t-d\t\t\t指定数据库名称，只列出指定的数据库相关操作。\n\t-o\t\t\t忽略掉日志中的前n行命令。\n\t-v\t\t\t将行事件(数据变更)重构为SQL语句\n\t-vv\t\t\t将行事件(数据变更)重构为SQL语句，并输出注释信息\n</code></pre>\n<pre><code>mysql&gt; use zh;\nDatabase changed\nmysql&gt; show tables;\n+----------------+\n| Tables_in_zh   |\n+----------------+\n| account        |\n| course         |\n| dept           |\n| emp            |\n| score          |\n| student        |\n| student_course |\n| tb_user        |\n| tb_user_edu    |\n| user           |\n| user1          |\n+----------------+\n11 rows in set (0.00 sec)\n\nmysql&gt;  update tb_user_edu set university = &quot;北京大学&quot;;\nQuery OK, 4 rows affected (0.00 sec)\nRows matched: 4  Changed: 4  Warnings: 0\n\n#二进制日志查看\n[root@db01 ~]# mysqlbinlog -v /var/lib/mysql/mysql-bin.000001 \n</code></pre>\n<h6 id=\"123-修改binlog格式\"><a class=\"anchor\" href=\"#123-修改binlog格式\">#</a> 1.2.3 修改 binlog 格式</h6>\n<pre><code>[root@db01 ~]# vim /etc/my.cnf\n...\nbinlog_format=STATEMENT\n...\n[root@db01 ~]# systemctl restart mysqld\n\nmysql&gt;  update tb_user_edu set university = '清华大学';\n[root@db01 ~]# mysqlbinlog -v /var/lib/mysql/mysql-bin.000002 \n...\nSET TIMESTAMP=1701440373/*!*/;\nupdate tb_user_edu set university = '清华大学'\n...\n</code></pre>\n<h5 id=\"13-查询日志\"><a class=\"anchor\" href=\"#13-查询日志\">#</a> 1.3 查询日志</h5>\n<p>查询日志中记录了客户端的所有操作语句，而二进制日志不包含查询数据的 SQL 语句。默认情况下，<strong>查询日志是未开启的</strong>。如果需要开启查询日志，可以设置以下配置︰</p>\n<pre><code>mysql&gt; show variables like '%general%';\n+------------------+-------------------------+\n| Variable_name    | Value                   |\n+------------------+-------------------------+\n| general_log      | OFF                     |\n| general_log_file | /var/lib/mysql/db01.log |\n+------------------+-------------------------+\n2 rows in set (0.00 sec)\n\n#开启查询日志功能\n[root@db01 ~]# cat /etc/my.cnf\ngeneral_log=1\ngeneral_log_file=/var/lib/mysql/mysql_query.log \n[root@db01 ~]# systemctl restart mysqld\n\n[root@db01 ~]# tail -f /var/lib/mysql/mysql_query.log \n2023-12-01T14:31:28.554384Z\t    2 Field List\tstudent \n2023-12-01T14:31:28.554743Z\t    2 Field List\tstudent_course \n2023-12-01T14:31:35.737041Z\t    2 Query\tshow variables like '%general%'\n2023-12-01T14:31:37.345179Z\t    2 Query\tshow variables like '%general%'\n2023-12-01T14:32:17.593471Z\t    2 Query\tSELECT DATABASE()\n2023-12-01T14:32:17.593651Z\t    2 Init DB\tzh\n2023-12-01T14:32:25.249258Z\t    2 Query\tselect * from emp\n</code></pre>\n<h5 id=\"14-慢查询日志\"><a class=\"anchor\" href=\"#14-慢查询日志\">#</a> 1.4 慢查询日志</h5>\n<p>慢查询<a href=\"https://so.csdn.net/so/search?q=%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95&amp;spm=1001.2101.3001.7020\">日志记录</a>了所有执行时间超过参数 <code>long_ query_time</code>  设置值并且扫描记录数不小于 <code>min_examined_row_limit</code>  的所有的 SQL 语句的日志，默认未开启。<strong> <code>long_query_time</code>  默认为 10 秒，最小为 0，精度可以到微秒。</strong></p>\n<pre><code>[root@db01 ~]# vim /etc/my.cnf\n#慢查询日志\nslow_query_log=on\n##执行时间参数\nlong_query_time=2\n# 若没有指定，默认名字为hostname_slow.log\nslow_query_log_file = /var/lib/mysql/slow-query.log\n[root@db01 ~]# systemctl restart mysqld\n\n#制造慢查询并执行\nmysql&gt; select sleep(3);\n[root@db01 ~]# tail -f /var/lib/mysql/slow-query.log \n/usr/sbin/mysqld, Version: 5.7.43-log (MySQL Community Server (GPL)). started with:\nTcp port: 0  Unix socket: /var/lib/mysql/mysql.sock\nTime                 Id Command    Argument\n# Time: 2023-12-01T14:47:57.763735Z\n# User@Host: root[root] @ localhost []  Id:     2\n# Query_time: 3.001229  Lock_time: 0.000000 Rows_sent: 1  Rows_examined: 0\nuse zh;\nSET timestamp=1701442077;\nselect sleep(3);\n</code></pre>\n<p>默认情况下，不会记录管理语句，也不会记录不使用索引进行查找的查询。可以使用 <code>log_slow_admin_statements</code>  和更改此行为 <code>log_queries_not_using_indexes</code> , 如下所述。</p>\n<pre><code>#记录执行较慢的管理语句\nlog_slow_admin_statements = 1\n#记录执行较慢的未使用索引的语句\nlog_queries_not_using_indexes = 1\n</code></pre>\n<h4 id=\"2-主从复制\"><a class=\"anchor\" href=\"#2-主从复制\">#</a> 2. 主从复制</h4>\n<h5 id=\"21-主从复制的概述\"><a class=\"anchor\" href=\"#21-主从复制的概述\">#</a> 2.1 主从复制的概述</h5>\n<p>主从复制是指将<strong>主数据库的 DDL 和 DML 操作</strong>通过<strong>二进制日志</strong>传到<strong>从库服务器</strong>中，然后在从库上对这些日志重新执行 (也叫重做) ，从而使得从库和主库的数据保持同步。</p>\n<p><a href=\"https://imgse.com/i/pEgO0Mj\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgO0Mj.png\" alt=\"pEgO0Mj.png\" /></a></p>\n<p>MySQL 支持一台主库同时向多台从库进行复制，从库同时也可以作为其他从服务器的主库， 实现链状复制。</p>\n<p>MySQL 复制的有点主要包含以下三个方面：</p>\n<ol>\n<li>主库出现问题，可以快速切换到从库提供服务；</li>\n<li>实现读写分离，降低主库的访问压力；（如果增删改对主库 查询对从库）</li>\n<li>可以在从库中执行备份，以避免备份期间影响主库服务。</li>\n</ol>\n<h5 id=\"22-主从复制的原理\"><a class=\"anchor\" href=\"#22-主从复制的原理\">#</a> 2.2 主从复制的原理</h5>\n<p><a href=\"https://imgse.com/i/pEgOdzQ\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgOdzQ.png\" alt=\"pEgOdzQ.png\" /></a></p>\n<p>从上图来看，复制分成三步：</p>\n<ol>\n<li>Master 主库在事务提交时，会把数据变更记录在二进制日志文件 Binlog 中。</li>\n<li>从库 IO 线程读取主库的二进制日志文件 Binlog，写入到从库的中继日志 Relay Log。</li>\n<li>slave 重做中继日志中的事件，SQL 线程将改变反映它自己的数据。</li>\n</ol>\n<h5 id=\"23-主从复制的搭建\"><a class=\"anchor\" href=\"#23-主从复制的搭建\">#</a> 2.3 主从复制的搭建</h5>\n<p><strong>主从复制的搭建步骤</strong>：</p>\n<ol>\n<li>准备主从复制服务器环境</li>\n<li>完成主库配置</li>\n<li>完成从库配置</li>\n</ol>\n<h6 id=\"231-服务器准备\"><a class=\"anchor\" href=\"#231-服务器准备\">#</a> 2.3.1 服务器准备</h6>\n<p><a href=\"https://imgse.com/i/pEgODLn\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgODLn.png\" alt=\"pEgODLn.png\" /></a></p>\n<h6 id=\"232-主库配置\"><a class=\"anchor\" href=\"#232-主库配置\">#</a> 2.3.2 主库配置</h6>\n<p><strong>#1. 安装 MySQL</strong></p>\n<pre><code>#1、关闭防火墙、selinux、环境配置\n[root@db01 ~]# hostnamectl set-hostname db01\n[root@db01 ~]# systemctl stop firewalld\n[root@db01 ~]# systemctl disable firewalld\n[root@db01 ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux\n[root@db01 ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config\n[root@db01 ~]# yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y\n[root@db01 ~]# yum update -y --exclude=kernel* &amp;&amp; reboot\n[root@db01 ~]# echo 'Asia/Shanghai' &gt;/etc/timezone\n[root@db01 ~]# ntpdate time2.aliyun.com\n[root@db01 ~]# crontab -e\n*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com &amp;&gt; /dev/nul\n[root@db01 ~]# mkdir /soft /data /scripts /backup\n\n#2、安装Mysql5.7\n[root@db01 ~]# yum install -y mysql-community-server\n[root@db01 ~]# systemctl start mysqld &amp;&amp; systemctl enable mysqld\n\n[root@db01 ~]# mysql -uroot -p$(awk '/temporary password/&#123;print $NF&#125;' /var/log/mysqld.log)\nmysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'passwd';\nmysql&gt; grant all on *.* to 'root'@'192.168.1.%' identified by 'passwd';\n\n#3、允许root用户在任何地方进行远程登录，并具有所有库任何操作权限，具体操作如下：\nmysql -u root -p&quot;youpass&quot;\nmysql&gt;GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'passwd' WITH GRANT OPTION;\nFLUSH PRIVILEGES;\n\n#4.配置主库\n[root@db01 ~]# vim /etc/my.cnf\nserver-id=1                #mysql服务ID，保证整个集群环境中唯一， 取值范围: 1 - 2^&#123;32&#125;-1\nlog-bin=mysql-bin          #启动二进制日志\nread-only=0                #是否只读,1代表只读, 0代表读写\n#binlog-ignore-db=mysql    #忽略的数据，指不需要同步的数据库\n#binlog-do-db=db01         #指定同步的数据库\n[root@db01 ~]# systemctl restart mysqld\n\n#5.创建repl用户，并设置密码，该用户可在任意主机连接该MySQL服务\nmysql&gt; grant replication slave on *.* to 'repl'@'%' identified by 'passwd';\n\n#6.查看master位置点\nmysql&gt; show master status;        \n+------------------+----------+--------------+------------------+-------------------+\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |\n+------------------+----------+--------------+------------------+-------------------+\n| mysql-bin.000006 |      889 |              |                  |                   |\n+------------------+----------+--------------+------------------+-------------------+\n1 row in set (0.00 sec)\n</code></pre>\n<h6 id=\"233-从库配置\"><a class=\"anchor\" href=\"#233-从库配置\">#</a> 2.3.3 从库配置</h6>\n<table>\n<thead>\n<tr>\n<th>参数名</th>\n<th>含义</th>\n<th><strong>8.0.23 之前</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>SOURCE_HOST</td>\n<td>主库 IP 地址</td>\n<td>MASTER_HOST</td>\n</tr>\n<tr>\n<td>SOURCE_USER</td>\n<td>连接主库的用户名</td>\n<td>MASTER_USER</td>\n</tr>\n<tr>\n<td>SOURCE_PASSWORD</td>\n<td>连接主库的密码</td>\n<td>MASTER_PASSWORD</td>\n</tr>\n<tr>\n<td>SOURCE_LOG FILE</td>\n<td>binlog 日志文件名</td>\n<td>MASTER LOG_FILE</td>\n</tr>\n<tr>\n<td>SOURCE_LOG POS</td>\n<td>binlog 日志文件位置</td>\n<td>MASTER_LOG_POS</td>\n</tr>\n</tbody>\n</table>\n<pre><code>#1.配置从库\n[root@db02 ~]# vim /etc/my.cnf\nserver-id=2           #mysql服务ID\nread-only=1           #是否只读,1代表只读, 0代表读写\n[root@db02 ~]# systemctl restart mysqld\n\n#2..配置从服务器，连接主服务器\nmysql&gt; change master to master_host='192.168.40.150',master_user='repl',master_password='passwd',master_log_file='mysql-bin.000006',master_log_pos=889;\n\n#3.开启从库\nmysql&gt; start slave;\nQuery OK, 0 rows affected (0.00 sec)\n\n#4.检查主从复制状态\nmysql&gt; show slave status\\G\n*************************** 1. row ***************************\n               Slave_IO_State: Waiting for master to send event\n                  Master_Host: 192.168.40.150\n                  Master_User: repl\n                  Master_Port: 3306\n                Connect_Retry: 60\n              Master_Log_File: mysql-bin.000006\n          Read_Master_Log_Pos: 889\n               Relay_Log_File: db02-relay-bin.000002\n                Relay_Log_Pos: 320\n        Relay_Master_Log_File: mysql-bin.000006\n             Slave_IO_Running: Yes\n            Slave_SQL_Running: Yes\n              Replicate_Do_DB: \n          Replicate_Ignore_DB: \n           Replicate_Do_Table: \n       Replicate_Ignore_Table: \n      Replicate_Wild_Do_Table: \n  Replicate_Wild_Ignore_Table: \n                   Last_Errno: 0\n                   Last_Error: \n                 Skip_Counter: 0\n          Exec_Master_Log_Pos: 889\n              Relay_Log_Space: 526\n              Until_Condition: None\n               Until_Log_File: \n                Until_Log_Pos: 0\n           Master_SSL_Allowed: No\n           Master_SSL_CA_File: \n           Master_SSL_CA_Path: \n              Master_SSL_Cert: \n            Master_SSL_Cipher: \n               Master_SSL_Key: \n        Seconds_Behind_Master: 0\nMaster_SSL_Verify_Server_Cert: No\n                Last_IO_Errno: 0\n                Last_IO_Error: \n               Last_SQL_Errno: 0\n               Last_SQL_Error: \n  Replicate_Ignore_Server_Ids: \n             Master_Server_Id: 1\n                  Master_UUID: 9b911bea-43e6-11ee-b239-000c29074f5d\n             Master_Info_File: /var/lib/mysql/master.info\n                    SQL_Delay: 0\n          SQL_Remaining_Delay: NULL\n      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates\n           Master_Retry_Count: 86400\n                  Master_Bind: \n      Last_IO_Error_Timestamp: \n     Last_SQL_Error_Timestamp: \n               Master_SSL_Crl: \n           Master_SSL_Crlpath: \n           Retrieved_Gtid_Set: \n            Executed_Gtid_Set: \n                Auto_Position: 0\n         Replicate_Rewrite_DB: \n                 Channel_Name: \n           Master_TLS_Version: \n1 row in set (0.00 sec)\n</code></pre>\n<h4 id=\"3-分库分表\"><a class=\"anchor\" href=\"#3-分库分表\">#</a> 3. <a href=\"https://so.csdn.net/so/search?q=%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8&amp;spm=1001.2101.3001.7020\">分库分表</a></h4>\n<h5 id=\"31-分库分表介绍\"><a class=\"anchor\" href=\"#31-分库分表介绍\">#</a> 3.1 分库分表介绍</h5>\n<h6 id=\"311-现在的问题\"><a class=\"anchor\" href=\"#311-现在的问题\">#</a> 3.1.1 现在的问题</h6>\n<p><strong>单数据库</strong></p>\n<p>所有数据都是存放在一个<a href=\"https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6&amp;spm=1001.2101.3001.7020\">数据库文件</a>里的，经过常年累月，内存不足了怎么办？</p>\n<p><a href=\"https://imgse.com/i/pEgOyd0\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgOyd0.png\" alt=\"pEgOyd0.png\" /></a></p>\n<p>随着互联网及移动互联网的发展，应用系统的数据量也是成指数式增长，若采用单数据库进行数据存储，存在以下性能瓶颈：</p>\n<p>IO 瓶颈：热点数据太多，数据库缓存不足，产生大量磁盘 IO，效率较低。请求数据太多，带宽不够，网络 IO 瓶颈。<br />\nCPU 瓶颈： 排序、分组、连接查询、聚合统计等 SQL 会耗费大量的 CPU 资源，请求数太多，CPU 出现瓶颈。</p>\n<p><a href=\"https://imgse.com/i/pEgO6oV\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgO6oV.png\" alt=\"pEgO6oV.png\" /></a></p>\n<p><strong>分库分表的中心思想：<br />\n将数据分散存储，使得单一数据库 / 表的数据量变小来缓解单一数据库的性能问题，从而达到提升数据库性能的目的。</strong></p>\n<h6 id=\"312-拆分策略\"><a class=\"anchor\" href=\"#312-拆分策略\">#</a> 3.1.2 拆分策略</h6>\n<p><a href=\"https://imgse.com/i/pE2dAXt\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/10/pE2dAXt.png\" alt=\"pE2dAXt.png\" /></a></p>\n<h6 id=\"313-垂直拆分策略\"><a class=\"anchor\" href=\"#313-垂直拆分策略\">#</a> 3.1.3 垂直拆分策略</h6>\n<p><a href=\"https://imgse.com/i/pE2dnAS\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/10/pE2dnAS.png\" alt=\"pE2dnAS.png\" /></a></p>\n<p>特点:</p>\n<ol>\n<li>每个库的表结构都不一样。</li>\n<li>每个库的数据也不一样 。</li>\n<li>所有，库的并集是全量数据。</li>\n</ol>\n<p><a href=\"https://imgse.com/i/pE2dQpj\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/10/pE2dQpj.png\" alt=\"pE2dQpj.png\" /></a></p>\n<p>特点:</p>\n<ol>\n<li>每个表的结构都不一样。</li>\n<li>每个表的数据也术一样，一般通过一列 (主键 / 外键) 关联。</li>\n<li>所有表的并集是全量数据。</li>\n</ol>\n<h6 id=\"314-水平拆分策略\"><a class=\"anchor\" href=\"#314-水平拆分策略\">#</a> 3.1.4 水平拆分策略</h6>\n<p><a href=\"https://imgse.com/i/pE2d3Xq\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/10/pE2d3Xq.png\" alt=\"pE2d3Xq.png\" /></a></p>\n<p>水平分库：以 “字段” 为依据，改为以 “行（记录）” 为依据。讲一个库的数据拆分到多个库</p>\n<p>特点：</p>\n<ol>\n<li>每个库的表结构都一样。</li>\n<li>每个库的数据都不一样。</li>\n<li>所有库的并集是全量数据。</li>\n</ol>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/8Vp5L6j.png\" alt=\"1.png\" /></p>\n<p>特点：</p>\n<ol>\n<li>每个表的表结构都一样 。</li>\n<li>每个表的数据都不一样 。</li>\n<li>所有表的并集是全量数据。</li>\n</ol>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/2ctPFwi.png\" alt=\"2.png\" /></p>\n<ul>\n<li>shardingJDBC：基于 AOP 原理，在应用程序中对本地执行的 SQL 进行拦截，解析、改写、路由处理。需要自行编码配置实现，只支持 java 语言，性能较高。</li>\n<li>MyCat：数据库分库分表中间件，不用调整代码即可实现分库分表，支持多种语言，性能不及前者。</li>\n</ul>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/lgs1r8g.png\" alt=\"3.png\" /></p>\n<h5 id=\"32-mycat概述\"><a class=\"anchor\" href=\"#32-mycat概述\">#</a> 3.2 Mycat 概述</h5>\n<p>Mycat 是开源的、活跃的、基于 Java 语言编写的<strong> MySQL 数据库中间件</strong>。可以像使用 mysql 一样来使用 mycat，对于开发人员来说根本感觉不到 mycat 的存在。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/KFB4gQ8.png\" alt=\"5.png\" /></p>\n<p>优势：</p>\n<ul>\n<li>性能可靠稳定</li>\n<li>强大的技术团队</li>\n<li>体系完善</li>\n<li>社区活跃</li>\n</ul>\n<p>Mycat 是采用 java 语言开发的开源的数据库中间件，支持 Windows 和 Linux 运行环境，下面介绍 MyCat 的 Linux 中的环境搭建。 我们需要在准备好的服务器中安装如下软件。</p>\n<table>\n<thead>\n<tr>\n<th>服务器</th>\n<th>安装软件</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>192.168.40.213</td>\n<td>JDK、Mycat</td>\n<td>MyCat 中间件服务器</td>\n</tr>\n<tr>\n<td>192.168.40.210</td>\n<td>MySQL</td>\n<td>分片服务器</td>\n</tr>\n<tr>\n<td>192.168.40.211</td>\n<td>MySQL</td>\n<td>分片服务器</td>\n</tr>\n<tr>\n<td>192.168.40.212</td>\n<td>MySQL</td>\n<td>分片服务器</td>\n</tr>\n</tbody>\n</table>\n<p>JDK 安装</p>\n<pre><code>#解压jdk\n[root@mycat ~]# tar xf jdk-8u371-linux-x64.tar.gz -C /usr/local\n[root@mycat ~]# ln -s /usr/local/jdk1.8.0_371/ /usr/local/jdk\n\n# 添加环境变量\n[root@mycat ~]# vim /etc/profile.d/jdk.sh \nexport JAVA_HOME=/usr/local/jdk\nexport PATH=$PATH:$JAVA_HOME/bin\nexport JRE_HOME=$JAVA_HOME/jre \nexport CLASSPATH=$JAVA_HOME/lib/:$JRE_HOME/lib/\n\n[root@mycat ~]# source /etc/profile\n[root@mycat ~]# java -version\n</code></pre>\n<p>Mycat 安装</p>\n<pre><code>[root@mycat ~]# tar xf Mycat-server-1.6-RELEASE-20161028204710-linux.tar.gz -C /usr/local/\n[root@mycat ~]# ll /usr/local/mycat/\ntotal 12\ndrwxr-xr-x 2 root root  190 Dec  2 22:15 bin\ndrwxrwxrwx 2 root root    6 Mar  1  2016 catlet\ndrwxrwxrwx 4 root root 4096 Dec  2 22:15 conf\ndrwxr-xr-x 2 root root 4096 Dec  2 22:15 lib\ndrwxrwxrwx 2 root root    6 Oct 28  2016 logs\n-rwxrwxrwx 1 root root  217 Oct 28  2016 version.txt\n\n#上传jar包\n[root@mycat ~]# rz /usr/local/mycat/lib/mysql-connector-java-8.0.25.jar\n[root@mycat lib]# chmod 777 mysql-connector-java-8.0.25.jar \n</code></pre>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/n86yXtx.png\" alt=\"4.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/U26clQE.png\" alt=\"6.png\" /></p>\n<h6 id=\"321-mycat入门\"><a class=\"anchor\" href=\"#321-mycat入门\">#</a> 3.2.1 Mycat 入门</h6>\n<p>由于 tb_gorder 表中数据量很大，磁盘 IO 及容量都到达了瓶颈，现在需要对 tb_order 表进行数据分片，分为三个数据节点，每一个节点主机位于不同的服务器上，具体的结构，参考下图：</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/YjmWPQf.png\" alt=\"5.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/PQqJdjJ.png\" alt=\"8.png\" /></p>\n<h6 id=\"322-mycat配置\"><a class=\"anchor\" href=\"#322-mycat配置\">#</a> 3.2.2 Mycat 配置</h6>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/iXUxPhi.png\" alt=\"9.png\" /></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/schema.xml \n&lt;?xml version=&quot;1.0&quot;?&gt;\n&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;\n&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;\n\t&lt;schema name=&quot;DB01&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot;&gt;\n\t\t&lt;table name=&quot;TB_ORDER&quot; dataNode=&quot;dn1,dn2,dn3&quot; rule=&quot;auto-sharding-long&quot; /&gt;\n\t&lt;/schema&gt;\n\t\n\t&lt;dataNode name=&quot;dn1&quot; dataHost=&quot;dhost1&quot; database=&quot;db01&quot; /&gt;\n\t&lt;dataNode name=&quot;dn2&quot; dataHost=&quot;dhost2&quot; database=&quot;db01&quot; /&gt;\n\t&lt;dataNode name=&quot;dn3&quot; dataHost=&quot;dhost3&quot; database=&quot;db01&quot; /&gt;\n\t\n\t&lt;dataHost name=&quot;dhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.210:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost2&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.211:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost3&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.212:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n&lt;/mycat:schema&gt;\n</code></pre>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/KkUttwJ.png\" alt=\"10.png\" /></p>\n<pre><code>[root@mycat mycat]# cat /usr/local/mycat/conf/server.xml \n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!-- - - Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); \n\t- you may not use this file except in compliance with the License. - You \n\tmay obtain a copy of the License at - - http://www.apache.org/licenses/LICENSE-2.0 \n\t- - Unless required by applicable law or agreed to in writing, software - \n\tdistributed under the License is distributed on an &quot;AS IS&quot; BASIS, - WITHOUT \n\tWARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. - See the \n\tLicense for the specific language governing permissions and - limitations \n\tunder the License. --&gt;\n&lt;!DOCTYPE mycat:server SYSTEM &quot;server.dtd&quot;&gt;\n&lt;mycat:server xmlns:mycat=&quot;http://io.mycat/&quot;&gt;\n\t&lt;system&gt;\n\t&lt;property name=&quot;useSqlStat&quot;&gt;0&lt;/property&gt;  &lt;!-- 1为开启实时统计、0为关闭 --&gt;\n\t&lt;property name=&quot;useGlobleTableCheck&quot;&gt;0&lt;/property&gt;  &lt;!-- 1为开启全加班一致性检测、0为关闭 --&gt;\n\n\t\t&lt;property name=&quot;sequnceHandlerType&quot;&gt;2&lt;/property&gt;\n      &lt;!--  &lt;property name=&quot;useCompression&quot;&gt;1&lt;/property&gt;--&gt; &lt;!--1为开启mysql压缩协议--&gt;\n        &lt;!--  &lt;property name=&quot;fakeMySQLVersion&quot;&gt;5.6.20&lt;/property&gt;--&gt; &lt;!--设置模拟的MySQL版本号--&gt;\n\t&lt;!-- &lt;property name=&quot;processorBufferChunk&quot;&gt;40960&lt;/property&gt; --&gt;\n\t&lt;!-- \n\t&lt;property name=&quot;processors&quot;&gt;1&lt;/property&gt; \n\t&lt;property name=&quot;processorExecutor&quot;&gt;32&lt;/property&gt; \n\t --&gt;\n\t\t&lt;!--默认为type 0: DirectByteBufferPool | type 1 ByteBufferArena--&gt;\n\t\t&lt;property name=&quot;processorBufferPoolType&quot;&gt;0&lt;/property&gt;\n\t\t&lt;!--默认是65535 64K 用于sql解析时最大文本长度 --&gt;\n\t\t&lt;!--&lt;property name=&quot;maxStringLiteralLength&quot;&gt;65535&lt;/property&gt;--&gt;\n\t\t&lt;!--&lt;property name=&quot;sequnceHandlerType&quot;&gt;0&lt;/property&gt;--&gt;\n\t\t&lt;!--&lt;property name=&quot;backSocketNoDelay&quot;&gt;1&lt;/property&gt;--&gt;\n\t\t&lt;!--&lt;property name=&quot;frontSocketNoDelay&quot;&gt;1&lt;/property&gt;--&gt;\n\t\t&lt;!--&lt;property name=&quot;processorExecutor&quot;&gt;16&lt;/property&gt;--&gt;\n\t\t&lt;!--\n\t\t\t&lt;property name=&quot;serverPort&quot;&gt;8066&lt;/property&gt; &lt;property name=&quot;managerPort&quot;&gt;9066&lt;/property&gt; \n\t\t\t&lt;property name=&quot;idleTimeout&quot;&gt;300000&lt;/property&gt; &lt;property name=&quot;bindIp&quot;&gt;0.0.0.0&lt;/property&gt; \n\t\t\t&lt;property name=&quot;frontWriteQueueSize&quot;&gt;4096&lt;/property&gt; &lt;property name=&quot;processors&quot;&gt;32&lt;/property&gt; --&gt;\n\t\t&lt;!--分布式事务开关，0为不过滤分布式事务，1为过滤分布式事务（如果分布式事务内只涉及全局表，则不过滤），2为不过滤分布式事务,但是记录分布式事务日志--&gt;\n\t\t&lt;property name=&quot;handleDistributedTransactions&quot;&gt;0&lt;/property&gt;\n\t\t\n\t\t\t&lt;!--\n\t\t\toff heap for merge/order/group/limit      1开启   0关闭\n\t\t--&gt;\n\t\t&lt;property name=&quot;useOffHeapForMerge&quot;&gt;1&lt;/property&gt;\n\n\t\t&lt;!--\n\t\t\t单位为m\n\t\t--&gt;\n\t\t&lt;property name=&quot;memoryPageSize&quot;&gt;1m&lt;/property&gt;\n\n\t\t&lt;!--\n\t\t\t单位为k\n\t\t--&gt;\n\t\t&lt;property name=&quot;spillsFileBufferSize&quot;&gt;1k&lt;/property&gt;\n\n\t\t&lt;property name=&quot;useStreamOutput&quot;&gt;0&lt;/property&gt;\n\n\t\t&lt;!--\n\t\t\t单位为m\n\t\t--&gt;\n\t\t&lt;property name=&quot;systemReserveMemorySize&quot;&gt;384m&lt;/property&gt;\n\n\n\t\t&lt;!--是否采用zookeeper协调切换  --&gt;\n\t\t&lt;property name=&quot;useZKSwitch&quot;&gt;true&lt;/property&gt;\n\n\n\t&lt;/system&gt;\n\t\n\t&lt;!-- 全局SQL防火墙设置 --&gt;\n\t&lt;!-- \n\t&lt;firewall&gt; \n\t   &lt;whitehost&gt;\n\t      &lt;host host=&quot;127.0.0.1&quot; user=&quot;mycat&quot;/&gt;\n\t      &lt;host host=&quot;127.0.0.2&quot; user=&quot;mycat&quot;/&gt;\n\t   &lt;/whitehost&gt;\n       &lt;blacklist check=&quot;false&quot;&gt;\n       &lt;/blacklist&gt;\n\t&lt;/firewall&gt;\n\t--&gt;\n\t\n\t&lt;user name=&quot;root&quot;&gt;\n\t\t&lt;property name=&quot;password&quot;&gt;Superman*2023&lt;/property&gt;\n\t\t&lt;property name=&quot;schemas&quot;&gt;DB01&lt;/property&gt;\n\t\t\n\t\t&lt;!-- 表级 DML 权限设置 --&gt;\n\t\t&lt;!-- \t\t\n\t\t&lt;privileges check=&quot;false&quot;&gt;\n\t\t\t&lt;schema name=&quot;TESTDB&quot; dml=&quot;0110&quot; &gt;\n\t\t\t\t&lt;table name=&quot;tb01&quot; dml=&quot;0000&quot;&gt;&lt;/table&gt;\n\t\t\t\t&lt;table name=&quot;tb02&quot; dml=&quot;1111&quot;&gt;&lt;/table&gt;\n\t\t\t&lt;/schema&gt;\n\t\t&lt;/privileges&gt;\t\t\n\t\t --&gt;\n\t&lt;/user&gt;\n\n\t&lt;user name=&quot;user&quot;&gt;\n\t\t&lt;property name=&quot;password&quot;&gt;Superman*2023&lt;/property&gt;\n\t\t&lt;property name=&quot;schemas&quot;&gt;DB01&lt;/property&gt;\n\t\t&lt;property name=&quot;readOnly&quot;&gt;true&lt;/property&gt;\n\t&lt;/user&gt;\n\n&lt;/mycat:server&gt;\n</code></pre>\n<h6 id=\"323-mycat启动\"><a class=\"anchor\" href=\"#323-mycat启动\">#</a> 3.2.3 Mycat 启动</h6>\n<pre><code>#1.启动mycat\n[root@mycat mycat]# ./bin/mycat restart\n\n#2.wrapper.log日志中常见错误\nERROR | wrapper | 2021/1/10 13:31:05 | Startup failed: Timed out waiting for signal from JVM.\nERROR | wrapper | 2021/1/10 13:31:05 | JVM did not exit on request, terminated\n\n#3.启动Mycat超时,前往wrapper.conf配置超时策略\n[root@mycat mycat]# vim /usr/local/mycat/conf/wrapper.conf\n...\nwrapper.startup.timeout=300     //添加此行，超时时间300秒\nwrapper.ping.timeout=120\n\n#4.查看mycat是否启动\n[root@mycat mycat]# tail -f logs/wrapper.log\n...\nINFO   | jvm 1    | 2023/12/02 22:53:44 | MyCAT Server startup successfully. see logs in logs/mycat.log\n[root@mycat mycat]# netstat -lntp|grep 8066\ntcp6       0      0 :::8066                 :::*                    LISTEN      18028/java\n</code></pre>\n<h6 id=\"324-分片测试\"><a class=\"anchor\" href=\"#324-分片测试\">#</a> 3.2.4 分片测试</h6>\n<pre><code>[root@db3 ~]#  mysql -h 192.168.40.213 -P 8066 -uroot -p'Superman*2023'\nmysql: [Warning] Using a password on the command line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 3\nServer version: 5.6.29-mycat-1.6-RELEASE-20161028204710 MyCat Server (OpenCloundDB)\n\nCopyright (c) 2000, 2023, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; show databases;\n+----------+\n| DATABASE |\n+----------+\n| DB01     |\n+----------+\n1 row in set (0.00 sec)\n\nmysql&gt; use DB01;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql&gt; show tables;\n+----------------+\n| Tables in DB01 |\n+----------------+\n| tb_order       |\n+----------------+\n1 row in set (0.00 sec)\nmysql&gt; CREATE TABLE TB_ORDER(\n    -&gt; id BIGINT(20) NOT NULL,\n    -&gt; title VARCHAR(100) NOT NULL,\n    -&gt; PRIMARY KEY (id)\n    -&gt; )ENGINE=INNODB DEFAULT CHARSET=utf8;\nQuery OK, 0 rows affected (0.04 sec)\n OK!\nmysql&gt;INSERT INTO TB_ORDER(id,title) VALUES(1,'guods1');\nmysql&gt;INSERT INTO TB_ORDER(id,title) VALUES(2,'guods2');\nmysql&gt;INSERT INTO TB_ORDER(id,title) VALUES(3,'guods3');\nmysql&gt;INSERT INTO TB_ORDER(id,title) VALUES(4,'guods4');\nmysql&gt; select * from TB_ORDER;\n+------+--------+\n| id   | title  |\n+------+--------+\n|    1 | guods1 |\n|    2 | guods2 |\n|    3 | guods3 |\n|    4 | guods4 |\n+------+--------+\n4 rows in set (0.03 sec)\n</code></pre>\n<p><strong>数据写入到 db1 中，因为 mycat 分片规则为 0-50000000 存入节点 1,5000001-10000000 存入节点 2,10000001-15000000 存入节点 3，15000001 以上无法插入数据，需要增加数据节点。</strong></p>\n<pre><code>[root@mycat mycat]# vim conf/rule.xml\n...\n        &lt;tableRule name=&quot;auto-sharding-long&quot;&gt;\n                &lt;rule&gt;\n                        &lt;columns&gt;id&lt;/columns&gt;\n                        &lt;algorithm&gt;rang-long&lt;/algorithm&gt;\n                &lt;/rule&gt;\n        &lt;/tableRule&gt;\n\n....\n       &lt;function name=&quot;rang-long&quot;\n                class=&quot;io.mycat.route.function.AutoPartitionByLong&quot;&gt;\n                &lt;property name=&quot;mapFile&quot;&gt;autopartition-long.txt&lt;/property&gt;\n        &lt;/function&gt;\n\n...\n\n[root@mycat mycat]# cat conf/autopartition-long.txt\n# range start-end ,data node index\n# K=1000,M=10000.\n0-500M=0\n500M-1000M=1\n\n#5000001-10000000存入节点2 \nmysql&gt; INSERT INTO TB_ORDER(id,title) VALUES(5000001,'guods5000001');\nQuery OK, 1 row affected (0.01 sec)\n OK!\n \n#10000001-15000000存入节点3 \nmysql&gt; INSERT INTO TB_ORDER(id,title) VALUES(10000001,'guods10000001');\nQuery OK, 1 row affected (0.00 sec)\n OK!\n\n#15000001以上无法插入数据，需要增加数据节点\nmysql&gt; INSERT INTO TB_ORDER(id,title) VALUES(15000001,'guods15000001');\nERROR 1064 (HY000): can't find any valid datanode :TB_ORDER -&gt; ID -&gt; 15000001\n</code></pre>\n<h5 id=\"33-mycat配置\"><a class=\"anchor\" href=\"#33-mycat配置\">#</a> 3.3 Mycat 配置</h5>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/I9QLBBR.png\" alt=\"11.png\" /></p>\n<h6 id=\"331-schema标签\"><a class=\"anchor\" href=\"#331-schema标签\">#</a> 3.3.1 Schema 标签</h6>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/TmYK7fP.png\" alt=\"13.png\" /></p>\n<p>schema 标签用于定义 MyCat 实例中的逻辑库，一个 MyCat 实例中，可以有多个逻辑库，可以通过 schema 标签来划分不同的逻辑库。MyCat 中的逻辑库的概念，等同于 MySQL 中的 database 概念，需要操作某个逻辑库下的表时也需要切换逻辑库 (use xxx)。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/SGo0DCv.png\" alt=\"14.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/XtDxXWj.png\" alt=\"15.png\" /></p>\n<h6 id=\"332-datanode标签\"><a class=\"anchor\" href=\"#332-datanode标签\">#</a> 3.3.2 Datanode 标签</h6>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/phHZ48F.png\" alt=\"16.png\" /></p>\n<h6 id=\"333-datahost标签\"><a class=\"anchor\" href=\"#333-datahost标签\">#</a> 3.3.3 Datahost 标签</h6>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/fXBnwcS.png\" alt=\"17.png\" /></p>\n<h6 id=\"334-rulexml\"><a class=\"anchor\" href=\"#334-rulexml\">#</a> 3.3.4 rule.xml</h6>\n<p>rule.xml 中定义所有拆分表的规则，在使用过程中可以灵活的使用分片算法，或者对同一个分片算法使用不同的参数，它让分片过程可配置化。主要包含两类标签： <code>tableRule</code> 、 <code>Function</code> 。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/Ecm1Nvr.png\" alt=\"18.png\" /></p>\n<h6 id=\"335-serverxml\"><a class=\"anchor\" href=\"#335-serverxml\">#</a> 3.3.5 server.xml</h6>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/xIDxYpu.png\" alt=\"19.png\" /></p>\n<h5 id=\"34-mycat分片\"><a class=\"anchor\" href=\"#34-mycat分片\">#</a> 3.4 Mycat 分片</h5>\n<h6 id=\"341-分库分表-mycat分片-垂直分库\"><a class=\"anchor\" href=\"#341-分库分表-mycat分片-垂直分库\">#</a> 3.4.1 分库分表 - MyCat 分片 - 垂直分库</h6>\n<p>场景：在业务系统中，涉及以下表结构，但是由于用户与订单每天都会产生大量的数据，单台服务器的数据存储及处理能力是有限的，可以对数据库表进行拆分，原有的数据库表如下。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/plSdAyY.png\" alt=\"20.png\" /></p>\n<p><strong>ps: 分库不需要指定 rule，涉及分表需要使用 rule；</strong></p>\n<p><strong>环境准备</strong></p>\n<p>①如图所示准备三台 Linux 服务器（ip 为：192.168.40.210、192.168.40.211、192.168.40.212）可以根据自己的实际情况进行准备。<br />\n②三台服务器上都安装 MySQL，在 192.168.40.213 服务器上安装 MyCat。<br />\n③三台服务器关闭防火墙或者开放对应的端口。<br />\n④分别在三台 MySQL 中创建数据库 shopping。<br />\n<img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/uMZB18q.png\" alt=\"21.png\" /></p>\n<p><strong>schema.xml 文件配置如下：</strong></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/schema.xml \n&lt;?xml version=&quot;1.0&quot;?&gt;\n&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;\n&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;\n\t&lt;schema name=&quot;SHOPPING&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot;&gt;\n\t\t&lt;table name=&quot;tb_goods_base&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_brand&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_cat&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_desc&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_item&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;goods_id&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_order_item&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_master&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;order_id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_pay_log&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;out_trade_no&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_user&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_user_address&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_areas_provinces&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_areas_city&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_areas_region&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t&lt;/schema&gt;\n\t\n\t&lt;dataNode name=&quot;dn1&quot; dataHost=&quot;dhost1&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn2&quot; dataHost=&quot;dhost2&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn3&quot; dataHost=&quot;dhost3&quot; database=&quot;shopping&quot; /&gt;\n\t\n\t&lt;dataHost name=&quot;dhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.210:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost2&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.211:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost3&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.212:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n&lt;/mycat:schema&gt;\n</code></pre>\n<p><strong>server.xml 文件配置如下：</strong></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/server.xml \n...\n\t&lt;user name=&quot;root&quot;&gt;\n\t\t&lt;property name=&quot;password&quot;&gt;Superman*2023&lt;/property&gt;\n\t\t&lt;property name=&quot;schemas&quot;&gt;SHOPPING&lt;/property&gt;\n\t\t\n\t\t&lt;!-- 表级 DML 权限设置 --&gt;\n\t\t&lt;!-- \t\t\n\t\t&lt;privileges check=&quot;false&quot;&gt;\n\t\t\t&lt;schema name=&quot;TESTDB&quot; dml=&quot;0110&quot; &gt;\n\t\t\t\t&lt;table name=&quot;tb01&quot; dml=&quot;0000&quot;&gt;&lt;/table&gt;\n\t\t\t\t&lt;table name=&quot;tb02&quot; dml=&quot;1111&quot;&gt;&lt;/table&gt;\n\t\t\t&lt;/schema&gt;\n\t\t&lt;/privileges&gt;\t\t\n\t\t --&gt;\n\t&lt;/user&gt;\n\n\t&lt;user name=&quot;user&quot;&gt;\n\t\t&lt;property name=&quot;password&quot;&gt;Superman*2023&lt;/property&gt;\n\t\t&lt;property name=&quot;schemas&quot;&gt;SHOPPING&lt;/property&gt;\n\t\t&lt;property name=&quot;readOnly&quot;&gt;true&lt;/property&gt;\n\t&lt;/user&gt;\n\n&lt;/mycat:server&gt;\n</code></pre>\n<p><strong>分库分表 - MyCat 分片 - 垂直分库 - 测试</strong></p>\n<p><strong>垂直分库 - 测试</strong></p>\n<pre><code>#1.重启mycat\n[root@mycat ~]# /usr/local/mycat/bin/mycat restart\nStopping Mycat-server...\nStopped Mycat-server.\nStarting Mycat-server...\n[root@mycat ~]# tail -f  /usr/local/mycat/logs/wrapper.log \n...\nINFO   | jvm 1    | 2023/12/03 15:29:02 | MyCAT Server startup successfully. see logs in logs/mycat.log\ncreate database shopping default charset utf8mb4;\n\n#2.在3台节点创建shopping数据库\nmysql&gt; create database shopping default charset utf8mb4;\nmysql&gt; create database shopping default charset utf8mb4;\nmysql&gt; create database shopping default charset utf8mb4;\n\n#3.登入mycat\n[root@db3 ~]# mysql -h 192.168.40.213 -P 8066 -uroot -p'Superman*2023'\nmysql&gt; show databases;\n+----------+\n| DATABASE |\n+----------+\n| SHOPPING |\n+----------+\n1 row in set (0.01 sec)\n\n#4.查看逻辑库\nmysql&gt; show databases;\n+----------+\n| DATABASE |\n+----------+\n| SHOPPING |\n+----------+\n1 row in set (0.01 sec)\n\n#5.切换到SHOPPING数据库\nmysql&gt; use SHOPPING;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\n\n#6.查看逻辑表\nmysql&gt; show tables;\n+--------------------+\n| Tables in SHOPPING |\n+--------------------+\n| tb_areas_city      |\n| tb_areas_provinces |\n| tb_areas_region    |\n| tb_goods_base      |\n| tb_goods_brand     |\n| tb_goods_cat       |\n| tb_goods_desc      |\n| tb_goods_item      |\n| tb_order_item      |\n| tb_order_master    |\n| tb_order_pay_log   |\n| tb_user            |\n| tb_user_address    |\n+--------------------+\n13 rows in set (0.00 sec)\n\n#7.上传shopping-table.sql表结构文件与shopping-insert.sql数据文件\n\n#8.执行shopping-table.sql文件\nmysql&gt; source /root/shopping-table.sql\n\n#9.执行shopping-insert.sql文件\nmysql&gt; source /root/shopping-insert.sql\n\n#10.查看三个数据库可以发现（根据schema.xml配置文件的配置进行了实现）\n①192.168.40.210的数据库中存放了 tb_goods_base、tb_goods_brand、tb_goods_cat、tb_goods_desc、tb_goods_item这五张表\n②192.168.40.211的数据库中存放了 tb_order_item、tb_order_master、tb_order_pay_log这三张表；\n③192.168.40.212的数据库中存放了 tb_user、tb_user_address、tb_areas_provinces、tb_areas_city、tb_areas_region这五张表\n</code></pre>\n<p><strong>exam1: 查询用户的收件人及收件人地址信息 (包含省、市、区)。</strong></p>\n<pre><code>mysql&gt; select ua.user_id,ua.contact,p.province,c.city,r.area,ua.address from tb_user_address ua,tb_areas_city c,tb_areas_provinces p,tb_areas_region r where ua.province_id = p.provinceid and ua.city_id = c.cityid and ua.town_id = r.areaid;\n+-----------+-----------+-----------+-----------+-----------+--------------------+\n| user_id   | contact   | province  | city      | area      | address            |\n+-----------+-----------+-----------+-----------+-----------+--------------------+\n| deng      | 叶问      | 北京市    | 市辖区    | 西城区    | 咏春武馆总部       |\n| java00001 | 李佳红    | 北京市    | 市辖区    | 崇文区    | 修正大厦           |\n| deng      | 李小龙    | 北京市    | 市辖区    | 崇文区    | 永春武馆           |\n| zhaoliu   | 赵三      | 北京市    | 市辖区    | 宣武区    | 西直门             |\n| java00001 | 李嘉诚    | 北京市    | 市辖区    | 朝阳区    | 金燕龙办公楼       |\n| java00001 | 李佳星    | 北京市    | 市辖区    | 朝阳区    | 中腾大厦           |\n+-----------+-----------+-----------+-----------+-----------+--------------------+\n</code></pre>\n<p><em><strong>ps: 此查询语句只涉及了一个分片所以查询成功</strong></em></p>\n<p><strong>exam2: 查询每一笔订单及订单的收件地址信息 (包含省、市、区)。</strong></p>\n<pre><code>mysql&gt; SELECT order_id,payment,receiver,province,city,area FROM tb_order_master o,tb_areas_provinces p,tb_areas_city c,tb_areas_region r WHERE o.receiver_province = p.provinceid AND o.receiver_city = c.cityid AND o.receiver_region = r.areaid;\nERROR 1064 (HY000): invalid route in sql, multi tables found but datanode has no intersection  sql:SELECT order_id,payment,receiver,province,city,area FROM tb_order_master o,tb_areas_provinces p,tb_areas_city c,tb_areas_region r WHERE o.receiver_province = p.provinceid AND o.receiver_city = c.cityid AND o.receiver_region = r.areaid\n</code></pre>\n<p><em><strong>ps: 此查询语句涉及多个分片所以查询报错，为了解决这个问题需要进行全局表配置</strong></em></p>\n<p><strong>全局表配置</strong></p>\n<p>对于省、市、区 / 县表 tb_areas_provinces，tb_areas_city，tb_areas_region，是属于数据字典表，在多个业务模块中都可能会遇到，可以将其设置为全局表，利于业务操作。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/EqJJ3Yv.png\" alt=\"22.png\" /></p>\n<p><strong>1. 修改 MyCat—schema.xml 文件配置</strong></p>\n<p><strong>schema.xml 文件配置如下：</strong></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/schema.xml \n&lt;?xml version=&quot;1.0&quot;?&gt;\n&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;\n&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;\n\t&lt;schema name=&quot;SHOPPING&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot;&gt;\n\t\t&lt;table name=&quot;tb_goods_base&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_brand&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_cat&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_desc&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_item&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;goods_id&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_order_item&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_master&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;order_id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_pay_log&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;out_trade_no&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_user&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_user_address&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\n\t\t&lt;table name=&quot;tb_areas_provinces&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot;/&gt;\n\t\t&lt;table name=&quot;tb_areas_city&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot;/&gt;\n\t\t&lt;table name=&quot;tb_areas_region&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot; /&gt;\n\t&lt;/schema&gt;\n\t\n\t&lt;dataNode name=&quot;dn1&quot; dataHost=&quot;dhost1&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn2&quot; dataHost=&quot;dhost2&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn3&quot; dataHost=&quot;dhost3&quot; database=&quot;shopping&quot; /&gt;\n\t\n\t&lt;dataHost name=&quot;dhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.210:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost2&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.211:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost3&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.212:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n&lt;/mycat:schema&gt;\n</code></pre>\n<p><strong>2. 全局表测试</strong></p>\n<pre><code>#1.删除3个节点上原有表\n\n#2.重启mycat\n[root@mycat ~]# /usr/local/mycat/bin/mycat restart\nStopping Mycat-server...\nStopped Mycat-server.\nStarting Mycat-server...\n[root@mycat ~]# tail -f  /usr/local/mycat/logs/wrapper.log \n...\nINFO   | jvm 1    | 2023/12/03 15:29:02 | MyCAT Server startup successfully. see logs in logs/mycat.log\ncreate database shopping default charset utf8mb4;\n\n#3.执行shopping-table.sql文件\n[root@db3 ~]# mysql -h 192.168.40.213 -P 8066 -uroot -p'Superman*2023'\nmysql&gt; source /root/shopping-table.sql\n\n#4.执行shopping-insert.sql文件\nmysql&gt; source /root/shopping-insert.sql\n\n#5 exam1:查询用户的收件人及收件人地址信息(包含省、市、区)。\nmysql&gt; select ua.user_id,ua.contact,p.province,c.city,r.area,ua.address from tb_user_address ua,tb_areas_city c,tb_areas_provinces p,tb_areas_region r where ua.province_id = p.provinceid and ua.city_id = c.cityid and ua.town_id = r.areaid;\n\n#6 exam2:查询每一笔订单及订单的收件地址信息(包含省、市、区)\nmysql&gt; SELECT order_id,payment,receiver,province,city,area FROM tb_order_master o,tb_areas_provinces p,tb_areas_city c,tb_areas_region r WHERE o.receiver_province = p.provinceid AND o.receiver_city = c.cityid AND o.receiver_region = r.areaid;\n</code></pre>\n<h6 id=\"342-分库分表-mycat分片-水平分表\"><a class=\"anchor\" href=\"#342-分库分表-mycat分片-水平分表\">#</a> 3.4.2 分库分表 - MyCat 分片 - 水平分表</h6>\n<ul>\n<li><strong>水平分表</strong></li>\n</ul>\n<p><strong>场景</strong>：在业务系统中，有一张表（日志表），业务系统每天都会产生大量的日志数据，单台服务器的数据存储及处理能力是有限的，可以对数据库表进行拆分。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/0kMP4Ru.png\" alt=\"23.png\" /></p>\n<p><strong>准备环境：</strong></p>\n<p>①如图所示准备三台 Linux 服务器（ip 为：192.168.40.210、192.168.40.211、192.168.40.212）可以根据自己的实际情况进行准备。<br />\n②三台服务器上都安装 MySQL，在 192.168.40.213 服务器上安装 MyCat。<br />\n③三台服务器关闭防火墙或者开放对应的端口。<br />\n④分别在三台 MySQL 中创建数据库 itcast。<br />\n<img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/zTm8XwU.png\" alt=\"24.png\" /></p>\n<p><strong>1. 三台 MySQL 中创建数据库 itcast</strong></p>\n<pre><code>mysql&gt; create database itcast default charset utf8mb4;\nmysql&gt; create database itcast default charset utf8mb4;\nmysql&gt; create database itcast default charset utf8mb4;\n</code></pre>\n<p><strong>2.MyCat—server.xml 文件配置</strong></p>\n<p><strong>server.xml 文件配置如下：</strong></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/schema.xml \n&lt;?xml version=&quot;1.0&quot;?&gt;\n&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;\n&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;\n\t&lt;schema name=&quot;SHOPPING&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot;&gt;\n\t\t&lt;table name=&quot;tb_goods_base&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_brand&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_cat&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_desc&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_item&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;goods_id&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_order_item&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_master&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;order_id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_pay_log&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;out_trade_no&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_user&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_user_address&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\n                &lt;table name=&quot;tb_areas_provinces&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot; /&gt;\n\t\t&lt;table name=&quot;tb_areas_city&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot; /&gt;\n\t\t&lt;table name=&quot;tb_areas_region&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot; /&gt;\n\t&lt;/schema&gt;\n\n        &lt;schema name=&quot;ITCAST&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot;&gt;\n        \t&lt;table name=&quot;tb_log&quot; dataNode=&quot;dn4,dn5,dn6&quot; primaryKey=&quot;id&quot; rule=&quot;mod-long&quot; /&gt;\n        &lt;/schema&gt;\n\t\n\t&lt;dataNode name=&quot;dn1&quot; dataHost=&quot;dhost1&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn2&quot; dataHost=&quot;dhost2&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn3&quot; dataHost=&quot;dhost3&quot; database=&quot;shopping&quot; /&gt;\n\n\t&lt;dataNode name=&quot;dn4&quot; dataHost=&quot;dhost1&quot; database=&quot;itcast&quot; /&gt;\n\t&lt;dataNode name=&quot;dn5&quot; dataHost=&quot;dhost2&quot; database=&quot;itcast&quot; /&gt;\n\t&lt;dataNode name=&quot;dn6&quot; dataHost=&quot;dhost3&quot; database=&quot;itcast&quot; /&gt;\n\t\n\t&lt;dataHost name=&quot;dhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.210:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost2&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.211:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost3&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.212:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n&lt;/mycat:schema&gt;\n</code></pre>\n<p><strong>3.MyCat—server.xml 文件配置</strong></p>\n<p><strong>server.xml 文件配置如下：</strong></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/server.xml \n...\n\t&lt;user name=&quot;root&quot;&gt;\n\t\t&lt;property name=&quot;password&quot;&gt;Superman*2023&lt;/property&gt;\n\t\t&lt;property name=&quot;schemas&quot;&gt;SHOPPING,ITCAST&lt;/property&gt;\n\t\t\n\t\t&lt;!-- 表级 DML 权限设置 --&gt;\n\t\t&lt;!-- \t\t\n\t\t&lt;privileges check=&quot;false&quot;&gt;\n\t\t\t&lt;schema name=&quot;TESTDB&quot; dml=&quot;0110&quot; &gt;\n\t\t\t\t&lt;table name=&quot;tb01&quot; dml=&quot;0000&quot;&gt;&lt;/table&gt;\n\t\t\t\t&lt;table name=&quot;tb02&quot; dml=&quot;1111&quot;&gt;&lt;/table&gt;\n\t\t\t&lt;/schema&gt;\n\t\t&lt;/privileges&gt;\t\t\n\t\t --&gt;\n\t&lt;/user&gt;\n\n\t&lt;user name=&quot;user&quot;&gt;\n\t\t&lt;property name=&quot;password&quot;&gt;Superman*2023&lt;/property&gt;\n\t\t&lt;property name=&quot;schemas&quot;&gt;SHOPPING,ITCAST&lt;/property&gt;\n\t\t&lt;property name=&quot;readOnly&quot;&gt;true&lt;/property&gt;\n\t&lt;/user&gt;\n\n&lt;/mycat:server&gt;\n</code></pre>\n<p><strong>4.MyCat 启动</strong></p>\n<pre><code>#1.重启mycat\n[root@mycat ~]# /usr/local/mycat/bin/mycat restart\nStopping Mycat-server...\nStopped Mycat-server.\nStarting Mycat-server...\n[root@mycat ~]# tail -f  /usr/local/mycat/logs/wrapper.log \n...\nINFO   | jvm 1    | 2023/12/03 15:29:02 | MyCAT Server startup successfully. see logs in logs/mycat.log\ncreate database shopping default charset utf8mb4;\n\n#2.登入mycat\n[root@db3 ~]# mysql -h 192.168.40.213 -P 8066 -uroot -p'Superman*2023'\nmysql&gt; show databases;\n+----------+\n| DATABASE |\n+----------+\n| ITCAST   |\n| SHOPPING |\n+----------+\n2 rows in set (0.00 sec)\n\nmysql&gt; use ITCAST;\nmysql&gt; show tables;\n+------------------+\n| Tables in ITCAST |\n+------------------+\n| tb_log           |\n+------------------+\n\n#3.创建表结构及数据导入\nmysql&gt; CREATE TABLE tb_log (\n    -&gt;   id bigint(20) NOT NULL COMMENT 'ID',\n    -&gt;   model_name varchar(200) DEFAULT NULL COMMENT '模块名',\n    -&gt;   model_value varchar(200) DEFAULT NULL COMMENT '模块值',\n    -&gt;   return_value varchar(200) DEFAULT NULL COMMENT '返回值',\n    -&gt;   return_class varchar(200) DEFAULT NULL COMMENT '返回值类型',\n    -&gt;   operate_user varchar(20) DEFAULT NULL COMMENT '操作用户',\n    -&gt;   operate_time varchar(20) DEFAULT NULL COMMENT '操作时间',\n    -&gt;   param_and_value varchar(500) DEFAULT NULL COMMENT '请求参数名及参数值',\n    -&gt;   operate_class varchar(200) DEFAULT NULL COMMENT '操作类',\n    -&gt;   operate_method varchar(200) DEFAULT NULL COMMENT '操作方法',\n    -&gt;   cost_time bigint(20) DEFAULT NULL COMMENT '执行方法耗时, 单位 ms',\n    -&gt;   source int(1) DEFAULT NULL COMMENT '来源 : 1 PC , 2 Android , 3 IOS',\n    -&gt;   PRIMARY KEY (id)\n    -&gt; ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\nQuery OK, 0 rows affected (0.09 sec)\n OK!\n查看三个数据库可以发现表和表结构都有了\n\n#4.添加数据\nINSERT INTO tb_log (id, model_name, model_value, return_value, return_class, operate_user, operate_time, param_and_value, operate_class, operate_method, cost_time，source) VALUES('1','user','insert','success','java.lang.String','10001','2022-01-06 18:12:28','&#123;\\&quot;age\\&quot;:\\&quot;20\\&quot;,\\&quot;name\\&quot;:\\&quot;Tom\\&quot;,\\&quot;gender\\&quot;:\\&quot;1\\&quot;&#125;','cn.itcast.controller.UserController','insert','10',1);\nINSERT INTO tb_log (id, model_name, model_value, return_value, return_class, operate_user, operate_time, param_and_value, operate_class, operate_method, cost_time，source) VALUES('2','user','insert','success','java.lang.String','10001','2022-01-06 18:12:27','&#123;\\&quot;age\\&quot;:\\&quot;20\\&quot;,\\&quot;name\\&quot;:\\&quot;Tom\\&quot;,\\&quot;gender\\&quot;:\\&quot;1\\&quot;&#125;','cn.itcast.controller.UserController','insert','23',1);\nINSERT INTO tb_log (id, model_name, model_value, return_value, return_class, operate_user, operate_time, param_and_value, operate_class, operate_method, cost_time，source) VALUES('3','user','update','success','java.lang.String','10001','2022-01-06 18:16:45','&#123;\\&quot;age\\&quot;:\\&quot;20\\&quot;,\\&quot;name\\&quot;:\\&quot;Tom\\&quot;,\\&quot;gender\\&quot;:\\&quot;1\\&quot;&#125;','cn.itcast.controller.UserController','update','34',1);\nINSERT INTO tb_log (id, model_name, model_value, return_value, return_class, operate_user, operate_time, param_and_value, operate_class, operate_method, cost_time，source) VALUES('4','user','update','success','java.lang.String','10001','2022-01-06 18:16:45','&#123;\\&quot;age\\&quot;:\\&quot;20\\&quot;,\\&quot;name\\&quot;:\\&quot;Tom\\&quot;,\\&quot;gender\\&quot;:\\&quot;1\\&quot;&#125;','cn.itcast.controller.UserController','update','13',2);\nINSERT INTO tb_log (id, model_name, model_value, return_value, return_class, operate_user, operate_time, param_and_value, operate_class, operate_method, cost_time，source) VALUES('5','user','insert','success','java.lang.String','10001','2022-01-06 18:30:31','&#123;\\&quot;age\\&quot;:\\&quot;200\\&quot;,\\&quot;name\\&quot;:\\&quot;TomCat\\&quot;,\\&quot;gender\\&quot;:\\&quot;0\\&quot;&#125;','cn.itcast.controller.UserController','insert','29',3);\nINSERT INTO tb_log (id, model_name, model_value, return_value, return_class, operate_user, operate_time, param_and_value, operate_class, operate_method, cost_time，source) VALUES('6','user','find','success','java.lang.String','10001','2022-01-06 18:30:31','&#123;\\&quot;age\\&quot;:\\&quot;200\\&quot;,\\&quot;name\\&quot;:\\&quot;TomCat\\&quot;,\\&quot;gender\\&quot;:\\&quot;0\\&quot;&#125;','cn.itcast.controller.UserController','find','29',2);\n\n查看三个数据库内的tb_log表发现有数据了，数据的分布规则是 id模以3的结果为0的数据分布在第一个节点，id模以3的结果为1的数据分布在第二个节点，id模以3的结果为2的数据分布在第三个节点\n</code></pre>\n<h5 id=\"33-分库分表-分片规则\"><a class=\"anchor\" href=\"#33-分库分表-分片规则\">#</a> 3.3 分库分表 - 分片规则</h5>\n<h6 id=\"331-分库分表-分片规则-范围分片\"><a class=\"anchor\" href=\"#331-分库分表-分片规则-范围分片\">#</a> 3.3.1 分库分表 - 分片规则 - 范围分片</h6>\n<p><strong>范围分片</strong>：根据指定的字段及其配置的范围与数据节点的对应情况，来决定该数据属于哪一个分片。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/sdd8bvs.png\" alt=\"25.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/R3ecZ4k.png\" alt=\"26.png\" /></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/autopartition-long.txt\n# range start-end ,data node index\n# K=1000,M=10000.\n0-500M=0\n500M-1000M=1\n1000M-1500M=2\n</code></pre>\n<h6 id=\"332-分库分表-分片规则-取模分片\"><a class=\"anchor\" href=\"#332-分库分表-分片规则-取模分片\">#</a> 3.3.2 分库分表 - 分片规则 - 取模分片</h6>\n<p><strong>取模分片</strong>：根据指定的字段值与节点数量进行求模运算，根据运算结果，来决定该数据属于哪一个分片。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/Xvn6sHi.png\" alt=\"1.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/aaey4H2.png\" alt=\"2.png\" /></p>\n<h6 id=\"333-分库分表-分片规则-一致性hash算法\"><a class=\"anchor\" href=\"#333-分库分表-分片规则-一致性hash算法\">#</a> 3.3.3 分库分表 - 分片规则 - 一致性 hash 算法</h6>\n<p><strong>一致性 hash 算法</strong>：所谓一致性哈希，相同的哈希因子计算值总是被划分到相同的分区表中，不会因为分区节点的增加而改变原来数据的分区位置。</p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/6ANYtsD.png\" alt=\"3.png\" /></p>\n<p><img loading=\"lazy\" data-src=\"https://wp-cdn.4ce.cn/v2/8i8c5Le.png\" alt=\"4.png\" /></p>\n<p><strong>一致性 hash 测试</strong></p>\n<p>schema.xml 配置</p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/schema.xml \n&lt;?xml version=&quot;1.0&quot;?&gt;\n&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;\n&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;\n\t&lt;schema name=&quot;SHOPPING&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot;&gt;\n\t\t&lt;table name=&quot;tb_goods_base&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_brand&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_cat&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_desc&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_goods_item&quot; dataNode=&quot;dn1&quot; primaryKey=&quot;goods_id&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_order_item&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_master&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;order_id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_order_pay_log&quot; dataNode=&quot;dn2&quot; primaryKey=&quot;out_trade_no&quot; /&gt;\n\t\t\n\t\t&lt;table name=&quot;tb_user&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\t\t&lt;table name=&quot;tb_user_address&quot; dataNode=&quot;dn3&quot; primaryKey=&quot;id&quot; /&gt;\n\n                &lt;table name=&quot;tb_areas_provinces&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot; /&gt;\n\t\t&lt;table name=&quot;tb_areas_city&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot; /&gt;\n\t\t&lt;table name=&quot;tb_areas_region&quot; dataNode=&quot;dn1,dn2,dn3&quot; primaryKey=&quot;id&quot; type=&quot;global&quot; /&gt;\n\t&lt;/schema&gt;\n\n        &lt;schema name=&quot;ITCAST&quot; checkSQLschema=&quot;true&quot; sqlMaxLimit=&quot;100&quot;&gt;\n        \t&lt;table name=&quot;tb_log&quot; dataNode=&quot;dn4,dn5,dn6&quot; primaryKey=&quot;id&quot; rule=&quot;mod-long&quot; /&gt;\n        \t&lt;table name=&quot;tb_order&quot; dataNode=&quot;dn4,dn5,dn6&quot; primaryKey=&quot;id&quot; rule=&quot;sharding-by-murmur&quot; /&gt;\n        &lt;/schema&gt;\n\t\n\t&lt;dataNode name=&quot;dn1&quot; dataHost=&quot;dhost1&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn2&quot; dataHost=&quot;dhost2&quot; database=&quot;shopping&quot; /&gt;\n\t&lt;dataNode name=&quot;dn3&quot; dataHost=&quot;dhost3&quot; database=&quot;shopping&quot; /&gt;\n\n\t&lt;dataNode name=&quot;dn4&quot; dataHost=&quot;dhost1&quot; database=&quot;itcast&quot; /&gt;\n\t&lt;dataNode name=&quot;dn5&quot; dataHost=&quot;dhost2&quot; database=&quot;itcast&quot; /&gt;\n\t&lt;dataNode name=&quot;dn6&quot; dataHost=&quot;dhost3&quot; database=&quot;itcast&quot; /&gt;\n\t\n\t&lt;dataHost name=&quot;dhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.210:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost2&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.211:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n\t\n\t&lt;dataHost name=&quot;dhost3&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;0&quot;\n\t\t\t  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;jdbc&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t\n\t\t&lt;writeHost host=&quot;master&quot; url=&quot;jdbc:mysql://192.168.40.212:3306?useSSL=false&amp;amp;serverTimezone=Asia/Shanghai&amp;amp;characterEncoding=utf8&quot; user=&quot;root&quot; password=&quot;Superman*2023&quot; /&gt;\n\t&lt;/dataHost&gt;\n&lt;/mycat:schema&gt;\n</code></pre>\n<p><strong>rule.xml 配置</strong></p>\n<pre><code>[root@mycat ~]# cat /usr/local/mycat/conf/rule.xml \n...\n\t&lt;function name=&quot;murmur&quot;\n\t\tclass=&quot;io.mycat.route.function.PartitionByMurmurHash&quot;&gt;\n\t\t&lt;property name=&quot;seed&quot;&gt;0&lt;/property&gt;&lt;!-- 默认是0 --&gt;\n\t\t&lt;property name=&quot;count&quot;&gt;3&lt;/property&gt;&lt;!-- 要分片的数据库节点数量，必须指定，否则没法分片 --&gt;\n\t\t&lt;property name=&quot;virtualBucketTimes&quot;&gt;160&lt;/property&gt;&lt;!-- 一个实际的数据库节点被映射为这么多虚拟节点，默认是160倍，也就是虚拟节点数是物理节点数的160倍 --&gt;\n\t\t&lt;!-- &lt;property name=&quot;weightMapFile&quot;&gt;weightMapFile&lt;/property&gt; 节点的权重，没有指定权重的节点默认是1。以properties文件的格式填写，以从0开始到count-1的整数值也就是节点索引为key，以节点权重值为值。所有权重值必须是正整数，否则以1代替 --&gt;\n\t\t&lt;!-- &lt;property name=&quot;bucketMapPath&quot;&gt;/etc/mycat/bucketMapPath&lt;/property&gt; \n\t\t\t用于测试时观察各物理节点与虚拟节点的分布情况，如果指定了这个属性，会把虚拟节点的murmur hash值与物理节点的映射按行输出到这个文件，没有默认值，如果不指定，就不会输出任何东西 --&gt;\n\t&lt;/function&gt;\n...\n</code></pre>\n<p><strong>重启 mycat 并插入数据测试</strong></p>\n<pre><code>[root@mycat ~]# /usr/local/mycat/bin/mycat restart\nStopping Mycat-server...\nStopped Mycat-server.\nStarting Mycat-server...\n\n[root@mycat ~]# tail -f  /usr/local/mycat/logs/wrapper.log\n...\nINFO   | jvm 1    | 2023/12/03 22:17:47 | MyCAT Server startup successfully. see logs in logs/mycat.log\n\n[root@db3 ~]# mysql -h 192.168.40.213 -P 8066 -uroot -p'Superman*2023'\nServer version: 5.6.29-mycat-1.6-RELEASE-20161028204710 MyCat Server (OpenCloundDB)\n\nmysql&gt; show databases;\n+----------+\n| DATABASE |\n+----------+\n| ITCAST   |\n| SHOPPING |\n+----------+\n2 rows in set (0.00 sec)\n\nmysql&gt; use ITCAST;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql&gt; show tables;\n+------------------+\n| Tables in ITCAST |\n+------------------+\n| tb_log           |\n| tb_order         |\n+------------------+\n2 rows in set (0.00 sec)\n\n#创建表结构\ncreate table tb_order(\n    id  varchar(100) not null primary key,\n    money   int null,\n    content varchar(200) null\n);\n\n#插入数据\nINSERT INTO tb_order (id, money, content) VALUES ('b92fdaaf-6fc4-11ec-b831-482ae33c4a2d', 10, 'b92fdaf8-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b93482b6-6fc4-11ec-b831-482ae33c4a2d', 20, 'b93482d5-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b937e246-6fc4-11ec-b831-482ae33c4a2d', 50, 'b937e25d-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b93be2dd-6fc4-11ec-b831-482ae33c4a2d', 100, 'b93be2f9-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b93f2d68-6fc4-11ec-b831-482ae33c4a2d', 130, 'b93f2d7d-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b9451b98-6fc4-11ec-b831-482ae33c4a2d', 30, 'b9451bcc-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b9488ec1-6fc4-11ec-b831-482ae33c4a2d', 560, 'b9488edb-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b94be6e6-6fc4-11ec-b831-482ae33c4a2d', 10, 'b94be6ff-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b94ee10d-6fc4-11ec-b831-482ae33c4a2d', 123, 'b94ee12c-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b952492a-6fc4-11ec-b831-482ae33c4a2d', 145, 'b9524945-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b95553ac-6fc4-11ec-b831-482ae33c4a2d', 543, 'b95553c8-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b9581cdd-6fc4-11ec-b831-482ae33c4a2d', 17, 'b9581cfa-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b95afc0f-6fc4-11ec-b831-482ae33c4a2d', 18, 'b95afc2a-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b95daa99-6fc4-11ec-b831-482ae33c4a2d', 134, 'b95daab2-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b9667e3c-6fc4-11ec-b831-482ae33c4a2d', 156, 'b9667e60-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b96ab489-6fc4-11ec-b831-482ae33c4a2d', 175, 'b96ab4a5-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b96e2942-6fc4-11ec-b831-482ae33c4a2d', 180, 'b96e295b-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b97092ec-6fc4-11ec-b831-482ae33c4a2d', 123, 'b9709306-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b973727a-6fc4-11ec-b831-482ae33c4a2d', 230, 'b9737293-6fc4-11ec-b831-482ae33c4a2d');\nINSERT INTO tb_order (id, money, content) VALUES ('b978840f-6fc4-11ec-b831-482ae33c4a2d', 560, 'b978843c-6fc4-11ec-b831-482ae33c4a2d');\n</code></pre>\n<p>PS：数据按一致性 hash 分布在不同节点</p>\n",
            "tags": [
                "MySQL"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/2771271649.html",
            "url": "http://ixuyong.cn/posts/2771271649.html",
            "title": "云原生K8s安全专家CKS认证考题详解",
            "date_published": "2025-04-09T13:38:39.000Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"抱歉, 这个密码看着不太对, 请再试试。\" data-whm=\"抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容。\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"51b7696c170db1f393208c9728cf1b39666792a92daee416449ae392a4ae125d\">d025f0d3bd12bef569594886c37488b3f72b0f85e79b466e52addc3fcd9d370499a86d765d96345502bfa68ca2b47343ba8a9b7797cc81d808e3efa72cafb7786ffd6a6fba1e799837c87d976607d26dc00198cecb9f66b043012982d55bf84bbd5c067a5f2f3a2cd5154efa6f2b5dbfec8e5d6a0adf5e972b51aa888c31d7baf58724c7890803a78330259f6e9b6efb52fdee5062732dbefeb4aa9e0d5f11233b483ef0c7cfb025e107cac2cfb8bfff06f74900913c747bf515c4a7f1ddbe8f4da9f7862f34caf954f17be53a83e7a3ecfe69edd176651c1b0e6f114ffa6d455c680d5fd1e7e80f18ca5aa880200686f5893b87d01e92c5f8b5e5b71f14eb850fc408ea171096fdbdb1ae1c4dd235429154cf45d708947d9f899f8f36b5874471f1ad130c57f7d2e4782cf66cd175d0d1880f17bdebe4be47fa13eef7a7d03c35f156b8fd3502bafb6fb43a7fabf2cf06df8142b186f726e07aadbfd35205c88f29e3a5a287dd884d4e07af0eb4fc56e2fc9db6b2d45ae23257b222a5f7964e24602ad0f63a062d881644e5a6cddf9f556c3111e445442815b50b73b870d1205d66e24e5a0553bbe56c0d1db30513259b094602cef96bfe6f7f75d4c9733816cc853a830eb43326c1c375e4696d7c8e78499f1c1deb60a1f351db456820edb39861cb5444650c343c396c3ff577b2c333140df9784559d101cfa0068498af30bb9f600c73a06520d55f61ef30410bc4a3e23ddb23aac7e6a8d31c26f3caf9e04aa0394e9881bf356cc98f928c43bcea6ebe864f9a0fab56d64392797b1ca3658b248a7ef63a00cdae39a14bbe0a999dfd92bc9cc42a29593055282f3a7b81f8cef52b2b8e76aba9d98017ac16af2fab8937adfa1074e5b3dd9a597eab7704920bd9c8ba2181bfb1330a91aa895ac07226929581865a1094820f17f9290c24bd711e546365fa21ce5399133309d7c34722ef7cc387114022e03e6f61a06e07d68ec3464fae6ce7af02835c18f2da24db5a73a345f89932c1b9ce2b70033b9a6967488fdd01313d37dd26510dfe20ddb11bc736f2cdee16f36aea4193f89e1ad10fb1aaa98ee1b76260d8a62e67e7f1e199636ae56758d4fc83134178a9114a7b2d5531e0aa0fce3385d6286cfe31223ed265bdbbb2a5343f76dc74c3589e789ec815816043a1709d891a75a2903a73ec274767d2e430fd8c749e145b372a394d1a9bf334260403c879454a46a90ed5319675419181a977a695061062780fc5b393827ce74f664df0f628b4d83104d7e23511eee8a44618f2a8c820c70798d77ac74be479f88196d9a58a6a92bf99ddb0c10cb73967150f7802c4bd44acc9a6008c7258c9fb896ea90880412e8aee0b7f586a147a668c84e5d0eb405e94a35f9ee0667bfbd888efac2c9577622e645be38c0fcb7debb426c9280019fca139bfb60e075add13b5120cb55a77525f4b575bfafc58af17a2302118e9bfa5d23cb74f1f486b3646116fc86b963b19f44d80d9a8e21e8d15857eb45a057bf6bb29010b5212b9743c1550319ada6a98372d0a4e9049a5e372341fa591a3d3e29e9a8ecb62a546450e5af0564ea6da1bc31d8edacd18bfefbed4f72f5b2109a03178e6f96db0e8edf126d8beecd3364baeb348b67c707c0f6994c5b8d541324f0179d2e39449becc69f8596a74479070ed30b7504adbd19e8281b85601307645195e0404ddbbb975260be158cc0a54d5213d114c842589fcc8f2c813c0a74e6bef7bba1c490c3692d8f5888071804a94b9fa8dba1fa6b3d1b7610aa94e89091a06930905152d7b937f7812fd35426bda5b623dc9315a736c990c1ca7b26949d3d72c77f377794527e0a66e8007cfb2ade192adf76d1a279d7155fdffee0f7ffcc35069f0e14d89e55535b573674927a756e337b569aa4d81d5a1cef5789b68e2e00f9bb06cb9036e9747025f67aacde51c9652311d6755bf4198965c0f19dffdb5601982ba9a5f4981e09c7124db8892f76bd29950c7f5864946179c1f6237285590a64733efb306f580d1fad5ff17b10d8fe9c20e5e35a5cc4cd58dcfba3fb57a363ffd8449f4328d61320b0379945d335348ce291736c7d7b8346a2066c28ffa19869b92ce96e712d0ec0640c3ec6317c00814a0ab4e7d1c39b0fd2ab01a3633ee38ab0c4710743c4da20572e5f44c817b0956cafc9321a84eb954894330819aaed901d53e8695c0c59ee01fe0c578449fc5cbbf3f15c1f6b810127e72c363e559c0199cc104972cb7290bf1bc7dadac5afedc79a02d78d6b4b648b3bcbadfdb267e41698f41735a5848b73eabf25686d47658b3d03758961da7fca355b252d3cc466d7819e6fa2339b29b7ca1c5d6de487622ed1593f67e29abbc5e6411392da2886a66e69e5a53cb026194422201a88f449e7278cfacec28a40697e0f237bd781f0214ceb8253b894393661c39f3ccb76af0ca4dd9f25e34d131151983963dad12ae443dea2862c69be1fcb2214be816b9fe82fa9da031273f031b26f2e2d53e324df3623846fec734ffad7564e614809fa07dd3eb73702ccaebdcceb8472d58c87965ebbbf56f122cb27acd0fd7bc9290705ba15551a9f1158d24601be8f5248c601c97ca4bfb06f230fdb35c0356034b83b7f3ab0e06e02bca2dd11b8fc17fda080e7b23c0f7f13324370a325a68fd280bcb100d721fb4fe996b7c235d195e0afd664e2dd0e874405d1f25c940f4afd75005f9fe329c8ed934389afd601884ee36ab087f3b69d753cec2e0ade0582cfa428e6b2a0bcc0c5d1922eb7b4be015d8bb36d4d08d21d6bf58ed2371261dd6fe73829528c388931c45323b6f63f5bde0349800e9730c4741fb2cce3445fe1d807fbf0cf79a8c31e1dc7ca919b6d708ec91bed507da2ff6ff7ef27463ff9e4405b515e9ad88bff561a6572bac9cb83b9df64e45cde60488e748ce70f6d41b322ef5cb63df98e02a6cac7955e8f73b8f7d315c5aab854572dbc08c267e428af39cb17a365d8ad659cf24d4d08974df82a5902405a4861310208e6537fd08f9ea21f5acace362caff28199e17287a9c67fbf6edd84219bcf8d9de8c243b9b100fd984429417c3f5b857fa129b6d0b8db8a769addec47d9c04f9bdf316458a4ed6f4bb9203eef7abc5902dcf9533048acee39c606df1c1f27b6f568b1f5ec980da0a0dc24c929fd0e7f0209ab39750094b266e4c303d7982f9270aaa4c992c614d517040220081619c25a2efde301995148ac737785549ce9259cbd4a39ba6cbf60b713f656a6b737637f0e7d473710c1eb6311b24d5b7aa2963f7cc9858994fcb0a3e1087dc4ad94f3410e756f96a506b349d221cc4ae2afa473b0467156402af4cb087446dafbd693ad69b9b4cf43015b0fe8ef8d9a86914d999ec0965a3c22657c6c07fd21abffd43ef071ca5949739de2eb43e65cd6b888642fcd1589a5d117c874c831f54c492bcd05174161a54f6c5de153b6aad0da92b099c34ad9b978498c044f6d14cfddbbb47f7410aa8fab2099894635fb41675181a270329063039104cef1932c2b453c7c5d862c43c2fc7b14344f0eab47f3581648866599cdcbbf0b8dab67178612c30f4784f0c7a6320979ffaee713004c422258c1e7119b4cfe597cedc391f1cabf169b8e24bbf7ddb6210412b21f72d15893b3d9d96dcd1cdd42793e6a19c70d3885e0d60e90348f0f6b4af6516b1edd2083d079b1e310866e38716a5e64d8867b5ba7f9d9a7b96e48ef779533691103579ab9929e8ca9ba83af54885aecfcbb869a58f5b9a9cbee998b0aa30ce8c294d2c81df7167e76e7a4071c8ed57fa51acf057a077d43cb151536a54716322f93c3a1245415245ef906be1425eae0ec6c5f4402daf9f02638ebbaa5f06764eb5fbc5f5bf3b2cc9f79d105a5fdfa6973d8f704cd7423d1141b77a8a61a8da40cf08ab66a31662ad5e7d5883de4f71cfcc57e4d1563c7bcda1c869e024e735d2c985c64b5556637df7faf9cb269c87b8179a9c2eab3884af570d046707c9b980b444dc6dbd4a51c009999fa583ec8290a748f4fd475909a9c8574858e4f50e1d48ff7528c457731895639706c81d5cac3f6520ca3225d6fa77faf02b6b00e8e5f79bfaa1b006d9dfd16415b1422fda6829e0fce6da369900e576c9816a615eb496210ba5c9c4cd83d15d51f7114407737ed091348153db28d51a92fbff3abe33b2216778ed22a9bf9875458db41fd2598f4baf39d2874953d56cbc0e4a53a015f2774fad904a34646d9d2d985620d98181445a174f9842a21f56f4b3089dac3d7eee98ad6fafcecf70356ccd3fdaecd23a379300a36c0f230969a9b18ede35018f8250f5d29ea78dc7b127769ce66a7c0c024ac528fffe4d37663e9de20b1ae3a1646fb1c036302312571d2f97e3d1a635d7d5018ff3c81cee31e1678e9e4b8f1795f0cea82d563cdd03479fc9d901199166b0c990acba49bdcfbb518323081c5fdb15cadd4da62189c9d17a115300e9cd7387aa4f3370d83f4c6c9bfcb9be5f656d57562752d7d98c2165027eeb49adcaefa7af460d6344b3d9ebff18305d1f1dbbd4bc25493fee7f65da8bac317c7214fe8fa751579b5230beb605260d930a889b772146f9dbeceef5c23638b7219b5a6c46087910e43d337773385511eb44faa53ee30ad4563009517583527f399f152325fa87a78da7e0d7203c1b129971f03d68fcf704d70d5359e4aeef6e8fbf2258eeac683f09669bd6ed420547b86a199c7c0b75271d7ad8882dfe5882f10d57b5bb2a95cda27a396b2e4829731d930ef88064b68ed651d3fd9bac9d523546bb5a1f6b5ea21708858eb96eb86e40184da6040636801080a9430c67c8d6d90b5b085c95d29fd23ef8b53afa9e8f8d5cf2fe31e7e3dea0a5e16d540d7d79ea582d923b6405d6c4819f59efab7af18f09833d355fb25db247381a4c318e5c91e1649c8dfd9b73cd285349489d5e8c3d95862b920cd79bb621e4c7247d6b4865502f6b020cdcd5943e65b8f9d25fec4bd1f321e1340ec82ffa58ec907a2128922c27d83917f734164b8af7889bcb56a2194c6ea99ab0d5df9a898162839788d0637e6a130b4819c16c50699f9a84d8e84da3f9b470a9135cc4733c55d48b1b06b781b2b7f54eafa16c3800a91487121de49cad26481d0286bb2d688de108801f34ff57672ace55a4736630cfbc7b7e51b81aae626cf17884e61f747a1d5a0385d89e878de486ac0c543a384ec6928d789f35696c6f1a5f9537f09e8e44fa0f8b43cb61598e7b0f752edbca7025ba56092d6615a9c903c6a49e450b6278e07820f07f56ac4267b77c5aecd9ce42c3137210b1d41dbc901a091053c3f7e5f17ebf0494a534639b307ae5645a8285a2e292dfcd0b65d00177d8de98b5d43b710d474e8c2757d0a76bb255477095dc9ed1d93498e0d183f68d675015e720c7bd0eec233f623d3ca82efc901e5a4b76ac968f033604a4aee463a2c0a1a0b7a210d5317d1d1540471472dc14168d08f2a705c08225708d0f780142a1c5d450b0e922461cd497dfebcf50ba44544b6f7883b047e288b60a361c66f73b4d31fa78cf994d42b42ba31833581e2fbad78f9bd589e3dd4e7513045387f57c5be2816dd479b3862228f882a6c3c5199cc12dae793dea9f4779e58c481167af0bee76443e9336a1ee4c3aa7a815822fe57a7841cd39ff3d3917f4d91a02dcaaf4d80f97a0f3fc73cdbb752c13f808a33907a8bc9f9975cc5dcaaed92711862ad3213f7f498f457f889009327b21a910980a9912ed9dfc8bbadab7cbf7da7f8eef1f0b33769886c7b2e015e92f4a093bf5e6f749ff085c619e8c2dbb9b0a8c6a8b4d64ae019c6d8747aa023810b10c03e9d1b88c47697708aadb9138f438238507699eefe4e80f9f3ffed6da22d3c30e08ca836d0b1d1d6aa8c92c8e1f007eb8c4b1adbf5e9ea789e9c2b2be87fadbf4304cac4bc52d985a26fdb84b5c24513b364997aff53668ce772af3f39c7b71f685f64cd9a4c2042c964365b47e11cfc0a2c8279dd80295973f341b797838629eec613f099de36cdb7a099a497e0af2d941f7d6aeb661cb146c591311546fd64a6d1ea873bf59321eda25c19e6ef92b1ba988b948263e9d2be04b74ac387c158389f1e475152436aa56f1c76cc6bd294409d36f4348110924e2fc3e4f646fd70e2d0c7343ca2b6907ff62512aa4583b3adcf9961dd3453c9f5ec8f8f0c2d4bc464ee244cae2b116d7f1a2d29475ca6739e215e48a6884c95c4e2a2ff8bc161c9b1198356ac527c4cf6bfb6f41747785a8ab430cea48f51117a39b103c1c87e24023c66e92d6330181f271e15a2a97a81b9ecae65e3ea830ef2a49c4890fa448d6ccc154191591f1aa27e9abdac439fe5c3e2424414c24227cf3b903b65f70b6238d10808c86a82ba269e1907f0b82b8e64adebfb46cb0222b353dc41242fab72fe3ecfe95d1252641d84b7e41fc4afc26821b4b30e4d686f3c4072007d1f07293b2ea549848617f0c28c0401d11ae60da2a39ac81622df6827a04b93b6e447e9dfc8000e01e9bfebf70c9acff28a0e715614fb96441be0eefbffaa1a66631d54a18f450f32f9a1469d01a143fcbc080bd9242a586943b749a75a4f600ac6891cc3d044631ff9fa758943c8d7e9048e6f24c8989a147c4774aadf7510dc3199cdb827b5d36d55c685133320c2f29801484bc155eb1775293b73770ec7c4aa0c10a93fc0d469279f48b973a45ecbe27d4e423de771c88f36d9ccfc6cbcfe737b065fe0b54954dbe0947c3e54df07a26347c04c48d7b928006086606c9cf02be8b15073bc3026e72feeb2a45b30c6589b8bed1b8189e57d9a4bfbaf4513c51161b1e2a209b274550769e027544eb1ed7b369389a3a233143f42a4c27a686a9d4f396c4ad632eca130e3932bc0912dc1588e240c9e6814fc5b213540e713ea1900314b935ca1b9dad0975b6ebb1fc84f7537d129bef58d36822cabe0ea91037af4a5dc6b09d223673023095d9c7d7c27dbc339a61716f6fc8990e90872dcdf3df9a537fe9fcc9477d4bcf26df7cf4314ae6bff3296fff4048152dd1947e47e237bc1feb31cf22780fb832c3235fb4ac71f292e7322b4fa33be14c624e026d4840eb60212354d542a7215f895a952c091f804279fd9610effcbf6394e8a13c18fb0aaa7775672b10b8a6ec5535715f4d99cfd2b8c100347fe4be972e67e7c9dbd80883d5efad85fecc42fcc1350eed07752aa6924a75c5853bfa7bf2910ee2f87a18e9d304718680c9c7343ebe2aee9680156f2e72af5e7b71d178994641c1ce0f9a4535a0dc5c68dbcb5f625d8140b55e361905aef59e464f469263e39759f874188a31707a0e52a7a8e5642fffcb643281852757908d5776c552f3453270810ee6871fc2dd733e40bb64929578c620d73168fb4060d2c90611f666060d19fb6507c8b622f9e79bf0721a2c67027f0a837cdb059f80a3fd87483e05929305862f7704e063b7c2fefac39db8763ddc4a280841f8e55e64f6bdef37fa0af994e6691041e27542012be4e8597b40dfb594cb945189be89e6d8d483704350920b0d3250156c2c8e71992d6540e4b21d55b6ff7cc28b65c0aff93e8bdd1f14fa03e607cf0a762efea155e5a39355c2472a7f2ad07b76c2802aa9cd69d303a1e718ef2ddc533820163cdf2d8dc6b914e76af47306247b3becd68baaa2597b0bd8e82d540021360bf2890b01ef7e744632f1919660fe15658a77f94ad28a59cd9c84505ae25c1d66cf01edd11215eb77fee0582447d94c69167f18afe1cc832544c74800fa2961cfe2383d3f5a7e3cec8fa55bcec08643ade51115586e96b6b8a11a9a355850d8c70cfc9bcb43f9a20c59f91da237266e8c9e24e4697d7c892480f34edd5a0ac6d1f274ba452ce9dbaed169a30c42954652afb5b1bbbcdf3f9cc2747ed312dcfb1b4ff68efe022a724091ad9e79159216188fd08c4745b1fa04010f02dcf5ea2bbf3a4e9bcd553fd9ab371a4184c5de1b22804c00d84c798aa7a22ed959af89c215c8e643803823ee962cdc7528a1d98b1d57aaa9d3553f13d7497acd394ca944292c0de31be375b7d8550d81c42e5fa4ca7c0ddc50a06202c116513a8e56bbb7a70c4e6324835572231d85866061fd13a018d019d6f42c8c73ecd8c548b929b41a0d1ce027c43e3180083a9fb8e8ae3b98108dc45f47c9f1e7d774b0e9b3b2dfaffbd23142bb7af9b8d58930841b69819dccaf8960604553496710770fa98475700816d5e2feb3d9508cc599108e267b6478b1548c1924ba0c1331c54c9b9efe7fe43dea85a15e3a5f5f364072d846392531b70089c7e060844f407767584f7ea3b277629626f80d871f1f916e784de807f3993abe70bf614201fbd461f5bb7a5ef06e5393e2b8ef9cbdf0390fec952725f6c09e86df23ca69114d72af64e56f1e3db196c14eb4df7941b2680240d5acf40b04bf54c1e0c22253f677b1e286adac7fcfbe81b5b37b615ee3b69733293233bc9ebe4e7179b5b67437bb09e9564c0dc7dcd90edf5943d9b18c3fe8ff9d74bcbaf993170d5afb60b862cb982b5b0df920f450dd8bbf41fbaefa7305e17a4fe1ed75011459b9fb8ad776a28609e9c2bb1cac1438693fd786e490cce90e445949a2b661a31373375676989b5bd4261e3499137c35df902e52dc6265850ddbe28055049b5510d4b3165781a3806a98d80a88f84bf687d9027647be800ee12b52643ddf139dd66b69623d60ea2d140f84b9c0ee07c74d78bbd0d5de8e8194178e37bef7965d4911984fbe5424386ead3cfcee56ba35840dad79b258f10a1ce3757226a889b2fb4d4581b6ceb71983139a0bfa0fdc685e6d234aa6395fd66e9e5a2de4a4f0ef5c0bfc2e243af2ceac52b27c323b11e3155df461c259d14e90041f2eea80744e18e9a50a406d17db551820f7059e3f26c492cab857986125f9c386ba1e12f84e809e35ced217f6de2212d3064d9954c95d78bbe4f33d3dbc5628791762122ebe7f1d29cbebee9e8b1ba2919c3c2eb12dce4d77184363bcab477f6715b1c0db363b1666ce3b63289077cf6c7cbce62c35d8ace665dffdaab73f879c561dc719235f506b61984c1166c4495eac018d56790fe192c6d4e94dc8d4b0add5a72965520f6ab181354613e4981c42174e4a5c236ee16c94534be04608b7a37518d3f71cefec54c1eed88084d11939c74cf19c19d2cbeabfeefb9da5a1a43fa0defeea2b04ccb90dfd8793123c2ae8027de4ed543bcd42100bfbd72b9d7e1d8085ecafe94fc0bc89f062f44d9630d4c6dc096e9ff838ac91d1789b8ec9c39eca0cfedc0714779b4990eaa72f422dada24ba0915570c3f8375ea490d0e53bdc9ac752b47920eaede928b67cbff3691836f57f1b08fbe93e738b38279a7f90b2ebea9e0582c017dc40af6d5f77bdb1ac9b1f6633ed4346c805219dbbcfff2b54acf6e88d0782194b8bbb358e9ad570588b4c3c24da49d808dd9c728e7b14debed8083e7bd6b251134402d95ced2ddadaa38b2147317b98a71236d338d1975bc04daeaa2773426bae450bc5674f41e8352d05c3fafbe3bd92436556f451756b7e9fa97986e60a49c07f9c86e90d0c51b87dff7d6cbc4a91961d2e97afa3ff51ef4a749d6897ff6dc3e78be6d9558ff4299d25c32dfc0629ebceb714c2cb735f4ebc75fd28ca8c8b216945081b70c26c547ca9402dffb18d888f2225989591c5dab5843c0d8fd278eaf246001509e3021fc160c8c681b146cb0483fe12395ed1e3e1f0fc68a8b151edf49e152648ee9295d5e419837cd6bd3cc8825a30439cdaf376f3bed4d79f537e983ac030cb5017223cd8bb37fb3ad72ca149cef7660412a2760a5e7676a523e791921c64865c53b49269f2721f8554451e43fbcc0b7d88817febeb8fc97a8e8866219fb293e42018873d6c733cf2578493799d6d801d4c0c01681350a708929c0cad701d12a10d54c6581ce62b0e982cfc9694f4dd43b0b5215950e1c2c881385b05be27bd1274ac55be9f67627a4da723afc9c58b150ee4eda5979a5fd2fcbb6fd331e7ca611aa798ca0fc3b9b710786c3b6d3d625918bfbb5846b6ca42b255424f928d1d68275b7450b51753604af2595701f29effa2dccd209bfd43f63863a71b252afceb01240a506cc9eeace474f3148d4350e8ac0a341ef0d6cc0053aa7c5ad2a150ccd8a5f5fde81f3edcd91ec72eccba41172c11ae95ad0caad01134541ee625e675d41292779e89c7f43b72b397228e7368b148a2a9556e9fa9e1d18765590841071a8fb902898f8cf901796339e0e0b1bee21679d44b6ee95ec54339443b985390f77cc43332d5bcdba17212f2bfe2acd62b07b65f9aa11508d2e8d01ef7b2a6ee5fe4d07aa4ff8364d18624a7e96b6dc854888b85f4f67883a419e17b7805ebba37bc1622860dcc0e7ebf6970b170c4ec94c11181b958e9a1976aa2bb4038e41f1dfa831a069a4931a1c1aa602b59e5db32a5b793d1e77b1b8d2c9f84bec37859d78c4e8651bdedd337fde2aa5079e2e9fd88c0202d48ec26c769611aa3469526abfcba90358a9fd588c07b819997dc1fc6bf1bf2d1e23e87404ae1ba47b4d3e5e23f509b4fee2533ec6a6063cfa3ac67da831d764f9a76bd584ce24115d5b060fae6e5ecc62e5c65a7b75637f2920ab705235ac6de15cf2ad2b328307227b89eefb82145d1b531854c4a9fe3155f8919b6a0fe5cfb9337cc796ddfde6f9d94bcfe16c32ae706a6ba321efbe8f4832d7b56b7ed1495f899f4b9b398e20a157e68bbd60f18f956d523f3e3b108373fa00277eb7cb38a77b40c6cfdd33076bdb1e90244ff6eafcadc69d662a7ceca760372e0d51253dec13e6a4b6b419c34ee6f40833b68d7ee6b09554da7dff60c1554b03d2ff6a4b6e00aec218d9c3d2e21945a90a429afb0a029587e2de0b47acdb5054ffc32f15cd0570517074c5ea5e5c96204fa5820131e2ccbc49c76714af4bcd4ff9afe1951b3f81be282b840ac41a42cbcd5744e61f839fc3bba34748513c35cacb6082e6b7f43e240befcffb1f4da855cd58eb5059c696dbe03ce31f2bceb027e4dad4346cb59f2d5e32b8a7057c7b1737f7928e90cf6bba4dda23caa250de0fb1158204999afe429b904ead61afa604d069edc128f12fe0be0ba4e34c72cdf3df62a1eb9ff4ef78cecd04de29b764fe18732ad3ffd3154921e63d787199c2269389f3b540303144699f9a8d4e38005ff6f77216b3378092bd08ac55690ed281ba7c9ace51304c7f6572a6b72dd0864b005aecf2c068669bdd712f46ae828c7edde1afcd241aadd10610e1adaeffb2ebd4d7326ddd8b0d82608de27080c84230163140b7b0fe9fdf43ba6bd530728261b9f81d039b2c82e464a3c067052f8d015bdae90862326730df8def074231f9d5d2167dd47cd1965e7d40b2f5df969a98d08f15d9f878f962dfeb4ce120c71d71dff62a09ca2d93408864fb785971550b11206c27024da9a1f9488860328b9c4033f3771b28c2a912ffa6c40bea08119d21f2bc0b827081cbc6c672397ada1046c057417f83b0dec77f421c592da0845c747a3f524f2d759e1bfba20bf17cb9fb37dc219cfb638c06d42fef0fcd07dbd0e260b670a277d12ee20a2ece6a675fbc3473eb41d0c9b4eb5710d66d2023aa3beacb6110015eb72d7901eb3cda646354643d6cdb022d46d61a1d4b6014eafcfb35c712f3119a1c3f6ca84f838da40466c489a73b2c89e79ea1cd257424f037f5fdb93d800c1cc5e90347484bfd24d013a7de95f54324a79c596ff346f1b3b3b5f87c8deb79e9efc957697aa437ff7509aac29a3eff0e76845d69b5bc261d3be05175695bef0201c6a752589d6d22698821ed8f0c35afd91e9f4959320f5b156ad587e3a5b2862e8b55fe1d36983fed19dba12205a7e2093f047c606866dd0b9abee3f8663c4eda714427dd5ca5f9cb96a30120fa201532bddf805bc84f152167f28aa34406343b42323481cd55496f25c42fd18c2eddad0517e6c6fe6dba1eb6e55b7e2058e0e312f4a002b78d254252a3dc02207e97f1a8da76b065df0d046962e0df842598eb0dfbd3141e7ca695361783d8e808357733446cd97bc7f7136f3377cbeed30d65fd211fca216b168a22b8efce356940316d4320cb6a65c07face1cf4b4bfc3b27255418b6d5f9eed9118b2eb4ec3fe089dbc36c745555fe226013c88d9137293e4d223a39b89422bbcc4f46bfac1038e5b1aa6f45252a4a697d30eacfc5efd926a08c9230dd285a4c6b81fa84159f27f62f2bb30c8e0bd8f2ddb04cddead3cef535302768570097246fab1e97c55b0c393b77aa2f60595a79aab1bbe1ab3280509a0cae6a7a935ddbe72084c8ea0ff1dbd355e3d45c971b9a5416c2cc4cd6ac0582329de36057933a4eec8d00c1b29b4a6e6abbbfd8f9d107e85fd826ec2003c03a40ce08cbeeeca2d6ac9bfb52f9354eb9cc5ea58a48815a610ed1e3835026cd4ac7ad296f16d042f49ce1405619dfc356141aa3531d49bcc45c2480a167cb4ee2ea0bea5aedd5067a3ee651130d5fab5392411f3e0bfa4bd31bd298b533b7fdc260cc3fc7de2e15db0d6117e7bba85a712aeb0eb320fb9d7a2ba91e2329bc0f47fd7f35fa029f16dcb43062aa64c4fac5524309edd1beb61f6002d20b00acbdc5ad58c11c5929f965da278ff90b3884d24c7bd34da575882efaa41bd30d719ce543283a982c416e710288ebe9320883c3fa44b6bbb919ac3e9eff51edd4691b584f63951cc605bd23986984bad911a0d210da92f6cddd53ad88c50252d97708c29fb9807ed17ab0f90c454ebe9dabab368e9c05324f34dfc219fcb2664bae8b7f90f63eb913ad2dcc52b325b7cc8f828182d9f2cc5139875b521410aa573ec20ceb09ee5dd617fd9bf02a511b4789a289ee461f48c9f6f8febf61fdff7d4e83b9091fd3a4a6465aa4da1f971ebad9f07f622930779b296959aab76c1d79f66d08666d81a2da41940e68166c20204469e39e6e79885ed662bbf0d9bff5cf075bd7cf5bbafdd019b76544972010d3f159f5c22c89c7538e090137a3fc97b7db10cc972d1e171c9134f6c6d8ea29eff50b5569e2ae5b6a4835f0fc5c1e8b14c907d4fff899933be7dff10905af31e584966f3f9b068126d4ce089f709365491800f7cc647b8657a27694c41a2cff6c888d12dc28499bc81530c84b17836a11368bd46f3d117df7a684dce72d098ad71117aae7f0440b68575a3c1803ffc68b137b907c54f23793d02f2f605caf6933c5a456368605b6976caf471ead4847e7b0031d60193731bd07e268c7c123b0c8a3bbb3b4ef170a5f21fc1b7d7790fcd15ff432d50cd0f8b25d93e42f5714cedc89711a4e83a4742c1dbd9881eb56b0be4aba5f83046120b251498d36f632679a9f0d8523b2d6c21b59bbc12f913d2c66f9e2ed58edabdb304fbdab2e932b288a0b3628ea94c33eb6943c185db2ce15f193f4bf598d278c448c3e16c19548074f7971932fd42417b055b92cd2e912f5a37925c56aa55ff44d8b72f8dbaa48aabc175efdddf571933367168cb3f808612388353d6f285e8b077ad30219db47d460858d24bdb1ba0e52b114c7dfdfeb0444094c34cab515dd6ea97c2534b67faefa38ff78fccea109141edfcdbea3539cb92ea8d31a74bf7c7da39e5b9f011d1bce4f9cb6972d5210f951d0809e8ad8736852abe912eca191bd025f4ac4c9d8da67b2afd438b7842402f1da5d4e5538df98557ee1d6bbcba978b7c39098d1d78a7d0b75d9d6e2ab17793b6774309d382af2a89935c8efe8d9c99b78f5298aa5654489aa690ff0854b0df0eb00e6734b149663629d409a06acb5f53893dc8181d8df966b2e111e57b1d2908afc6dc65f748ad33e2fd13f3dcc0851ae149296d2d83ae7084768562f0baa9499848a60249fcfaea3d473bd4fed311812d0e3fd965de29ca24276b65ac1379e4316977ce94f38327d4af7a136aadd1a4d535ec577cce2cd5ad98d209dfbfb6883aa49af373fd966ea7dffb1e91a1300b8602b7daad80869ff1dd63f769fb15e429bf32bff1d9e0c3b6f8b54a95b2208c39daea15d68fc86b64b1c2d6e98899d94b5f52da70e5272cb50d019c3d3aee9b3e40bb247856faba607a06b7eebf89706eb24f73807315cffb7491b30152c98d2fc09797df4b5448da4a0285bd331b24a5d1d1384f9263b6e0c4e9f19dfafe2c3259f2b6512bb27ced615bde3c44727db2701864fce7550f9280da31c7c583f7ddf3424360887ab76dfb281a69b9281d63d999760d3029e2138b78578b9893f776f79a0496011281bd5e1d618aa144e9a1fefceb1d412c320d62032d31138039724314c15c0080b491a7dbcfd599031d432e6db328755e3b44e0744021a93431eca5f8aeda896c4bdc7ac123700fff11a5e194fee5629bc246bda52b9590597577a27d907e53754ff464629029f74ad4316d408a8e95b73d30a3626cf17b6a15d3ad844a5b897b11cf7ad818c3965cbfd4ce9935150fa5fd8f5a5abe2c3221a64422463d6c89063cce2c871d55a1b081df684c4c740998adbedc19e9a178dc5d10e995d1e52f3494264b371103cc8a92d937dc983dd0070edb29fc73e8b2a811897bafacc5bc7ade2e7bc5aefd64ee9125f648f60ff45d9f56898af745bbadf35e0f1803297667be957fd8c7690226dbba09201be98ab06de4c55d004065fb32f0739670f5a52e111c7f996e6fec6d529a227b0667fadb3ee4067e55a716fed7da68260ed22bbcd10f12df11fc5cbb7c8d10ece2ea5d57df58718fb9b36e3a231bb695b9d8d11ebdea98e9aeaa654eb87670fa8e98e139aca56e1efb25e491fe79d27b910e287aaa8ee9f413b2f61c9f3a972632d6cb434434b79ce97a66412fdb27fea1a2fe2db551eb441f0dc4d736103c7382df53438f5b59c7f82d401ecf084113c125c77150263ddb98a1aa3d5de846f5d6f3887ecffda0719c1667ece1e3b998d108de71a2bb84ed5f0431098db4c9a40087b6bee2d12c85080f75eec5861dfebb3a793c6f1d6ce76c41820416e4e7aa1cfa9bf43649f3a82bcf54bfb5141331f7b31b68a221ade78e9b75dc9c410d482814256b6da5655612e39b68d0baa025fd0855dec617dbf6d18dbf299cf3f421cd567c29f399132df417b6e73a49a7c2fc16b0c77d84ebe6f676f8b487bae477dd00306f915af2a56b78810c7ab602179332cd9673ee88043f19e421ddca66b0c98932adc3ca596b8a25f44e563f122b72d398fa089af91a1de0fbea79d2aa4d12bf742422d8c9108b63b5150b2ba1b66ea63c44ea6d670b0d157a4f1a76e800d13e8034c804f4ead64df997f7c58812bb8f2b4601b1e04f6390a8be3f6b75c73dd86eb27af211091265dfe913109efa620852b97526de1cf0f7af95a7eba864becb4e87f978557695c35154a348c4d2d06031ee90bf977df64abafea113f77bd7a6a6685c73358395156116f56ecf60586a4a456b7a39142b1f1308ad0361116e4484bf72e656ef71bdc4f116db9c3ff0a3e3073c0797cde40bb14b3182dde7117f0e5a71b5650300dc620cb9f93bb67150e5dfbb637894b3a656081e07a52e63e93c2352ac89443ed098e59409d69500feafd9adbf82a3d879ee2365eb60ea5656af3ab0c0312b0aa2e6ee306ee9c1775663c796c5f35180b88672f26c5d6c2e5b8fc4734d72772ba58cf579b686db2a54953ab022ff0fce3a9f086a25c19ae12c5899e466ca39a6f1cdd4c0b71a833855e477eea7ba6dd288fc975ff7525714fbc3b1b623110dfcc3d841fafa0ed298d71c66b513ed1a858cb028e7976e9c69ef19d3193c556c43499576e448a9bba80f95268512db0bad0d19c496ddd66097fd552cb82133b23ca7f9a3e120e7488ee0047e0e4d3f3ad5f0f98b0ffe17725f1781662afc0f5142cdc414a6e72fee5f245d15b4df97ab931d3e490aa18cb05af69dd6406a6ed3a1ce6814664dbf378ea2ebd78fe2f63e545118af64050e9768955db6fd88495a2aa37b781b31007acae9ba5bf3278db18012bbd2a6c7a7686d85f5fd12d0946ae0b5f3eb46232cb43b9230797f0fb1a777f800d151fc5f925278219f46be16a3b40eda542bd6f7f17b90a8c2cd52da0c453a76e416d5dae0d0fbb900ffe045f6829be9c69e72ca0e27d0109ec4e9353802cb4ef6259ccad40a3ab550177111fc8c0b0bf72e2edb16b7d4c59da2936f19e31970834d2c6392dcf8c07dbce002aa30b032f0d72d68c663a045f4bc8f89c8e97bf643c8e21164a7af9a327658ec2d0a157a49322ca710306d2108319c5fe9ee33db7323fa5dae6955e09a030d59c0ff6bd10e64fedb22ea9963eb0cab69d4389840f18b2207585601c0eb4e2fe39fab9e75807f6fc36706cc51eaf6b0d5b4d77ee4a0326526ae954c866699f0f67588fc048ccd7760da2f4317b651d8110c4ae369172bc62ce160a1dd6f0d2304fd76544e8227e6d7ff712336d85d48e4e7f8dfb918eaa43483c203b46396d6a23a88157ac55378cc7dd0487b244fb067014fb683adb12f1d52343dc8419b4b64acdf58b7659c6ca13f982dea59a1de1c74514727ed01e2bb3aa1e9a8bd22123b816e5969890cd81fc8c2db663a926b8a428c8778ae6374e2dd8a05f17d0dcd8aae314b586bf4248495e3c8e3e2a4e31468f85181aafa00bcde3c0d29e877a0e3410038b2a081dda29978244a2146a9147cba17cfb85ce7b231e808ae65c1588d0fdf1e83a18ffc6a8911fbf59546bd3ff5c899578f3be6196c7e5ed4b0ed294b2782471d7b2d496d773fa5b79a111205645d6922556fa97548a2b062ebea9fdd0f33d9fd62097aee23ed1fb90886e323981404b1fdb60760428bb0c81af97056d8d63a3e49d301dbebeac1f074fa917496b2d3cd3debe026cb2612bd27a0269859ba484febac16c86614141aa5a85ec2e3c21da3b9219d9f850b56d64699a87b65ec1d0c6fc14921fc47227d8d589b43a22cc6e1037a924c8f960d24d07a3d4809d3a6d6740a31c140ad8f1d488d88df9f320f26e9f8b2dc69c21ab07a4be64dfb4924fad3a9689aae4a3ad9b0f71bb718bd98396f455b3a732ef8dd420fd525d2d3ab3664f4049bc0faaf895133213897344263e4d8e18da00005f248788ae62183572fb31b27403d20c91b0b8d3553e38053e24539eb5e07f42d345ff2b5a958dc24b22ed8a2b48a3237cc04492c04bfc2c5cdb82b7d4d681f0842d5960fa99dc941c7cdda40e463be96643e3f4a9fdb4e8f10036418a9797857c90c64a5073a20d79fd8f0529ac1a521eab7af279dcf0c37f8301c9b59fdb37d7f36108d343150feb22e9f2bf01bdc3b5ea189e2418528cd44dc7ecad800c5bacd0ae58cd6bce75106b759c97df0e69f8a3d4ac2f0a26432ae7e3ae1edb5c778a98d7a48d7a8321d50d87168a591a8562b53d5d33567170f5378e8fd4d6451749868e00cdbfdb0a79ca29f30a653a4e844fec111562cc4dbabe2c1944fc040dfcfbe3c7692957072d1ed91c15e6fed9f9a878f5016461d345232bec0f50a822db226d7b352b517a0a0fba041ff4c83ebeaebe3f3659460915254c8d1051a40f6955c70bbcf92d47371db42cb76e63c45182fc22b6c5fde08a9c68e08effe764ac20d60ea3a3c5ed64aacdd2f9f67a5c3cfd705d88b7e69945b93c05822f2e9dc065cdbbd2db883a4351351094aab5c2dbf14a3e816c983eb2b609926ed44f5a2d86ef2a925a3d6d96e4d253507696c4ca0ed2e1783dfc3e78f8863d13868d2eb2596f2c8782f504f7d0b1f3a12878ca0db5acb05a30bb4c5da2d1686a7b56c6ddb2e624777883ccfe00ccbac81567a2f4b9b788e06f90179242a04c2ba0d8597990f0223d5ae28dedc51b1ca6ca76767ccd1127d3f1102cf5fa2718779fbb4d30568fc914701dee510c610289f28ad4e79ac4b2b086ec6e524fccb0856e3a575eb595cc9d46a42da864d867c74b8d5fc5b66350119bb8ac509196254db6411b8a388123c79801bd724c2c7568695d04d5e28f94cd9623399e69704b83c9f0622b9a8c31f54741ece0f854831cba701f3728543d3d28e82ec3ac908856e0318b1fca63488cb8d6de5c8808f4d924cf4a81cc48c2095d41abd723c158a3ba0e84dee9aa520ea8ee5829d7951825d1a089fc27b7cb8dd2e0d2f0d559af28bd62ead9b00b0449ca1e513dbb2492eb5e987a1365f8f49f36b943101b35cc12230e609222a9041bebc60bf208274b75d267116d47809cecaab2b21cc9023bbed80d5f0526a6cb1906ce52b0b302784079e8cb665290b17ddfe43f648b820a79ba04cc9a0095eed18dc2c0979dfc83537980c829e81b40b2a9d570b39b1deed9c1772e422c3dfe2f292bc368234b874202dbe244ed0e09205989ace6b116f6bdc7f0ec18756be3d4044c29dc5c1420636464fb213a53963d8b7f313a5cc1e91d38fa7bddb019bfbe136d63cb35f33de9884d667bb2140ee45ff5cf8769d97ffb68fc2129ce6a8ef65dc20905b90ea79e5448768dd8db471327fd74889a0145b1eb4cdb15300e24552d4ab3f064b52224f4fb4e4305a1d2c67d0cc9b204b49264bfe86d12d9814982374d1275e029f27fe24d561a8a5ac13b088ea569ec8b0f0ee0593f945c01c247476cdfb36b539de2b85fae37cc55770da562d07966bd9ea983b9d3472bfd3b13cc01dcf19441fec8cccdf816851807ee92cfc3c3111025e968d2fd2f9c936f0a34c619b8d1aa7e051ad3a33b9e30f5519462beef4b00feb64bb4cb1cb6fd32f29d2ef65f192e9f39be7de1c271de70b93e52cc48ec312c503f832f7ab1db10f5faab68175936e20af41cbf412dbc38a054fd4405f46fe009c1fdbca533835ddfcb5c30c1bd1fb3e5e9a3021072d15a56276fe461d58b7a60702415157abd762c0e7a1c682b6fecae7a8e830db8ee1e57e4679ccb44af49b4ead6c7f8ca83d87d025c1f0b46637a5b249fc1d732e9041dd6fa3a7e708dce9a8560b46979ad0d81e9a9d948b7df147a26871f6733ab0f32508928b92c7c40461b67acf916bb7fb4d834218f9d12c8fb8c55b10d493299cd237d4adba42e0003a4bd973e7267245731381104ab2ce7167bbea39763bc017ab424d267c898e044750fbe2cd13f3d472cfbb3a09a111953e01eed2ffe984bafc2a504575399d2030f23f89746b6d2a583188d8a7236c8d3beec5b62f2ffc09cb3e9944f5936512935d8d29b13cf8a2d346d78f2e6e3dfb859bb993414ec218db77fb122f7bde6ac22caebddfa890cd1ea05783761f00429c149ed55048d626722da08031989fe5034a5bc6dec69062e5b0476502e057e65f1433cd673e6bb2ad258dffffff41b984a8a177e75c6c3c70a36ae4fa1aa0f1a6fd318f1ebe2c61b0d1c7939789397f5bd5325e9ed73367633c814ccb397536372c8d1f7adf3f90a90b59dd32bf1760c57d9087036f15243224226f13bf640bacacef311ac13a826f13376b6b56433cc8fe6e09adb21a6df01b34f02f8aed1faa5e9bc10245a4472d7471c7d0f4fbd8587e6a34ffc7de30155ddf1a61bf784aabcedd325463ce20424913be0b816559f322b6cef252717069cd977b6189f54f975f3b27554532faa485c7fcfe34e09355b80d89cafc4d3dfec54cdc4a012932af9d430a7e72da5a54f757dca3fcccb6bfd5227d9e4b1a396883c38ce1b9da1a00941627ba8d3fd298c480e0b7767354b6af9d06a926a16a84f8583b0aea0ab006b1ca19d9a6acd4c993a78997542b6fc43464a9b259cf6ae6cc1af5471b059e05cd58f302769865c0e1242e3aa2cf508588ce2319544dc3aa581f13946b073921260393dcde8a4d353221894dc0ca0232ccf42c3e3f9793620cf9ea5e26d6fbc7c36c7d4990447b3950eff0e09fbcace5b7fbb4dbb377270052d44768428cb000681cbea8bb2121fc2efd6ebb8d4ecb9e14f6b0ac8876110ae4f8bbcc42dea8a39c5167080602ab8337ffc8168fd07484eedd825b38d4b0162c1b41550282fa118de46eb0b332b1ff74f24c05a1c8c7dc2bdf329fcf2ac4770c952254c7c55bf596774d8f14dcf65fd4c77e593d6be78b7295e2db5117ceef202644c081fa84872408d587374377efc7690cb0dacd1fcdefac6355f81a1131ebc9a9463cd792d59878c43d1a7b57e2ed9cacf154f279a9c1b4e657e5072ffceb933c537aa27ef3ed2ecf091aa649bde851b6aded80cb2f9b4cfd5e5bd20ce1cb8a047149b33bb303fd4c9823e675ef7e60577d1a7d990fa02b3fe6ae80fe512679e6bb383952b802dcbde2071024fe03bed0812ad1d0de55531a27fb18a3c4443ffcbe885b0e3b4e982f4eb909e31b9438be0b9339592ca001999362408729d81ec2558b868392e4b7a9f397fb77c70b02f69775aded2999af971ec9233eca974ffe2a9538da3c5ba5b2d02db2565697eebc6034ac80d9f081c0c42ba96aa58ec5b784f31bb5ffcc1d2634910dc2526e1b2e7b9f8e6c564f28d2a54d10e5b9ee9e6b3d32edf4fc5c1892781b0698e70e9b4ba61a0583bfffa56c208d937f82fdc8447157a40f86d27f2d8bfcf9890293adf2c93de62f2eb8efd145409355234f4dbb183488e155e35cd2a1634e780846bb34cccbb8fc32184e2af3f0bc9ff8e42a6c576c42d8a7240bd8eea74e297016389e9586a527d38df65c921d5109ad61598f3e330128661e2cb52a8be583316f1081508bcf7bb4671a3677ca6816742b7030b44dcd995131a7107d95e3e67f47d09dc8fc05e2bd4bb4cc94d7b7290b61f9d99e2b6141c760f62c0c2a1e7ada3881e5336d87a9f359d39dae5650266033ae4d776f640c9ce37354499f4fb80a064198e281102c3390460320d2fdb5ab6d49f6b9057f5a90faa2a09345f26ffd672ce3a9024fcc9418b2f3f68c31a8f124ce81babe12d2b96414ff1dc3564a39bbd9b8ba6d05d7e500ead6248b4798ea3065310219fb0545fb866efc6e77b4f2325b09e434194754d49828c5eb6bd38782b476b3ce3305db9b39d49e93afef84e70ce053048723294f1fa51d81b9c4e232c908850cefe424acfbd2d4aa3f5d820358bf99261c5d54d8deb9aa2c45db881dc8805fa777b58a9c284182421b6ab9febe35672f36dd4aeb5337bb5b1e01afd737e63e5a7a005e09ed08f64a1c0e5c4aacebfe38efe8ae48fc95146d5da6647a62d5dbb6b91d93f7c98e76caac34083591db601c6a798d0ac8d174c2990331826d4f9d60d55d6e6ad93c02f0f36762b90e9aed400022482fea94f4040544dfaa119d7c06b22f5f74355fb550adfa3d326c988005385e3ecbdacde75d6f1fbc5cf411b1c33ec2c96d76cfd587efbcb7a56b25f8f13c05990d6d64d1eb8f470a4f622a35be399798a4f94f3e398b9342e3f4188a8169ea8ced8cedf4caef4faaa4d6c58c7b4f6a92605c98c517d5880ce6ee9d510ebf059ee3dcc284ce9a471fde01ab02a6547dfe05f7c7df4c35583d94696fc96a13232b54d670678c7b6113555e08ed87fb13f8cae23cb6ac9825b0987e96055f59f5a4a25d7cbf0b2b7e259e1d4afa364100393c9308073aa45049106a2f70363556dd8f321d1e350acfedf15fd157a7f9f8830d2b0d4e4ddc44de4f2e674071394d32ffed67cea89e1750ed3607e7119357c2659758d2b42a7f69e983cde0da7f8b14de0b9ea55a415c7ef46f4a7f5a9115e40763455cdfbb5e16ace47cc8d01825db821c59e11d22ab4242cd5e3ddf91813a2ee984a01e8199355bbe77ff1fbb700fc23bd35bc466f9bbb0135f5318c91403626c526396839215ce5c54669d1a20d7e679c068de7b32d571d8431ac9a48bb1813cc75aee07316fcc3ec243acf32852e2cdf081063d3561a58036da7254367fae88fa8dd117b6038f9dc492b3578789a9c170b8af640a3de114ac74718c20ee6379041e03d266d6699d5cbe89a4d4e309d4a0eb69c3a386dd38c90039b1f95f0122a889e00e29cf9dff4fd191d0a0a36318ce5be6ee2f9940a7c9dd7b91522a8c1c952d3bea713e655a2f22880dbeefdd04e320e91ded5ddab97ba5042d08a2872fd0d31240ac679de40e82b0bb212ca8452280afc95ecf7cea77d1f6f7afe2063a31d52b414c49e9cf4ffd4424a116e1ecf21e8e9433dce41595633efc7027958d33045e58dd35c2719139735351c784a9675ad3c61ea9e1f58d5d73571d0f89236ae15dec6007c3c937046a313d90ea4f8159674eb388686a6832e5120bf7d5b8610c2146e1ae7b3e3f4af63f3baf2bf1eaab52d86ec74946d25a473b8447a997616e46f03d2cba5f236636c22e0b1473a0935686021a3e4b0fe4bfcdb53a8eec9c2eef8fc0f09348580601d6800c72ee171891a86d6ad6f21b91713dba0352aa1fe06e45b084fc31664cecbbb1023498ede619e739c3bebe6edf14c65813507696404809bde3885f8130af9686bb3bec95d9245eb585faa99d002b26cae007c7994059a5d593692a624be09bfc0c4a6b562bb2f0187fbe5e6e7bb085ff4e41c651497cc6366a7d75bd9a3a3f51d3ce5516705003528afe01957d42bc4688a81b9a24148d85fc966f3771edb0a9f27ff87de8f1afae125742699506baba3c2fd574b7fdc8badb069c89083c5724246bcba95504c34b913a14bb7d7eec241c95768e9ae757cd41beaac3dccb0c1ba184e36b7d7e5eafad1335c9472a339c4e7c8e1fd661ff2215a79373b8bf12b973778b954cbb441861050b574f579cd4f9265f64b2f8e5471ccead161553f897ae6d5c5d2d3f39aa914a0310473357c267518949730555bc109250cb6cc6a9605a4ee632a9d31ccef80100071718362a91c2e81c048ef6a9b8e6d428f6ecc88ea06fc22bccbcfb30b2002e7ef43257b607659eb2ae0b104cae7d0952d2bba41d5ae7af74ddb99f20041d3afe5e361fcefe158aaad26eefdafaa701ac79714c86963149da8ddc94aa3757232913c6beaee0d50364217cb70f8fc080f04f5e364a98c8bfdb1cd9636d088df666796364616ac3d8e238a7752d853d534bffc511fcffc0acb742784792eb3d2e83efea5fc4ae61682d202e96193091a1e0565b14e6442365909a95ea29c02f2771bcc43cbfb55ace7ea43ef7adc5052bbb706d0a5dfb9a2480d4760211425fea4fc846f6a8abace22a5b99e2ed40bdcb8f3dd2d456448660b464acbe3df1756c8aeb09aeef278336e4d7f83e18d692c74e409b679e5ad2b6b91ab2d98d0b6af5fa5852cd69397152c21857eebb586959c26dc3fad2501897f2c9eed0f3bb8cd6f95c5519ce869aa353c59de8efb6332bb692771312896bb8e2bba19c899d5150171f4a8e4a4ad5af45f6c3576545f03ee4de83538b2966527a77aa7f5c141764dbd0bb58e438b059363156def2f1d2bae9ef8f5b06b34c37871e653e4612b1e1001dfff7beea548ae4c2e065d31a509a46dba33f3a11c0fbd2895de31244d4efaa6ed3ea84739df7cc06817a0f0a510984d8dd169fdb99729f1a78bd8e62229edad09e40bf8433c0c2b5368653e88f1e1b65f6a498748b1e5b72a0a87d4dae363eafc0ad063373b92699a99fbd2cb274b9f99a579bbc3d3e235b1f1ab2c96cba6bdf1f78d900b4fec9f343377c3506e8110ceab55c37af8c803a281fd7a3c2b91e1903875054047875b340fb2c1169f0cf744bd98e4289b5945a0a84b99d674567869655f7bce5621347bec2199434de2b426435228169b7b5398078d016062bb132195c407eae8b75fc6a526411df22a8fa65947f4f18223d77ea1a6ca6f971dce593455b73509c14704099b20c4ad59bbf924dd09c098c69446af735b0677ea61dfbbab9db9dc0955a3ddd8afdf977f347c3a109bf5bef8237a80b1257d613910fba9ce73999d7561038beb74fc14a09e2a6d4c5f697d51fe9e7d0db7fb16969adb8122329c470c5e7c6d1561f7ee517d0f12aeb2b7b207a247c863a40b8ace7a7ecb8aee3d9b21dc119ea6950824bac399ddf9cad000d4726c66d8d0e05bce6c2fd87e167204de7c77c146faa989a777cfa1fac9ffb45f249de5774ede6befdb8f6c18caee44f8421a438425a339c4011ba6bfc8c69db7692386d9e252f3d727ad21cbc963d3516821c8d4ef25840d99bf67fe686d2438f565df09210ba3fecc1e089ad0f0190015e22e5c1a2f8a6028f7905e154315cd543c9451d1d8220b0c09b00f9e6656bd2ddf5114025ef1236f7088e8b844652f0bd2cf52ea57fd7aa338a7ecd98778c34931f46bd29925c3e24ba4393410c4c4c21c095288fe2d33d78e602f66f363861e43c677d4e9709b47da50849014eb987f69b75ea5b58cc56e6e144e4a12722206f38a126237a9a1372027be6674c0f785e20c4ea01bc6571e43a9d609e56f070d2bb080a629af766ee35c607e3ff1a11ac86fc8a9fcfc0d798f2a1c976bcdd2156f1bbf0a7af7ed3a89cf45c1330cc7eafd715545c3ba344c2c92114ac5471ddf5c38991fb617a659314385fabe13d7f96f477d7f602bf6f704fb65599c8eab4296d240e7450288c0f1519b5cfc771fb06f30ed5e1671c722209ec1262c0d22e3522818154cdb8799dfc1b7c070dcc188cb3db881bfbfd4309d5655a363433e1c7b5d184c510ab0a71ef404e67890c142679726c89ebdd092b47e013b5d21793a58873c6c169a4191e3d90012ef7cc1a443d3f310a330a4a6031b03d5b266064d097aef4b5e7356db65d9e3935b7745d510c3737f8ad08f80b679be0e832887dbbef75d46c04f066e4b57759ee5c299e360c9984df04c6b92e7407e9fd2a43d06a90d5150cd60ad1435374d65383da5c3ba2b4ee36b9fe5d9ebcbce2dd2a48068318b8bdd6dee4f3550a5e2da78a7b8dbe4a4b2ea72259903593413756052fbb33cda1bf941b2a9f9a6fa7a73ece577c7e844f59b0758159a7d4e29981828b9bf87d0a0acfbd7e6ce56b69e29fc670b4d55c2e64930d8158f7fb1598cc1d6972ee5a90b67c8a93aa762674ce3e08ad053fcb08c273baa3dac8cc7344bd85052284cc9ea4657dd9f41299b060cc6625595b08ccf14d954994c52c59301513a9d11ca45f00cd10e5b2a1d37c232464d658a987c7250ada6f8a651b64075f0f5911a1c3830bb8a190eb6423a8bf850c77212a78511a537c442126a389e671e703c631584ada1949f57597ab0d286e4c0941664c5518c4d6efa49a994cc248a5270af4bb2b76111ad8ad9b0ab6160e82687b430ad38398b0dfab7bfd411db290a4c67846e697d9357fd8c1c10db7027527e29ff0fb12c7e0053ee0cd07d1b98cd924318d92f27803abe0941cbfb0694480c402962d4414d8334690019a0e6c6c9a15a246fd77eef2a5a595396829e54b590c7180f20c06fbd8868cb8be8b8d385430e43beb8b25ac3e267e4c13faa7346070c907c60f4579582fc39fe046508b7eb4b56c8edc326f1c85c0cacce9bda121fdd0e7de85bbf1e5548aa2a7917a5459b805cd548f463963962238ac681c1f84c691012330186d8852628179a32a916a34c5d1f68523c63cb06eee8ef122ca38565f3094216c62c39ed631406e91200630032db2ea963ab9b6ddb5833e245baf0b1e7fdd75284190a6ffbf3f84b3f49c3977fbb862255ddba4d1d4483627d6d9ecef9f95fdf6e6a06047270746e8aba89580f3d2fcbdf9d63f8f17a0f337b8dd3f9fe3dbba47003fc8cc632bb30c9451dfdfd31e2228398b6490df5708802e6083dec9af1f1533cb347dbc08368c2cbb93d45b6c2b1988d75a166202141eeae748375fda8d571469aa9bcefef8f1073d267a31101b2775e43b111eede979ee909851dd2e792b0cebd084ce40165ebe5bb64155b2c343c6f0ab15f61b879337a3abb786dfbd616d720b0df70280e2170c456b57265c7b85fa7783dc7a63cc72f3f06307ad3de55007fa1155914079a016980aa41318e70621b47fb3aeef35999d405c81b47a6c295e3e81bc0e9caa8fc6f3dd2197c36b1e879c4c3ec7213dedbc250e3f556122f74b3db89d79b8be98673d6582ddf3405750704ecd44a2de0a314f7c85b61fe1195f8441b6f39b7f7f358b3173c87600ccf6f6059ec7771a59a42bdd298761fb7b2cd42c99eb072194dde57e7b0cc3cdccbbe69818cad00042a0b6469c5f4b05e646fccbcd90767b0d1592a35abb61fd8bc578c6217b25a161ca42b37ed04240f2219882962ee6499ab5b7dcb8936768dcfac29ee0a84308960c3a14fd9dad49e3192a03d10b6496f97be283e8336b7554ff572773b984abfed05ad4014814f8621b0c5c439ccbe119d4d8147550e963914cc97f9c3cff5cdf76f7341fe5b67bf0104b7932638f4f3edb7c8050b1cca46af571362f42328616d1b542ef7bd8d8684b8b12446a18ffa405952969953b6cb45f574ab5deb9949fc5ea0cb2ca41c4a254d6967db533f9bfe55fd45cd9a12106688b6ec4c281c534e85cb2058b77a331a72c95d95b766e10b6a560b7582ddf6a6e5d3590dcc4856e5f9b9bf69cc4c32811e640209c2fc04d9a6b3ed970f5e5654448427d9e6280c2bb7af5de3ec49b713a3c4afdca67177865e2d27e1f056506b20c1284d731f369a2defdb6e798400f4b7d5753f8e3340e1f22e8bb06cc5ba9c43f97d9fdec33995a8c0f68a61f6ead5c2ee0f5fe9aee6160c392d95f68ed1a440733c36fe4cd854b5a60f7c0ac31442bb544cc3c14bbefbcb76c79394f8f3529fb999f2ded00873b105fadf004e990b0ccaf69b706ab16cb1b799470ec43e052765a80f566474cf49c1cab6148be6c10244b755f156afdd0d6f9e66c9d950e1fbdff8cdf0bb3e16e803460c972ee30997a604ae2b134fe0cddce3afc8b2ee759f4ae6ab30e84f453fd518774ce11bfeac71d27675ef51246e7f46d85bb64b8a60377fe1a3f67f141fa9952fd4372c73b71d5b93990664f852998403bae13bc89334751c5c0607e45eb5cf82e84add5d8c8813a189ff8140570593593948fe2815f06ec3acb6de3d140d6cc45afc7b4b4e5c1c8e2703416c83bbfcb3ea2a88881db64db0beef0afc19ffea8337ef3ad7b9dd55d5900f1bb44159f99eacc0472d549071a11304011b97fe83f3d36be3aaf5f6c03cd926cdb24e100ee6510be2fe2d3f4175cd5ac2d04d3c2eff2852447e20fd19d45e4a62488508a505aa3eae1142f7f103fd1df94e94bc5b59feab16fab72b2504223fe3ff176a67e04728b4303ed2095da38310373e63a52253c893d086d2d22c738a49b97dfbe8225771e59cadb0b08282aa6d2ca9fd882a0a2ab4f49e918c11acd29ed63b6931f7a82beae01e27019c6d5caa5097edbccacb28bb1b536216a6262660985ae89d5e40a40978fd1fd83aad8c1666fd330c8c867e7348d439d96af8cab2e1086bfbf0782d4b5d7205df14eab171e1e4ebb9770927adcf013087c278d86a44a9b1334766f21052c258e24f953f80410a1b8e385d2d01ccef3b132338ad15c73092805babc2f792e5acf95fa0d2864ef84671374553cdef9b32b6675c23e780595b8518403064b0485d4cf57fc43ec6e798496ea9c43149abc5ca39a8c61ec0595cfb7aed8f87f1fad1bac5ff82294c929f4fb65607fe35d7ee6a919eb463dd311d723c26e0682bb3455ea624b517d25a49c6727b5380f33fabfb68c95ada58d4807e70a14d67447cfb9ad36a843a2ce02ccb68b1b974a6754080c82bd9ceff75e174b9df5497dbd4aac3dda08e3c1a298eae6ac4930f8df6a5a7fdd99164cb3df0ee7522f9763b939a621de92d61fd1d61a00f9c1d53cd4defeaa17b4e8a7ccf206771e08a462775128ba22c4edcde2a46025f696101405c091e1ffcb98f23cd07bbb1f42a9cae9b1f043c8ca702ce2cda9558e374707789d4c3f097d4128975a6b162258023e8273b51656f02d352293bb67fab5f941b181a78a201fab2f314a900a73c50ed82f12dc91087ed08240cae47d67ca9b3277965e047255594a3769771b2fef4b75063c9f5edf933235577cc367aeba9db5204893a4736b2d3cb1977f75c2dec190da57fe5f67353bdb8177fa23b2dcc5f97cede5bf35a1525624cd25696672034727aeb6005048530e23bfa06e8d33e608d8d890717e625db053148319b58415fb8de692edfdf1ac372f73e272e4222d38f4b8292445d62dc6cfb406673e1239cc019ec7e27458ed8a0337b23249bfa6d19cd3a17305ce39df5cf38e2710712c8f82bb9d89bf8088452e2176a13d427b9787a72b3785ed25bfad25f4712e3bba0637f0eb9f3867eed41cf036424bbe3381aae4735e4f93cb2a743de9469b7fcd04e818f7d061283c1ba6b378b275d431ffd235d68d6a1ea274d91995511e8ca32344ab35cfd8ec1e7749f7db9e9874a26f5d798f85397edd4699622d108a9cf495bd39401710abc57e92e59f20f5a3d0d9ae842f3a511ba40d75d9442a0c616b7ed0cf16885f2f6f47fbaf549248342c6733e66f9d1bae9378438716282cea8d43068304ca138c422d8178fbfd5a57d2a307596c95312ad858e2371379f284f4eafd5e114acba57cd8f1d3ced3c292412bb4956bb48e2c08d583ba30f156db3f2c6f6d5f28815e55f7cf0f7dc5cabe8e5e3c5eda672de1db49ce40508801391d6def3dbc9b697d3701fdf525afcd824fa46f37dc3700c39f10f53c43b75c2630a10dd9ab679536622c96f54b02df3e2117ee7bbbdb2afa41d48164f7f4fdf614160e06d500e98d5ccc1214e49d544a2e5883f4d7653a2e298efac3d7830e7edde90853c439cd2cb004a581d5277f3412dc5d08756c6cc99df4acb99d9b2472cba53e9509430fb50f923b16e1a47fcc2111fbcb08c6e916eac542aed7a12417936d10cc23afb8acb8d28d60894d2fdda55b3f6573ef1c72765b64fd4c989b6da36ee6c207cabd40de35695a0873d61c43827959dff70f3d960b743781734b6385702cc57bb094da8c0c6d775dece57fa79282e1d5eeb624bab342cb04b98e7d275d23d83c45460bacef6bc9256081efe0adc47018cdc55412c98b887fe9087f568159814d49ee8b8c24ce473b018cda06735200a6c0c6d321abc92a2693a5feacf447497c213a851ef1779ff786f669d72d03b1abb7293e11db279e68c9f02d8de450dc608a11d9bc2d61edf0c189749c71340a86c5a22e99a1ffe034341dc5ad4cf92f5f0dfc604fd74f13a7f2cb9484625e4cac4d039038130c9eef772a90ceb0f14b6b7eecc5393b36b03a2c29e3d46f10b3c8d09db01e094a445ac7b17ee4ededbdf2d7b40c52b6c58f5be8b3215cb5cf6b5fc75ffbab79a3f56b3c5b7d2c355ec2b1b006a7cb8a7e10bc47f782fc4e8e3ca4a16aa42afa26b052a56dcc2e070e3e066c14593a5541dc22e8cc0854d68eb3b0b668ee144c5b7eacc8317b6cc81a95080532ed175732b9c2c70af9063bc8e84468c0d2bde0f47bec34399cd83e0126101d47339af8c4c027ba9f879148aa7e20383be5c624806cf0a9a1469bf2ad5b841303239c893f1ac1c359f5e03e965fb3fd74c01f9e776d8cd0fb50a44db2ad655cee71059d01915d1ec384677821630c51d18d4df4e17059698ad1e0cd00a37f670710d1155782f35be77bb72e11b369a98420bdc796bd3182aeb4a1f48ccfa5f66425191f240840fafb01f2970147cf37142546d86010524db8a0feff439e0b5e1405dfd8bd75ddaccf6752d74ecc9fab10ef440e651aa2cb6c26f89b940e987319e990984b1128244d9e33d971fd64c3da8cc5a9ac558de93305faa7190f6013e07c3343bd0c721852618b15ca61ac38e18dea88a2e36f9ed4601e45632dbb2adeccbf758e89cc9098ae8bf233926267f1db3372c79c733964088bf1cfce23061a788120189529af1df0a75739dd25a864f1278bfce119a56016f931fcaf033557b4be1402d8f4c12db9236adc8285f61b2a86ec9fbcad2dcfe558fe034f623de93265b38c7fe7548e6591655f65eb276e296f01ae5225d5b357bb1e6024d62e3c58b279ee8cc40468e4309c834274dcd95f12ef3633febf3feada1394c49fad81ec139496da6f98020c240a42806278c9cb3fe64890b17302e1f792203c1cdcbab13d406ac8929274b71906d2dceff978ad6a3e9fefe5063f768c72da3b22ffd02160dec3dc814a2c272456f4f4f301c9c5a28c518ec2f655f7217373a32378f6abe2564744263d91ffafba5b29c8f58c777ea77b489af48123b6cf85d681fd301b2edaed8941b872d21c1fbe3a24e75e5a9ca30bd9c978d8d8161010d05e1c40003c5035be5aa7d9958b0db47ee8ae48c8b68301ba7a03ff2b2c726b0979ae8b8e3319e237d100369659d19655927b1d929b83f5035bc28122c7c6bc9951d868b8c0949d54f1a27c90e865f071a3d8d6ca5184c15db941796f520446da6bbdb0067863a1384b3a6206d056e48fba5721009062e54aa0301c23a917863de8737a9f2535663a53e5c245569fc59faaea54950533761e59d7263e8533f8c2e7f9ae536086e2304b9d3ce4afcb22a609d630c09379df09c07eb1d0b14f6fe0316fa17cd066e0df5fb85c9e5f33fe125e2758c76d12a482cf28c0401f26cc03260e48d2110318e7a34dcb0c103a383e0dd5b0ded8eee6c5f9c305c96a062df46eda34eb5ca805558e20a850111c9243f20ea4e5df459d8a88d16ea0dcb147c772cd90cdd7acc9e5aa38ca3940bb8e2e5eb755cf4a8793f45d3fb7cea05e9aeae67eccec545a054122e0e49ed17497edce59f2f376cd8903254c862092ac64bf4035ae5d7f96bca164ba930509a6c46be93843f9b1903fbb9251d237e054126dbcb5af58c998c4706cae66fc9a221a5364e460833c8fdf34e5fe777779fc3d3ccb6f67a49da88fdcad0b4069b1922957c2530ae475b63ec0c6a459e224a13561436515818d0d042cd5aedbe89fb2d9689dc5af644937a15e007fbf57abc38b8243334ff210fb6f1bc0d0c80ecf8e786f997afb76079c4526980f0972f97673a59e6728a7227ad6cd0e3fceb92883f9772a8bcc0c66d932dd16016e8906f9c358ef906c8041bb939f872d26a7b5e3059987bcd2d9332d763bf619b0ae2525887f82ddc8dd4d2635a20aec7555fb51e072ab304bd0833a13381d7cee824aa4746a20df980ceeebdb7c8dfd34d70c91b6e74b2dc58bfebf81d061b4f1fabe6b94720974414d9324c64ca16d351ee034786364e60d0a5c8bdf720d18200207ead1b20e040ee406c34997f3a82c650da47a290609d84aba6e1a384ed871f14025d964d39388cc143e79a9f488bc573f992e913e958b125234349ef3a90eccbbc102182653e1dd5b5b47576fc7c8e8863f4e67ba941166c9fbba32c19ab86afadeb6008e57edb725244fa62543f9a51f33da2f3171967f54715cd215e3a5808b2ab87918f6a538b41e96636f562850b3d8b8307a4182a15548b27bffbdb7445ecaabe354f80df0ea79a8896c5f7d3cad37f1ab9129b4ff6a471c98b2f6bb6478951661811c3f6f0192f52fd21dd49cf91a09399cba2854240076b6b1aeaea79693eb32a1685fc701e33cae0b473fe04a770e863ed68ba78519e16200bab77d6eed1631bacf4c63acc9da7932e200ed032850a560633120d05d08e46a938188f584ba1db96fa1b9795e36a76b4318d52d9692f8c9bff01c778a44b3d60e60389d6e925c22c722889b9dbfb3dfa7ad7b22300f95bed2763e4a197499485ac89afe57fe11e57302fa53f54b3ddde88efe9be832b7e93d2aee3e81cfebf4ea158215e74d0648234977e4757454b3045f25125e81993120e9ae056c6104b6dd5809b99efefcd8770bf5262a4e55901ea3fe2717901ae4cb007eeb09e041177edd192adadf55433dc9b9828bb4709fc39d271f7b2eb0ee41fa265a293449ffdc6c828900a61891e1128af70cc2d7b0463f41196a60977ed89fde161df8418368e8767c650d3773b4ffc77b7bfd64bacd413f5746a1a88dcb83537fda8a90495b2a563fbbb1ffc0c587a0072aff2db6134d6696d98f2b06c236af9dc117ee7d5092883f47f0a04b2292039d7e784bc77d32f801b4c03ac5007fbe3989c519853cf0630ec8235dc60f548eddc67d096b80c75fb32660b23ef1c20a3854db8f22786ec42e8273fddcd46566a2d7157cf32546023c49d80a3bf2d11e3e87ace2ea433c8844f5842739e1afcb6900a613488e9f730e3283e95c4eb679de8c79c2a3caaad3226ad63650ff7e0cf2822755e32216b6ba2d90657e30a3b8c471e5a7e85ab4609647cf15385600727f095adbe58072e4c161bc10e0e709290a63c36cd55b7210f10862c817723cc5dedb2358547acfafb936a6cf6bae7cd58cbbf42f98d6961779b8caf9defc9d276c3501b9b8d0d93fb376c7fca81fa48c97c87f77b637dc19d0ec0284babffe696fcfb439999e054d38ee0ee79084d05857650cf1d3a9aedba44398ea685e9ffb0f5c599a865500a6fa8116c1d0e4f00f347f980a129b6ff63ae40c8532d761cff669230e11f42d89a4c791e966a466c30c0befbf9cafc65aee767365b7758ee77e3d51bd07714dc9f91f176df4e3f210b2252bcc0bd173f152a75d8fcf1e0eee5e432a938b629bfa078cdaa98e73f721963b7b4a96c2f58c5bf760c456e2405c6b482358b34851c95edb977b145d063bfe7c12ca9d5bffd8aa119f2e94133e145d82ae17b2a3acd3085f78353d5c6b1435c6672129660765ff5ea8748c7b869749425e5b4f16a2c760252a8f9801f4f8f43c259ef80c9a52c672426cf0ac3f2f3374f51ec6c2cce701a0de46e9d07e4ea5092d057a36b53821ba9456bfc244460720f65231a88e5da5c3510a4d76d534b0876b5402</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-xray\">\n      <input class=\"hbe hbe-input-field hbe-input-field-xray\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-xray\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-xray\">您好, 这里需要输入密码。</span>\n      </label>\n      <svg class=\"hbe hbe-graphic hbe-graphic-xray\" width=\"300%\" height=\"100%\" viewBox=\"0 0 1200 60\" preserveAspectRatio=\"none\">\n        <path d=\"M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0\"></path>\n        <path d=\"M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0\"></path>\n      </svg>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/1414180692.html",
            "url": "http://ixuyong.cn/posts/1414180692.html",
            "title": "Redis集群（主从+哨兵）模式",
            "date_published": "2025-04-09T11:50:06.000Z",
            "content_html": "<h3 id=\"redis集群主从哨兵模式\"><a class=\"anchor\" href=\"#redis集群主从哨兵模式\">#</a> Redis 集群（主从 + 哨兵）模式</h3>\n<h3 id=\"一-什么是redis主从复制\"><a class=\"anchor\" href=\"#一-什么是redis主从复制\">#</a> 一、什么是 redis 主从复制？</h3>\n<p>主从复制，是指将一台 Redis 服务器的数据，复制到其他的 Redis 服务器。前者称为主节点 (master)，后者称为从节点 (slave), 数据的复制是单向的，只能由主节点到从节点。master 以写为主，slave 以读为主。</p>\n<p><a href=\"https://imgse.com/i/pEgTlKx\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgTlKx.png\" alt=\"pEgTlKx.png\" /></a></p>\n<h3 id=\"二-主从复制的作用\"><a class=\"anchor\" href=\"#二-主从复制的作用\">#</a> 二、主从复制的作用</h3>\n<p>数据冗余：主从复制实现了数据的热备份，是持久化之外的一种数据冗余方式。<br />\n故障恢复：当主节点出现问题时，可以由从节点提供服务，实现快速的故障恢复；实际上是一种服务的冗余。<br />\n负载均衡：在主从复制的基础上，配合读写分离，可以由主节点提供写服务，由从节点提供读服务（即写 Redis 数据时应用连接主节点，读 Redis 数据时应用连接从节点），分担服务器负载；尤其是在写少读多的场景下，通过多个从节点分担读负载，可以大大提高 Redis 服务器的并发量。<br />\n读写分离：用于实现读写分离，主库写、从库读，读写分离不仅可以提高服务器的负载能力，同时可根据需求的变化，改变从库的数量；<br />\n高可用基石：除了上述作用以外，主从复制还是哨兵和集群能够实施的基础，因此说主从复制是 Redis 高可用的基础。</p>\n<h3 id=\"三-实现主从复制\"><a class=\"anchor\" href=\"#三-实现主从复制\">#</a> 三、实现主从复制</h3>\n<table>\n<thead>\n<tr>\n<th>主机名</th>\n<th>IP</th>\n<th>角色</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>redis01</td>\n<td>192.168.40.101</td>\n<td>master</td>\n</tr>\n<tr>\n<td>redis02</td>\n<td>192.168.40.102</td>\n<td>slave</td>\n</tr>\n<tr>\n<td>redis03</td>\n<td>192.168.40.103</td>\n<td>slave</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"31-关闭防火墙-selinux\"><a class=\"anchor\" href=\"#31-关闭防火墙-selinux\">#</a> 3.1 关闭防火墙、selinux</h4>\n<pre><code>[root@master01 ~]# hostnamectl set-hostname redis01\n[root@redis01 ~]# systemctl stop firewalld\n[root@redis01 ~]# systemctl disable firewalld\n[root@redis01 ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux\n[root@redis01 ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config\n[root@redis01 ~]# yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y\n[root@redis01 ~]# yum update -y --exclude=kernel* &amp;&amp; reboot\n[root@redis01 ~]# echo 'Asia/Shanghai' &gt;/etc/timezone\n[root@redis01 ~]# ntpdate time2.aliyun.com\n[root@redis01 ~]# crontab -e\n*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com &amp;&gt; /dev/null\n[root@redis01 ~]# mkdir /soft /data /scripts /backup\n</code></pre>\n<h4 id=\"32-安装redis\"><a class=\"anchor\" href=\"#32-安装redis\">#</a> 3.2 安装 redis</h4>\n<pre><code>[root@redis01 ~]# yum install gcc-c++ -y\n[root@redis01 soft]# wget https://download.redis.io/releases/redis-6.2.11.tar.gz\n[root@redis01 soft]# tar xf redis-6.2.11.tar.gz \n[root@redis01 soft]# ln -s /soft/redis-6.2.11 /soft/redis\n[root@redis01 soft]# cd /soft/redis\n[root@redis01 redis]# make            #执行make编译\n[root@redis01 redis]# make install    #将 src下的许多可执行文件复制到/usr/local/bin 目录下\n[root@redis01 redis]# redis-server /soft/redis/redis.conf &amp;\n[root@redis01 redis]# netstat -lntp|grep redis\ntcp        0      0 127.0.0.1:6379          0.0.0.0:*               LISTEN      69686/redis-server  \ntcp6       0      0 ::1:6379                :::*                    LISTEN      69686/redis-server     \n[root@redis01 redis]# redis-cli shutdown      #关闭Redis服务\n</code></pre>\n<h4 id=\"33-redis配置文件说明\"><a class=\"anchor\" href=\"#33-redis配置文件说明\">#</a> 3.3 redis 配置文件说明</h4>\n<pre><code>[root@db01 redis]# vim redis.conf \nbind 127.0.0.1      \t\t# 绑定的ip\nprotected-mode yes  \t\t# 保护模式\nport 6379           \t\t# 端口设置\ndaemonize yes               # 后台启动\nbind 127.0.0.1      \t\t# 绑定的ip\nprotected-mode yes  \t\t# 保护模式\nport 6379           \t\t# 端口设置\nloglevel notice     \t\t# 记录日志级别\nlogfile &quot;redis.log&quot;         # 日志的文件位置名\ndir ./               \t\t# 日志存储目录\ndatabases 16        \t\t# 数据库的数量，默认是 16 个数据库\nalways-show-logo yes \t\t# 是否总是显示LOGO\n\n# 如果900s内，如果至少有一个1 key进行了修改，我们及进行持久化操作\nsave 900 1\n# 如果300s内，如果至少10 key进行了修改，我们及进行持久化操作\nsave 300 10\n# 如果60s内，如果至少10000 key进行了修改，我们及进行持久化操作\nsave 60 10000\n# 我们之后学习持久化，会自己定义这个测试！\nstop-writes-on-bgsave-error yes   # 持久化如果出错，是否还需要继续工作！\nrdbcompression yes                # 是否压缩 rdb 文件，需要消耗一些cpu资源！\nrdbchecksum yes                   # 保存rdb文件的时候，进行错误的检查校验！\ndbfilename dump.rdb               # rdb 文件保存的名称！\ndir ./                            # rdb 文件保存的目录！\n\nslaveof 192.168.1.154 6379        # 配置主从复制\nrequirepass foobared              # 配置redis登录密码\n\nappendonly no    # 默认是不开启aof模式的，默认是使用rdb方式持久化的，在大部分所有的情况下，rdb完全够用！\nappendfilename &quot;appendonly.aof&quot;   # 持久化的文件的名字\n# appendfsync always        # 每次修改都会 sync。消耗性能\nappendfsync everysec        # 每秒执行一次 sync，可能会丢失这1s的数据！\n# appendfsync no            # 不执行 sync，这个时候操作系统自己同步数据，速度最快！\nno-appendfsync-on-rewrite   #重写时是否可以运用appendsync，默认no，可以保证数据的安全性\n</code></pre>\n<h4 id=\"34-redis环境配置\"><a class=\"anchor\" href=\"#34-redis环境配置\">#</a> 3.4 redis 环境配置</h4>\n<p>#修改 maser 配置文件</p>\n<pre><code>vim redis.conf\nbind 192.168.40.101 #绑定本机ip地址\nport 6739          #绑定端口号\ndaemonize yes      #用来指定redis是否要用守护进程的方式启动，默认为no\npidfile /var/run/redis_6379.pid\nlogfile &quot;redis.log&quot;   #redis日志文件\nrequirepass Superman*2023  #本地redis密码\nmasterauth Superman*2023   #主节点redis密码 注意:从节点也要配置，后边哨兵容灾切换用到\nprotected-mode yes    #保护模式\n</code></pre>\n<p>#修改 slave01 配置文件</p>\n<pre><code>vim redis.conf\nbind 192.168.40.102 #绑定本机ip地址\nport 6739          #绑定端口号\ndaemonize yes      #用来指定redis是否要用守护进程的方式启动，默认为no\npidfile /var/run/redis_6379.pid\nlogfile &quot;redis.log&quot;   #redis日志文件\nreplicaof  192.168.40.101 6379 #配置文件中设置主节点，redis主从复制这个地方只配置从库，注意:主库不需要这个配置\nrequirepass Superman*2023  #本地redis密码\nmasterauth Superman*2023   #主节点redis密码 注意:从节点也要配置，后边哨兵容灾切换用到\nprotected-mode yes    #保护模式\n</code></pre>\n<p>#修改 slave02 配置文件</p>\n<pre><code>vim redis.conf\nbind 192.168.40.103 #绑定本机ip地址\nport 6739          #绑定端口号\ndaemonize yes      #用来指定redis是否要用守护进程的方式启动，默认为no\npidfile /var/run/redis_6379.pid\nlogfile &quot;redis.log&quot;   #redis日志文件\nreplicaof  192.168.40.101 6379 #配置文件中设置主节点，redis主从复制这个地方只配置从库，注意:主库不需要这个配置\nrequirepass Superman*2023  #本地redis密码\nmasterauth Superman*2023   #主节点redis密码 注意:从节点也要配置，后边哨兵容灾切换用到\nprotected-mode yes    #保护模式\n</code></pre>\n<h4 id=\"35-启动3台redis服务\"><a class=\"anchor\" href=\"#35-启动3台redis服务\">#</a> 3.5 启动 3 台 redis 服务</h4>\n<pre><code>#启动redis01\n[root@redis01 redis]# redis-server /soft/redis/redis.conf\n[root@redis0[root@redis01 redis]# redis-server /soft/redis/redis.conf redis]# netstat -lntp|grep redis\ntcp        0      0 192.168.40.101:6379     0.0.0.0:*               LISTEN      117358/redis-server \n\n#启动redis02\n[root@redis02 redis]# redis-server /soft/redis/redis.conf\n[root@redis02 redis]# netstat -lntp|grep redis\ntcp        0      0 192.168.40.102:6379     0.0.0.0:*               LISTEN      18210/redis-server\n\n启动redis03\n[root@redis03 redis]# redis-server /soft/redis/redis.conf\n[root@redis03 redis]# netstat -lntp|grep redis\ntcp        0      0 192.168.40.103:6379     0.0.0.0:*               LISTEN      19186/redis-server \n</code></pre>\n<h4 id=\"36-查看主从状态\"><a class=\"anchor\" href=\"#36-查看主从状态\">#</a> 3.6 查看主从状态</h4>\n<pre><code>#主节点\n[root@redis01 redis]# redis-cli -p 6379 -h 192.168.40.101 -a Superman*2023\n192.168.40.101:6379&gt; info replication\n# Replication\nrole:master\nconnected_slaves:2\nslave0:ip=192.168.40.102,port=6379,state=online,offset=616,lag=0\nslave1:ip=192.168.40.103,port=6379,state=online,offset=616,lag=0\nmaster_failover_state:no-failover\nmaster_replid:93df7cd5095dcccdbf8266787031b17cf638a2ad\nmaster_replid2:0000000000000000000000000000000000000000\nmaster_repl_offset:616\nsecond_repl_offset:-1\nrepl_backlog_active:1\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:1\nrepl_backlog_histlen:616\n\n#从节点\n[root@redis01 redis]# redis-cli -p 6379 -h 192.168.40.103 -a Superman*2023\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\n192.168.40.103:6379&gt; info replication\n# Replication\nrole:slave\nmaster_host:192.168.40.101\nmaster_port:6379\nmaster_link_status:up\nmaster_last_io_seconds_ago:1\nmaster_sync_in_progress:0\nslave_read_repl_offset:812\nslave_repl_offset:812\nslave_priority:100\nslave_read_only:1\nreplica_announced:1\nconnected_slaves:0\nmaster_failover_state:no-failover\nmaster_replid:93df7cd5095dcccdbf8266787031b17cf638a2ad\nmaster_replid2:0000000000000000000000000000000000000000\nmaster_repl_offset:812\nsecond_repl_offset:-1\nrepl_backlog_active:1\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:295\nrepl_backlog_histlen:518\n</code></pre>\n<h4 id=\"37-测试主从\"><a class=\"anchor\" href=\"#37-测试主从\">#</a> 3.7 测试主从</h4>\n<pre><code>[root@redis01 redis]# redis-cli -p 6379 -h 192.168.40.101 -a Superman*2023\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\n192.168.40.101:6379&gt; set k1 v1\nOK\n192.168.40.101:6379&gt; set k2 v2\nOK\n\n[root@redis03 redis]# redis-cli -p 6379 -h 192.168.40.103 -a Superman*2023\nWarning: Using a password with '-a' or '-u' option on the command line interface may not be safe.\n192.168.40.103:6379&gt; get k1\n&quot;v1&quot;\n192.168.40.103:6379&gt; get k2\n&quot;v2&quot;\n</code></pre>\n<p><strong>注意:</strong><br />\n1、主机可以写，从机不能写，只能读。主机中的所有数据都会保存到从机中去。<br />\n2、主机断开连接，从机依旧连接到主机的，但是没有写操作，这个时候，主机如果回来了，从机依旧可以直接获取到主机写的信息！<br />\n3、如果是使用命令行，来配置的主从，这个时候如果重启了，就会变回主机！只要变为从机，立马就会从主机中获取值！<br />\n4、主从复制原理<br />\n Slave 启动成功连接到 master 后会发送一个 sync 同步命令<br />\n Master 接到命令，启动后台的存盘进程，同时收集所有接收到的用于修改数据集命令，在后台进程执行完毕之后，master 将传送整个数据文件到 slave，并完成一次完全同步。<br />\n全量复制：slave 服务在接收到数据库文件数据后，将其存盘并加载到内存中。<br />\n增量复制：Master 继续将新的所有收集到的修改命令依次传给 slave，完成同步，但是只要是重新连接 master，一次完全同步（全量复制）将被自动执行！ 主机的数据一定可以在从机中看到。</p>\n<h3 id=\"四-哨兵模式搭建\"><a class=\"anchor\" href=\"#四-哨兵模式搭建\">#</a> 四、哨兵模式搭建</h3>\n<p>1、什么是 redis 哨兵？<br />\nRedisSentinel 是 Redis 的高可用性解决方案，由一个或多个 Sentinel（哨兵）实例组成。它可以监视任意多个主服务器，以及这些主服务器属下的所有从服务器，并在被监视的主服务器进入下线状态时，自动将下线主服务器属下的某个从服务器升级为新的主服务器，它的主要功能如下：<br />\n监控 (Monitoring)：Sentinel 会不断地检查你的主服务器和从服务器是否运作正常。<br />\n通知 (Notification)：当被监控的某个 Redis 服务器出现问题时，Sentinel 可以通过 API 向管理员或者其他应用程序发送通知。<br />\n故障迁移：当主服务器不能正常工作时，Sentinel 会自动进行故障迁移，也就是主从切换。<br />\n统一的配置：管理连接者询问 sentinel 取得主从的地址。</p>\n<p>2、哨兵原理是什么？<br />\nSentinel 使用的算法核心是 Raft 算法，主要用途就是用于分布式系统，系统容错，以及 Leader 选举，每个 Sentinel 都需要定期的执行以下任务：<br />\n每个 Sentinel 会自动发现其他 Sentinel 和从服务器，它以每秒钟一次的频率向它所知的主服务器、从服务器以及其他 Sentinel 实例发送一个 PING 命令。<br />\n如果一个实例（instance）距离最后一次有效回复 PING 命令的时间超过 down-after-milliseconds 选项所指定的值， 那么这个实例会被 Sentinel 标记为主观下线。 有效回复可以是： +PONG 、 -LOADING 或者 -MASTERDOWN 。<br />\n如果一个主服务器被标记为主观下线， 那么正在监视这个主服务器的所有 Sentinel 要以每秒一次的频率确认主服务器的确进入了主观下线状态。<br />\n如果一个主服务器被标记为主观下线， 并且有足够数量的 Sentinel（至少要达到配置文件指定的数量）在指定的时间范围内同意这一判断，那么这个主服务器被标记为客观下线。<br />\n在一般情况下， 每个 Sentinel 会以每 10 秒一次的频率向它已知的所有主服务器和从服务器发送 INFO 命令。当一个主服务器 Sentinel 标记为客观下线时，Sentinel 向下线主服务器的所有从服务器发送 INFO 命令的频率会从 10 秒一次改为每秒一次。<br />\n当没有足够数量的 Sentinel 同意主服务器已经下线， 主服务器的客观下线状态就会被移除。 当主服务器重新向 Sentinel 的 PING 命令返回有效回复时， 主服务器的主管下线状态就会被移除。</p>\n<p><a href=\"https://imgse.com/i/pEgT1r6\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgT1r6.png\" alt=\"pEgT1r6.png\" /></a></p>\n<h4 id=\"41-搭建哨兵\"><a class=\"anchor\" href=\"#41-搭建哨兵\">#</a> 4.1 搭建哨兵</h4>\n<p><em>在每台服务器上部署一个哨兵，配置方式如下:</em></p>\n<pre><code>[root@redis01 redis]# vim sentinel.conf\n#端口默认为26379。\nport 26379\n#关闭保护模式，可以外部访问。\nprotected-mode no\n#设置为后台启动。\ndaemonize yes\n#日志文件。\nlogfile &quot;/soft/redis/sentinel.log&quot;\n#指定服务器IP地址和端口，并且指定当有2台哨兵认为主机挂了，则对主机进行容灾切换。注意:三台哨兵这里的ip配置均为主节点ip 和端口\nsentinel monitor mymaster 192.168.40.101 6379 2\n#当在Redis实例中开启了requirepass，这里就需要提供密码。\nsentinel auth-pass mymaster psw66\n#这里设置了主机多少秒无响应，则认为挂了。\nsentinel down-after-milliseconds mymaster 3000\n#主备切换时，最多有多少个slave同时对新的master进行同步，这里设置为默认的\nsnetinel parallel-syncs mymaster 1\n#故障转移的超时时间，这里设置为三分钟。\nsentinel failover-timeout mymaster 180000\n</code></pre>\n<h4 id=\"42-启动三台服务器上的哨兵\"><a class=\"anchor\" href=\"#42-启动三台服务器上的哨兵\">#</a> 4.2 启动三台服务器上的哨兵</h4>\n<pre><code>#启动redis01的sentine\n[root@redis01 redis]# redis-sentinel /soft/redis/sentinel.conf\n[root@redis01 redis]#  netstat -lntp|grep redis\ntcp        0      0 0.0.0.0:26379           0.0.0.0:*               LISTEN      33536/redis-sentine \ntcp        0      0 192.168.40.101:6379     0.0.0.0:*               LISTEN      117358/redis-server \ntcp6       0      0 :::26379                :::*                    LISTEN      33536/redis-sentine\n\n#启动redis02的sentine\n[root@redis02 redis]# redis-sentinel /soft/redis/sentinel.conf\n[root@redis02 redis]#  netstat -lntp|grep redis\ntcp        0      0 0.0.0.0:26379           0.0.0.0:*               LISTEN      18757/redis-sentine \ntcp        0      0 192.168.40.102:6379     0.0.0.0:*               LISTEN      18210/redis-server  \ntcp6       0      0 :::26379                :::*                    LISTEN      18757/redis-sentine\n\n#启动redis03的sentine\n[root@redis03 redis]# redis-sentinel /soft/redis/sentinel.conf                     \n[root@redis03 redis]# netstat -lntp|grep redis\ntcp        0      0 0.0.0.0:26379           0.0.0.0:*               LISTEN      19745/redis-sentine \ntcp        0      0 192.168.40.103:6379     0.0.0.0:*               LISTEN      19186/redis-server  \ntcp6       0      0 :::26379                :::*                    LISTEN      19745/redis-sentine\n</code></pre>\n<h4 id=\"43-连接客户端\"><a class=\"anchor\" href=\"#43-连接客户端\">#</a> 4.3 连接客户端</h4>\n<pre><code>[root@redis01 redis]# redis-cli -p 26379\n127.0.0.1:26379&gt;  info sentinel\n# Sentinel\nsentinel_masters:1\nsentinel_tilt:0\nsentinel_running_scripts:0\nsentinel_scripts_queue_length:0\nsentinel_simulate_failure_flags:0\nmaster0:name=mymaster,status=ok,address=192.168.40.101:6379,slaves=2,sentinels=3\n</code></pre>\n<h4 id=\"44-redis容灾切换\"><a class=\"anchor\" href=\"#44-redis容灾切换\">#</a> 4.4 redis 容灾切换</h4>\n<pre><code>#连接redis客户端\n[root@redis01 redis]# redis-cli -p 6379 -h 192.168.40.101 \n#验证密码\n192.168.40.101:6379&gt; auth Superman*2023\nOK\n#关闭redis服务\n192.168.40.101:6379&gt; shutdown\nnot connected&gt;\n#退出客户端\nnot connected&gt; exit\n</code></pre>\n<p>关闭主节点之后，我们去查看哨兵日志:</p>\n<pre><code>[root@redis01 ~]# tail -f /soft/redis/sentinel.log \n91936:X 14 Apr 2023 23:26:23.838 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo\n91936:X 14 Apr 2023 23:26:23.838 # Redis version=6.2.11, bits=64, commit=00000000, modified=0, pid=91936, just started\n91936:X 14 Apr 2023 23:26:23.838 # Configuration loaded\n91936:X 14 Apr 2023 23:26:23.838 * monotonic clock: POSIX clock_gettime\n91936:X 14 Apr 2023 23:26:23.839 * Running mode=sentinel, port=26379.\n91936:X 14 Apr 2023 23:26:23.839 # Sentinel ID is 835b4c8544fb250af5fd479f834ee369cc4f388e\n91936:X 14 Apr 2023 23:26:23.839 # +monitor master mymaster 192.168.40.101 6379 quorum 2\n\n\n\n91936:X 14 Apr 2023 23:31:25.329 # +sdown master mymaster 192.168.40.101 6379   #这里应该是发现主节点宕机\n91936:X 14 Apr 2023 23:31:25.359 # +new-epoch 5\n91936:X 14 Apr 2023 23:31:25.360 # +vote-for-leader ab43979285cb47b1b459aeb0ab91b63fa9d1a989 5\n91936:X 14 Apr 2023 23:31:25.401 # +odown master mymaster 192.168.40.101 6379 #quorum 3/2 两个哨兵都觉得主节点宕机了\n91936:X 14 Apr 2023 23:31:25.401 # Next failover delay: I will not start a failover before Fri Apr 14 23:37:25 2023\n91936:X 14 Apr 2023 23:31:26.468 # +config-update-from sentinel ab43979285cb47b1b459aeb0ab91b63fa9d1a989 192.168.40.102 26379 @ mymaster 192.168.40.101 6379\n91936:X 14 Apr 2023 23:31:26.468 # +switch-master mymaster 192.168.40.101 6379 192.168.40.103 6379 #通过投票选举40.103为新的主节点\n91936:X 14 Apr 2023 23:31:26.468 * +slave slave 192.168.40.102:6379 192.168.40.102 6379 @ mymaster 192.168.40.103 6379\n91936:X 14 Apr 2023 23:31:26.469 * +slave slave 192.168.40.101:6379 192.168.40.101 6379 @ mymaster 192.168.40.103 6379\n</code></pre>\n<p>下面我们去 40.103 下查看哨兵主从切换是否成功</p>\n<pre><code>[root@redis03 redis]# redis-cli -p 6379 -h 192.168.40.103\n192.168.40.103:6379&gt; auth Superman*2023\nOK\n192.168.40.103:6379&gt; info replication\n# Replication\nrole:master   # 40.103变成主节点了\nconnected_slaves:1   # 下面的从机个数为1\nslave0:ip=192.168.40.102,port=6379,state=online,offset=108708,lag=1\nmaster_failover_state:no-failover\nmaster_replid:cf36f762dcae0c07b54f7287dc19d7ecc0d50dd3\nmaster_replid2:a7de32d10b2d31f8886c84ca91dc7f055439c935\nmaster_repl_offset:108851\nsecond_repl_offset:59887\nrepl_backlog_active:1\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:1\nrepl_backlog_histlen:108851\n</code></pre>\n<p>重新连接挂掉的主节点</p>\n<pre><code>[root@redis01 redis]# redis-server redis.conf \n[root@redis01 redis]#  redis-cli -p 6379 -h 192.168.40.101\n192.168.40.101:6379&gt; auth Superman*2023\nOK\n192.168.40.101:6379&gt; info replication\n# Replication\nrole:slave          #主节点连接回来之后自动变成了从节点，并且成功连上了主机\nmaster_host:192.168.40.103\nmaster_port:6379\nmaster_link_status:up\nmaster_last_io_seconds_ago:1\nmaster_sync_in_progress:0\nslave_read_repl_offset:130607\nslave_repl_offset:130607\nslave_priority:100\nslave_read_only:1\nreplica_announced:1\nconnected_slaves:0\nmaster_failover_state:no-failover\nmaster_replid:cf36f762dcae0c07b54f7287dc19d7ecc0d50dd3\nmaster_replid2:0000000000000000000000000000000000000000\nmaster_repl_offset:130607\nsecond_repl_offset:-1\nrepl_backlog_active:1\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:126982\nrepl_backlog_histlen:3626\n</code></pre>\n<p>再去主节点确认一下</p>\n<pre><code>192.168.40.103:6379&gt; info replication\n# Replication\nrole:master\nconnected_slaves:2   #两个从节点\nslave0:ip=192.168.40.102,port=6379,state=online,offset=147879,lag=1\nslave1:ip=192.168.40.101,port=6379,state=online,offset=147879,lag=1\nmaster_failover_state:no-failover\nmaster_replid:cf36f762dcae0c07b54f7287dc19d7ecc0d50dd3\nmaster_replid2:a7de32d10b2d31f8886c84ca91dc7f055439c935\nmaster_repl_offset:148165\nsecond_repl_offset:59887\nrepl_backlog_active:1\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:1\nrepl_backlog_histlen:148165\n</code></pre>\n<p>五、哨兵模式的优缺点<br />\n 1. 优点</p>\n<p>哨兵集群，基于主从复制模式，所有的主从配置优点，它全有</p>\n<p>主从可以切换，故障可以转移，系统的可用性就会更好</p>\n<p>哨兵模式就是主从模式的升级，手动到自动，更加健壮！</p>\n<p>2. 缺点</p>\n<p>Redis 不好在线扩容，集群容量一旦到达上限，在线扩容就十分麻烦</p>\n<p>哨兵模式的配置繁琐</p>\n<p>3. 哨兵模式的配置文件详解</p>\n<pre><code># Example sentinel.conf\n# 哨兵sentinel实例运行的端口 默认26379\nport 26379\n \n# 哨兵sentinel的工作目录\ndir /tmp\n \n# 哨兵sentinel监控的redis主节点的 ip port\n# master-name 可以自己命名的主节点名字 只能由字母A-z、数字0-9 、这三个字符&quot;.-_&quot;组成。\n# quorum 配置多少个sentinel哨兵统一认为master主节点失联 那么这时客观上认为主节点失联了\n# sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;\nsentinel monitor mymaster 127.0.0.1 6379 2\n  \n# 当在Redis实例中开启了requirepass foobared 授权密码这样所有连接Redis实例的客户端都要提供 密码\n# 设置哨兵sentinel 连接主从的密码 注意必须为主从设置一样的验证密码\n# sentinel auth-pass &lt;master-name&gt; &lt;password&gt;\nsentinel auth-pass mymaster MySUPER--secret-0123passw0rd\n \n# 指定多少毫秒之后 主节点没有应答哨兵sentinel 此时哨兵主观上认为主节点下线 默认30秒\n# sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;\nsentinel down-after-milliseconds mymaster 30000\n \n# 这个配置项指定了在发生failover主备切换时最多可以有多少个slave同时对新的master进行同步，这个数字越小，完成failover所需的时间就越长， 但是如果这个数字越大，就意味着越 多的slave因为replication而不可用。 可以通过将这个值设为 1 来保证每次只有一个slave 处于不能处理命令请求的状态。\n# sentinel parallel-syncs &lt;master-name&gt; &lt;numslaves&gt;\nsentinel parallel-syncs mymaster 1\n \n# 故障转移的超时时间 failover-timeout 可以用在以下这些方面：\n#1. 同一个sentinel对同一个master两次failover之间的间隔时间。\n#2. 当一个slave从一个错误的master那里同步数据开始计算时间。直到slave被纠正为向正确的master那 里同步数据时。\n#3.当想要取消一个正在进行的failover所需要的时间。\n#4.当进行failover时，配置所有slaves指向新的master所需的最大时间。不过，即使过了这个超时， slaves依然会被正确配置为指向master，但是就不按parallel-syncs所配置的规则来了 # 默认三分钟\n# sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt; bilibili：\nsentinel failover-timeout mymaster 180000\n \n# SCRIPTS EXECUTION\n#配置当某一事件发生时所需要执行的脚本，可以通过脚本来通知管理员，例如当系统运行不正常时发邮件通知 相关人员。\n#对于脚本的运行结果有以下规则：\n#若脚本执行后返回1，那么该脚本稍后将会被再次执行，重复次数目前默认为10\n#若脚本执行后返回2，或者比2更高的一个返回值，脚本将不会重复执行。\n#如果脚本在执行过程中由于收到系统中断信号被终止了，则同返回值为1时的行为相同。\n#一个脚本的最大执行时间为60s，如果超过这个时间，脚本将会被一个SIGKILL信号终止，之后重新执行。\n#通知型脚本:当sentinel有任何警告级别的事件发生时（比如说redis实例的主观失效和客观失效等等）， 将会去调用这个脚本，这时这个脚本应该通过邮件，SMS等方式去通知系统管理员关于系统不正常运行的信 息。调用该脚本时，将传给脚本两个参数，一个是事件的类型，一个是事件的描述。如果sentinel.conf配 置文件中配置了这个脚本路径，那么必须保证这个脚本存在于这个路径，并且是可执行的，否则sentinel无 法正常启动成功。\n#通知脚本\n# shell编程\n# sentinel notification-script &lt;master-name&gt; &lt;script-path&gt; sentinel\nnotification-script mymaster /var/redis/notify.sh\n \n# 客户端重新配置主节点参数脚本\n# 当一个master由于failover而发生改变时，这个脚本将会被调用，通知相关的客户端关于master地址已 经发生改变的信息。\n# 以下参数将会在调用脚本时传给脚本:\n# &lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt; # 目前&lt;state&gt;总是“failover”,\n# &lt;role&gt;是“leader”或者“observer”中的一个。\n# 参数 from-ip, from-port, to-ip, to-port是用来和旧的master和新的master(即旧的slave)通 信的# 这个脚本应该是通用的，能被多次调用，不是针对性的。\n# sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt; sentinel client-reconfig-\nscript mymaster /var/redis/reconfig.sh\n</code></pre>\n<p><em>再去看一下 redis 的配置文件和哨兵的配置文件，你会惊讶的发现，里边的配置文件已经被改过来了。</em></p>\n<pre><code>cat redis.con\n...\nreplicaof 192.168.40.103 6379\n</code></pre>\n",
            "tags": [
                "Redis"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3166738000.html",
            "url": "http://ixuyong.cn/posts/3166738000.html",
            "title": "Kubeadm高可用安装K8s集群",
            "date_published": "2025-04-09T10:28:34.000Z",
            "content_html": "<h2 id=\"kubeadm高可用安装k8s集群\"><a class=\"anchor\" href=\"#kubeadm高可用安装k8s集群\">#</a> Kubeadm 高可用安装 K8s 集群</h2>\n<h4 id=\"1-基本配置\"><a class=\"anchor\" href=\"#1-基本配置\">#</a> 1. 基本配置</h4>\n<h5 id=\"11-基本环境配置\"><a class=\"anchor\" href=\"#11-基本环境配置\">#</a> 1.1 基本环境配置</h5>\n<table>\n<thead>\n<tr>\n<th>主机名</th>\n<th>IP 地址</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>k8s-master01 ~ 03</td>\n<td>192.168.1.71 ~ 73</td>\n<td>master 节点 * 3</td>\n</tr>\n<tr>\n<td>/</td>\n<td>192.168.1.70</td>\n<td>keepalived 虚拟 IP（不占用机器）</td>\n</tr>\n<tr>\n<td>k8s-node01 ~ 02</td>\n<td>192.168.1.74/75</td>\n<td>worker 节点 * 2</td>\n</tr>\n</tbody>\n</table>\n<p><em>请统一替换这些网段，Pod 网段和 service 和宿主机网段不要重复！！！</em></p>\n<table>\n<thead>\n<tr>\n<th><em><strong>* 配置信息 *</strong></em></th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>系统版本</td>\n<td>Rocky Linux 8/9</td>\n</tr>\n<tr>\n<td>Containerd</td>\n<td>latest</td>\n</tr>\n<tr>\n<td>Pod 网段</td>\n<td>172.16.0.0/16</td>\n</tr>\n<tr>\n<td>Service 网段</td>\n<td>10.96.0.0/16</td>\n</tr>\n</tbody>\n</table>\n<p><mark>所有节点</mark>更改主机名（其它节点按需修改）：</p>\n<pre><code>hostnamectl set-hostname k8s-master01 \n</code></pre>\n<p><mark>所有节点</mark>配置 hosts，修改 /etc/hosts 如下：</p>\n<pre><code>[root@k8s-master01 ~]# cat /etc/hosts\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n192.168.1.71 k8s-master01\n192.168.1.72 k8s-master02\n192.168.1.73 k8s-master03\n192.168.1.74 k8s-node01\n192.168.1.75 k8s-node02\n</code></pre>\n<p><mark>所有节点</mark>配置 yum 源：</p>\n<pre><code># 配置基础源\nsed -e 's|^mirrorlist=|#mirrorlist=|g' \\\n    -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.aliyun.com/rockylinux|g' \\\n    -i.bak \\\n    /etc/yum.repos.d/*.repo\n\nyum makecache\n</code></pre>\n<p><mark>所有节点</mark>必备工具安装：</p>\n<pre><code>yum install wget jq psmisc vim net-tools telnet yum-utils device-mapper-persistent-data lvm2 git rsyslog -y\n</code></pre>\n<p><mark>所有节点</mark>关闭防火墙、selinux、dnsmasq、swap、开启 rsyslog。服务器配置如下：</p>\n<pre><code>systemctl disable --now firewalld \nsystemctl disable --now dnsmasq\nsetenforce 0\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/sysconfig/selinux\nsed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/selinux/config\nsystemctl enable --now rsyslog\n</code></pre>\n<p><mark>所有节点</mark>关闭 swap 分区：</p>\n<pre><code>swapoff -a &amp;&amp; sysctl -w vm.swappiness=0\nsed -ri '/^[^#]*swap/s@^@#@' /etc/fstab\n</code></pre>\n<p><mark>所有节点</mark>安装 ntpdate：</p>\n<pre><code>sudo dnf install epel-release -y\nsudo dnf config-manager --set-enabled epel\nsudo dnf install ntpsec\n</code></pre>\n<p><mark>所有节点</mark>同步时间并配置上海时区：</p>\n<pre><code>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\necho 'Asia/Shanghai' &gt;/etc/timezone\nntpdate time2.aliyun.com\n# 加入到crontab\ncrontab -e\n*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com\n</code></pre>\n<p><mark>所有节点</mark>配置 limit：</p>\n<pre><code>ulimit -SHn 65535\nvim /etc/security/limits.conf\n# 末尾添加如下内容\n* soft nofile 65536\n* hard nofile 131072\n* soft nproc 65535\n* hard nproc 655350\n* soft memlock unlimited\n* hard memlock unlimited\n</code></pre>\n<p><mark>所有节点</mark>升级系统：</p>\n<pre><code>yum update -y\n</code></pre>\n<p><mark>Master01 节点</mark>免密钥登录其他节点，安装过程中生成配置文件和证书均在 Master01 上操作，集群管理也在 Master01 上操作：</p>\n<pre><code>ssh-keygen -t rsa\nfor i in k8s-master01 k8s-master02 k8s-master03 k8s-node01 k8s-node02;do ssh-copy-id -i .ssh/id_rsa.pub $i;done\n</code></pre>\n<p><em>注意：公有云环境，可能需要把 kubectl 放在一个非 Master 节点上</em></p>\n<p><mark>Master01 节点</mark>下载安装所有的源码文件：</p>\n<pre><code>cd /root/ ; git clone https://gitee.com/chinagei/k8s-ha-install\n</code></pre>\n<h5 id=\"12-内核配置\"><a class=\"anchor\" href=\"#12-内核配置\">#</a> 1.2 内核配置</h5>\n<p><mark>所有节点</mark>安装 ipvsadm：</p>\n<pre><code>yum install ipvsadm ipset sysstat conntrack libseccomp -y\n</code></pre>\n<p><mark>所有节点</mark>配置 ipvs 模块：</p>\n<pre><code>modprobe -- ip_vs\nmodprobe -- ip_vs_rr\nmodprobe -- ip_vs_wrr\nmodprobe -- ip_vs_sh\nmodprobe -- nf_conntrack\n</code></pre>\n<p><mark>所有节点</mark>创建 ipvs.conf，并配置开机自动加载：</p>\n<pre><code>vim /etc/modules-load.d/ipvs.conf \n# 加入以下内容\nip_vs\nip_vs_lc\nip_vs_wlc\nip_vs_rr\nip_vs_wrr\nip_vs_lblc\nip_vs_lblcr\nip_vs_dh\nip_vs_sh\nip_vs_fo\nip_vs_nq\nip_vs_sed\nip_vs_ftp\nip_vs_sh\nnf_conntrack\nip_tables\nip_set\nxt_set\nipt_set\nipt_rpfilter\nipt_REJECT\nipip\n</code></pre>\n<p><mark>所有节点</mark>然后执行 systemctl enable --now systemd-modules-load.service 即可（报错不用管）</p>\n<pre><code>systemctl enable --now systemd-modules-load.service\n</code></pre>\n<p><mark>所有节点</mark>内核优化配置：</p>\n<pre><code>cat &lt;&lt;EOF &gt; /etc/sysctl.d/k8s.conf\nnet.ipv4.ip_forward = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nfs.may_detach_mounts = 1\nnet.ipv4.conf.all.route_localnet = 1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\nfs.inotify.max_user_watches=89100\nfs.file-max=52706963\nfs.nr_open=52706963\nnet.netfilter.nf_conntrack_max=2310720\n\nnet.ipv4.tcp_keepalive_time = 600\nnet.ipv4.tcp_keepalive_probes = 3\nnet.ipv4.tcp_keepalive_intvl =15\nnet.ipv4.tcp_max_tw_buckets = 36000\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_max_orphans = 327680\nnet.ipv4.tcp_orphan_retries = 3\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_max_syn_backlog = 16384\nnet.ipv4.ip_conntrack_max = 65536\nnet.ipv4.tcp_max_syn_backlog = 16384\nnet.ipv4.tcp_timestamps = 0\nnet.core.somaxconn = 16384\nEOF\n</code></pre>\n<p><mark>所有节点</mark>应用配置：</p>\n<pre><code>sysctl --system\n</code></pre>\n<p><mark>所有节点</mark>配置完内核后，重启机器，之后查看内核模块是否已自动加载：</p>\n<pre><code>reboot\nlsmod | grep --color=auto -e ip_vs -e nf_conntrack\n</code></pre>\n<h4 id=\"2-高可用组件安装\"><a class=\"anchor\" href=\"#2-高可用组件安装\">#</a> 2. 高可用组件安装</h4>\n<p><em>注意：如果安装的不是高可用集群，haproxy 和 keepalived 无需安装</em></p>\n<p><em>注意：公有云要用公有云自带的负载均衡，比如阿里云的 SLB、NLB，腾讯云的 ELB，用来替代 haproxy 和 keepalived，因为公有云大部分都是不支持 keepalived 的。</em></p>\n<p><mark>所有 Master 节点</mark>通过 yum 安装 HAProxy 和 KeepAlived：</p>\n<pre><code>yum install keepalived haproxy -y\n</code></pre>\n<p><mark>所有 Master 节点</mark>配置 HAProxy，需要注意黄色部分的 IP：</p>\n<pre><code>[root@k8s-master01 etc]# mkdir /etc/haproxy\n[root@k8s-master01 etc]# vim /etc/haproxy/haproxy.cfg \nglobal\n  maxconn  2000\n  ulimit-n  16384\n  log  127.0.0.1 local0 err\n  stats timeout 30s\n\ndefaults\n  log global\n  mode  http\n  option  httplog\n  timeout connect 5000\n  timeout client  50000\n  timeout server  50000\n  timeout http-request 15s\n  timeout http-keep-alive 15s\n\nfrontend monitor-in\n  bind *:33305\n  mode http\n  option httplog\n  monitor-uri /monitor\n\nfrontend k8s-master\n  bind 0.0.0.0:16443       #HAProxy监听端口\n  bind 127.0.0.1:16443     #HAProxy监听端口\n  mode tcp\n  option tcplog\n  tcp-request inspect-delay 5s\n  default_backend k8s-master\n\nbackend k8s-master\n  mode tcp\n  option tcplog\n  option tcp-check\n  balance roundrobin\n  default-server inter 10s downinter 5s rise 2 fall 2 slowstart 60s maxconn 250 maxqueue 256 weight 100\n  server k8s-master01\t192.168.1.71:6443  check       #API Server IP地址\n  server k8s-master02\t192.168.1.72:6443  check       #API Server IP地址\n  server k8s-master03\t192.168.1.73:6443  check       #API Server IP地址\n</code></pre>\n<p><mark>所有 Master 节点</mark>配置 KeepAlived，需要注意黄色部分的配置。</p>\n<p><mark>Master01 节点</mark>的配置：</p>\n<pre><code>[root@k8s-master01 etc]# mkdir /etc/keepalived\n\n[root@k8s-master01 ~]# vim /etc/keepalived/keepalived.conf \n! Configuration File for keepalived\nglobal_defs &#123;\n    router_id LVS_DEVEL\nscript_user root\n    enable_script_security\n&#125;\nvrrp_script chk_apiserver &#123;\n    script &quot;/etc/keepalived/check_apiserver.sh&quot;\n    interval 5\n    weight -5\n    fall 2  \nrise 1\n&#125;\nvrrp_instance VI_1 &#123;\n    state MASTER\n    interface ens160               #网卡名称\n    mcast_src_ip 192.168.1.71      #K8s-master01 IP地址\n    virtual_router_id 51\n    priority 101\n    advert_int 2\n    authentication &#123;\n        auth_type PASS\n        auth_pass K8SHA_KA_AUTH\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.70        #VIP地址\n    &#125;\n    track_script &#123;\n       chk_apiserver\n    &#125;\n&#125;\t\n</code></pre>\n<p><mark>Master02 节点</mark>的配置：</p>\n<pre><code># vim /etc/keepalived/keepalived.conf \n\n! Configuration File for keepalived\nglobal_defs &#123;\n    router_id LVS_DEVEL\nscript_user root\n    enable_script_security\n&#125;\nvrrp_script chk_apiserver &#123;\n    script &quot;/etc/keepalived/check_apiserver.sh&quot;\n   interval 5\n    weight -5\n    fall 2  \nrise 1\n&#125;\nvrrp_instance VI_1 &#123;\n    state BACKUP\n    interface ens160                #网卡名称\n    mcast_src_ip 192.168.1.72       #K8s-master02 IP地址\n    virtual_router_id 51\n    priority 100\n    advert_int 2\n    authentication &#123;\n        auth_type PASS\n        auth_pass K8SHA_KA_AUTH\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.70              #VIP地址\n    &#125;\n    track_script &#123;\n       chk_apiserver\n    &#125;\n&#125;\n</code></pre>\n<p><mark>Master03 节点</mark>的配置：</p>\n<pre><code># vim /etc/keepalived/keepalived.conf \n\n! Configuration File for keepalived\nglobal_defs &#123;\n    router_id LVS_DEVEL\nscript_user root\n    enable_script_security\n&#125;\nvrrp_script chk_apiserver &#123;\n    script &quot;/etc/keepalived/check_apiserver.sh&quot;\n interval 5\n    weight -5\n    fall 2  \nrise 1\n&#125;\nvrrp_instance VI_1 &#123;\n    state BACKUP\n    interface ens160                 #网卡名称\n    mcast_src_ip 192.168.1.73        #K8s-master03 IP地址\n    virtual_router_id 51\n    priority 100\n    advert_int 2\n    authentication &#123;\n        auth_type PASS\n        auth_pass K8SHA_KA_AUTH\n    &#125;\n    virtual_ipaddress &#123;\n        192.168.1.70          #VIP地址\n    &#125;\n    track_script &#123;\n       chk_apiserver\n    &#125;\n&#125;\n</code></pre>\n<p><mark>所有 master 节点</mark>配置 KeepAlived 健康检查文件：</p>\n<pre><code>[root@k8s-master01 keepalived]# vim /etc/keepalived/check_apiserver.sh \n#!/bin/bash\n\nerr=0\nfor k in $(seq 1 3)\ndo\n    check_code=$(pgrep haproxy)\n    if [[ $check_code == &quot;&quot; ]]; then\n        err=$(expr $err + 1)\n        sleep 1\n        continue\n    else\n        err=0\n        break\n    fi\ndone\n\nif [[ $err != &quot;0&quot; ]]; then\n    echo &quot;systemctl stop keepalived&quot;\n    /usr/bin/systemctl stop keepalived\n    exit 1\nelse\n    exit 0\nfi\n</code></pre>\n<p><mark>所有 master 节点</mark>配置健康检查文件添加执行权限：</p>\n<pre><code>chmod +x /etc/keepalived/check_apiserver.sh\n</code></pre>\n<p><mark>所有 master 节点</mark>启动 haproxy 和 keepalived：</p>\n<pre><code>[root@k8s-master01 keepalived]# systemctl daemon-reload\n[root@k8s-master01 keepalived]# systemctl enable --now haproxy\n[root@k8s-master01 keepalived]# systemctl enable --now keepalived\n</code></pre>\n<p>重要：如果安装了 keepalived 和 haproxy，需要测试 keepalived 是否是正常的</p>\n<pre><code>所有节点测试VIP\n[root@k8s-master01 ~]# ping 192.168.1.70 -c 4\nPING 192.168.1.70 (192.168.1.70) 56(84) bytes of data.\n64 bytes from 192.168.1.70: icmp_seq=1 ttl=64 time=0.464 ms\n64 bytes from 192.168.1.70: icmp_seq=2 ttl=64 time=0.063 ms\n64 bytes from 192.168.1.70: icmp_seq=3 ttl=64 time=0.062 ms\n64 bytes from 192.168.1.70: icmp_seq=4 ttl=64 time=0.063 ms\n\n[root@k8s-master01 ~]# telnet 192.168.1.70 16443\nTrying 192.168.1.70...\nConnected to 192.168.1.70.\nEscape character is '^]'.\nConnection closed by foreign host.\n</code></pre>\n<p>如果 ping 不通且 telnet 没有出现 ] ，则认为 VIP 不可以，不可在继续往下执行，需要排查 keepalived 的问题，比如防火墙和 selinux，haproxy 和 keepalived 的状态，监听端口等</p>\n<ul>\n<li>所有节点查看防火墙状态必须为 disable 和 inactive：systemctl status firewalld</li>\n<li>所有节点查看 selinux 状态，必须为 disable：getenforce</li>\n<li>master 节点查看 haproxy 和 keepalived 状态：systemctl status keepalived haproxy</li>\n<li>master 节点查看监听端口：netstat -lntp</li>\n</ul>\n<p>如果以上都没有问题，需要确认：</p>\n<ol>\n<li>\n<p>是否是公有云机器</p>\n</li>\n<li>\n<p>是否是私有云机器（类似 OpenStack）</p>\n</li>\n</ol>\n<p>上述公有云一般都是不支持 keepalived，私有云可能也有限制，需要和自己的私有云管理员咨询</p>\n<h4 id=\"3-runtime安装\"><a class=\"anchor\" href=\"#3-runtime安装\">#</a> 3. Runtime 安装</h4>\n<p>如果安装的版本低于 1.24，选择 Docker 和 Containerd 均可，高于 1.24 建议选择 Containerd 作为 Runtime，不再推荐使用 Docker 作为 Runtime。</p>\n<h5 id=\"31-安装containerd\"><a class=\"anchor\" href=\"#31-安装containerd\">#</a> 3.1 安装 Containerd</h5>\n<p><mark>所有节点</mark>配置安装源：</p>\n<pre><code>yum install wget jq psmisc vim net-tools telnet yum-utils device-mapper-persistent-data lvm2 git -y\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n</code></pre>\n<p><mark>所有节点</mark>安装 docker-ce（如果在以前已经安装过，需要重新安装更新一下）：</p>\n<pre><code># yum install docker-ce containerd -y\n</code></pre>\n<p><em>可以无需启动 Docker，只需要配置和启动 Containerd 即可。</em></p>\n<p>首先配置 Containerd 所需的模块（<mark>所有节点</mark>）：</p>\n<pre><code># cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/containerd.conf\noverlay\nbr_netfilter\nEOF\n</code></pre>\n<p><mark>所有节点</mark>加载模块：</p>\n<pre><code># modprobe -- overlay\n# modprobe -- br_netfilter\n</code></pre>\n<p><mark>所有节点</mark>，配置 Containerd 所需的内核：</p>\n<pre><code># cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.ipv4.ip_forward                 = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nEOF\n</code></pre>\n<p><mark>所有节点</mark>加载内核：</p>\n<pre><code># sysctl --system\n</code></pre>\n<p><mark>所有节点</mark>生成 Containerd 的配置文件：</p>\n<pre><code># mkdir -p /etc/containerd\n# containerd config default | tee /etc/containerd/config.toml\n</code></pre>\n<p><mark>所有节点</mark>更改 Containerd 的 Cgroup 和 Pause 镜像配置：</p>\n<pre><code>sed -i 's#SystemdCgroup = false#SystemdCgroup = true#g' /etc/containerd/config.toml\nsed -i 's#k8s.gcr.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\nsed -i 's#registry.gcr.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\nsed -i 's#registry.k8s.io/pause#registry.cn-hangzhou.aliyuncs.com/google_containers/pause#g'  /etc/containerd/config.toml\n</code></pre>\n<p><mark>所有节点</mark>启动 Containerd，并配置开机自启动：</p>\n<pre><code># systemctl daemon-reload\n# systemctl enable --now containerd\n</code></pre>\n<p><mark>所有节点</mark>配置 crictl 客户端连接的运行时位置（可选）：</p>\n<pre><code># cat &gt; /etc/crictl.yaml &lt;&lt;EOF\nruntime-endpoint: unix:///run/containerd/containerd.sock\nimage-endpoint: unix:///run/containerd/containerd.sock\ntimeout: 10\ndebug: false\nEOF\n</code></pre>\n<h4 id=\"4-安装kubernetes组件\"><a class=\"anchor\" href=\"#4-安装kubernetes组件\">#</a> 4 . 安装 Kubernetes 组件</h4>\n<p><mark>所有节点</mark>配置源（注意更改版本号）：</p>\n<pre><code>cat &lt;&lt;EOF | tee /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes-new/core/stable/v1.32/rpm/\nenabled=1\ngpgcheck=1\ngpgkey=https://mirrors.aliyun.com/kubernetes-new/core/stable/v1.32/rpm/repodata/repomd.xml.key\nEOF\n</code></pre>\n<p>首先在<mark> Master01 节点</mark>查看最新的 Kubernetes 版本是多少：</p>\n<pre><code># yum list kubeadm.x86_64 --showduplicates | sort -r\n</code></pre>\n<p><mark>所有节点</mark>安装 1.32 最新版本 kubeadm、kubelet 和 kubectl：</p>\n<pre><code># yum install kubeadm-1.32* kubelet-1.32* kubectl-1.32* -y\n</code></pre>\n<p><mark>所有节点</mark>设置 Kubelet 开机自启动（由于还未初始化，没有 kubelet 的配置文件，此时 kubelet 无法启动，无需关心）：</p>\n<pre><code># systemctl daemon-reload\n# systemctl enable --now kubelet\n</code></pre>\n<p><em>此时 kubelet 是起不来的，日志会有报错不影响！</em></p>\n<h4 id=\"5-集群初始化\"><a class=\"anchor\" href=\"#5-集群初始化\">#</a> 5 . 集群初始化</h4>\n<p>以下操作在<mark> master01</mark>（注意黄色部分）：</p>\n<pre><code>vim kubeadm-config.yaml\napiVersion: kubeadm.k8s.io/v1beta3\nbootstrapTokens:\n- groups:\n  - system:bootstrappers:kubeadm:default-node-token\n  token: 7t2weq.bjbawausm0jaxury\n  ttl: 24h0m0s\n  usages:\n  - signing\n  - authentication\nkind: InitConfiguration\nlocalAPIEndpoint:\n  advertiseAddress: 192.168.1.71\n  bindPort: 6443\nnodeRegistration:\n  criSocket: unix:///var/run/containerd/containerd.sock\n  name: k8s-master01\n  taints:\n  - effect: NoSchedule\n    key: node-role.kubernetes.io/control-plane\n---\napiServer:\n  certSANs:\n  - 192.168.1.70               # 如果搭建的不是高可用集群，把此处改为master的IP\n  timeoutForControlPlane: 4m0s\napiVersion: kubeadm.k8s.io/v1beta3\ncertificatesDir: /etc/kubernetes/pki\nclusterName: kubernetes\ncontrolPlaneEndpoint: 192.168.1.70:16443 # 如果搭建的不是高可用集群，把此处IP改为master的IP，端口改成6443\ncontrollerManager: &#123;&#125;\netcd:\n  local:\n    dataDir: /var/lib/etcd\nimageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers\nkind: ClusterConfiguration\nkubernetesVersion: v1.32.3    # 更改此处的版本号和kubeadm version一致\nnetworking:\n  dnsDomain: cluster.local\n  podSubnet: 172.16.0.0/16    # 注意此处的网段，不要与service和节点网段冲突\n  serviceSubnet: 10.96.0.0/16 # 注意此处的网段，不要与pod和节点网段冲突\nscheduler: &#123;&#125;\n</code></pre>\n<p><mark>master01 节点</mark>更新 kubeadm 文件：</p>\n<pre><code>kubeadm config migrate --old-config kubeadm-config.yaml --new-config new.yaml\n</code></pre>\n<p>将 new.yaml 文件复制到<mark>其他 master 节点</mark>:</p>\n<pre><code>for i in k8s-master02 k8s-master03; do scp new.yaml $i:/root/; done\n</code></pre>\n<p>之后<mark>所有 Master 节点</mark>提前下载镜像，可以节省初始化时间（其他节点不需要更改任何配置，包括 IP 地址也不需要更改）：</p>\n<pre><code>kubeadm config images pull --config /root/new.yaml \n</code></pre>\n<p>正确的反馈信息如下（<em><strong>* 版本可能不一样 *</strong></em>）：</p>\n<pre><code>[root@k8s-master02 ~]# kubeadm config images pull --config /root/new.yaml \n[config/images] Pulled registry.cn-hangzhou.aliyuncs.com/google_containers/kube-apiserver:v1.32.0\n[config/images] Pulled registry.cn-hangzhou.aliyuncs.com/google_containers/kube-controller-manager:v1.32.0\n[config/images] Pulled registry.cn-hangzhou.aliyuncs.com/google_containers/kube-scheduler:v1.32.0\n[config/images] Pulled registry.cn-hangzhou.aliyuncs.com/google_containers/kube-proxy:v1.32.0\n[config/images] Pulled registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:v1.11.3\n[config/images] Pulled registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.10\n[config/images] Pulled registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:3.5.16-0\n</code></pre>\n<p><mark>Master01 节点</mark>初始化，初始化以后会在 /etc/kubernetes 目录下生成对应的证书和配置文件，之后其他 Master 节点加入 Master01 即可：</p>\n<pre><code>kubeadm init --config /root/new.yaml  --upload-certs\n</code></pre>\n<p>初始化成功以后，会产生 Token 值，用于其他节点加入时使用，因此要记录下初始化成功生成的 token 值（令牌值）：</p>\n<pre><code>Your Kubernetes control-plane has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nAlternatively, if you are the root user, you can run:\n\n  export KUBECONFIG=/etc/kubernetes/admin.conf\n\nYou should now deploy a pod network to the cluster.\nRun &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nYou can now join any number of the control-plane node running the following command on each as root:\n\n# 不要复制文档当中的，要去使用节点生成的\n  kubeadm join 192.168.1.70:16443 --token 7t2weq.bjbawausm0jaxury \\\n\t--discovery-token-ca-cert-hash sha256:df72788de04bbc2e8fca70becb8a9e8503a962b5d7cd9b1842a0c39930d08c94 \\\n\t--control-plane --certificate-key c595f7f4a7a3beb0d5bdb75d9e4eff0a60b977447e76c1d6885e82c3aa43c94c\n\nPlease note that the certificate-key gives access to cluster sensitive data, keep it secret!\nAs a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use\n&quot;kubeadm init phase upload-certs --upload-certs&quot; to reload certs afterward.\n\nThen you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join 192.168.1.70:16443 --token 7t2weq.bjbawausm0jaxury \\\n\t--discovery-token-ca-cert-hash sha256:df72788de04bbc2e8fca70becb8a9e8503a962b5d7cd9b1842a0c39930d08c94\n</code></pre>\n<p><mark>Master01 节点</mark>配置环境变量，用于访问 Kubernetes 集群：</p>\n<pre><code>cat &lt;&lt;EOF &gt;&gt; /root/.bashrc\nexport KUBECONFIG=/etc/kubernetes/admin.conf\nEOF\nsource /root/.bashrc\n</code></pre>\n<p><mark>Master01 节点</mark>查看节点状态：（显示 NotReady 不影响）</p>\n<pre><code># kubectl get node\nNAME           STATUS     ROLES           AGE   VERSION\nk8s-master01   NotReady   control-plane   24s   v1.32.3\n</code></pre>\n<p>采用初始化安装方式，所有的系统组件均以容器的方式运行并且在 kube-system 命名空间内，此时可以查看 Pod 状态（显示 pending 不影响）：</p>\n<pre><code class=\"language-\\\"># kubectl get pods -n kube-system\n</code></pre>\n<h5 id=\"51-初始化失败排查\"><a class=\"anchor\" href=\"#51-初始化失败排查\">#</a> 5.1 初始化失败排查</h5>\n<p>如果初始化失败，重置后再次初始化，命令如下（没有失败不要执行）：</p>\n<pre><code>kubeadm reset -f ; ipvsadm --clear  ; rm -rf ~/.kube\n</code></pre>\n<p>如果多次尝试都是初始化失败，需要看系统日志，CentOS/RockyLinux 日志路径:/var/log/messages，Ubuntu 系列日志路径:/var/log/syslog：</p>\n<pre><code>tail -f /var/log/messages | grep -v &quot;not found&quot;\n</code></pre>\n<p>经常出错的原因：</p>\n<ol>\n<li>Containerd 的配置文件修改的不对，自行参考《安装 containerd》小节核对</li>\n<li>new.yaml 配置问题，比如非高可用集群忘记修改 16443 端口为 6443</li>\n<li>new.yaml 配置问题，三个网段有交叉，出现 IP 地址冲突</li>\n<li>VIP 不通导致无法初始化成功，此时 messages 日志会有 VIP 超时的报错</li>\n</ol>\n<h5 id=\"52-高可用master\"><a class=\"anchor\" href=\"#52-高可用master\">#</a> 5.2 高可用 Master</h5>\n<p><strong>其他 master</strong> 加入集群，master02 和 master03 分别执行 (千万不要在 master01 再次执行，不能直接复制文档当中的命令，而是你自己刚才 master01 初始化之后产生的命令)</p>\n<pre><code>kubeadm join 192.168.1.70:16443 --token 7t2weq.bjbawausm0jaxury \\\n\t--discovery-token-ca-cert-hash sha256:df72788de04bbc2e8fca70becb8a9e8503a962b5d7cd9b1842a0c39930d08c94 \\\n\t--control-plane --certificate-key c595f7f4a7a3beb0d5bdb75d9e4eff0a60b977447e76c1d6885e82c3aa43c94c\n</code></pre>\n<p>查看当前状态：（如果显示 NotReady 不影响）</p>\n<pre><code># kubectl get node\nNAME           STATUS     ROLES           AGE     VERSION\nk8s-master01   NotReady   control-plane   4m23s   v1.32.3\nk8s-master02   NotReady   control-plane   66s     v1.32.3\nk8s-master03   NotReady   control-plane   14s     v1.32.3\n</code></pre>\n<h5 id=\"53-token过期处理\"><a class=\"anchor\" href=\"#53-token过期处理\">#</a> 5.3 Token 过期处理</h5>\n<p>注意：以下步骤是上述 init 命令产生的 Token 过期了才需要执行以下步骤，如果没有过期不需要执行，直接 join 即可。</p>\n<p>Token 过期后生成新的 token：</p>\n<pre><code>kubeadm token create --print-join-command\n</code></pre>\n<p>Master 需要生成 --certificate-key：</p>\n<pre><code>kubeadm init phase upload-certs  --upload-certs\n</code></pre>\n<h4 id=\"6-node节点的配置\"><a class=\"anchor\" href=\"#6-node节点的配置\">#</a> 6. Node 节点的配置</h4>\n<p>Node 节点上主要部署公司的一些业务应用，生产环境中不建议 Master 节点部署系统组件之外的其他 Pod，测试环境可以允许 Master 节点部署 Pod 以节省系统资源。</p>\n<pre><code>kubeadm join 192.168.1.70:16443 --token 7t2weq.bjbawausm0jaxury \\\n\t--discovery-token-ca-cert-hash sha256:377702f508fe70b9d8ab68beccaa9af1b4609b754e4cc2fcc6185974e1d620b5\n</code></pre>\n<p>所有节点初始化完成后，查看集群状态（NotReady 不影响）</p>\n<pre><code># kubectl get node\nNAME           STATUS     ROLES           AGE     VERSION\nk8s-master01   NotReady   control-plane   4m23s   v1.32.3\nk8s-master02   NotReady   control-plane   66s     v1.32.3\nk8s-master03   NotReady   control-plane   14s     v1.32.3\nk8s-node01     NotReady   &lt;none&gt;          13s     v1.32.3\nk8s-node02     NotReady   &lt;none&gt;          10s     v1.32.3\n</code></pre>\n<h4 id=\"7-calico组件的安装\"><a class=\"anchor\" href=\"#7-calico组件的安装\">#</a> 7. Calico 组件的安装</h4>\n<p><mark>所有节点</mark>禁止 NetworkManager 管理 Calico 的网络接口，防止有冲突或干扰：</p>\n<pre><code>cat &gt;&gt;/etc/NetworkManager/conf.d/calico.conf&lt;&lt;EOF\n[keyfile]\nunmanaged-devices=interface-name:cali*;interface-name:tunl*;interface-name:vxlan.calico;interface-name:vxlan-v6.calico;interface-name:wireguard.cali;interface-name:wg-v6.cali\nEOF\nsystemctl daemon-reload\nsystemctl restart NetworkManager\n</code></pre>\n<p>以下步骤只在<mark> master01</mark> 执行（.x 不需要更改）：</p>\n<pre><code>cd /root/k8s-ha-install &amp;&amp; git checkout manual-installation-v1.32.x &amp;&amp; cd calico/\n</code></pre>\n<p>修改 Pod 网段：</p>\n<pre><code>POD_SUBNET=`cat /etc/kubernetes/manifests/kube-controller-manager.yaml | grep cluster-cidr= | awk -F= '&#123;print $NF&#125;'`\n\nsed -i &quot;s#POD_CIDR#$&#123;POD_SUBNET&#125;#g&quot; calico.yaml\nkubectl apply -f calico.yaml\n</code></pre>\n<p>查看容器和节点状态：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get pods -n kube-system\nNAME                                       READY   STATUS    RESTARTS   AGE\ncalico-kube-controllers-6f497d8478-v2q8c   1/1     Running   0          24h\ncalico-node-7mzmb                          1/1     Running   0          24h\ncalico-node-ljqnl                          1/1     Running   0          24h\ncalico-node-njqlb                          1/1     Running   0          24h\ncalico-node-ph4m4                          1/1     Running   0          24h\ncalico-node-rx8rl                          1/1     Running   0          24h\ncoredns-76fccbbb6b-76559                   1/1     Running   0          24h\ncoredns-76fccbbb6b-hkvn7                   1/1     Running   0          24h\netcd-k8s-master01                          1/1     Running   0          24h\netcd-k8s-master02                          1/1     Running   0          24h\netcd-k8s-master03                          1/1     Running   0          24h\nkube-apiserver-k8s-master01                1/1     Running   0          24h\nkube-apiserver-k8s-master02                1/1     Running   0          24h\nkube-apiserver-k8s-master03                1/1     Running   0          24h\nkube-controller-manager-k8s-master01       1/1     Running   0          24h\nkube-controller-manager-k8s-master02       1/1     Running   0          24h\nkube-controller-manager-k8s-master03       1/1     Running   0          24h\nkube-proxy-9dtz4                           1/1     Running   0          24h\nkube-proxy-jh7rl                           1/1     Running   0          24h\nkube-proxy-jvvwt                           1/1     Running   0          24h\nkube-proxy-sh89l                           1/1     Running   0          24h\nkube-proxy-t2j49                           1/1     Running   0          24h\nkube-scheduler-k8s-master01                1/1     Running   0          24h\nkube-scheduler-k8s-master02                1/1     Running   0          24h\nkube-scheduler-k8s-master03                1/1     Running   0          24h\nmetrics-server-7d9d8df576-jgnp2            1/1     Running   0          24h\n</code></pre>\n<p>此时节点全部变为 Ready 状态：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get nodes\nNAME           STATUS   ROLES           AGE   VERSION\nk8s-master01   Ready    control-plane   24h   v1.32.3\nk8s-master02   Ready    control-plane   24h   v1.32.3\nk8s-master03   Ready    control-plane   24h   v1.32.3\nk8s-node01     Ready    &lt;none&gt;          24h   v1.32.3\nk8s-node02     Ready    &lt;none&gt;          24h   v1.32.3\n</code></pre>\n<h4 id=\"8-metrics部署\"><a class=\"anchor\" href=\"#8-metrics部署\">#</a> 8. Metrics 部署</h4>\n<p>在新版的 Kubernetes 中系统资源的采集均使用 Metrics-server，可以通过 Metrics 采集节点和 Pod 的内存、磁盘、CPU 和网络的使用率。</p>\n<p>将<mark> Master01 节点</mark>的 front-proxy-ca.crt 复制到所有 Node 节点</p>\n<pre><code>scp /etc/kubernetes/pki/front-proxy-ca.crt k8s-node01:/etc/kubernetes/pki/front-proxy-ca.crt\n\nscp /etc/kubernetes/pki/front-proxy-ca.crt k8s-node(其他节点自行拷贝):/etc/kubernetes/pki/front-proxy-ca.crt\n</code></pre>\n<p>以下操作均在<mark> master01 节点</mark>执行:</p>\n<p>安装 metrics server</p>\n<pre><code>cd /root/k8s-ha-install/kubeadm-metrics-server\n\n# kubectl  create -f comp.yaml \nserviceaccount/metrics-server created\nclusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created\nclusterrole.rbac.authorization.k8s.io/system:metrics-server created\nrolebinding.rbac.authorization.k8s.io/metrics-server-auth-reader created\nclusterrolebinding.rbac.authorization.k8s.io/metrics-server:system:auth-delegator created\nclusterrolebinding.rbac.authorization.k8s.io/system:metrics-server created\nservice/metrics-server created\ndeployment.apps/metrics-server created\napiservice.apiregistration.k8s.io/v1beta1.metrics.k8s.io created\n</code></pre>\n<p>查看状态：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get po -n kube-system -l k8s-app=metrics-server\nNAME                              READY   STATUS    RESTARTS   AGE\nmetrics-server-7d9d8df576-jgnp2   1/1     Running   0          24h\n</code></pre>\n<p>等 Pod 变成 1/1   Running 后，查看节点和 Pod 资源使用率：</p>\n<pre><code>[root@k8s-master01 ~]#  kubectl top node\nNAME           CPU(cores)   CPU(%)   MEMORY(bytes)   MEMORY(%)   \nk8s-master01   132m         3%       932Mi           5%          \nk8s-master02   131m         3%       845Mi           5%          \nk8s-master03   148m         3%       912Mi           5%          \nk8s-node01     54m          1%       600Mi           3%          \nk8s-node02     49m          1%       602Mi           3%          \n[root@k8s-master01 ~]#  kubectl top po -A\nNAMESPACE              NAME                                         CPU(cores)   MEMORY(bytes)   \ningress-nginx          ingress-nginx-controller-5v9gl               2m           98Mi            \ningress-nginx          ingress-nginx-controller-r978m               1m           104Mi           \nkrm                    krm-backend-d7ff675d8-vmt9z                  1m           21Mi            \nkrm                    krm-frontend-588ffd677b-c2pgj                1m           4Mi             \nkrm                    nginx-574cf48959-vcfjs                       0m           2Mi             \nkube-system            calico-kube-controllers-6f497d8478-v2q8c     6m           17Mi            \nkube-system            calico-node-7mzmb                            16m          176Mi           \nkube-system            calico-node-ljqnl                            15m          182Mi           \nkube-system            calico-node-njqlb                            19m          180Mi           \nkube-system            calico-node-ph4m4                            15m          178Mi           \nkube-system            calico-node-rx8rl                            17m          180Mi           \nkube-system            coredns-76fccbbb6b-76559                     2m           16Mi            \nkube-system            coredns-76fccbbb6b-hkvn7                     2m           16Mi            \nkube-system            etcd-k8s-master01                            22m          86Mi            \nkube-system            etcd-k8s-master02                            27m          84Mi            \nkube-system            etcd-k8s-master03                            22m          84Mi            \nkube-system            kube-apiserver-k8s-master01                  22m          267Mi           \nkube-system            kube-apiserver-k8s-master02                  20m          242Mi           \nkube-system            kube-apiserver-k8s-master03                  18m          241Mi           \nkube-system            kube-controller-manager-k8s-master01         6m           69Mi            \nkube-system            kube-controller-manager-k8s-master02         2m           21Mi            \nkube-system            kube-controller-manager-k8s-master03         1m           19Mi            \nkube-system            kube-proxy-9dtz4                             11m          30Mi            \nkube-system            kube-proxy-jh7rl                             1m           27Mi            \nkube-system            kube-proxy-jvvwt                             17m          29Mi            \nkube-system            kube-proxy-sh89l                             1m           29Mi            \nkube-system            kube-proxy-t2j49                             16m          29Mi            \nkube-system            kube-scheduler-k8s-master01                  6m           25Mi            \nkube-system            kube-scheduler-k8s-master02                  6m           25Mi            \nkube-system            kube-scheduler-k8s-master03                  6m           25Mi            \nkube-system            metrics-server-7d9d8df576-jgnp2              2m           26Mi            \nkubernetes-dashboard   dashboard-metrics-scraper-69b4796d9b-klnwr   1m           19Mi            \nkubernetes-dashboard   kubernetes-dashboard-778584b9dd-pd5ln        1m           31Mi  \n</code></pre>\n<h4 id=\"9-dashboard部署\"><a class=\"anchor\" href=\"#9-dashboard部署\">#</a> 9. Dashboard 部署</h4>\n<h5 id=\"91-安装dashboard\"><a class=\"anchor\" href=\"#91-安装dashboard\">#</a> 9.1 安装 Dashboard</h5>\n<p>Dashboard 用于展示集群中的各类资源，同时也可以通过 Dashboard 实时查看 Pod 的日志和在容器中执行一些命令等。</p>\n<pre><code>cd /root/k8s-ha-install/dashboard/\n\n[root@k8s-master01 dashboard]# kubectl  create -f .\nserviceaccount/admin-user created\nclusterrolebinding.rbac.authorization.k8s.io/admin-user created\nnamespace/kubernetes-dashboard created\nserviceaccount/kubernetes-dashboard created\nservice/kubernetes-dashboard created\nsecret/kubernetes-dashboard-certs created\nsecret/kubernetes-dashboard-csrf created\nsecret/kubernetes-dashboard-key-holder created\nconfigmap/kubernetes-dashboard-settings created\nrole.rbac.authorization.k8s.io/kubernetes-dashboard created\nclusterrole.rbac.authorization.k8s.io/kubernetes-dashboard created\nrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created\nclusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created\ndeployment.apps/kubernetes-dashboard created\nservice/dashboard-metrics-scraper created\ndeployment.apps/dashboard-metrics-scraper created\n</code></pre>\n<h5 id=\"92-登录dashboard\"><a class=\"anchor\" href=\"#92-登录dashboard\">#</a> 9.2 登录 dashboard</h5>\n<p>在谷歌浏览器（Chrome）启动文件中加入启动参数，用于解决无法访问 Dashboard 的问题，参考下图：</p>\n<pre><code>--test-type --ignore-certificate-errors\n</code></pre>\n<p><a href=\"https://imgse.com/i/pEgWfHJ\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgWfHJ.png\" alt=\"pEgWfHJ.png\" /></a></p>\n<p>更改 dashboard 的 svc 为 NodePort:</p>\n<pre><code>kubectl edit svc kubernetes-dashboard -n kubernetes-dashboard\n</code></pre>\n<p><a href=\"https://imgse.com/i/pEgW5NR\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgW5NR.png\" alt=\"pEgW5NR.png\" /></a></p>\n<p><em>将 ClusterIP 更改为 NodePort（如果已经为 NodePort 忽略此步骤）</em></p>\n<p>查看端口号：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl get svc kubernetes-dashboard -n kubernetes-dashboard\nNAME                   TYPE       CLUSTER-IP     EXTERNAL-IP   PORT(S)         AGE\nkubernetes-dashboard   NodePort   10.96.139.11   &lt;none&gt;        443:32409/TCP   24h\n</code></pre>\n<p>根据自己的实例端口号，通过任意安装了 kube-proxy 的宿主机的 IP + 端口即可访问到 dashboard：</p>\n<p>访问 Dashboard：<a href=\"https://192.168.181.129:31106\">https://192.168.1.71:32409</a> （把 IP 地址和端口改成你自己的）选择登录方式为令牌（即 token 方式），参考下图：</p>\n<p><a href=\"https://imgse.com/i/pEgW736\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgW736.png\" alt=\"pEgW736.png\" /></a></p>\n<p>创建登录 Token：</p>\n<pre><code>kubectl create token admin-user -n kube-system\n</code></pre>\n<p>将 token 值输入到令牌后，单击登录即可访问 Dashboard，参考下图：</p>\n<p><a href=\"https://imgse.com/i/pEgfPv8\"><img loading=\"lazy\" data-src=\"https://s21.ax1x.com/2025/04/09/pEgfPv8.png\" alt=\"pEgfPv8.png\" /></a></p>\n<h4 id=\"10必看一些必须的配置更改\"><a class=\"anchor\" href=\"#10必看一些必须的配置更改\">#</a> 10.【必看】一些必须的配置更改</h4>\n<p>将 Kube-proxy 改为 ipvs 模式，因为在初始化集群的时候注释了 ipvs 配置，所以需要自行修改一下：</p>\n<p>在 master01 节点执行：</p>\n<pre><code>kubectl edit cm kube-proxy -n kube-system\nmode: ipvs\n</code></pre>\n<p>更新 Kube-Proxy 的 Pod：</p>\n<pre><code>kubectl patch daemonset kube-proxy -p &quot;&#123;\\&quot;spec\\&quot;:&#123;\\&quot;template\\&quot;:&#123;\\&quot;metadata\\&quot;:&#123;\\&quot;annotations\\&quot;:&#123;\\&quot;date\\&quot;:\\&quot;`date +'%s'`\\&quot;&#125;&#125;&#125;&#125;&#125;&quot; -n kube-system\n</code></pre>\n<p>验证 Kube-Proxy 模式:</p>\n<pre><code>[root@k8s-master01]# curl 127.0.0.1:10249/proxyMode\nipvs\n</code></pre>\n<h4 id=\"11必看注意事项\"><a class=\"anchor\" href=\"#11必看注意事项\">#</a> 11.【必看】注意事项</h4>\n<p>注意：kubeadm 安装的集群，证书有效期默认是一年。master 节点的 kube-apiserver、kube-scheduler、kube-controller-manager、etcd 都是以容器运行的。可以通过 kubectl get po -n kube-system 查看。</p>\n<p>启动和二进制不同的是，kubelet 的配置文件在 /etc/sysconfig/kubelet 和 /var/lib/kubelet/config.yaml，修改后需要重启 kubelet 进程。</p>\n<p>其他组件的配置文件在 /etc/kubernetes/manifests 目录下，比如 kube-apiserver.yaml，该 yaml 文件更改后，kubelet 会自动刷新配置，也就是会重启 pod。不能再次创建该文件。</p>\n<p>kube-proxy 的配置在 kube-system 命名空间下的 configmap 中，可以通过</p>\n<pre><code>kubectl edit cm kube-proxy -n kube-system\n</code></pre>\n<p>进行更改，更改完成后，可以通过 patch 重启 kube-proxy</p>\n<pre><code>kubectl patch daemonset kube-proxy -p &quot;&#123;\\&quot;spec\\&quot;:&#123;\\&quot;template\\&quot;:&#123;\\&quot;metadata\\&quot;:&#123;\\&quot;annotations\\&quot;:&#123;\\&quot;date\\&quot;:\\&quot;`date +'%s'`\\&quot;&#125;&#125;&#125;&#125;&#125;&quot; -n kube-system\n</code></pre>\n<p>Kubeadm 安装后，master 节点默认不允许部署 pod，可以通过以下方式删除 Taint，即可部署 Pod：</p>\n<pre><code>[root@k8s-master01 ~]# kubectl  taint node  -l node-role.kubernetes.io/control-plane node-role.kubernetes.io/control-plane:NoSchedule-\n</code></pre>\n<h4 id=\"12-containerd配置镜像加速\"><a class=\"anchor\" href=\"#12-containerd配置镜像加速\">#</a> 12. Containerd 配置镜像加速</h4>\n<pre><code># vim /etc/containerd/config.toml\n#添加以下配置镜像加速服务\n       [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;docker.io&quot;]\n        endpoint=[&quot;https://dockerproxy.com&quot;, &quot;https://mirror.baidubce.com&quot;,&quot;https://ccr.ccs.tencentyun.com&quot;,&quot;https://docker.m.daocloud.io&quot;,&quot;https://docker.nju.edu.cn&quot;,&quot;https://docker.mirrors.ustc.edu.cn&quot;,&quot;https://registry-1.docker.io&quot;, &quot;https://hbv0b596.mirror.aliyuncs.com&quot;]\n       [plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;registry.k8s.io&quot;]\n        endpoint=[&quot;https://dockerproxy.com&quot;, &quot;https://mirror.baidubce.com&quot;,&quot;https://ccr.ccs.tencentyun.com&quot;,&quot;https://docker.m.daocloud.io&quot;,&quot;https://docker.nju.edu.cn&quot;,&quot;https://docker.mirrors.ustc.edu.cn&quot;,&quot;https://hbv0b596.mirror.aliyuncs.com&quot;, &quot;https://k8s.m.daocloud.io&quot;, &quot;https://docker.mirrors.ustc.edu.cn&quot;,&quot;https://hub-mirror.c.163.com&quot;]\n</code></pre>\n<p>所有节点重新启动 Containerd：</p>\n<pre><code># systemctl daemon-reload\n# systemctl restart containerd\n</code></pre>\n<h4 id=\"13-docker配置镜像加速\"><a class=\"anchor\" href=\"#13-docker配置镜像加速\">#</a> 13. Docker 配置镜像加速</h4>\n<pre><code># sudo mkdir -p /etc/docker\n# sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'\n&#123;\n  &quot;registry-mirrors&quot;: [\n\t  &quot;https://docker.credclouds.com&quot;,\n\t  &quot;https://k8s.credclouds.com&quot;,\n\t  &quot;https://quay.credclouds.com&quot;,\n\t  &quot;https://gcr.credclouds.com&quot;,\n\t  &quot;https://k8s-gcr.credclouds.com&quot;,\n\t  &quot;https://ghcr.credclouds.com&quot;,\n\t  &quot;https://do.nark.eu.org&quot;,\n\t  &quot;https://docker.m.daocloud.io&quot;,\n\t  &quot;https://docker.nju.edu.cn&quot;,\n\t  &quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;,\n\t  &quot;https://docker.1panel.live&quot;,\n\t  &quot;https://docker.rainbond.cc&quot;\n  ], \n  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;] \n&#125;\nEOF\n</code></pre>\n<p>所有节点重新启动 Docker：</p>\n<pre><code># systemctl daemon-reload\n# systemctl enable --now docker\n</code></pre>\n<p><em>本文出自于：<a href=\"https://edu.51cto.com/course/23845.html\">https://edu.51cto.com/course/23845.html</a></em></p>\n",
            "tags": [
                "Kubernetes"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/1922841233.html",
            "url": "http://ixuyong.cn/posts/1922841233.html",
            "title": "Rsync服务实践",
            "date_published": "2025-03-30T12:45:48.000Z",
            "content_html": "<h3 id=\"ursync服务实践u\"><a class=\"anchor\" href=\"#ursync服务实践u\">#</a> <u>Rsync 服务实践</u></h3>\n<p><strong>环境准备</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">主机名</th>\n<th style=\"text-align:center\"><strong>IP</strong></th>\n<th><strong>角色</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">server</td>\n<td style=\"text-align:center\">192.168.40.101</td>\n<td>rsync 服务端</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">client</td>\n<td style=\"text-align:center\">192.168.40.102</td>\n<td>rsync 客户</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"1rsync服务端\"><a class=\"anchor\" href=\"#1rsync服务端\">#</a> 1.rsync 服务端</h4>\n<h5 id=\"11-关闭防火墙-selinux\"><a class=\"anchor\" href=\"#11-关闭防火墙-selinux\">#</a> 1.1 关闭防火墙、selinux</h5>\n<pre><code>[root@localhost ~]# hostnamectl set-hostname backup\n[root@localhost ~]# bash\n[root@backup ~]# hostnamectl set-hostname aizj_lb01\n[root@backup ~]# systemctl stop firewalld\n[root@backup ~]# systemctl disable firewalld\n[root@backup ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux\n[root@backup ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config\n[root@backup ~]# yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y\n[root@backup ~]# yum update -y --exclude=kernel* &amp;&amp; reboot\n[root@backup ~]# echo 'Asia/Shanghai' &gt;/etc/timezone\n[root@backup ~]# ntpdate time2.aliyun.com\n[root@backup ~]# crontab -e\n*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com &amp;&gt; /dev/nul\n[root@backup ~]# mkdir /soft /data /scripts /backup\n</code></pre>\n<h5 id=\"12-安装rsync\"><a class=\"anchor\" href=\"#12-安装rsync\">#</a> 1.2 安装 rsync</h5>\n<pre><code>[root@backup ~]# yum install -y rsync\n[root@server ~]# systemctl start rsyncd\n[root@server ~]# systemctl enable rsyncd\n[root@backup ~]# useradd -M -s /sbin/nologin rsync\n[root@backup ~]# mkdir -p /backup/mysql  /backup/file\n[root@backup ~]# chown -R rsync.rsync /backup/mysql /backup/file \n</code></pre>\n<h5 id=\"13-修改配置文件\"><a class=\"anchor\" href=\"#13-修改配置文件\">#</a> 1.3 修改配置文件</h5>\n<p><em><mark>#生产环境中取消注释，导致备份数据报错</mark></em></p>\n<pre><code>#带注释配置文件\n[root@backup ~]# vim /etc/rsyncd.conf\nuid = rsync             #运行服务的用户\ngid = rsync             #运行服务的组\nport = 873              #服务监听端口\nfake super = yes        #服务无需使用root用户身份，即可接收文件的完整属性\nuse chroot = no         #禁锢目录,不允许获取root权限\nmax connections = 200   #最大连接数,最多能有多少个客户端跟服务端的873端口建立连接\ntimeout = 600           #超时时间\nignore errors          #忽略错误\nread only = false      #客户是否只读\nlist = false           #不允许查看模块信息\nauth users = rsync_backup         #定义虚拟用户，用户数据传输\nsecrets file = /etc/rsync.passwd  #定义虚拟用户密码认证文件\nlog file = /var/log/rsyncd.log    #日志文件存放的位置\n[backup_mysql]         #模块名\ncomment = welcome to rsync_backup\npath = /backup/mysql   #数据存放目录\n[backup_file]          #模块名\ncomment = welcome to rsync_backup\npath = /backup/file    #数据存放目录 \n\n#不带注释配置文件\n[root@backup ~]# cat /etc/rsyncd.conf\nuid = rsync        \ngid = rsync         \nport = 873     \nfake super = yes     \nuse chroot = no        \nmax connections = 200  \ntimeout = 600         \nignore errors       \nread only = false    \nlist = false          \nauth users = rsync_backup        \nsecrets file = /etc/rsync.passwd\nlog file = /var/log/rsyncd.log    \n[backup_mysql]       \ncomment = welcome to rsync_backup\npath = /backup/mysql  \n[backup_file]         \ncomment = welcome to rsync_backup\npath = /backup/file \n</code></pre>\n<h5 id=\"4-创建虚拟用户密码文件并设置权限\"><a class=\"anchor\" href=\"#4-创建虚拟用户密码文件并设置权限\">#</a> 4. 创建虚拟用户密码文件并设置权限</h5>\n<pre><code>[root@backup ~]# cat /etc/rsync.passwd\nrsync_backup:your passwd\n[root@backup ~]# chmod 600 /etc/rsync.passwd\n[root@backup ~]# systemctl restart rsyncd &amp;&amp; systemctl status rsyncd\n</code></pre>\n<h5 id=\"5-检查服务端口是否开启\"><a class=\"anchor\" href=\"#5-检查服务端口是否开启\">#</a> 5. 检查服务端口是否开启</h5>\n<pre><code>[root@backup ~]# netstat -lntp | grep &quot;rsync&quot;\ntcp        0      0 0.0.0.0:873             0.0.0.0:*               LISTEN      20357/rsync         \ntcp6       0      0 :::873                  :::*                    LISTEN      20357/rsync \n</code></pre>\n<h4 id=\"2-rsync客户端\"><a class=\"anchor\" href=\"#2-rsync客户端\">#</a> 2. rsync 客户端</h4>\n<h5 id=\"21-安装rsync\"><a class=\"anchor\" href=\"#21-安装rsync\">#</a> 2.1 安装 rsync</h5>\n<pre><code>[root@db01 ~]# yum install nfs-utils -y\n</code></pre>\n<h5 id=\"22-配置传输密码\"><a class=\"anchor\" href=\"#22-配置传输密码\">#</a> 2.2 配置传输密码</h5>\n<p>方法 1：将密码写入文件</p>\n<pre><code>[root@db01 ~]#  echo 'your passwd' &gt; /etc/rsync.pass\n[root@db01 ~]# cat /etc/rsync.pass \nyour passwd\n[root@db01 ~]# chmod 600 /etc/rsync.pass\n--测试收发数据：\n[root@db01 ~]# rsync -avz --password-file=/etc/rsync.pass /root/test rsync_backup@192.168.40.101::backup_file\nsending incremental file list\n\nsent 47 bytes  received 20 bytes  134.00 bytes/sec\ntotal size is 0  speedup is 0.00\n</code></pre>\n<p>方法 2：使用密码环境变量 RSYNC_PASSWORD</p>\n<pre><code>[root@db01 ~]# export RSYNC_PASSWORD='your passwd'\n--测试收发数据：\n[root@db01 ~]# rsync -avz /root/test rsync_backup@192.168.40.101::backup_file\nsending incremental file list\n\nsent 47 bytes  received 20 bytes  134.00 bytes/sec\ntotal size is 0  speedup is 0.00\n</code></pre>\n<h3 id=\"ursync企业级备份案例u\"><a class=\"anchor\" href=\"#ursync企业级备份案例u\">#</a> <u>Rsync 企业级备份案例</u></h3>\n<p><strong>环境准备</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">主机名</th>\n<th style=\"text-align:center\"><strong>IP</strong></th>\n<th><strong>角色</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">server</td>\n<td style=\"text-align:center\">192.168.40.101</td>\n<td>rsync 服务端</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">client</td>\n<td style=\"text-align:center\">192.168.40.102</td>\n<td>rsync 客户</td>\n</tr>\n</tbody>\n</table>\n<p><strong>客户端需求</strong></p>\n<ul>\n<li>客户端每天凌晨 3 点备份 MySQL 至 /backup 下以 &quot;主机名_IP 地址_当前时间命名&quot; 的目录中</li>\n<li>客户端推送 /backup 目录下数据备份目录至 Rsync 备份服务器</li>\n<li>客户端只保留最近七天的备份数据，避免浪费磁盘空间</li>\n</ul>\n<p><strong>服务端需求</strong></p>\n<ul>\n<li>服务端部署 rsync 服务，用于接收用户的备份数据</li>\n<li>服务端每天校验客户端推送过来的数据是否完整，并将结果以邮件的方式发送给管理员</li>\n<li>服务端仅保留 6 个月的备份数据</li>\n</ul>\n<p><strong>注意</strong>：所有服务器的备份目录均为 /backup，所有脚本存放目录均为 /scripts。</p>\n<h4 id=\"1-服务端部署rsync服务\"><a class=\"anchor\" href=\"#1-服务端部署rsync服务\">#</a> <strong>1. 服务端部署 rsync 服务</strong></h4>\n<h5 id=\"11-关闭防火墙-selinux-2\"><a class=\"anchor\" href=\"#11-关闭防火墙-selinux-2\">#</a> 1.1 关闭防火墙、selinux</h5>\n<pre><code>[root@localhost ~]# hostnamectl set-hostname backup\n[root@localhost ~]# bash\n[root@backup ~]# hostnamectl set-hostname aizj_lb01\n[root@backup ~]# systemctl stop firewalld\n[root@backup ~]# systemctl disable firewalld\n[root@backup ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux\n[root@backup ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config\n[root@backup ~]# yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y\n[root@backup ~]# yum update -y --exclude=kernel* &amp;&amp; reboot\n[root@backup ~]# echo 'Asia/Shanghai' &gt;/etc/timezone\n[root@backup ~]# ntpdate time2.aliyun.com\n[root@backup ~]# crontab -e\n*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com &amp;&gt; /dev/nul\n[root@backup ~]# mkdir /soft /data /scripts /backup\n</code></pre>\n<h5 id=\"12-安装rsync-2\"><a class=\"anchor\" href=\"#12-安装rsync-2\">#</a> 1.2 安装 rsync</h5>\n<pre><code>[root@backup ~]# yum install -y rsync\n[root@server ~]# systemctl start rsyncd\n[root@server ~]# systemctl enable rsyncd\n[root@backup ~]# useradd -M -s /sbin/nologin rsync\n[root@backup ~]# mkdir -p /backup/mysql  /backup/file\n[root@backup ~]# chown -R rsync.rsync /backup/mysql /backup/file \n</code></pre>\n<h5 id=\"13-修改配置文件-2\"><a class=\"anchor\" href=\"#13-修改配置文件-2\">#</a> 1.3 修改配置文件</h5>\n<p><em><mark>#生产环境中取消注释，导致备份数据报错</mark></em></p>\n<pre><code>#带注释配置文件\n[root@backup ~]# vim /etc/rsyncd.conf\nuid = rsync             #运行服务的用户\ngid = rsync             #运行服务的组\nport = 873              #服务监听端口\nfake super = yes        #服务无需使用root用户身份，即可接收文件的完整属性\nuse chroot = no         #禁锢目录,不允许获取root权限\nmax connections = 200   #最大连接数,最多能有多少个客户端跟服务端的873端口建立连接\ntimeout = 600           #超时时间\nignore errors          #忽略错误\nread only = false      #客户是否只读\nlist = false           #不允许查看模块信息\nauth users = rsync_backup         #定义虚拟用户，用户数据传输\nsecrets file = /etc/rsync.passwd  #定义虚拟用户密码认证文件\nlog file = /var/log/rsyncd.log    #日志文件存放的位置\n[backup_mysql]         #模块名\ncomment = welcome to rsync_backup\npath = /backup/mysql   #数据存放目录\n[backup_file]          #模块名\ncomment = welcome to rsync_backup\npath = /backup/file    #数据存放目录 \n\n#不带注释配置文件\n[root@backup ~]# cat /etc/rsyncd.conf\nuid = rsync        \ngid = rsync         \nport = 873     \nfake super = yes     \nuse chroot = no        \nmax connections = 200  \ntimeout = 600         \nignore errors       \nread only = false    \nlist = false          \nauth users = rsync_backup        \nsecrets file = /etc/rsync.passwd\nlog file = /var/log/rsyncd.log    \n[backup_mysql]       \ncomment = welcome to rsync_backup\npath = /backup/mysql  \n[backup_file]         \ncomment = welcome to rsync_backup\npath = /backup/file \n</code></pre>\n<h5 id=\"4-创建虚拟用户密码文件并设置权限-2\"><a class=\"anchor\" href=\"#4-创建虚拟用户密码文件并设置权限-2\">#</a> 4. 创建虚拟用户密码文件并设置权限</h5>\n<pre><code>[root@backup ~]# cat /etc/rsync.passwd\nrsync_backup:your passwd\n[root@backup ~]# chmod 600 /etc/rsync.passwd\n[root@backup ~]# systemctl restart rsyncd &amp;&amp; systemctl status rsyncd\n</code></pre>\n<h5 id=\"5-检查服务端口是否开启-2\"><a class=\"anchor\" href=\"#5-检查服务端口是否开启-2\">#</a> 5. 检查服务端口是否开启</h5>\n<pre><code>[root@backup ~]# netstat -lntp | grep &quot;rsync&quot;\ntcp        0      0 0.0.0.0:873             0.0.0.0:*               LISTEN      20357/rsync         \ntcp6       0      0 :::873                  :::*                    LISTEN      20357/rsync \n</code></pre>\n<h4 id=\"2-rsync客户端-2\"><a class=\"anchor\" href=\"#2-rsync客户端-2\">#</a> 2. rsync 客户端</h4>\n<h5 id=\"21-安装rsync-2\"><a class=\"anchor\" href=\"#21-安装rsync-2\">#</a> 2.1 安装 rsync</h5>\n<pre><code>[root@db01 ~]# yum install nfs-utils -y\n</code></pre>\n<h5 id=\"22-测试客户端备份数据并推送至rsync服务器\"><a class=\"anchor\" href=\"#22-测试客户端备份数据并推送至rsync服务器\">#</a> 2.2 测试客户端备份数据并推送至 rsync 服务器</h5>\n<pre><code>[root@db01 ~]# export RSYNC_PASSWORD='your passwd'\n[root@db01 ~]# rsync -avz /root/test rsync_backup@192.168.40.101::backup_file\n</code></pre>\n<h5 id=\"23-客户端备份数据并推送至rsync服务器\"><a class=\"anchor\" href=\"#23-客户端备份数据并推送至rsync服务器\">#</a> <strong>2.3 客户端备份数据并推送至 rsync 服务器</strong></h5>\n<pre><code>[root@db01 ~]# mkdir /scripts\n[root@db01 ~]# cat /scripts/mysql_backup.sh \n#!/bin/bash\nexport PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin\n\n#1、定义变量\nHost=$(hostname)\nIp=$(ifconfig ens192 | awk 'NR==2&#123;print $2&#125;')\nDate=$(date +%F)\nBackupDir=/backup/mysql\nDest=$&#123;BackupDir&#125;/$&#123;Host&#125;_$&#123;Ip&#125;_$&#123;Date&#125;\nFILE_NAME=mysql_backup_`date '+%Y%m%d%H%M%S'`;\nOLDBINLOG=/var/lib/mysql/oldbinlog\n\n#2、创建备份目录\nif [ ! -d $Dest ];then\n  mkdir -p $Dest\nfi\n\n#3、备份目录\n/usr/bin/mysqldump -u'root' -p'your passwd' nf_flms &gt; $Dest/nf-flms_$&#123;FILE_NAME&#125;.sql\ntar -czvf $Dest/$&#123;FILE_NAME&#125;.tar.gz $Dest/nf-flms_$&#123;FILE_NAME&#125;.sql\nrm -rf $Dest/*$&#123;FILE_NAME&#125;.sql\necho &quot;Your database backup successfully&quot;\n\n#4、校验\nmd5sum $Dest/* &gt;$Dest/backup_check_$Date\n\n#5、将备份目录推动到rsync服务端\nRsync_Ip=192.168.1.145\nRsync_user=rsync_backup\nRsync_Module=backup_mysql\nexport RSYNC_PASSWORD=your passwd\nrsync -avz $Dest $Rsync_user@$Rsync_Ip::$Rsync_Module\n\n#6、删除15天备份目录\nfind $Dest -type d -mtime +15 | xargs rm -rf\necho &quot;remove file  successfully&quot;\n\n[root@db01 ~]# chmod +x /scripts/etc_backup.sh\n[root@db01 ~]# crontab -e\n00 03 * * * /bin/bash /scripts/mysql_backup.sh &amp;&gt; /dev/null\n</code></pre>\n<h5 id=\"24-服务端校验数据并将结果以邮件发送给管理员\"><a class=\"anchor\" href=\"#24-服务端校验数据并将结果以邮件发送给管理员\">#</a> <strong>2.4 服务端校验数据并将结果以邮件发送给管理员</strong></h5>\n<h6 id=\"241-配置邮件服务\"><a class=\"anchor\" href=\"#241-配置邮件服务\">#</a> 2.4.1 配置邮件服务</h6>\n<pre><code>[root@backup ~]# yum -y install mailx\n[root@backup ~]# cat /etc/mail.rc      #最后一行插入\nset from=373370405@qq.com\nset smtp=smtps://smtp.qq.com:465\nset smtp-auth-user=373370405@qq.com\nset smtp-auth-password=**********   # 发件邮箱的授权码\nset smtp-auth=login\nset ssl-verify=ignore\nset nss-config-dir=/etc/pki/nssdb\n</code></pre>\n<h6 id=\"242-发送邮件测试\"><a class=\"anchor\" href=\"#242-发送邮件测试\">#</a> 2.4.2 发送邮件测试</h6>\n<pre><code>[root@backup ~]#  echo Hello World | mail -s test 373370405@qq.com &amp;&gt; /dev/null\n</code></pre>\n<h6 id=\"243-配置脚本校验数据并将结果发送给管理员\"><a class=\"anchor\" href=\"#243-配置脚本校验数据并将结果发送给管理员\">#</a> 2.4.3 配置脚本校验数据并将结果发送给管理员</h6>\n<pre><code>[root@backup mysql]# cat /scripts/check_backup.sh \n#!/bin/bash\nexport PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin\n\n#1、定义变量\nPath=/backup/mysql\nDate=$(date +%F)\n\n#2、查看flag文件，并对对文件进行校验,然后将校验的结果保存至result_时间\nfind $Path -type f -name &quot;backup_check_$&#123;Date&#125;*&quot;|xargs md5sum -c &gt;$Path/result_$&#123;Date&#125;\n\n#3、将校验结果发送邮件给管理员\nmail -s &quot;Mysql Backup&quot; 373370405@qq.com &lt;$Path/result_$&#123;Date&#125; &amp;&gt; /dev/null\n\n#4、删除超过7天的校验结果文件，删除超过180天的备份数据文件\nfind $Path -type f -name &quot;result*&quot; -mtime +7 | xargs rm -rf\nfind $Path -type f -mtime +180 | xargs rm -rf\n</code></pre>\n<h6 id=\"244-写计划任务\"><a class=\"anchor\" href=\"#244-写计划任务\">#</a> <strong>2.4.4 写计划任务</strong></h6>\n<pre><code>[root@backup ~]# chmod +x /scripts/check_backup.sh \n[root@db01 ~]# crontab -e\n00 06 * * * /bin/bash /scripts/mysql_backup.sh &amp;&gt; /dev/null\n</code></pre>\n<h3 id=\"rsyncsersync实现数据实时同步\"><a class=\"anchor\" href=\"#rsyncsersync实现数据实时同步\">#</a> Rsync+sersync 实现数据实时同步</h3>\n<p><strong>环境准备</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">主机名</th>\n<th style=\"text-align:center\"><strong>IP</strong></th>\n<th><strong>角色</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">server</td>\n<td style=\"text-align:center\">192.168.40.101</td>\n<td>rsync 服务端</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">client</td>\n<td style=\"text-align:center\">192.168.40.102</td>\n<td>rsync 客户</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"1rsync服务端-2\"><a class=\"anchor\" href=\"#1rsync服务端-2\">#</a> 1.rsync 服务端</h4>\n<h5 id=\"11-关闭防火墙-selinux-3\"><a class=\"anchor\" href=\"#11-关闭防火墙-selinux-3\">#</a> 1.1 关闭防火墙、selinux</h5>\n<pre><code>[root@localhost ~]# hostnamectl set-hostname backup\n[root@localhost ~]# bash\n[root@backup ~]# hostnamectl set-hostname aizj_lb01\n[root@backup ~]# systemctl stop firewalld\n[root@backup ~]# systemctl disable firewalld\n[root@backup ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux\n[root@backup ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config\n[root@backup ~]# yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y\n[root@backup ~]# yum update -y --exclude=kernel* &amp;&amp; reboot\n[root@backup ~]# echo 'Asia/Shanghai' &gt;/etc/timezone\n[root@backup ~]# ntpdate time2.aliyun.com\n[root@backup ~]# crontab -e\n*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com &amp;&gt; /dev/nul\n[root@backup ~]# mkdir /soft /data /scripts /backup\n</code></pre>\n<h5 id=\"12-安装rsync-3\"><a class=\"anchor\" href=\"#12-安装rsync-3\">#</a> 1.2 安装 rsync</h5>\n<pre><code>[root@backup ~]# yum install -y rsync\n[root@server ~]# systemctl start rsyncd\n[root@server ~]# systemctl enable rsyncd\n[root@backup ~]# useradd -M -s /sbin/nologin rsync\n[root@backup ~]# mkdir -p /backup/mysql  /backup/file\n[root@backup ~]# chown -R rsync.rsync /backup/mysql /backup/file \n</code></pre>\n<h5 id=\"13-修改配置文件-3\"><a class=\"anchor\" href=\"#13-修改配置文件-3\">#</a> 1.3 修改配置文件</h5>\n<p><em><mark>#生产环境中取消注释，导致备份数据报错</mark></em></p>\n<pre><code>#带注释配置文件\n[root@backup ~]# vim /etc/rsyncd.conf\nuid = rsync             #运行服务的用户\ngid = rsync             #运行服务的组\nport = 873              #服务监听端口\nfake super = yes        #服务无需使用root用户身份，即可接收文件的完整属性\nuse chroot = no         #禁锢目录,不允许获取root权限\nmax connections = 200   #最大连接数,最多能有多少个客户端跟服务端的873端口建立连接\ntimeout = 600           #超时时间\nignore errors          #忽略错误\nread only = false      #客户是否只读\nlist = false           #不允许查看模块信息\nauth users = rsync_backup         #定义虚拟用户，用户数据传输\nsecrets file = /etc/rsync.passwd  #定义虚拟用户密码认证文件\nlog file = /var/log/rsyncd.log    #日志文件存放的位置\n[backup_mysql]         #模块名\ncomment = welcome to rsync_backup\npath = /backup/mysql   #数据存放目录\n[backup_file]          #模块名\ncomment = welcome to rsync_backup\npath = /backup/file    #数据存放目录 \n\n#不带注释配置文件\n[root@backup ~]# cat /etc/rsyncd.conf\nuid = rsync        \ngid = rsync         \nport = 873     \nfake super = yes     \nuse chroot = no        \nmax connections = 200  \ntimeout = 600         \nignore errors       \nread only = false    \nlist = false          \nauth users = rsync_backup        \nsecrets file = /etc/rsync.passwd\nlog file = /var/log/rsyncd.log    \n[backup_mysql]       \ncomment = welcome to rsync_backup\npath = /backup/mysql  \n[backup_file]         \ncomment = welcome to rsync_backup\npath = /backup/file \n</code></pre>\n<h5 id=\"4-创建虚拟用户密码文件并设置权限-3\"><a class=\"anchor\" href=\"#4-创建虚拟用户密码文件并设置权限-3\">#</a> 4. 创建虚拟用户密码文件并设置权限</h5>\n<pre><code>[root@backup ~]# cat /etc/rsync.passwd\nrsync_backup:your passwd\n[root@backup ~]# chmod 600 /etc/rsync.passwd\n[root@backup ~]# systemctl restart rsyncd &amp;&amp; systemctl status rsyncd\n</code></pre>\n<h5 id=\"5-检查服务端口是否开启-3\"><a class=\"anchor\" href=\"#5-检查服务端口是否开启-3\">#</a> 5. 检查服务端口是否开启</h5>\n<pre><code>[root@backup ~]# netstat -lntp | grep &quot;rsync&quot;\ntcp        0      0 0.0.0.0:873             0.0.0.0:*               LISTEN      20357/rsync         \ntcp6       0      0 :::873                  :::*                    LISTEN      20357/rsync \n</code></pre>\n<h4 id=\"2-客户端安装sersync\"><a class=\"anchor\" href=\"#2-客户端安装sersync\">#</a> 2. 客户端安装 sersync</h4>\n<p><strong>2.1 安装 sercync 依赖</strong></p>\n<pre><code>[root@nfs ~]# yum install -y inotify-tools rsync\n</code></pre>\n<p><strong>2.2 安装 sercync</strong></p>\n<pre><code>[root@nfs ~]# mkdir -p /soft\n[root@nfs ~]# cd /soft/\n[root@nfs ~]# wget https://down.whsir.com/downloads/sersync2.5.4_64bit_binary_stable_final.tar.gz\n[root@nfs soft]# tar -xf sersync2.5.4_64bit_binary_stable_final.tar.gz\n[root@nfs soft]# mv GNU-Linux-x86 /usr/local/sersync\n</code></pre>\n<h5 id=\"23-修改配置文件\"><a class=\"anchor\" href=\"#23-修改配置文件\">#</a> 2.3 <strong>修改配置文件</strong></h5>\n<pre><code>[root@nfs soft]# cd /usr/local/sersync/\n[root@nfs sersync]# cp confxml.xml confxml.xml.bak\n[root@nfs sersync]# vim confxml.xml\n...\n5    &lt;fileSystem xfs=&quot;true&quot;/&gt;    #第5行 false改为true\n13          &lt;delete start=&quot;true&quot;/&gt; #第13-20行 false改为true,#说明：监控以上变化推送\n14        &lt;createFolder start=&quot;true&quot;/&gt;\n15        &lt;createFile start=&quot;false&quot;/&gt;\n16        &lt;closeWrite start=&quot;true&quot;/&gt;\n17        &lt;moveFrom start=&quot;true&quot;/&gt;\n18        &lt;moveTo start=&quot;true&quot;/&gt;\n19        &lt;attrib start=&quot;true&quot;/&gt;\n20        &lt;modify start=&quot;true&quot;/&gt;\n24        &lt;localpath watch=&quot;/data&quot;&gt;      #监控的本地目录\n25             &lt;remote ip=&quot;192.168.1.145&quot; name=&quot;backup_file&quot;/&gt;  #rsync服务端IP和模块名backup_file\n30      &lt;commonParams params=&quot;-avz&quot;/&gt;  #rsync命令选项\n31      &lt;auth start=&quot;true&quot; users=&quot;rsync_backup&quot; passwordfile=&quot;/etc/rsync.passwd&quot;/&gt; #rsync认证信息\n...\n</code></pre>\n<h5 id=\"24-生成密码文件\"><a class=\"anchor\" href=\"#24-生成密码文件\">#</a> 2.4 生成密码文件</h5>\n<pre><code>[root@nfs sersync]# echo 'your passwd' &gt; /etc/rsync.passwd\n[root@nfs sersync]# chmod 600 /etc/rsync.passwd\n</code></pre>\n<h5 id=\"25-启动sersync\"><a class=\"anchor\" href=\"#25-启动sersync\">#</a> 2.5 启动 sersync</h5>\n<pre><code>[root@nfs sersync]# ln -s /usr/local/sersync/sersync2 /usr/bin/\n[root@nfs sersync]# sersync2 -dro /usr/local/sersync/confxml.xml     #针对配置文件confxml.xml启动sersync\n</code></pre>\n<p><strong>2.5 设置 sersync 开机自启</strong></p>\n<pre><code>[root@qzj_nfs sersync]# vim /etc/rc.d/rc.local   \n/usr/local/sersync/sersync2 -d -r -o  /usr/local/sersync/confxml.xml  #在最后添加一行\n[root@qzj_nfs sersync]# chmod +x /etc/rc.d/rc.local\n</code></pre>\n<p><strong>2.6 测试</strong></p>\n<p><em>在客户端 /data 目录增删改目录文件，rsync 服务端数据存放目录变化</em></p>\n<pre><code>[root@backup backup]# watch ls\n</code></pre>\n<p><strong>2.7 添加脚本监控 sersync 是否正常运行</strong></p>\n<pre><code>[root@nfs sersync]# cat /scripts/check_sersync.sh \n#!/bin/sh\nsersync=&quot;/usr/local/sersync/sersync2&quot;\nconfxml=&quot;/usr/local/sersync/confxml.xml&quot;\nstatus=$(ps aux |grep 'sersync2'|grep -v 'grep'|wc -l)\nif [ $status -eq 0 ];\nthen\n$sersync -d -r -o $confxml &amp;\nelse\nexit 0;\nfi\n\n[root@nfs sersync]# chmod +x /scripts/check_sersync.sh\n[root@nfs sersync]# crontab -l\n*/5 * * * * /usr/bin/sh /scripts/check_sersync.sh &amp;&gt; /dev/null\n</code></pre>\n<p><em><strong>补充： 多实例情况</strong></em><br />\n 1、配置多个 confxml.xml 文件（比如：www、bbs、blog.... 等等）<br />\n2、修改端口、同步路径、模块名称<br />\n 3、根据不同的需求同步对应的实例文件<br />\n /usr/local/sersync/sersync2 -dro /usr/local/sersync/www_confxml.xml<br />\n/usr/local/sersync/sersync2 -dro /usr/local/sersync/bbs_confxml.xml</p>\n",
            "tags": [
                "rsync"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/3071070978.html",
            "url": "http://ixuyong.cn/posts/3071070978.html",
            "title": "企业级私有仓库Harbor搭建",
            "date_published": "2025-03-30T08:17:00.000Z",
            "content_html": "<h3 id=\"企业级私有仓库harbor\"><a class=\"anchor\" href=\"#企业级私有仓库harbor\">#</a> 企业级私有仓库 Harbor</h3>\n<p>企业部署 Kuberetes 集群环境之后，我们就可以将原来在传统虚拟机上运行的业务，迁移到 kubernetes 上，让 Kubernetes 通过容器的方式来管理。而一旦我们需要将传统业务使用容器的方式运行起来，就需要构建很多镜像，那么这些镜像就需要有一个专门的位置存储起来，为我们提供镜像上传和镜像下载等功能。但我们不能使用阿里云或者 Dockerhub 等仓库，首先拉取速度比较慢，其次镜像的安全性无法保证，所以就需要部署一个私有的镜像仓库来管理这些容器镜像。同时该仓库还需要提供高可用功能，确保随时都能上传和下载可用的容器镜像。</p>\n<h4 id=\"1-关闭防火墙-selinux-环境配置\"><a class=\"anchor\" href=\"#1-关闭防火墙-selinux-环境配置\">#</a> 1、关闭防火墙、Selinux、环境配置</h4>\n<pre><code>[root@harbor ~]# sudo mkdir -p /etc/docker\n[root@harbor ~]# hostnamectl set-hostname harbor\n[root@harbor ~]# systemctl stop firewalld\n[root@harbor ~]# systemctl disable firewalld\n[root@harbor ~]# sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux\n[root@harbor ~]# yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate -y\n[root@harbor ~]# yum update -y\n[root@harbor ~]# mkdir /soft /data /scripts /backup\n</code></pre>\n<h4 id=\"2-docker安装\"><a class=\"anchor\" href=\"#2-docker安装\">#</a> 2、Docker 安装</h4>\n<pre><code>[root@harbor ~]# yum install -y yum-utils device-mapper-persistent-data lvm2\n[root@harbor ~]# curl -o /etc/yum.repos.d/docker-ce.repo  https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n[root@harbor ~]# yum list docker-ce --showduplicates |sort -r \n[root@harbor ~]# yum install docker-ce docker-compose -y\n</code></pre>\n<h4 id=\"3-配置docker加速\"><a class=\"anchor\" href=\"#3-配置docker加速\">#</a> 3、配置 Docker 加速</h4>\n<pre><code>[root@harbor ~]# sudo mkdir -p /etc/docker\n[root@harbor ~]# sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'\n&#123;\n  &quot;registry-mirrors&quot;: [\n\t  &quot;https://docker.credclouds.com&quot;,\n\t  &quot;https://k8s.credclouds.com&quot;,\n\t  &quot;https://quay.credclouds.com&quot;,\n\t  &quot;https://gcr.credclouds.com&quot;,\n\t  &quot;https://k8s-gcr.credclouds.com&quot;,\n\t  &quot;https://ghcr.credclouds.com&quot;,\n\t  &quot;https://do.nark.eu.org&quot;,\n\t  &quot;https://docker.m.daocloud.io&quot;,\n\t  &quot;https://docker.nju.edu.cn&quot;,\n\t  &quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;,\n\t  &quot;https://docker.1panel.live&quot;,\n\t  &quot;https://docker.rainbond.cc&quot;\n  ], \n  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;] \n&#125;\nEOF\n[root@harbor ~]# systemctl enable docker --now\n</code></pre>\n<h4 id=\"4-安装harbor\"><a class=\"anchor\" href=\"#4-安装harbor\">#</a> 4、安装 Harbor</h4>\n<pre><code>[root@harbor ~]# cd /soft/\n[root@harbor ~]# wget https://github.com/goharbor/harbor/releases/download/v2.6.1/harbor-offline-installer-v2.6.1.tgz\n[root@harbor soft]# tar xf harbor-offline-installer-v2.6.1.tgz\n[root@harbor soft]# cd harbor\n[root@harbor harbor]# vim harbor.yml\nhostname: 192.168.1.134\n...\n#https:\n#  # https port for harbor, default is 443\n#  port: 443\n#  # The path of cert and key files for nginx\n#  certificate: /your/certificate/path\n#  private_key: /your/private/key/path\n...\nharbor_admin_password: Harbor12345\n[root@harbor harbor]#  ./install.sh\n</code></pre>\n<h4 id=\"5-配置nginx负载均衡调度\"><a class=\"anchor\" href=\"#5-配置nginx负载均衡调度\">#</a> 5、配置 Nginx 负载均衡调度</h4>\n<pre><code>[root@lb ~]# vim s.hmallleasing.com.conf\nserver &#123;\n    listen 443 ssl;\n    server_name harbor.hmallleasing.com;\n    client_max_body_size 1G; \n    ssl_prefer_server_ciphers on;\n    ssl_certificate  /etc/nginx/sslkey/_.hmallleasing.com_chain.crt;\n    ssl_certificate_key  /etc/nginx/sslkey/_.hmallleasing.com_key.key;\n    location / &#123;\n        proxy_pass http://192.168.1.134;\n#      include proxy_params;\n#        proxy_set_header Host $http_host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        \n        proxy_connect_timeout 30;\n        proxy_send_timeout 60;\n        proxy_read_timeout 60;\n        \n        proxy_buffering on;\n        proxy_buffer_size 32k;\n        proxy_buffers 4 128k;\n        proxy_temp_file_write_size 10240k;\t\t\n        proxy_max_temp_file_size 10240k;\n    &#125;\n&#125;\n\nserver &#123;\n    listen 80;\n    server_name s.hmallleasing.com;\n    return 302 https://$server_name$request_uri;\n&#125;\n</code></pre>\n<h4 id=\"6-推送镜像至harbor\"><a class=\"anchor\" href=\"#6-推送镜像至harbor\">#</a> 6、推送镜像至 Harbor</h4>\n<pre><code>[root@harbor harbor]# docker tag beae173ccac6 harbor.hmallleasing.com/ops/busybox.v1\n[root@harbor harbor]# docker push harbor.hmallleasing.com/ops/busybox.v1\n[root@harbor harbor]# docker login harbor.hmallleasing.com\n[root@harbor harbor]# docker push harbor.hmallleasing.com/ops/busybox.v1\n</code></pre>\n<h4 id=\"7-harbor停止与启动\"><a class=\"anchor\" href=\"#7-harbor停止与启动\">#</a> 7、Harbor 停止与启动</h4>\n<pre><code>#停用Harbor\n[root@harbor harbor]# pwd\n/soft/harbor\n[root@harbor harbor]# docker-compose stop\n #启动Harbor\n[root@harbor harbor]# docker-compose up -d\n[root@harbor harbor]# docker-compose start\n</code></pre>\n",
            "tags": [
                "Harbor"
            ]
        }
    ]
}