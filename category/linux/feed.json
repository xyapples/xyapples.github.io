{
    "version": "https://jsonfeed.org/version/1",
    "title": "LinuxSre云原生 • All posts by \"linux\" category",
    "description": "专注于 Linux 运维、云计算、云原⽣等技术",
    "home_page_url": "http://ixuyong.cn",
    "items": [
        {
            "id": "http://ixuyong.cn/posts/269104229.html",
            "url": "http://ixuyong.cn/posts/269104229.html",
            "title": "Samba服务实践",
            "date_published": "2025-06-20T14:12:07.000Z",
            "content_html": "<h3 id=\"samba服务实践\"><a class=\"anchor\" href=\"#samba服务实践\">#</a> Samba 服务实践</h3>\n",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/2889248111.html",
            "url": "http://ixuyong.cn/posts/2889248111.html",
            "title": "Vsftp服务实践",
            "date_published": "2025-06-20T14:12:00.000Z",
            "content_html": "<h3 id=\"vsftp服务实践\"><a class=\"anchor\" href=\"#vsftp服务实践\">#</a> Vsftp 服务实践</h3>\n",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/581151773.html",
            "url": "http://ixuyong.cn/posts/581151773.html",
            "title": "100个运维相关技术官网汇总",
            "date_published": "2025-06-19T13:16:37.000Z",
            "content_html": "<h3 id=\"100个运维相关技术官网大汇总\"><a class=\"anchor\" href=\"#100个运维相关技术官网大汇总\">#</a> 100 个运维相关技术官网大汇总</h3>\n<h4 id=\"1-操作系统官网\"><a class=\"anchor\" href=\"#1-操作系统官网\">#</a> <strong>1. 操作系统官网</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Ubuntu</td>\n<td style=\"text-align:left\"><a href=\"https://ubuntu.com\">https://ubuntu.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Debian</td>\n<td style=\"text-align:left\"><a href=\"https://www.debian.org\">https://www.debian.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">RHEL</td>\n<td style=\"text-align:left\"><a href=\"https://www.redhat.com\">https://www.redhat.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Rocky Linux</td>\n<td style=\"text-align:left\"><a href=\"https://rockylinux.org\">https://rockylinux.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">AlmaLinux</td>\n<td style=\"text-align:left\"><a href=\"https://almalinux.org\">https://almalinux.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Arch Wiki</td>\n<td style=\"text-align:left\"><a href=\"https://wiki.archlinux.org\">https://wiki.archlinux.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">麒麟系统</td>\n<td style=\"text-align:left\"><a href=\"https://www.kylinos.cn/\">https://www.kylinos.cn/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">统信系统</td>\n<td style=\"text-align:left\"><a href=\"https://uniontech.com/\">https://uniontech.com/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">openEuler</td>\n<td style=\"text-align:left\"><a href=\"https://www.openeuler.org/zh/\">https://www.openeuler.org/zh/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">正版操作系统</td>\n<td style=\"text-align:left\"><a href=\"https://msdn.itellyou.cn/\">https://msdn.itellyou.cn/</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"2-开源镜像站\"><a class=\"anchor\" href=\"#2-开源镜像站\">#</a> <strong>2. 开源镜像站</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">镜像源名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">清华大学镜像站</td>\n<td style=\"text-align:left\"><a href=\"https://mirrors.tuna.tsinghua.edu.cn\">https://mirrors.tuna.tsinghua.edu.cn</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">中科大镜像站</td>\n<td style=\"text-align:left\"><a href=\"https://mirrors.ustc.edu.cn\">https://mirrors.ustc.edu.cn</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">阿里云镜像站</td>\n<td style=\"text-align:left\"><a href=\"https://developer.aliyun.com/mirror\">https://developer.aliyun.com/mirror</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">华为云镜像站</td>\n<td style=\"text-align:left\"><a href=\"https://mirrors.huaweicloud.com\">https://mirrors.huaweicloud.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">中国科技网镜像</td>\n<td style=\"text-align:left\"><a href=\"https://mirrors.cstcloud.cn\">https://mirrors.cstcloud.cn</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">网易开源镜像站</td>\n<td style=\"text-align:left\"><a href=\"http://mirrors.163.com\">http://mirrors.163.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">腾讯云镜像站</td>\n<td style=\"text-align:left\"><a href=\"https://mirrors.cloud.tencent.com\">https://mirrors.cloud.tencent.com</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"3-容器与-kubernetes\"><a class=\"anchor\" href=\"#3-容器与-kubernetes\">#</a> <strong>3. 容器与 Kubernetes</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Docker</td>\n<td style=\"text-align:left\"><a href=\"https://www.docker.com\">https://www.docker.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Kubernetes</td>\n<td style=\"text-align:left\"><a href=\"https://kubernetes.io\">https://kubernetes.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Helm</td>\n<td style=\"text-align:left\"><a href=\"https://helm.sh\">https://helm.sh</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Podman</td>\n<td style=\"text-align:left\"><a href=\"https://podman.io\">https://podman.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">containerd</td>\n<td style=\"text-align:left\"><a href=\"https://containerd.io\">https://containerd.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">K3s</td>\n<td style=\"text-align:left\"><a href=\"https://k3s.io\">https://k3s.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Rancher</td>\n<td style=\"text-align:left\"><a href=\"https://www.rancher.com/\">https://www.rancher.com/</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"4-云平台\"><a class=\"anchor\" href=\"#4-云平台\">#</a> <strong>4. 云平台</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">AWS</td>\n<td style=\"text-align:left\"><a href=\"https://aws.amazon.com\">https://aws.amazon.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Azure</td>\n<td style=\"text-align:left\"><a href=\"https://azure.microsoft.com\">https://azure.microsoft.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">阿里云</td>\n<td style=\"text-align:left\"><a href=\"https://www.aliyun.com\">https://www.aliyun.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">腾讯云</td>\n<td style=\"text-align:left\"><a href=\"https://cloud.tencent.com\">https://cloud.tencent.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">华为云</td>\n<td style=\"text-align:left\"><a href=\"https://www.huaweicloud.com\">https://www.huaweicloud.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">天翼云</td>\n<td style=\"text-align:left\"><a href=\"https://www.ctyun.cn/\">https://www.ctyun.cn/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">OpenStack</td>\n<td style=\"text-align:left\"><a href=\"https://www.openstack.org\">https://www.openstack.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CNCF Landscape</td>\n<td style=\"text-align:left\"><a href=\"https://landscape.cncf.io\">https://landscape.cncf.io</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"5-数据库\"><a class=\"anchor\" href=\"#5-数据库\">#</a> <strong>5. 数据库</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">MySQL</td>\n<td style=\"text-align:left\"><a href=\"https://www.mysql.com\">https://www.mysql.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Oracle</td>\n<td style=\"text-align:left\"><a href=\"https://www.oracle.com/\">https://www.oracle.com/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PostgreSQL</td>\n<td style=\"text-align:left\"><a href=\"https://www.postgresql.org\">https://www.postgresql.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">MariaDB</td>\n<td style=\"text-align:left\"><a href=\"https://mariadb.org\">https://mariadb.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">MongoDB</td>\n<td style=\"text-align:left\"><a href=\"https://www.mongodb.com\">https://www.mongodb.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Redis</td>\n<td style=\"text-align:left\"><a href=\"https://redis.io\">https://redis.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Memcached</td>\n<td style=\"text-align:left\"><a href=\"https://memcached.org\">https://memcached.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">达梦数据库</td>\n<td style=\"text-align:left\"><a href=\"https://www.dameng.com/\">https://www.dameng.com/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">OceanBase</td>\n<td style=\"text-align:left\"><a href=\"https://www.oceanbase.com/\">https://www.oceanbase.com/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Elasticsearch</td>\n<td style=\"text-align:left\"><a href=\"https://www.elastic.co/elasticsearch/\">https://www.elastic.co/elasticsearch/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ClickHouse</td>\n<td style=\"text-align:left\"><a href=\"https://clickhouse.com\">https://clickhouse.com</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"6-基础服务\"><a class=\"anchor\" href=\"#6-基础服务\">#</a> <strong>6. 基础服务</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Nginx</td>\n<td style=\"text-align:left\"><a href=\"https://nginx.org\">https://nginx.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Apache HTTPD</td>\n<td style=\"text-align:left\"><a href=\"https://httpd.apache.org\">https://httpd.apache.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Tomcat</td>\n<td style=\"text-align:left\"><a href=\"https://tomcat.apache.org/\">https://tomcat.apache.org/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">HAProxy</td>\n<td style=\"text-align:left\"><a href=\"https://www.haproxy.org\">https://www.haproxy.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Dnsmasq</td>\n<td style=\"text-align:left\"><a href=\"https://thekelleys.org.uk/dnsmasq/doc.html\">https://thekelleys.org.uk/dnsmasq/doc.html</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CoreDNS</td>\n<td style=\"text-align:left\"><a href=\"https://coredns.io\">https://coredns.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">RabbitMQ</td>\n<td style=\"text-align:left\"><a href=\"https://www.rabbitmq.com\">https://www.rabbitmq.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Kafka</td>\n<td style=\"text-align:left\"><a href=\"https://kafka.apache.org\">https://kafka.apache.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Etcd</td>\n<td style=\"text-align:left\"><a href=\"https://etcd.io\">https://etcd.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Consul</td>\n<td style=\"text-align:left\"><a href=\"https://www.consul.io\">https://www.consul.io</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"7-cicd-与服务网格\"><a class=\"anchor\" href=\"#7-cicd-与服务网格\">#</a> <strong>7. CI/CD 与服务网格</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Jenkins</td>\n<td style=\"text-align:left\"><a href=\"https://www.jenkins.io\">https://www.jenkins.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">GitLab CI/CD</td>\n<td style=\"text-align:left\"><a href=\"https://about.gitlab.com\">https://about.gitlab.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">GitHub Actions</td>\n<td style=\"text-align:left\"><a href=\"https://github.com/features/actions\">https://github.com/features/actions</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ArgoCD</td>\n<td style=\"text-align:left\"><a href=\"https://argo-cd.readthedocs.io/\">https://argo-cd.readthedocs.io/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Spinnaker</td>\n<td style=\"text-align:left\"><a href=\"https://spinnaker.io\">https://spinnaker.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Istio</td>\n<td style=\"text-align:left\"><a href=\"https://istio.io/\">https://istio.io/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Envoy Proxy</td>\n<td style=\"text-align:left\"><a href=\"https://www.envoyproxy.io\">https://www.envoyproxy.io</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"8-监控与日志系统\"><a class=\"anchor\" href=\"#8-监控与日志系统\">#</a> <strong>8. 监控与日志系统</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Prometheus</td>\n<td style=\"text-align:left\"><a href=\"https://prometheus.io\">https://prometheus.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Grafana</td>\n<td style=\"text-align:left\"><a href=\"https://grafana.com\">https://grafana.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Loki</td>\n<td style=\"text-align:left\"><a href=\"https://grafana.com/oss/loki/\">https://grafana.com/oss/loki/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ELK Stack</td>\n<td style=\"text-align:left\"><a href=\"https://www.elastic.co/what-is/elk-stack\">https://www.elastic.co/what-is/elk-stack</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Kibana</td>\n<td style=\"text-align:left\"><a href=\"https://www.elastic.co/kibana/\">https://www.elastic.co/kibana/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Fluentd</td>\n<td style=\"text-align:left\"><a href=\"https://www.fluentd.org\">https://www.fluentd.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Zabbix</td>\n<td style=\"text-align:left\"><a href=\"https://www.zabbix.com\">https://www.zabbix.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Netdata</td>\n<td style=\"text-align:left\"><a href=\"https://www.netdata.cloud\">https://www.netdata.cloud</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"9-自动化运维工具\"><a class=\"anchor\" href=\"#9-自动化运维工具\">#</a> <strong>9. 自动化运维工具</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Ansible</td>\n<td style=\"text-align:left\"><a href=\"https://docs.ansible.com/\">https://docs.ansible.com/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Terraform</td>\n<td style=\"text-align:left\"><a href=\"https://developer.hashicorp.com/terraform/docs\">https://developer.hashicorp.com/terraform/docs</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SaltStack</td>\n<td style=\"text-align:left\"><a href=\"https://docs.saltproject.io/\">https://docs.saltproject.io/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Puppet</td>\n<td style=\"text-align:left\"><a href=\"https://puppet.com/docs/\">https://puppet.com/docs/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Chef</td>\n<td style=\"text-align:left\"><a href=\"https://docs.chef.io/\">https://docs.chef.io/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Packer</td>\n<td style=\"text-align:left\"><a href=\"https://developer.hashicorp.com/packer/docs\">https://developer.hashicorp.com/packer/docs</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"10-运维常用工具\"><a class=\"anchor\" href=\"#10-运维常用工具\">#</a> <strong>10. 运维常用工具</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">工具名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Xshell</td>\n<td style=\"text-align:left\"><a href=\"https://www.netsarang.com/zh/xshell/\">https://www.netsarang.com/zh/xshell/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Xftp</td>\n<td style=\"text-align:left\"><a href=\"https://www.netsarang.com/en/xftp/\">https://www.netsarang.com/en/xftp/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">MobaXterm</td>\n<td style=\"text-align:left\"><a href=\"https://mobaxterm.mobatek.net\">https://mobaxterm.mobatek.net</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PuTTY</td>\n<td style=\"text-align:left\"><a href=\"https://www.putty.org\">https://www.putty.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SecureCRT</td>\n<td style=\"text-align:left\"><a href=\"https://www.vandyke.com/products/securecrt/\">https://www.vandyke.com/products/securecrt/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">WinSCP</td>\n<td style=\"text-align:left\"><a href=\"https://winscp.net\">https://winscp.net</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">FileZilla</td>\n<td style=\"text-align:left\"><a href=\"https://filezilla-project.org\">https://filezilla-project.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">FastCopy</td>\n<td style=\"text-align:left\"><a href=\"https://fastcopy.jp/en/\">https://fastcopy.jp/en/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Everything</td>\n<td style=\"text-align:left\"><a href=\"https://www.voidtools.com\">https://www.voidtools.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Wireshark</td>\n<td style=\"text-align:left\"><a href=\"https://www.wireshark.org\">https://www.wireshark.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">VirtualBox</td>\n<td style=\"text-align:left\"><a href=\"https://www.virtualbox.org/\">https://www.virtualbox.org/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">VMware Workstation</td>\n<td style=\"text-align:left\"><a href=\"https://www.vmware.com/products/workstation-pro.html\">https://www.vmware.com/products/workstation-pro.html</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"11-数据库可视化连接工具\"><a class=\"anchor\" href=\"#11-数据库可视化连接工具\">#</a> <strong>11. 数据库可视化连接工具</strong></h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">工具名称</th>\n<th style=\"text-align:left\">官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">DBeaver</td>\n<td style=\"text-align:left\"><a href=\"https://dbeaver.io\">https://dbeaver.io</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Navicat</td>\n<td style=\"text-align:left\"><a href=\"https://www.navicat.com\">https://www.navicat.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">HeidiSQL</td>\n<td style=\"text-align:left\"><a href=\"https://www.heidisql.com\">https://www.heidisql.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SSMS</td>\n<td style=\"text-align:left\"><a href=\"https://learn.microsoft.com/sql/ssms/\">https://learn.microsoft.com/sql/ssms/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Toad for Oracle</td>\n<td style=\"text-align:left\"><a href=\"https://www.toadworld.com/products/toad-for-oracle\">https://www.toadworld.com/products/toad-for-oracle</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SQL Developer</td>\n<td style=\"text-align:left\"><a href=\"https://www.oracle.com/database/sqldeveloper/\">https://www.oracle.com/database/sqldeveloper/</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">DbVisualizer</td>\n<td style=\"text-align:left\"><a href=\"https://www.dbvis.com\">https://www.dbvis.com</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SQL Workbench</td>\n<td style=\"text-align:left\"><a href=\"https://www.sql-workbench.eu\">https://www.sql-workbench.eu</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">phpMyAdmin</td>\n<td style=\"text-align:left\"><a href=\"https://www.phpmyadmin.net\">https://www.phpmyadmin.net</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">pgAdmin</td>\n<td style=\"text-align:left\"><a href=\"https://www.pgadmin.org\">https://www.pgadmin.org</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">MongoDB Compass</td>\n<td style=\"text-align:left\"><a href=\"https://www.mongodb.com/products/compass\">https://www.mongodb.com/products/compass</a></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">RedisInsight</td>\n<td style=\"text-align:left\"><a href=\"https://redis.com/redis-enterprise/redis-insight/\">https://redis.com/redis-enterprise/redis-insight/</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"12-实用工具\"><a class=\"anchor\" href=\"#12-实用工具\">#</a> 12. 实用工具</h4>\n<table>\n<thead>\n<tr>\n<th>工具名称</th>\n<th>官网链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>图床工具</td>\n<td><a href=\"https://wp-cdn.4ce.cn/\">https://wp-cdn.4ce.cn/</a></td>\n</tr>\n<tr>\n<td>科学上网</td>\n<td><a href=\"https://ikuuu.one/auth/register\">https://ikuuu.one/auth/register</a></td>\n</tr>\n<tr>\n<td>截图工具</td>\n<td><a href=\"https://pixpin.cn/\">https://pixpin.cn/</a></td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/2260957686.html",
            "url": "http://ixuyong.cn/posts/2260957686.html",
            "title": "Linux—Centos7修改网卡名称",
            "date_published": "2025-06-07T02:40:25.000Z",
            "content_html": "<h3 id=\"linuxcentos7修改网卡名称\"><a class=\"anchor\" href=\"#linuxcentos7修改网卡名称\">#</a> Linux—Centos7 修改网卡名称</h3>\n<p>首先我们先了解不同网卡名称对应的内核参数：</p>\n<ol>\n<li>biosdevname=0  net.ifnames=1：网卡名 “enp<em>s</em>” 此内核参数一般为默认</li>\n<li>biosdevname=1  net.ifnames=0：网卡名 “em*”</li>\n<li>biosdevname=0  net.ifnames=0：网卡名 “eth*”</li>\n</ol>\n<p>本次以将网卡名命名为 eth * 格式作示例</p>\n<h4 id=\"1-查看当前网卡的信息\"><a class=\"anchor\" href=\"#1-查看当前网卡的信息\">#</a> 1. 查看当前网卡的信息</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ifconfig</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ens33: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">416</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class=\"token operator\">></span>  mtu <span class=\"token number\">1500</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        inet <span class=\"token number\">192.168</span>.40.88  netmask <span class=\"token number\">255.255</span>.255.0  broadcast <span class=\"token number\">192.168</span>.40.255</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        inet6 fe80::b92f:3dd3:19e7:1311  prefixlen <span class=\"token number\">64</span>  scopeid 0x2<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>link<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        ether 00:0c:29:5e:a0:59  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>Ethernet<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        RX packets <span class=\"token number\">75</span>  bytes <span class=\"token number\">8065</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7.8</span> KiB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        TX packets <span class=\"token number\">63</span>  bytes <span class=\"token number\">7754</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7.5</span> KiB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>lo: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class=\"token operator\">></span>  mtu <span class=\"token number\">65536</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        inet <span class=\"token number\">127.0</span>.0.1  netmask <span class=\"token number\">255.0</span>.0.0</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        inet6 ::1  prefixlen <span class=\"token number\">128</span>  scopeid 0x1<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>host<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        loop  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>Local Loopback<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        RX packets <span class=\"token number\">0</span>  bytes <span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span> B<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        TX packets <span class=\"token number\">0</span>  bytes <span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span> B<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr></table></figure><h4 id=\"2-修改配置文件\"><a class=\"anchor\" href=\"#2-修改配置文件\">#</a> 2 . 修改配置文件</h4>\n<p>（1）在下列路径下找到 ifcgf-ens33</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /etc/sysconfig/network-scripts/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager network-scripts<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ifcfg-ens33  ifdown-ippp  ifdown-routes    <span class=\"token function\">ifup</span>          ifup-ipv6   ifup-ppp       ifup-tunnel</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>ifcfg-lo     ifdown-ipv6  ifdown-sit       ifup-aliases  ifup-isdn   ifup-routes    ifup-wireless</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">ifdown</span>       ifdown-isdn  ifdown-Team      ifup-bnep     ifup-plip   ifup-sit       init.ipv6-global</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ifdown-bnep  ifdown-post  ifdown-TeamPort  ifup-eth      ifup-plusb  ifup-Team      network-functions</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ifdown-eth   ifdown-ppp   ifdown-tunnel    ifup-ippp     ifup-post   ifup-TeamPort  network-functions-ipv6</pre></td></tr></table></figure><p>（2）使用 MV 命令，修改当前网卡的名称</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mv ifcfg-ens33 ifcfg-eth0</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager network-scripts<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ifcfg-eth0   ifdown-ippp  ifdown-routes    <span class=\"token function\">ifup</span>          ifup-ipv6   ifup-ppp       ifup-tunnel</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>ifcfg-lo     ifdown-ipv6  ifdown-sit       ifup-aliases  ifup-isdn   ifup-routes    ifup-wireless</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">ifdown</span>       ifdown-isdn  ifdown-Team      ifup-bnep     ifup-plip   ifup-sit       init.ipv6-global</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ifdown-bnep  ifdown-post  ifdown-TeamPort  ifup-eth      ifup-plusb  ifup-Team      network-functions</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ifdown-eth   ifdown-ppp   ifdown-tunnel    ifup-ippp     ifup-post   ifup-TeamPort  network-functions-ipv6</pre></td></tr></table></figure><p>（3）同步修改网卡配置文件中的 name 和 device，修改为需要配置网卡的名字</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">NAME</span><span class=\"token operator\">=</span><span class=\"token string\">\"ens33\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">DEVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"ens33\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>将上列命令修改为</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">NAME</span><span class=\"token operator\">=</span><span class=\"token string\">\"eth0\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">DEVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"eth0\"</span></pre></td></tr></table></figure><p>（4）修改 grub</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /etc/default/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#编辑内核信息，在 GRUB_CMDLINE_LINUX 行添加字段 net.ifnames=0 biosdevname=0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager default<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat grub </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token assign-left variable\">GRUB_TIMEOUT</span><span class=\"token operator\">=</span><span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">GRUB_DISTRIBUTOR</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">sed</span> <span class=\"token string\">'s, release .*$,,g'</span> /etc/system-release<span class=\"token variable\">)</span></span>\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">GRUB_DEFAULT</span><span class=\"token operator\">=</span>saved</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token assign-left variable\">GRUB_DISABLE_SUBMENU</span><span class=\"token operator\">=</span>true</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">GRUB_TERMINAL_OUTPUT</span><span class=\"token operator\">=</span><span class=\"token string\">\"console\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">GRUB_CMDLINE_LINUX</span><span class=\"token operator\">=</span><span class=\"token string\">\"crashkernel=auto rhgb net.ifnames=0 biosdevname=0 quiet\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">GRUB_DISABLE_RECOVERY</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">#生成启动菜单</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager default<span class=\"token punctuation\">]</span><span class=\"token comment\"># grub2-mkconfig -o /boot/grub2/grub.cfg</span></pre></td></tr></table></figure><p>（5）完成之后 reboot 重启系统即可</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager default<span class=\"token punctuation\">]</span><span class=\"token comment\"># reboot</span></pre></td></tr></table></figure><p>（6）使用 ifconfig 即可查看</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@manager ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ifconfig</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>eth0: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">416</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class=\"token operator\">></span>  mtu <span class=\"token number\">1500</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        inet <span class=\"token number\">192.168</span>.40.88  netmask <span class=\"token number\">255.255</span>.255.0  broadcast <span class=\"token number\">192.168</span>.40.255</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        inet6 fe80::63d4:467f:9b76:e34f  prefixlen <span class=\"token number\">64</span>  scopeid 0x2<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>link<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        inet6 fe80::1856:7b0:9d1e:7208  prefixlen <span class=\"token number\">64</span>  scopeid 0x2<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>link<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        ether 00:0c:29:5e:a0:59  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>Ethernet<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        RX packets <span class=\"token number\">77</span>  bytes <span class=\"token number\">8117</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7.9</span> KiB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        TX packets <span class=\"token number\">62</span>  bytes <span class=\"token number\">7842</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7.6</span> KiB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>lo: <span class=\"token assign-left variable\">flags</span><span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class=\"token operator\">></span>  mtu <span class=\"token number\">65536</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        inet <span class=\"token number\">127.0</span>.0.1  netmask <span class=\"token number\">255.0</span>.0.0</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        inet6 ::1  prefixlen <span class=\"token number\">128</span>  scopeid 0x1<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>host<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        loop  txqueuelen <span class=\"token number\">1000</span>  <span class=\"token punctuation\">(</span>Local Loopback<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        RX packets <span class=\"token number\">0</span>  bytes <span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span> B<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        RX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span>  overruns <span class=\"token number\">0</span>  frame <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        TX packets <span class=\"token number\">0</span>  bytes <span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span> B<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        TX errors <span class=\"token number\">0</span>  dropped <span class=\"token number\">0</span> overruns <span class=\"token number\">0</span>  carrier <span class=\"token number\">0</span>  collisions <span class=\"token number\">0</span></pre></td></tr></table></figure>",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "http://ixuyong.cn/posts/1922841233.html",
            "url": "http://ixuyong.cn/posts/1922841233.html",
            "title": "Rsync服务实践",
            "date_published": "2025-03-30T12:45:48.000Z",
            "content_html": "<h3 id=\"ursync服务实践u\"><a class=\"anchor\" href=\"#ursync服务实践u\">#</a> <u>Rsync 服务实践</u></h3>\n<p><strong>环境准备</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">主机名</th>\n<th style=\"text-align:center\"><strong>IP</strong></th>\n<th><strong>角色</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">server</td>\n<td style=\"text-align:center\">192.168.40.101</td>\n<td>rsync 服务端</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">client</td>\n<td style=\"text-align:center\">192.168.40.102</td>\n<td>rsync 客户</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"1rsync服务端\"><a class=\"anchor\" href=\"#1rsync服务端\">#</a> 1.rsync 服务端</h4>\n<h5 id=\"11-关闭防火墙-selinux\"><a class=\"anchor\" href=\"#11-关闭防火墙-selinux\">#</a> 1.1 关闭防火墙、selinux</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># hostnamectl set-hostname backup</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># bash</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># hostnamectl set-hostname aizj_lb01</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl stop firewalld</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl disable firewalld</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum update -y --exclude=kernel* &amp;&amp; reboot</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo 'Asia/Shanghai' >/etc/timezone</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ntpdate time2.aliyun.com</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># crontab -e</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com <span class=\"token operator\">&amp;></span> /dev/nul</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /soft /data /scripts /backup</span></pre></td></tr></table></figure><h5 id=\"12-安装rsync\"><a class=\"anchor\" href=\"#12-安装rsync\">#</a> 1.2 安装 rsync</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install -y rsync</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@server ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl start rsyncd</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@server ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl enable rsyncd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd -M -s /sbin/nologin rsync</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir -p /backup/mysql  /backup/file</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chown -R rsync.rsync /backup/mysql /backup/file</span></pre></td></tr></table></figure><h5 id=\"13-修改配置文件\"><a class=\"anchor\" href=\"#13-修改配置文件\">#</a> 1.3 修改配置文件</h5>\n<p><em><mark>#生产环境中取消注释，导致备份数据报错</mark></em></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#带注释配置文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/rsyncd.conf</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>uid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>             <span class=\"token comment\">#运行服务的用户</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>gid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>             <span class=\"token comment\">#运行服务的组</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>port <span class=\"token operator\">=</span> <span class=\"token number\">873</span>              <span class=\"token comment\">#服务监听端口</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>fake super <span class=\"token operator\">=</span> <span class=\"token function\">yes</span>        <span class=\"token comment\">#服务无需使用 root 用户身份，即可接收文件的完整属性</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>use <span class=\"token function\">chroot</span> <span class=\"token operator\">=</span> no         <span class=\"token comment\">#禁锢目录，不允许获取 root 权限</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>max connections <span class=\"token operator\">=</span> <span class=\"token number\">200</span>   <span class=\"token comment\">#最大连接数，最多能有多少个客户端跟服务端的 873 端口建立连接</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">timeout</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span>           <span class=\"token comment\">#超时时间</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>ignore errors          <span class=\"token comment\">#忽略错误</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token builtin class-name\">read</span> only <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>      <span class=\"token comment\">#客户是否只读</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>list <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>           <span class=\"token comment\">#不允许查看模块信息</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>auth <span class=\"token function\">users</span> <span class=\"token operator\">=</span> rsync_backup         <span class=\"token comment\">#定义虚拟用户，用户数据传输</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>secrets <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /etc/rsync.passwd  <span class=\"token comment\">#定义虚拟用户密码认证文件</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>log <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /var/log/rsyncd.log    <span class=\"token comment\">#日志文件存放的位置</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">[</span>backup_mysql<span class=\"token punctuation\">]</span>         <span class=\"token comment\">#模块名</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/mysql   <span class=\"token comment\">#数据存放目录</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">[</span>backup_file<span class=\"token punctuation\">]</span>          <span class=\"token comment\">#模块名</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/file    <span class=\"token comment\">#数据存放目录 </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#不带注释配置文件</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/rsyncd.conf</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>uid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>        </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>gid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>         </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>port <span class=\"token operator\">=</span> <span class=\"token number\">873</span>     </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>fake super <span class=\"token operator\">=</span> <span class=\"token function\">yes</span>     </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>use <span class=\"token function\">chroot</span> <span class=\"token operator\">=</span> no        </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>max connections <span class=\"token operator\">=</span> <span class=\"token number\">200</span>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token function\">timeout</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span>         </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>ignore errors       </pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token builtin class-name\">read</span> only <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>    </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>list <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>          </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>auth <span class=\"token function\">users</span> <span class=\"token operator\">=</span> rsync_backup        </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>secrets <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /etc/rsync.passwd</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>log <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /var/log/rsyncd.log    </pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">[</span>backup_mysql<span class=\"token punctuation\">]</span>       </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/mysql  </pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">[</span>backup_file<span class=\"token punctuation\">]</span>         </pre></td></tr><tr><td data-num=\"42\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/file</pre></td></tr></table></figure><h5 id=\"4-创建虚拟用户密码文件并设置权限\"><a class=\"anchor\" href=\"#4-创建虚拟用户密码文件并设置权限\">#</a> 4. 创建虚拟用户密码文件并设置权限</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/rsync.passwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>rsync_backup:your <span class=\"token function\">passwd</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod 600 /etc/rsync.passwd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl restart rsyncd &amp;&amp; systemctl status rsyncd</span></pre></td></tr></table></figure><h5 id=\"5-检查服务端口是否开启\"><a class=\"anchor\" href=\"#5-检查服务端口是否开启\">#</a> 5. 检查服务端口是否开启</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># netstat -lntp | grep \"rsync\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>tcp        <span class=\"token number\">0</span>      <span class=\"token number\">0</span> <span class=\"token number\">0.0</span>.0.0:873             <span class=\"token number\">0.0</span>.0.0:*               LISTEN      <span class=\"token number\">20357</span>/rsync         </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>tcp6       <span class=\"token number\">0</span>      <span class=\"token number\">0</span> :::873                  :::*                    LISTEN      <span class=\"token number\">20357</span>/rsync</pre></td></tr></table></figure><h4 id=\"2-rsync客户端\"><a class=\"anchor\" href=\"#2-rsync客户端\">#</a> 2. rsync 客户端</h4>\n<h5 id=\"21-安装rsync\"><a class=\"anchor\" href=\"#21-安装rsync\">#</a> 2.1 安装 rsync</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install nfs-utils -y</span></pre></td></tr></table></figure><h5 id=\"22-配置传输密码\"><a class=\"anchor\" href=\"#22-配置传输密码\">#</a> 2.2 配置传输密码</h5>\n<p>方法 1：将密码写入文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\">#  echo 'your passwd' > /etc/rsync.pass</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/rsync.pass </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>your <span class=\"token function\">passwd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod 600 /etc/rsync.pass</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>--测试收发数据：</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># rsync -avz --password-file=/etc/rsync.pass /root/test rsync_backup@192.168.40.101::backup_file</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>sending incremental <span class=\"token function\">file</span> list</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sent <span class=\"token number\">47</span> bytes  received <span class=\"token number\">20</span> bytes  <span class=\"token number\">134.00</span> bytes/sec</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>total size is <span class=\"token number\">0</span>  speedup is <span class=\"token number\">0.00</span></pre></td></tr></table></figure><p>方法 2：使用密码环境变量 RSYNC_PASSWORD</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># export RSYNC_PASSWORD='your passwd'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>--测试收发数据：</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># rsync -avz /root/test rsync_backup@192.168.40.101::backup_file</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sending incremental <span class=\"token function\">file</span> list</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sent <span class=\"token number\">47</span> bytes  received <span class=\"token number\">20</span> bytes  <span class=\"token number\">134.00</span> bytes/sec</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>total size is <span class=\"token number\">0</span>  speedup is <span class=\"token number\">0.00</span></pre></td></tr></table></figure><h3 id=\"ursync企业级备份案例u\"><a class=\"anchor\" href=\"#ursync企业级备份案例u\">#</a> <u>Rsync 企业级备份案例</u></h3>\n<p><strong>环境准备</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">主机名</th>\n<th style=\"text-align:center\"><strong>IP</strong></th>\n<th><strong>角色</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">server</td>\n<td style=\"text-align:center\">192.168.40.101</td>\n<td>rsync 服务端</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">client</td>\n<td style=\"text-align:center\">192.168.40.102</td>\n<td>rsync 客户</td>\n</tr>\n</tbody>\n</table>\n<p><strong>客户端需求</strong></p>\n<ul>\n<li>客户端每天凌晨 3 点备份 MySQL 至 /backup 下以 &quot;主机名_IP 地址_当前时间命名&quot; 的目录中</li>\n<li>客户端推送 /backup 目录下数据备份目录至 Rsync 备份服务器</li>\n<li>客户端只保留最近七天的备份数据，避免浪费磁盘空间</li>\n</ul>\n<p><strong>服务端需求</strong></p>\n<ul>\n<li>服务端部署 rsync 服务，用于接收用户的备份数据</li>\n<li>服务端每天校验客户端推送过来的数据是否完整，并将结果以邮件的方式发送给管理员</li>\n<li>服务端仅保留 6 个月的备份数据</li>\n</ul>\n<p><strong>注意</strong>：所有服务器的备份目录均为 /backup，所有脚本存放目录均为 /scripts。</p>\n<h4 id=\"1-服务端部署rsync服务\"><a class=\"anchor\" href=\"#1-服务端部署rsync服务\">#</a> <strong>1. 服务端部署 rsync 服务</strong></h4>\n<h5 id=\"11-关闭防火墙-selinux-2\"><a class=\"anchor\" href=\"#11-关闭防火墙-selinux-2\">#</a> 1.1 关闭防火墙、selinux</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># hostnamectl set-hostname backup</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># bash</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># hostnamectl set-hostname aizj_lb01</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl stop firewalld</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl disable firewalld</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum update -y --exclude=kernel* &amp;&amp; reboot</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo 'Asia/Shanghai' >/etc/timezone</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ntpdate time2.aliyun.com</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># crontab -e</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com <span class=\"token operator\">&amp;></span> /dev/nul</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /soft /data /scripts /backup</span></pre></td></tr></table></figure><h5 id=\"12-安装rsync-2\"><a class=\"anchor\" href=\"#12-安装rsync-2\">#</a> 1.2 安装 rsync</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install -y rsync</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@server ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl start rsyncd</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@server ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl enable rsyncd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd -M -s /sbin/nologin rsync</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir -p /backup/mysql  /backup/file</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chown -R rsync.rsync /backup/mysql /backup/file</span></pre></td></tr></table></figure><h5 id=\"13-修改配置文件-2\"><a class=\"anchor\" href=\"#13-修改配置文件-2\">#</a> 1.3 修改配置文件</h5>\n<p><em><mark>#生产环境中取消注释，导致备份数据报错</mark></em></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#带注释配置文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/rsyncd.conf</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>uid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>             <span class=\"token comment\">#运行服务的用户</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>gid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>             <span class=\"token comment\">#运行服务的组</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>port <span class=\"token operator\">=</span> <span class=\"token number\">873</span>              <span class=\"token comment\">#服务监听端口</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>fake super <span class=\"token operator\">=</span> <span class=\"token function\">yes</span>        <span class=\"token comment\">#服务无需使用 root 用户身份，即可接收文件的完整属性</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>use <span class=\"token function\">chroot</span> <span class=\"token operator\">=</span> no         <span class=\"token comment\">#禁锢目录，不允许获取 root 权限</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>max connections <span class=\"token operator\">=</span> <span class=\"token number\">200</span>   <span class=\"token comment\">#最大连接数，最多能有多少个客户端跟服务端的 873 端口建立连接</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">timeout</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span>           <span class=\"token comment\">#超时时间</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>ignore errors          <span class=\"token comment\">#忽略错误</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token builtin class-name\">read</span> only <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>      <span class=\"token comment\">#客户是否只读</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>list <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>           <span class=\"token comment\">#不允许查看模块信息</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>auth <span class=\"token function\">users</span> <span class=\"token operator\">=</span> rsync_backup         <span class=\"token comment\">#定义虚拟用户，用户数据传输</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>secrets <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /etc/rsync.passwd  <span class=\"token comment\">#定义虚拟用户密码认证文件</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>log <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /var/log/rsyncd.log    <span class=\"token comment\">#日志文件存放的位置</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">[</span>backup_mysql<span class=\"token punctuation\">]</span>         <span class=\"token comment\">#模块名</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/mysql   <span class=\"token comment\">#数据存放目录</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">[</span>backup_file<span class=\"token punctuation\">]</span>          <span class=\"token comment\">#模块名</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/file    <span class=\"token comment\">#数据存放目录 </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#不带注释配置文件</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/rsyncd.conf</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>uid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>        </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>gid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>         </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>port <span class=\"token operator\">=</span> <span class=\"token number\">873</span>     </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>fake super <span class=\"token operator\">=</span> <span class=\"token function\">yes</span>     </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>use <span class=\"token function\">chroot</span> <span class=\"token operator\">=</span> no        </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>max connections <span class=\"token operator\">=</span> <span class=\"token number\">200</span>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token function\">timeout</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span>         </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>ignore errors       </pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token builtin class-name\">read</span> only <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>    </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>list <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>          </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>auth <span class=\"token function\">users</span> <span class=\"token operator\">=</span> rsync_backup        </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>secrets <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /etc/rsync.passwd</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>log <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /var/log/rsyncd.log    </pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">[</span>backup_mysql<span class=\"token punctuation\">]</span>       </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/mysql  </pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">[</span>backup_file<span class=\"token punctuation\">]</span>         </pre></td></tr><tr><td data-num=\"42\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/file</pre></td></tr></table></figure><h5 id=\"4-创建虚拟用户密码文件并设置权限-2\"><a class=\"anchor\" href=\"#4-创建虚拟用户密码文件并设置权限-2\">#</a> 4. 创建虚拟用户密码文件并设置权限</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/rsync.passwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>rsync_backup:your <span class=\"token function\">passwd</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod 600 /etc/rsync.passwd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl restart rsyncd &amp;&amp; systemctl status rsyncd</span></pre></td></tr></table></figure><h5 id=\"5-检查服务端口是否开启-2\"><a class=\"anchor\" href=\"#5-检查服务端口是否开启-2\">#</a> 5. 检查服务端口是否开启</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># netstat -lntp | grep \"rsync\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>tcp        <span class=\"token number\">0</span>      <span class=\"token number\">0</span> <span class=\"token number\">0.0</span>.0.0:873             <span class=\"token number\">0.0</span>.0.0:*               LISTEN      <span class=\"token number\">20357</span>/rsync         </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>tcp6       <span class=\"token number\">0</span>      <span class=\"token number\">0</span> :::873                  :::*                    LISTEN      <span class=\"token number\">20357</span>/rsync</pre></td></tr></table></figure><h4 id=\"2-rsync客户端-2\"><a class=\"anchor\" href=\"#2-rsync客户端-2\">#</a> 2. rsync 客户端</h4>\n<h5 id=\"21-安装rsync-2\"><a class=\"anchor\" href=\"#21-安装rsync-2\">#</a> 2.1 安装 rsync</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install nfs-utils -y</span></pre></td></tr></table></figure><h5 id=\"22-测试客户端备份数据并推送至rsync服务器\"><a class=\"anchor\" href=\"#22-测试客户端备份数据并推送至rsync服务器\">#</a> 2.2 测试客户端备份数据并推送至 rsync 服务器</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># export RSYNC_PASSWORD='your passwd'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># rsync -avz /root/test rsync_backup@192.168.40.101::backup_file</span></pre></td></tr></table></figure><h5 id=\"23-客户端备份数据并推送至rsync服务器\"><a class=\"anchor\" href=\"#23-客户端备份数据并推送至rsync服务器\">#</a> <strong>2.3 客户端备份数据并推送至 rsync 服务器</strong></h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /scripts</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /scripts/mysql_backup.sh </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#!/bin/bash</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#1、定义变量</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">Host</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">hostname</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token assign-left variable\">Ip</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ifconfig</span> ens192 <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'NR==2&#123;print $2&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">Date</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">date</span> +%F<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">BackupDir</span><span class=\"token operator\">=</span>/backup/mysql</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">Dest</span><span class=\"token operator\">=</span><span class=\"token variable\">$&#123;BackupDir&#125;</span>/<span class=\"token variable\">$&#123;Host&#125;</span>_<span class=\"token variable\">$&#123;Ip&#125;</span>_<span class=\"token variable\">$&#123;Date&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token assign-left variable\">FILE_NAME</span><span class=\"token operator\">=</span>mysql_backup_<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">date</span> <span class=\"token string\">'+%Y%m%d%H%M%S'</span><span class=\"token variable\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token assign-left variable\">OLDBINLOG</span><span class=\"token operator\">=</span>/var/lib/mysql/oldbinlog</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#2、创建备份目录</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token operator\">!</span> <span class=\"token parameter variable\">-d</span> <span class=\"token variable\">$Dest</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> <span class=\"token variable\">$Dest</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#3、备份目录</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>/usr/bin/mysqldump -u<span class=\"token string\">'root'</span> -p<span class=\"token string\">'your passwd'</span> nf_flms <span class=\"token operator\">></span> <span class=\"token variable\">$Dest</span>/nf-flms_<span class=\"token variable\">$&#123;FILE_NAME&#125;</span>.sql</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-czvf</span> <span class=\"token variable\">$Dest</span>/<span class=\"token variable\">$&#123;FILE_NAME&#125;</span>.tar.gz <span class=\"token variable\">$Dest</span>/nf-flms_<span class=\"token variable\">$&#123;FILE_NAME&#125;</span>.sql</pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> <span class=\"token variable\">$Dest</span>/*<span class=\"token variable\">$&#123;FILE_NAME&#125;</span>.sql</pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Your database backup successfully\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">#4、校验</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>md5sum <span class=\"token variable\">$Dest</span>/* <span class=\"token operator\">></span><span class=\"token variable\">$Dest</span>/backup_check_<span class=\"token variable\">$Date</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">#5、将备份目录推动到 rsync 服务端</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token assign-left variable\">Rsync_Ip</span><span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.1.145</pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token assign-left variable\">Rsync_user</span><span class=\"token operator\">=</span>rsync_backup</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token assign-left variable\">Rsync_Module</span><span class=\"token operator\">=</span>backup_mysql</pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">RSYNC_PASSWORD</span><span class=\"token operator\">=</span>your <span class=\"token function\">passwd</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token function\">rsync</span> <span class=\"token parameter variable\">-avz</span> <span class=\"token variable\">$Dest</span> <span class=\"token variable\">$Rsync_user</span>@<span class=\"token variable\">$Rsync_Ip</span>::<span class=\"token variable\">$Rsync_Module</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">#6、删除 15 天备份目录</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token variable\">$Dest</span> <span class=\"token parameter variable\">-type</span> d <span class=\"token parameter variable\">-mtime</span> +15 <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"remove file  successfully\"</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod +x /scripts/etc_backup.sh</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># crontab -e</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>00 03 * * * /bin/bash /scripts/mysql_backup.sh <span class=\"token operator\">&amp;></span> /dev/null</pre></td></tr></table></figure><h5 id=\"24-服务端校验数据并将结果以邮件发送给管理员\"><a class=\"anchor\" href=\"#24-服务端校验数据并将结果以邮件发送给管理员\">#</a> <strong>2.4 服务端校验数据并将结果以邮件发送给管理员</strong></h5>\n<h6 id=\"241-配置邮件服务\"><a class=\"anchor\" href=\"#241-配置邮件服务\">#</a> 2.4.1 配置邮件服务</h6>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum -y install mailx</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/mail.rc      #最后一行插入</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">from</span><span class=\"token operator\">=</span><span class=\"token number\">373370405</span>@qq.com</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">smtp</span><span class=\"token operator\">=</span>smtps://smtp.qq.com:465</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">set</span> smtp-auth-user<span class=\"token operator\">=</span><span class=\"token number\">373370405</span>@qq.com</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin class-name\">set</span> smtp-auth-password<span class=\"token operator\">=</span>**********   <span class=\"token comment\"># 发件邮箱的授权码</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token builtin class-name\">set</span> smtp-auth<span class=\"token operator\">=</span>login</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">set</span> ssl-verify<span class=\"token operator\">=</span>ignore</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token builtin class-name\">set</span> nss-config-dir<span class=\"token operator\">=</span>/etc/pki/nssdb</pre></td></tr></table></figure><h6 id=\"242-发送邮件测试\"><a class=\"anchor\" href=\"#242-发送邮件测试\">#</a> 2.4.2 发送邮件测试</h6>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\">#  echo Hello World | mail -s test 373370405@qq.com &amp;> /dev/null</span></pre></td></tr></table></figure><h6 id=\"243-配置脚本校验数据并将结果发送给管理员\"><a class=\"anchor\" href=\"#243-配置脚本校验数据并将结果发送给管理员\">#</a> 2.4.3 配置脚本校验数据并将结果发送给管理员</h6>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup mysql<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /scripts/check_backup.sh </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#!/bin/bash</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#1、定义变量</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">Path</span><span class=\"token operator\">=</span>/backup/mysql</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">Date</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">date</span> +%F<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#2、查看 flag 文件，并对对文件进行校验，然后将校验的结果保存至 result_时间</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token variable\">$Path</span> <span class=\"token parameter variable\">-type</span> f <span class=\"token parameter variable\">-name</span> <span class=\"token string\">\"backup_check_<span class=\"token variable\">$&#123;Date&#125;</span>*\"</span><span class=\"token operator\">|</span><span class=\"token function\">xargs</span> md5sum <span class=\"token parameter variable\">-c</span> <span class=\"token operator\">></span><span class=\"token variable\">$Path</span>/result_<span class=\"token variable\">$&#123;Date&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#3、将校验结果发送邮件给管理员</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>mail <span class=\"token parameter variable\">-s</span> <span class=\"token string\">\"Mysql Backup\"</span> <span class=\"token number\">373370405</span>@qq.com <span class=\"token operator\">&lt;</span><span class=\"token variable\">$Path</span>/result_<span class=\"token variable\">$&#123;Date&#125;</span> <span class=\"token operator\">&amp;></span> /dev/null</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#4、删除超过 7 天的校验结果文件，删除超过 180 天的备份数据文件</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token variable\">$Path</span> <span class=\"token parameter variable\">-type</span> f <span class=\"token parameter variable\">-name</span> <span class=\"token string\">\"result*\"</span> <span class=\"token parameter variable\">-mtime</span> +7 <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">find</span> <span class=\"token variable\">$Path</span> <span class=\"token parameter variable\">-type</span> f <span class=\"token parameter variable\">-mtime</span> +180 <span class=\"token operator\">|</span> <span class=\"token function\">xargs</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span></pre></td></tr></table></figure><h6 id=\"244-写计划任务\"><a class=\"anchor\" href=\"#244-写计划任务\">#</a> <strong>2.4.4 写计划任务</strong></h6>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod +x /scripts/check_backup.sh </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@db01 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># crontab -e</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>00 06 * * * /bin/bash /scripts/mysql_backup.sh <span class=\"token operator\">&amp;></span> /dev/null</pre></td></tr></table></figure><h3 id=\"rsyncsersync实现数据实时同步\"><a class=\"anchor\" href=\"#rsyncsersync实现数据实时同步\">#</a> Rsync+sersync 实现数据实时同步</h3>\n<p><strong>环境准备</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">主机名</th>\n<th style=\"text-align:center\"><strong>IP</strong></th>\n<th><strong>角色</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">server</td>\n<td style=\"text-align:center\">192.168.40.101</td>\n<td>rsync 服务端</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">client</td>\n<td style=\"text-align:center\">192.168.40.102</td>\n<td>rsync 客户</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"1rsync服务端-2\"><a class=\"anchor\" href=\"#1rsync服务端-2\">#</a> 1.rsync 服务端</h4>\n<h5 id=\"11-关闭防火墙-selinux-3\"><a class=\"anchor\" href=\"#11-关闭防火墙-selinux-3\">#</a> 1.1 关闭防火墙、selinux</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># hostnamectl set-hostname backup</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># bash</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># hostnamectl set-hostname aizj_lb01</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl stop firewalld</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl disable firewalld</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># sed -i 's/^SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install net-tools vim tree lrzsz wget unzip dos2unix bash-completion  lsof ntp ntpdate git -y</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum update -y --exclude=kernel* &amp;&amp; reboot</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo 'Asia/Shanghai' >/etc/timezone</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ntpdate time2.aliyun.com</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># crontab -e</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>*/5 * * * * /usr/sbin/ntpdate time2.aliyun.com <span class=\"token operator\">&amp;></span> /dev/nul</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /soft /data /scripts /backup</span></pre></td></tr></table></figure><h5 id=\"12-安装rsync-3\"><a class=\"anchor\" href=\"#12-安装rsync-3\">#</a> 1.2 安装 rsync</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install -y rsync</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@server ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl start rsyncd</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@server ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl enable rsyncd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd -M -s /sbin/nologin rsync</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir -p /backup/mysql  /backup/file</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chown -R rsync.rsync /backup/mysql /backup/file</span></pre></td></tr></table></figure><h5 id=\"13-修改配置文件-3\"><a class=\"anchor\" href=\"#13-修改配置文件-3\">#</a> 1.3 修改配置文件</h5>\n<p><em><mark>#生产环境中取消注释，导致备份数据报错</mark></em></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#带注释配置文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/rsyncd.conf</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>uid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>             <span class=\"token comment\">#运行服务的用户</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>gid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>             <span class=\"token comment\">#运行服务的组</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>port <span class=\"token operator\">=</span> <span class=\"token number\">873</span>              <span class=\"token comment\">#服务监听端口</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>fake super <span class=\"token operator\">=</span> <span class=\"token function\">yes</span>        <span class=\"token comment\">#服务无需使用 root 用户身份，即可接收文件的完整属性</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>use <span class=\"token function\">chroot</span> <span class=\"token operator\">=</span> no         <span class=\"token comment\">#禁锢目录，不允许获取 root 权限</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>max connections <span class=\"token operator\">=</span> <span class=\"token number\">200</span>   <span class=\"token comment\">#最大连接数，最多能有多少个客户端跟服务端的 873 端口建立连接</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">timeout</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span>           <span class=\"token comment\">#超时时间</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>ignore errors          <span class=\"token comment\">#忽略错误</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token builtin class-name\">read</span> only <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>      <span class=\"token comment\">#客户是否只读</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>list <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>           <span class=\"token comment\">#不允许查看模块信息</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>auth <span class=\"token function\">users</span> <span class=\"token operator\">=</span> rsync_backup         <span class=\"token comment\">#定义虚拟用户，用户数据传输</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>secrets <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /etc/rsync.passwd  <span class=\"token comment\">#定义虚拟用户密码认证文件</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>log <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /var/log/rsyncd.log    <span class=\"token comment\">#日志文件存放的位置</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">[</span>backup_mysql<span class=\"token punctuation\">]</span>         <span class=\"token comment\">#模块名</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/mysql   <span class=\"token comment\">#数据存放目录</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">[</span>backup_file<span class=\"token punctuation\">]</span>          <span class=\"token comment\">#模块名</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/file    <span class=\"token comment\">#数据存放目录 </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#不带注释配置文件</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/rsyncd.conf</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>uid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>        </pre></td></tr><tr><td data-num=\"26\"></td><td><pre>gid <span class=\"token operator\">=</span> <span class=\"token function\">rsync</span>         </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>port <span class=\"token operator\">=</span> <span class=\"token number\">873</span>     </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>fake super <span class=\"token operator\">=</span> <span class=\"token function\">yes</span>     </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>use <span class=\"token function\">chroot</span> <span class=\"token operator\">=</span> no        </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>max connections <span class=\"token operator\">=</span> <span class=\"token number\">200</span>  </pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token function\">timeout</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span>         </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>ignore errors       </pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token builtin class-name\">read</span> only <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>    </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>list <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>          </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>auth <span class=\"token function\">users</span> <span class=\"token operator\">=</span> rsync_backup        </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>secrets <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /etc/rsync.passwd</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>log <span class=\"token function\">file</span> <span class=\"token operator\">=</span> /var/log/rsyncd.log    </pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">[</span>backup_mysql<span class=\"token punctuation\">]</span>       </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/mysql  </pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">[</span>backup_file<span class=\"token punctuation\">]</span>         </pre></td></tr><tr><td data-num=\"42\"></td><td><pre>comment <span class=\"token operator\">=</span> welcome to rsync_backup</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>path <span class=\"token operator\">=</span> /backup/file</pre></td></tr></table></figure><h5 id=\"4-创建虚拟用户密码文件并设置权限-3\"><a class=\"anchor\" href=\"#4-创建虚拟用户密码文件并设置权限-3\">#</a> 4. 创建虚拟用户密码文件并设置权限</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/rsync.passwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>rsync_backup:your <span class=\"token function\">passwd</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod 600 /etc/rsync.passwd</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl restart rsyncd &amp;&amp; systemctl status rsyncd</span></pre></td></tr></table></figure><h5 id=\"5-检查服务端口是否开启-3\"><a class=\"anchor\" href=\"#5-检查服务端口是否开启-3\">#</a> 5. 检查服务端口是否开启</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># netstat -lntp | grep \"rsync\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>tcp        <span class=\"token number\">0</span>      <span class=\"token number\">0</span> <span class=\"token number\">0.0</span>.0.0:873             <span class=\"token number\">0.0</span>.0.0:*               LISTEN      <span class=\"token number\">20357</span>/rsync         </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>tcp6       <span class=\"token number\">0</span>      <span class=\"token number\">0</span> :::873                  :::*                    LISTEN      <span class=\"token number\">20357</span>/rsync</pre></td></tr></table></figure><h4 id=\"2-客户端安装sersync\"><a class=\"anchor\" href=\"#2-客户端安装sersync\">#</a> 2. 客户端安装 sersync</h4>\n<p><strong>2.1 安装 sercync 依赖</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># yum install -y inotify-tools rsync</span></pre></td></tr></table></figure><p><strong>2.2 安装 sercync</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir -p /soft</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /soft/</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget https://down.whsir.com/downloads/sersync2.5.4_64bit_binary_stable_final.tar.gz</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs soft<span class=\"token punctuation\">]</span><span class=\"token comment\"># tar -xf sersync2.5.4_64bit_binary_stable_final.tar.gz</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs soft<span class=\"token punctuation\">]</span><span class=\"token comment\"># mv GNU-Linux-x86 /usr/local/sersync</span></pre></td></tr></table></figure><h5 id=\"23-修改配置文件\"><a class=\"anchor\" href=\"#23-修改配置文件\">#</a> 2.3 <strong>修改配置文件</strong></h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs soft<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /usr/local/sersync/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># cp confxml.xml confxml.xml.bak</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim confxml.xml</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">5</span>    <span class=\"token operator\">&lt;</span>fileSystem <span class=\"token assign-left variable\">xfs</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span>    <span class=\"token comment\">#第 5 行 false 改为 true</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">13</span>          <span class=\"token operator\">&lt;</span>delete <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span> <span class=\"token comment\">#第 13-20 行 false 改为 true,# 说明：监控以上变化推送</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">14</span>        <span class=\"token operator\">&lt;</span>createFolder <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">15</span>        <span class=\"token operator\">&lt;</span>createFile <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"false\"</span>/<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">16</span>        <span class=\"token operator\">&lt;</span>closeWrite <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">17</span>        <span class=\"token operator\">&lt;</span>moveFrom <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">18</span>        <span class=\"token operator\">&lt;</span>moveTo <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">19</span>        <span class=\"token operator\">&lt;</span>attrib <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">20</span>        <span class=\"token operator\">&lt;</span>modify <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>/<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">24</span>        <span class=\"token operator\">&lt;</span>localpath <span class=\"token assign-left variable\">watch</span><span class=\"token operator\">=</span><span class=\"token string\">\"/data\"</span><span class=\"token operator\">></span>      <span class=\"token comment\">#监控的本地目录</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">25</span>             <span class=\"token operator\">&lt;</span>remote <span class=\"token assign-left variable\">ip</span><span class=\"token operator\">=</span><span class=\"token string\">\"192.168.1.145\"</span> <span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span><span class=\"token string\">\"backup_file\"</span>/<span class=\"token operator\">></span>  <span class=\"token comment\">#rsync 服务端 IP 和模块名 backup_file</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token number\">30</span>      <span class=\"token operator\">&lt;</span>commonParams <span class=\"token assign-left variable\">params</span><span class=\"token operator\">=</span><span class=\"token string\">\"-avz\"</span>/<span class=\"token operator\">></span>  <span class=\"token comment\">#rsync 命令选项</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">31</span>      <span class=\"token operator\">&lt;</span>auth <span class=\"token assign-left variable\">start</span><span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span> <span class=\"token assign-left variable\">users</span><span class=\"token operator\">=</span><span class=\"token string\">\"rsync_backup\"</span> <span class=\"token assign-left variable\">passwordfile</span><span class=\"token operator\">=</span><span class=\"token string\">\"/etc/rsync.passwd\"</span>/<span class=\"token operator\">></span> <span class=\"token comment\">#rsync 认证信息</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">..</span>.</pre></td></tr></table></figure><h5 id=\"24-生成密码文件\"><a class=\"anchor\" href=\"#24-生成密码文件\">#</a> 2.4 生成密码文件</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo 'your passwd' > /etc/rsync.passwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod 600 /etc/rsync.passwd</span></pre></td></tr></table></figure><h5 id=\"25-启动sersync\"><a class=\"anchor\" href=\"#25-启动sersync\">#</a> 2.5 启动 sersync</h5>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln -s /usr/local/sersync/sersync2 /usr/bin/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># sersync2 -dro /usr/local/sersync/confxml.xml     #针对配置文件 confxml.xml 启动 sersync</span></pre></td></tr></table></figure><p><strong>2.5 设置 sersync 开机自启</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@qzj_nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/rc.d/rc.local   </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/usr/local/sersync/sersync2 <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-o</span>  /usr/local/sersync/confxml.xml  <span class=\"token comment\">#在最后添加一行</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@qzj_nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod +x /etc/rc.d/rc.local</span></pre></td></tr></table></figure><p><strong>2.6 测试</strong></p>\n<p><em>在客户端 /data 目录增删改目录文件，rsync 服务端数据存放目录变化</em></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@backup backup<span class=\"token punctuation\">]</span><span class=\"token comment\"># watch ls</span></pre></td></tr></table></figure><p><strong>2.7 添加脚本监控 sersync 是否正常运行</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /scripts/check_sersync.sh </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#!/bin/sh</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">sersync</span><span class=\"token operator\">=</span><span class=\"token string\">\"/usr/local/sersync/sersync2\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">confxml</span><span class=\"token operator\">=</span><span class=\"token string\">\"/usr/local/sersync/confxml.xml\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ps</span> aux <span class=\"token operator\">|</span><span class=\"token function\">grep</span> <span class=\"token string\">'sersync2'</span><span class=\"token operator\">|</span><span class=\"token function\">grep</span> <span class=\"token parameter variable\">-v</span> <span class=\"token string\">'grep'</span><span class=\"token operator\">|</span><span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$status</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$sersync</span> <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-o</span> <span class=\"token variable\">$confxml</span> <span class=\"token operator\">&amp;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token builtin class-name\">exit</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod +x /scripts/check_sersync.sh</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>root@nfs sersync<span class=\"token punctuation\">]</span><span class=\"token comment\"># crontab -l</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>*/5 * * * * /usr/bin/sh /scripts/check_sersync.sh <span class=\"token operator\">&amp;></span> /dev/null</pre></td></tr></table></figure><p><em><strong>补充： 多实例情况</strong></em><br />\n 1、配置多个 confxml.xml 文件（比如：www、bbs、blog.... 等等）<br />\n2、修改端口、同步路径、模块名称<br />\n 3、根据不同的需求同步对应的实例文件<br />\n /usr/local/sersync/sersync2 -dro /usr/local/sersync/www_confxml.xml<br />\n/usr/local/sersync/sersync2 -dro /usr/local/sersync/bbs_confxml.xml</p>\n",
            "tags": [
                "rsync"
            ]
        }
    ]
}